(function(){function t(u,n,a,h){function p(d,l){var q=0;"object"===typeof l&&0!==l.length?angular.forEach(d,function(d,f){a.containsObject(d.carClass,l)&&q++}):q=d.length;return q}function d(a){var l=[],d;angular.forEach(a,function(a){d=a.carClass?a.carClass:a;l.push(d)});return l}return{getVehicleTypeDisplayName:function(a,d){var l;angular.isDefined(d)&&(l=d[0].description+" ("+p(a,d[0].cargroup)+")");return l},getCountByVehicleType:p,filterByVehicleClass:function(k,l){var q=[];angular.forEach(k,
function(k,f){a.containsObject(k.carClass,d(l))&&q.push(k)});return q},getVehicleGroups:d,getVehicleClasses:function(a){var d=[],k;angular.forEach(a,function(a){k={carClass:a};d.push(k)});return d},filterBySpeacialFeatures:function(a,d){var l=[],k={};angular.forEach(d,function(a){k[a]=!0;if("abg"===a||"ABG"===a)k.abgquantity={size:6,condition:"\x3e"}});return l=h("customFeaturesFilter")(a,k)},getOtherVehiclesList:function(d,l){var k=[];angular.forEach(d,function(d,f){a.containsObject(d,l)||k.push(d)});
return k},getOrderedList:function(a,d){var l=[];angular.forEach(d,function(d,f){angular.forEach(a,function(a,f){d==a.makeModel&&l.push(a)})});return l}}}angular.module("carRental").service("carGuideService",t);t.$inject=["$http","$q","utilityService","$filter"]})();
(function(){function t(u,n,a,h,p,d,k){function l(a){var d=[];angular.forEach(a,function(a){-1==d.indexOf(a.carClass)&&d.push(a.carClass)});return d}var q=this;q.fleetInfo=function(a){a=a.currentTarget;var d=angular.element(a).closest(".car-title-container");angular.element(d).find(".car-title-box").toggleClass("image-opacity");angular.element(a).toggleClass("icon-remove");angular.element(d).find(".feature-car-facilities").toggleClass("bg-grey slide-bottom")};q.fleetReset=function(){if(angular.element(".car-title-container")){var a=
angular.element(".car-title-container");angular.element(a).find(".car-title-box").removeClass("image-opacity");angular.element("icon-remove").removeClass("icon-remove");angular.element(a).find(".feature-car-facilities").removeClass("bg-grey slide-bottom")}};q.toggleFilters=function(a){if(q.disableVehicleType)return!1;q.vehicleTypeListDisplay=!q.vehicleTypeListDisplay};q.getCarCountByClass=function(a){return p.getCountByVehicleType(q.fleetList,a)};q.filterVehicle=function(a,l){q.filteredCarClass=a.cargroup;
0==q.filteredCarClass.length||q.filteredCarClass==q.availableCarClass?(q.showAdditionalVehicles=!1,q.filteredCarClass=q.availableCarClass):q.showAdditionalVehicles=!0;q.selectedFilter=a;q.mobileSelectedVehicleType=a;q.filteredSearch=!1;a.code!=h.defaultDisplayedVehicleType&&(q.filteredSearch=!0);q.displayedVehicleType=a.code;q.visibleVehicleType=a.code===h.defaultDisplayedVehicleType?"":a.description;q.vehicleTypeListDisplay=!1;q.vehicleTypeDisplayName=a.description+" ("+q.getCarCountByClass(a.cargroup)+
")";var z=p.getVehicleClasses(a.cargroup);l?(q.vehicleTypeDisplayName=Dictionary.I18n.get("msg.res.specialFeature"),q.fleetFilteredList=p.filterBySpeacialFeatures(q.fleetList,q.selectedFeatures.list),q.otherfleet=p.getOtherVehiclesList(q.fleetList,q.fleetFilteredList)):""==z?(q.fleetFilteredList=q.fleetList,q.otherfleet=[]):(q.fleetFilteredList=p.filterByVehicleClass(q.fleetList,p.getVehicleClasses(a.cargroup)),q.otherfleet=p.getOtherVehiclesList(q.fleetList,q.fleetFilteredList));q.fleetReset();q._collapseSortFilter();
d(function(){var a=n.deviceType===h.deviceTypeMobile?"focus":"hover";jQuery('a.popOver[data-toggle\x3d"popover"], a.steptwoinfo[data-toggle\x3d"popover"], a.info-icon[data-toggle\x3d"popover"]').attr("data-trigger",a);jQuery('[data-toggle\x3d"popover"]').popover()},0)};q.getFeatureCount=function(a){var d={};d[a]=!0;if("abg"===a||"ABG"===a)d.abgquantity={size:6,condition:"\x3e"};return 0===k("customFeaturesFilter")(q.fleetList,d).length?!0:!1};q.showFeaturesForMobile=function(a){q.fleetFeatures=a};
q.specialFeatureDialogClose=function(){jQuery(".myModalSpecial").modal("hide");jQuery("body").removeClass("modal-open")};q.step1ARedirect=function(d){a.location.href=n.contextPath+"/"+n.locale+"/reservation/make-reservation"+htmlExtension+"?preferredCarClass\x3d"+d.carClass};q.updateMobileView=function(){!angular.equals({},q.mobileSelectedVehicleType)&&q.mobileSelectedVehicleType?q.filterVehicle(q.mobileSelectedVehicleType,!1):q._collapseSortFilter()};q.assignSelectedVehicleType=function(a){q.mobileSelectedVehicleType=
a;q.vehicleTypeDisplayName=a.description+" ("+q.getCarCountByClass(a.cargroup)+")";jQuery(".allvehimodalformob")&&jQuery(".allvehimodalformob").modal("hide")};q.openSpecialFeatureModal=function(){jQuery(".myModalSpecial").modal("show")};q.redirectCarGuidePage=function(d){a.location.href=d};q.getFleetData=function(a){return angular.fromJson(a)};q.selectedCountry={};q.fleetList={};q.availableCarClass;q.fleetFilteredList=[];q.filteredCarClass=[];q.vehicleTypes={};q.specialFeaturesList={};q.vehicleTypeDisplayName=
h.defaultVehicleTypeDesc;q.vehicleTypeListDisplay=!1;q.disableVehicleType=!0;q.displayedVehicleType=h.defaultDisplayedVehicleType;q.selectedFeatures={list:[]};q.otherfleet={};q.fleetFeatures={};q.mobileSelectedVehicleType={};q.orderedList=a.orderedList;q.enableOrdering=a.enableAuthorSort;q.filteredSearch=!1;q._loadCarGuideGrid=function(){var d=angular.fromJson(a.fleetList);q.fleetList=d;q.availableCarClass=l(q.fleetList);if(angular.isDefined(q.enableOrdering)&&"true"==q.enableOrdering){var f=angular.copy(q.fleetList);
q.orderedFleetList=p.getOrderedList(f,q.orderedList)}q.filteredCarClass=q.availableCarClass;q.fleetFilteredList=q.fleetList;f=angular.fromJson(a.vehicleTypes);if(""!=f&&void 0!=f){q.vehicleTypes=f.CarGroups;if(n.deviceType===h.deviceTypeMobile&&angular.isDefined(q.vehicleTypes)){var z={code:"spl",description:Dictionary.I18n.get("lbl.res.step2.specialFeaturesFilter")};q.vehicleTypes.push(z)}q.specialFeaturesList=f.specialFeatures;angular.forEach(q.specialFeaturesList,function(a,d){a.name=a.name.toLowerCase();
a.value=!1})}""==d||void 0==d||angular.equals({},f)||(q.vehicleTypeDisplayName=p.getVehicleTypeDisplayName(d,q.vehicleTypes),q.disableVehicleType=!1,q.vehicleTypeListDisplay=!1);if("avis"==a.brand||"budget"==a.brand)q.electricVehicleFeatures=!0;n.requestInProgress=!1};q._collapseSortFilter=function(){angular.element("#vehicleModal")&&angular.element("#vehicleModal").modal("hide");angular.element(".allvehimodalformob")&&angular.element(".allvehimodalformob").modal("hide");angular.element(".myModalVehicleDrpDwn")&&
angular.element(".myModalVehicleDrpDwn").modal("hide");angular.element("#mobile-drop")&&angular.element("#mobile-drop").removeClass("open")};n.requestInProgress=!0;jQuery(document).ready(function(){q._loadCarGuideGrid()})}angular.module("carRental").controller("CarGuide",t);t.$inject="$scope $rootScope $window carRentalConstant carGuideService $timeout $filter".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f){var z=this;z.offerSignup={};z.emailErrmsg=!1;z.showSuccessCon=!1;z.offerSignup.business=!1;z.signUpSubmit=function(a){q.validate(a).success(z._validationSuccess).error(z._validationFailure)};z.getCSSClass=function(a){var d="";""==f.current.name&&-1<J.indexOf("home")?d="offers-emailcontainer-homepage":""==f.current.name&&(d=a);return d};z._validationSuccess=function(){n.brand==p.brandName.PAYLESS?d.httpPost(z.offerSignup,"/mail/subscribe").then(function(a){angular.isDefined(a)&&
angular.isDefined(a.instructionList)&&0<a.instructionList.length&&"07002"==a.instructionList[0].code?(z.mainErrorFlag=!1,z.successFlag=!0,z.successMessage=a.instructionList[0].message):angular.isDefined(a)&&angular.isDefined(a.message)&&(z.mainErrorFlag=!0,z.successFlag=!1,z.errorMessage=angular.isDefined(a.message.message)?a.message.message:"")}):(angular.element("#signUpEmail2").attr("disabled",!1),document.subscribeFooterForm.submit())};z._validationFailure=function(a){z.mainErrorFlag=!1;1<a.errorCount&&
(z.mainErrorFlag=!0,z.successFlag=!1,z.errorMessage=Dictionary.I18n.get("err.res.mutliplemsg"))};l=window.location.hostname;var J=window.location.pathname,B=x.search();z.countriesList=angular.fromJson(n.countryList);x=a.getStorageData("customer");a=a.getStorageData("session");z.hostNameSuccess="https://"+l+J+"#/?flag\x3dSUCCESS";z.hostNameFailure="https://"+l+J+"#/?flag\x3dFAILURE";z.hostNameUnsub="https://"+l+J+"#/?flag\x3dUNSUB";B.flag&&("SUCCESS"===B.flag?z.showSuccessCon=!0:"FAILURE"===B.flag&&
(z.emailErrmsg=!0));!angular.isDefined(a)||"AUTHENTICATED"!=a.status&&"RECOGNIZED"!=a.status?z.uEmail="":z.uEmail=x.contacts.email;k(function(){if(B.flag){var a=jQuery(".offers-grids.deals-signup").offset().top-70;$("body,html").animate({scrollTop:a})}},3E3);u=h("SignUpExnCntrl",{$scope:u});angular.extend(this,u)}angular.module("carRental").controller("SignUpCntrl",t);t.$inject="$scope $window storageService $controller carRentalConstant getVehicles $timeout language $validation $location $state".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,z,J,B,y,F,C,r,G,t,m,w,H,A,v,e,g,O,Q){function D(){b.sessionErrorMessage=t.getStorageData("sessionErrMsg");q.deleteDataBeforeLogoClick();ia();a.requestInProgress=!0;b.vehicleExchangeObj=angular.isDefined(t.getStorageData("vehicleExchangeObj"))?t.getStorageData("vehicleExchangeObj"):b.vehicleExchangeObj;var e=B.readQuery("id");angular.isDefined(q.getUrlParameter("vol_key"))?(e=new Map,e.set("uniqueId",q.getUrlParameter("vol_key")),e.set("ancillary",q.getUrlParameter("product")),
e.set("eventType",q.getUrlParameter("carrier")),u.init({uniqueId:e.has("uniqueId")&&void 0!=e.get("uniqueId")&&0<e.get("uniqueId").length?e.get("uniqueId"):"",ancillary:e.has("ancillary")&&void 0!=e.get("ancillary")&&0<e.get("ancillary").length?e.get("ancillary").toUpperCase():""},"new").then(function(c){a.requestInProgress=!1;a.$broadcast("getRentalDetails",c);b.rentalDetails=c;U();I()},function(b){console.log("error in rental/extras call");a.requestInProgress=!1;k.location.href=a.contextPath+"/"+
a.locale+"/reservation/view-modify-cancel"+htmlExtension})):u.init(e,"old").then(function(c){a.requestInProgress=!1;a.$broadcast("getRentalDetails",c);b.rentalDetails=c;U();I()},function(b){console.log("error in rental/extras call");a.requestInProgress=!1;k.location.href=a.contextPath+"/"+a.locale+"/reservation/view-modify-cancel"+htmlExtension});angular.isDefined(b.reservationModel.paymentRq.expMonth)&&""==b.reservationModel.paymentRq.expMonth&&(b.reservationModel.paymentRq.expMonth=null);angular.isDefined(b.reservationModel.paymentRq.expYear)&&
""==b.reservationModel.paymentRq.expYear&&(b.reservationModel.paymentRq.expYear=null)}function I(){b.sessionErrorMessage&&($("#rentalErrorModal").modal("show"),t.deleteStorageData("sessionErrMsg"))}function U(){k.scrollTo(0,0);b.rentalModel.epIndicator=b.rentalDetails.epIndicator;b.rentalNumber=b.rentalDetails.reservationSummary.rentalAgreementNumber;angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary.splitBillEnabled)&&
(b.rentalModel.availedSplitbill=b.rentalDetails.reservationSummary.splitBillSummary.splitBillEnabled);angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.personalInfo)&&angular.isDefined(b.rentalDetails.reservationSummary.personalInfo.residency)&&angular.isDefined(b.rentalDetails.reservationSummary.personalInfo.residency.value)&&(b.reservationModel.paymentRq.address.country=b.rentalDetails.reservationSummary.personalInfo.residency.value);b._populateAddressFields();
b._displayCarFeatures();b._loadMnthYrDropdown();angular.isDefined(b.addresses)&&!$.isEmptyObject(b.addresses)&&b._getAddressList(b.addresses);b._populateBillingInfoCountryList();"avis"==b.brand&&b.getStatesForCountry(b.reservationModel.paymentRq.address.country,"onload");if(angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary))var X={splitOpted:b.rentalDetails.reservationSummary.splitBillSummary.splitBillEnabled,cardNumber:angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary)&&
null!=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary)&&null!=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary.number)&&null!=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary.number?b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary.number:
""};y.addToSplitDetails(X);angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary)&&null!=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary)&&null!=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary&&
(b.secondaryCardSelected=angular.copy(b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary),angular.isDefined(b.secondaryCardSelected.expiryMsg)&&(b.warningMsgSC=n.processErrorMessage(b.secondaryCardSelected).expiryMsg));angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary.splitBillPrimary)&&b.rentalDetails.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary&&
(b.primaryCard=angular.copy(b.rentalDetails.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary),angular.isDefined(b.primaryCard.expiryMsg)&&(b.warningMsgPC=n.processErrorMessage(b.primaryCard).expiryMsg));V.rentalLocation=b.rentalDetails.reservationSummary.pickLoc.address.country;a.$broadcast("setReviewCreditCard",V);b.rentalDetails.emailSmsNotification.indicator&&angular.forEach(b.rentalDetails.reservationSummary.productSummaryList,function(c){if("XMR"==b.rentalDetails.emailSmsNotification.product&&
"XMR"==c.code||"CSD"==b.rentalDetails.emailSmsNotification.product&&"CSD"==c.code)b.productCheckbox[c.code]=!0,b.productSelected(c,c.code,"",c.code+"productCheck")});try{x.analyticsRentalDetails(b.rentalDetails,"viewModifyPage")}catch(N){}X=document.referrer;var c=document.location.origin+a.contextPath+"/"+a.locale+"/rental/rental-dashboard"+htmlExtension,K=e.url();if(0<K.length)b.events.redirect(f.modifyRentalStateTabMap[K],!0);else{X!=c&&(b.rentalDetails.tabDisplayControl.tab1.active=!1,b.rentalDetails.tabDisplayControl.tab2.active=
!1,b.rentalDetails.tabDisplayControl.tab3.active=!1,b.rentalDetails.tabDisplayControl.tab4.active=!1);(q.getUrlParameter("vol_key")||B.readQuery("id"))&&b.events.redirect("tab1");K=0;for(var E=1;4>=E;E++)1==b.rentalDetails.tabDisplayControl["tab"+E].visible&&K++;1>=K&&X!=c?(b.rentalDetails.tabDisplayControl.tab3.active=!0,b.events.redirect("tab3")):(b.rentalDetails.tabDisplayControl.tab1.active=!1,b.rentalDetails.tabDisplayControl.tab2.active=!1,b.rentalDetails.tabDisplayControl.tab3.active=!1,b.rentalDetails.tabDisplayControl.tab4.active=
!1)}b.rentalDetails.tabDisplayControl.tab1.active&&Y();0==b.rentalDetails.tabDisplayControl.tab4.visible&&angular.element(".sp-rental-container .nav-tabs li:nth-last-child(2) a").css("border-bottom","none");jQuery(".hide-on-load-profile").removeClass("hide-on-load-profile")}function Z(a,c){if(!0===a)for(a=1;4>=a;a++){var e="tab"+a;b.rentalDetails.tabDisplayControl[e].active=e===c?!0:!1}"tab2"===c&&setTimeout(function(){$("#rentalCal").click(function(){jQuery(".end-date-input").datepicker("show")})},
500)}function aa(e,c){e=F.getDateFormat(e);b.dateFormatPalceholder=e.dateFormatPalceholder;w.datePickerInitFun(a.deviceType,e.dateFormat.format);e=h("date")(c.reservationSummary.pickDateTime,"yyyy-MM-dd");c=h("date")(c.reservationSummary.dropDateTime,"yyyy-MM-dd");if(""!=e){e=jQuery.datepicker.parseDate("yy-mm-dd",e);jQuery(".start-date-input").datepicker("setDate",e).trigger("change");jQuery(".start-date-input").datepicker("option","dpheaderlabel",ba(e));var K=new Date,E=new Date(e);e>K&&(K=e);E.setDate(E.getDate()+
30);jQuery(".end-date-input").datepicker("option",{minDate:K,maxDate:E})}""!=c&&(c=jQuery.datepicker.parseDate("yy-mm-dd",c),jQuery(".end-date-input").datepicker("setDate",c).trigger("change"),jQuery(".end-date-input").datepicker("option","dpheaderlabel",ba(c)))}function ba(b){var c=b.getDate(),a=b.getMonth();b=b.getDay();return jQuery.datepicker.regional[internalLocale].dayNames[b]+" \x3cspan\x3e"+jQuery.datepicker.regional[internalLocale].monthNamesShort[a]+" "+c+"\x3c/span\x3e"}function ca(a,c){b.times=
a&&a.preferences.timeFmt===f.timeFmtHmm?f.timeMilitaryFormat:f.timeDefaultFormat;b.times[0].minits=Dictionary.I18n.get("msg.res.midnight");b.times[24].minits=Dictionary.I18n.get("msg.res.defaultTime")}function da(){b.errorAmountSplit="";b.primaryDayValue="";b.secondaryDayValue="";b.rentalModel.daySplitConfirmCTA=!1;b.errorDaySplit=""}function M(a,c,e,E,N){a&&(window.dataLayer=[],q.addGTMScript());setTimeout(function(){if("splitbill"==e||"splitByType"==e){var a=angular.isDefined(b.rentalDetails.reservationSummary)&&
angular.isDefined(b.rentalDetails.reservationSummary.gateExitDone)&&!0===b.rentalDetails.reservationSummary.gateExitDone?"Mid Rental":"Pre Rental";N=angular.isDefinedAndNotNull(N)?N:a;x.analyticsSplitbillClickEvents({eventCategory:e,eventLabel:c,data:E,rentalState:N});dataLayer.push({event:"customDimension",bookingState:"Mid Rental"==a?"Mid-Rental":"Pre-Rental","resConfirmationNum-rentalAggrementNum":b.rentalDetails.reservationSummary.confirmationNumber+"-"+b.rentalDetails.reservationSummary.rentalAgreementNumber})}else"select"==
e||"unselect"==e?x.analyticsRentalClickEvents(b.rentalDetails,c,e):x.analyticsRentalClickEvents(b.rentalDetails,c)},100)}function ja(b,c){e.url(f.modifyRentalTabMap[b]);c()}function S(a){b.prodItemizedPri=null==a.reservationSummary.splitBillSummary.splitBillPrimary.productmap?{}:a.reservationSummary.splitBillSummary.splitBillPrimary.productmap;b.insuranceItemizedPri=null==a.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap?{}:a.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap;
var c=u.displayDropDown(b.prodItemizedPri,b.insuranceItemizedPri,"primary",a);b.dropDownValue.insDropDownPri=c.insDrop;b.dropDownValue.proDropDownPri=c.proDrop;null!=a.reservationSummary.splitBillSummary.splitBillSecondary&&(b.prodItemizedSec=null==a.reservationSummary.splitBillSummary.splitBillSecondary.productmap?{}:a.reservationSummary.splitBillSummary.splitBillSecondary.productmap,b.insuranceItemizedSec=null==a.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap?{}:a.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap);
angular.isDefinedAndNotNull(a.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount)&&angular.isDefinedAndNotNull(a.reservationSummary.splitBillSummary.splitBillSecondary)&&null!=a.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount&&null!=a.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount&&angular.isUndefined(b.primaryAmount)&&angular.isUndefined(b.secondaryAmount)&&(b.itemizedPrimaryAmount=a.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount,b.itemizedSecondaryAmount=
a.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount);c=u.displayDropDown(b.prodItemizedSec,b.insuranceItemizedSec,"secondary",a);b.dropDownValue.insDropDownSec=c.insDrop;b.dropDownValue.proDropDownSec=c.proDrop;1==a.reservationSummary.splitBillSummary.numberOfDays?(b.primaryValue=a.reservationSummary.splitBillSummary.splitBillPrimary.lengthOfRental,b.secondaryValue=a.reservationSummary.splitBillSummary.splitBillSecondary.lengthOfRental,b.primaryValue=1<b.primaryValue||0==b.primaryValue?
b.primaryValue+" Days":b.primaryValue+" Day",b.secondaryValue=1<b.secondaryValue||0==b.secondaryValue?b.secondaryValue+" Days":b.secondaryValue+" Day"):(b.primaryValue=null,b.secondaryValue=null);angular.forEach(a.reservationSummary.productSummaryList,function(c){c.subProducts&&0<c.subProducts.length?angular.forEach(c.subProducts,function(c){"PER_RENTAL"==c.category&&(b.cubsideSelected[c.code]=b.prodItemizedPri[c.code]==b.rentalDetails.reservationSummary.lengthOfRental?"primary":b.prodItemizedSec[c.code]==
b.rentalDetails.reservationSummary.lengthOfRental?"secondary":null)}):"PER_RENTAL"==c.category&&(b.cubsideSelected[c.code]=b.prodItemizedPri[c.code]==b.rentalDetails.reservationSummary.lengthOfRental?"primary":b.prodItemizedSec[c.code]==b.rentalDetails.reservationSummary.lengthOfRental?"secondary":null)})}function ea(a,c){if(c)for(c=0;c<b.product.selectedProduct.length;c++)if(a===b.product.selectedProduct[c].code){b.product.selectedProduct.splice(c,1);break}}function Y(){b.product.selectedAvailableProducts=
[];angular.isDefined(b.rentalDetails)&&angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.productSummaryList)&&(angular.forEach(b.rentalDetails.reservationSummary.productSummaryList,function(a){(a.visible||angular.isDefined(a.ismandatory)&&"true"==a.ismandatory)&&b.product.selectedAvailableProducts.push(a);1==a.selected&&a.visible&&angular.forEach(b.product.selectedProduct,function(c){c.code!=a.code&&b.product.selectedProduct.push(a)});a.visible&&
0==a.selected&&(b.rentalDetails.productVisible=!0);b.cubsideSelected={};"PER_RENTAL"==a.category&&1==a.selected&&(b.rentalModel.enableCta=!1,b.cubsideSelected[a.code]="secondary")}),b.product.selectedAvailableProducts&&0<b.product.selectedAvailableProducts.length&&(b.rentalDetails.reservationSummary.productSummaryList=b.product.selectedAvailableProducts),y.addRentalProducts(b.product.selectedProduct))}function fa(){angular.isDefined(b.rentalDetails)&&angular.isDefined(b.rentalDetails.reservationSummary)&&
angular.isDefined(b.rentalDetails.reservationSummary.productSummaryList)&&angular.forEach(b.rentalDetails.reservationSummary.productSummaryList,function(a){void 0!=a.subProducts&&angular.forEach(a.subProducts,function(c){for(var a=c.code,E=c.displayQuantity,e=0;e<=E;e++)b.cssDropDownValues[a].push({selectId:e,selectName:e});b.cssDropDown[c.code]=0})})}function ha(){b.Insurance.selectedInsurance=[];angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.insuranceSummaryList)&&
(angular.forEach(b.rentalDetails.reservationSummary.insuranceSummaryList,function(a){a.visible&&(b.insuranceVisible=!0);a.selected&&a.visible&&b.Insurance.selectedInsurance.push(a)}),y.addRentalInsurances(b.Insurance.selectedInsurance))}function ka(a,c){if(c)for(c=0;c<b.Insurance.selectedInsurance.length;c++)if(a===b.Insurance.selectedInsurance[c].code){b.Insurance.selectedInsurance.splice(c,1);break}}function R(){a.requestInProgress=!0;b.Insurance.selectedInsurance=[];y.addRentalInsurances(b.Insurance.selectedInsurance);
b.product.selectedProduct=[];y.addRentalProducts(b.product.selectedProduct);u.getAncillaryList().then(function(e){b.rentalState.value=angular.isDefined(e.reservationSummary)&&angular.isDefined(e.reservationSummary.rentalState)&&"estimate"==e.reservationSummary.rentalState?!0:!1;b.rentalDetails=e;b.rentalDetails.reservationSummary.gebUser&&(b.rateSummary.totalAdditonalCharges=0);b.rentalDetails.reservationSummary.gebUser&&e.reservationSummary.splitBillSummary.splitBillSecondary&&e.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary&&
e.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary.number&&(b.rentalModel.availedSplitbill=!0);Y();fa();ha();Z(!0,"tab1");b.rentalModel.failExtras&&(b.rentalModel.failExtras=!1);a.requestInProgress=!1;b.requestInProgress=!1;1==b.rentalDetails.tabDisplayControl.tab3.active&&b.events.redirect("tab3")})}function T(e,c){b.error=[];a.requestInProgress=!0;b.rentalModel.dateTimeSelected=!1;b.modifiedData=e;u.modifyRentalExtension(e).then(function(K){b.hideStickySection&&(b.hideStickySection=
!1);b.rentalModel.tabFocus?L(!0):L(!1);angular.isDefined(K.reservationSummary.splitBillSummary)&&angular.isDefined(K.reservationSummary.splitBillSummary.splitBillEnabled)&&(b.rentalModel.availedSplitbill=K.reservationSummary.splitBillSummary.splitBillEnabled,b.rentalDetails.reservationSummary.splitBillSummary.splitBillEnabled=b.rentalModel.availedSplitbill);angular.isDefined(K.reservationSummary)&&angular.isDefined(K.reservationSummary.dropLoc)&&angular.isDefined(K.reservationSummary.dropLoc.locationCode)&&
(b.rentalModel.newLoc=K.reservationSummary.dropLoc.locationCode!=e.dropLocCode?!0:!1);angular.isDefined(K.reservationSummary)&&angular.isDefined(K.reservationSummary.rateSummary)&&angular.isDefined(K.reservationSummary.splitBillSummary)&&"estimate"==K.reservationSummary.rentalState&&(0<K.reservationSummary.rateSummary.totalAdditonalCharges||null!=K.reservationSummary.splitBillSummary.splitBillSecondary&&0<K.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount)?b.rentalModel.showSplitOpt=
!0:b.rentalModel.showSplitOpt=!1;b._loadMnthYrDropdown();b._populateBillingInfoCountryList();angular.isDefined(b.addresses)&&!$.isEmptyObject(b.addresses)&&b._getAddressList(b.addresses);angular.isDefined(K.reservationSummary)&&angular.isDefined(K.reservationSummary.personalInfo)&&angular.isDefined(K.reservationSummary.personalInfo.residency)&&angular.isDefined(K.reservationSummary.personalInfo.residency.value)&&(b.reservationModel.paymentRq.address.country=K.reservationSummary.personalInfo.residency.value);
"avis"==b.brand&&b.getStatesForCountry(b.reservationModel.paymentRq.address.country,"onload");b.rentalModel.showModifiedReturns=!1;b.rateSummary=K.reservationSummary.rateSummary;angular.isDefined(K.reservationSummary)&&angular.isDefined(K.reservationSummary.splitBillSummary)&&(b.rentalDetails.reservationSummary.splitBillSummary=K.reservationSummary.splitBillSummary);angular.isDefined(K.reservationSummary.gebUser)&&K.reservationSummary.gebUser&&angular.isDefined(K.reservationSummary.splitBillSummary)&&
K.reservationSummary.splitBillSummary.splitBillSecondary&&(b.rentalModel.availedSplitbill=!0);b.rentalState={value:"estimate"==K.reservationSummary.rentalState?!0:!1,tab:"Modify-Return"};M(!1,c);a.requestInProgress=!1;$("html, body").animate({scrollTop:$("#tabStart").position().top})},function(c){angular.isDefined(c.errorList)&&0<c.errorList.length&&(b.hideStickySection&&(b.hideStickySection=!1),L(!1),b.rentalModel.tabFocus?L(!0):L(!1),b.error=n.processErrorMessage(c).errorList,a.requestInProgress=
!1)})}function L(b){b?jQuery(".showTab-tab2").removeClass("sp-tab-geb-user"):jQuery(".showTab-tab2").addClass("sp-tab-geb-user")}var b=this;b.showPromo=!1;b.shuttleError=!1;b.init=D;b.rentalDetails={};b.rentalExtension={};b.rateSummary={};b.returnLoc="";b.returnDate="";b.pickDate="";b.dropTime="";b.helpURL="";b.cubsideSelected={};b.previousSplitType="";b.secondaryCardSelected={number:""};b.oldSecondaryCardSummary={};b.dropDownValue={proDropDownPri:{},insDropDownPri:{},proDropDownSec:{},insDropDownSec:{},
primaryValue:null,secondaryValue:null};b.brand=k.brand;b.warningMsgPC={};b.warningMsgSC={};b.domain=k.domain.toUpperCase();b.expMonths=[];b.rentalDays={productDays:{primaryValues:[],secondaryValues:[]},insuranceDays:{primaryValues:[],secondaryValues:[]},vehicleDays:[]};b.totalDays="";var V={rentalLocation:""};b.secondaryValue=null;b.prefilledZipcode="";b.primaryValue=null;b.selectedAddress="";b.rentalModel={primary:!1,changedCard:!1,loc:!1,newLoc:!1,showCity:!1,showState:!1,showZipcode:!1,showSuburb:!1,
epIndicator:!1,saveCreditCard:!1,enableCta:!1,formValidated:!1,latError:!1,hideItemizedTab:!1,unsplit:!1,date:!1,time:!1,locationChanged:!1,confirmSuccess:!1,amountSplitConfirmCTA:!1,daySplitConfirmCTA:!1,rentalSummary:!0,tabFocus:!1,showSplitOpt:!1,showExtras:!1,showModifiedReturns:!1,dateTimeSelected:!1,confirmMessage:!1,modifyReturnActive:!1,addtionalTrue:!1,failExtras:!1,showAlertMessage:!1};b.countryList={};b.prodItemizedPri={};b.prodItemizedSec={};b.insuranceItemizedPri={};b.insuranceItemizedSec=
{};b.addresses=[];b.billingAddress={address1:"",address2:"",address3:"",city:"",state:null,zipCode:""};b.additionalVehicleData={licensePlateNumber:"",lotSpaceNumber:""};b.displayAdditionalVehicleData=!1;b.split={};b.clickedtab="";b.instructionMessageList=[];b.addressDisplayList=[];b.pageArray=[];b.rentalState={value:!1,tab:""};b.indicatorMap={credit_id:"",address_id:""};b.modifiedData={};b.extentionSplitData={};b.primaryAmountOldValue="";b.secondaryAmountOldValue="";b.rentalNumber="";b.Insurance=
{selectedInsurance:[],selectedAvailableInsurances:[]};b.product={selectedProduct:[],selectedAvailableProducts:[]};b.isBackButton=!0;b.hidePaymentInfo=!1;b.splitOptionTab={};b.cssDropDown={};b.cssDropDownValues={CBS:[],CFS:[],CIS:[],CSB:[],CSS:[],BXM:[],BXS:[],BXL:[]};b.expandCSS=!1;b.expandCSSServ=!1;b.thresholdMsg=!1;b.vehicleExchangeObj={flow:!1,thresholdError:!1};b.rentalUtil=O;b.reservationModel=angular.copy(q.bookingModel);b._loadMnthYrDropdown=function(){var a=ABG.loadMonthAndYear();b.expMonths=
a.expMonths;b.expYears=a.expYears};b._itemizedDropdown=function(){b.rentalDays.productDays.primaryValues=[];b.rentalDays.productDays.secondaryValues=[];b.rentalDays.insuranceDays.primaryValues=[];b.rentalDays.insuranceDays.secondaryValues=[];"number"===typeof b.primaryValue&&(b.primaryValue=1<b.primaryValue||0==b.primaryValue?b.primaryValue+" Days":b.primaryValue+" Day");"number"===typeof b.secondaryValue&&(b.secondaryValue=1<b.secondaryValue||0==b.secondaryValue?b.secondaryValue+" Days":b.secondaryValue+
" Day");if(0!=b.secondaryValue||"0 Days"!=b.secondaryValue)b.rentalDays.productDays.secondaryValues.push(b.secondaryValue),b.rentalDays.insuranceDays.secondaryValues.push(b.secondaryValue);if(0!=b.primaryValue||"0 Days"!=b.primaryValue)b.rentalDays.productDays.primaryValues.push(b.primaryValue),b.rentalDays.insuranceDays.primaryValues.push(b.primaryValue);"number"===typeof b.totalDays&&(b.totalDays=1<b.totalDays||0==b.totalDays?b.totalDays+" Days":b.totalDays+" Day");var a=parseInt(b.secondaryValue.replace(/^[^0-9]+/,
"")),c=parseInt(b.totalDays.replace(/^[^0-9]+/,""));a!=c&&(b.rentalDays.productDays.secondaryValues.push(b.totalDays),b.rentalDays.insuranceDays.secondaryValues.push(b.totalDays));b.checkForMaxDaysExtras(b.prodItemizedPri,b.insuranceItemizedPri,"primary");b.checkForMaxDaysExtras(b.prodItemizedSec,b.insuranceItemizedSec,"secondary")};b.getStatesForCountry=function(a,c){"onchange"==c&&(b.billingAddress.address1="",b.billingAddress.address2="",b.billingAddress.address3="",b.billingAddress.suburb="",
b.billingAddress.city="",b.billingAddress.state="",b.billingAddress.zipCode="");!b.countryList||void 0==a||""==a||a!==f.countryCodeAU&&a!==f.countryCodeCA&&a!==f.countryCodeUS||(c=b.countryList.indexOf(h("filter")(b.countryList,function(b){return b.code===a})[0]),b.statesForCountry=b.countryList[c].stateList);b._displayFunction(a)};b._getAddressList=function(a){b.addressDisplayList=[];angular.forEach(a,function(c){var a={code:"",description:""};"1"==c.maskId&&(a.code="1",a.description="Primary Address",
b.addressDisplayList.push(a),b.selectedAddress="Primary Address",b.reservationModel.paymentRq.address.address1=c.address1,b.reservationModel.paymentRq.address.address2=c.address2,b.reservationModel.paymentRq.address.address3=c.address3,b.reservationModel.paymentRq.address.city=c.city,b.reservationModel.paymentRq.address.state=c.state,b.reservationModel.paymentRq.address.zipCode=c.zipCode,b.reservationModel.paymentRq.address.country=c.country,angular.forEach(b.countryList,function(c){c.code==b.addresses[0].country&&
(b.reservationModel.paymentRq.address.country=c.name)}),b.indicatorMap.address_id=c.maskId);"2"==c.maskId&&(a.code="2",a.description="Secondary Address",b.addressDisplayList.push(a))});return b.addressDisplayList};b._populateRentalDays=function(a){b.totalDays=a;for(a=1;a<b.totalDays;a++){var c=a;a=1==a?a+" Day":a+" Days";b.rentalDays.vehicleDays.push(a);a=c}for(a=0;a<=b.totalDays;a++)c=a,a=1==a?a+" Day":a+" Days",b.rentalDays.productDays.primaryValues.push(a),b.rentalDays.productDays.secondaryValues.push(a),
b.rentalDays.insuranceDays.primaryValues.push(a),b.rentalDays.insuranceDays.secondaryValues.push(a),a=c};b._displayCarFeatures=function(){b.vehicleFeatures=[];angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.vehicle)&&angular.isDefined(b.rentalDetails.reservationSummary.vehicle.vehicleFeatures)&&angular.forEach(b.rentalDetails.reservationSummary.vehicle.vehicleFeatures,function(a){"Air"!=a.name&&"Auto"!=a.name&&"NS"!=a.name&&"mpg"!=a.name||
!a.webEnabled||b.vehicleFeatures.push(a)});angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.onAirportIndicator)&&1==b.rentalDetails.reservationSummary.onAirportIndicator&&angular.isDefined(b.rentalDetails.reservationSummary.vehicle)&&angular.isDefined(b.rentalDetails.reservationSummary.vehicle.vehicleFeatures)&&angular.forEach(b.rentalDetails.reservationSummary.vehicle.vehicleFeatures,function(a){"licensePlateNumber"==a.name?b.additionalVehicleData.licensePlateNumber=
a.value:"lotSpaceNumber"==a.name&&(b.additionalVehicleData.lotSpaceNumber=a.value);b.displayAdditionalVehicleData=!0})};b._add=function(a,c){if(angular.isDefined(c))var e=c.code;b.primaryValue="string"===typeof b.primaryValue?parseInt(b.primaryValue.replace(/^[^0-9]+/,"")):b.primaryValue;b.secondaryValue="string"===typeof b.secondaryValue?parseInt(b.secondaryValue.replace(/^[^0-9]+/,"")):b.secondaryValue;b.totalDays="string"===typeof b.totalDays?parseInt(b.totalDays.replace(/^[^0-9]+/,"")):b.totalDays;
if(b.primaryDayValue==b.totalDays||b.secondaryDayValue==b.totalDays)b.rentalModel.daySplitConfirmCTA=!1;if(a==f.splitInRental.PRIMARYDAY&&b.primaryDayValue!=b.totalDays)b.secondaryDayValue=b.totalDays-b.primaryDayValue,e={splitType:f.splitInRental.DAY,days:b.secondaryDayValue,splitOpted:b.rentalModel.availedSplitbill,estimateCall:!0,secondaryCreditCard:b.secondaryCardSelected.number,rentalNumber:b.rentalNumber},y.addToSplitDetails(e),b.splitByTypeAPICall(e);else if(a==f.splitInRental.SECONDARYDAY&&
b.secondaryDayValue!=b.totalDays)b.primaryDayValue=b.totalDays-b.secondaryDayValue,e={splitType:f.splitInRental.DAY,days:b.secondaryDayValue,splitOpted:b.rentalModel.availedSplitbill,estimateCall:!0,secondaryCreditCard:b.secondaryCardSelected.number,rentalNumber:b.rentalNumber},y.addToSplitDetails(e),b.splitByTypeAPICall(e);else if("privalue-and-fees"==a){null==b.primaryValue?b.secondaryValue=null:(b.secondaryValue=b.totalDays-b.primaryValue,"number"===typeof b.totalDays&&(b.secondaryValue=1<b.secondaryValue||
0==b.secondaryValue?b.secondaryValue+" Days":b.secondaryValue+" Day"));if(0==b.secondaryValue||"0 Days"==b.secondaryValue)b.dropDownValue.secondaryValue="0 Days";var E=u.itemizedDropdown(b.primaryValue,b.secondaryValue,b.rentalDetails,"",a);b.prodItemizedSec=E.productItemizedSec;b.insuranceItemizedSec=E.insuranceItemizedSec;b.prodItemizedPri=E.productItemizedPri;b.insuranceItemizedPri=E.insuranceItemizedPri;b.cubsideSelected={};angular.forEach(b.prodItemizedSec,function(c,a){"PER_RENTAL"==c&&(b.cubsideSelected[a]=
"secondary")});e={days:"string"==typeof b.secondaryValue?parseInt(b.secondaryValue.replace(/^[^0-9]+/,"")):b.secondaryValue,splitOpted:b.rentalModel.availedSplitbill,estimateCall:!0,secondaryCreditCard:b.secondaryCardSelected.number,rentalNumber:b.rentalNumber,selectedProducts:E.selectedProducts,selectedInsurances:E.selectedInsurances,splitType:""};y.addToSplitDetails(e);b.splitByTypeAPICall(e)}else if("secvalue-and-fees"==a){null==b.secondaryValue?b.primaryValue=null:(b.primaryValue=b.totalDays-
b.secondaryValue,b.primaryValue=1<b.primaryValue||0==b.primaryValue?b.primaryValue+" Days":b.primaryValue+" Day");if(0==b.primaryValue||"0 Days"==b.primaryValue)b.dropDownValue.primaryValue="0 Days";E=u.itemizedDropdown(b.primaryValue,b.secondaryValue,b.rentalDetails,"",a);b.prodItemizedSec=E.productItemizedSec;b.insuranceItemizedSec=E.insuranceItemizedSec;b.prodItemizedPri=E.productItemizedPri;b.insuranceItemizedPri=E.insuranceItemizedPri;b.cubsideSelected={};angular.forEach(b.prodItemizedSec,function(c,
a){"PER_RENTAL"==c&&(b.cubsideSelected[a]="secondary")});e={days:"string"==typeof b.secondaryValue?parseInt(b.secondaryValue.replace(/^[^0-9]+/,"")):b.secondaryValue,splitOpted:b.rentalModel.availedSplitbill,estimateCall:!0,secondaryCreditCard:b.secondaryCardSelected.number,rentalNumber:b.rentalNumber,selectedProducts:E.selectedProducts,selectedInsurances:E.selectedInsurances,splitType:""};y.addToSplitDetails(e);b.splitByTypeAPICall(e)}else if(""!=e&&angular.isDefined(c)&&(""==c.category||void 0==
c.category))if(c=null,"string"===typeof b.totalDays&&(b.totalDays=parseInt(b.totalDays.replace(/^[^0-9]+/,""))),b.prodItemizedPri=b.getExtrasDays(b.prodItemizedPri),b.insuranceItemizedPri=b.getExtrasDays(b.insuranceItemizedPri),b.prodItemizedSec=b.getExtrasDays(b.prodItemizedSec),b.insuranceItemizedSec=b.getExtrasDays(b.insuranceItemizedSec),"primaryProduct"==a?(b.prodItemizedSec[e]=b.totalDays-b.prodItemizedPri[e],E=u.itemizedDropdown(b.prodItemizedPri,b.prodItemizedSec,b.rentalDetails,e,"product"),
b.dropDownValue.proDropDownPri[e]=0):"secondaryProduct"==a?(b.prodItemizedPri[e]=b.totalDays-b.prodItemizedSec[e],E=u.itemizedDropdown(b.prodItemizedPri,b.prodItemizedSec,b.rentalDetails,e,"product"),b.dropDownValue.proDropDownSec[e]=0):"primaryInsurance"==a?(b.insuranceItemizedSec[e]=b.totalDays-b.insuranceItemizedPri[e],E=u.itemizedDropdown(b.insuranceItemizedPri,b.insuranceItemizedSec,b.rentalDetails,e,"insurance"),b.dropDownValue.insDropDownPri[e]=0):"secondaryInsurance"==a&&(b.insuranceItemizedPri[e]=
b.totalDays-b.insuranceItemizedSec[e],E=u.itemizedDropdown(b.insuranceItemizedPri,b.insuranceItemizedSec,b.rentalDetails,e,"insurance"),b.dropDownValue.insDropDownSec[e]=0),"primaryProduct"==a||"secondaryProduct"==a)null!=b.secondaryValue&&(c=b.secondaryValue),e={days:c,splitOpted:b.rentalModel.availedSplitbill,estimateCall:!0,secondaryCreditCard:b.secondaryCardSelected.number,rentalNumber:b.rentalNumber,selectedProducts:E.selectedProducts,selectedInsurances:E.selectedInsurances,splitType:""},y.addToSplitDetails(e),
b.splitByTypeAPICall(e);else{if("primaryInsurance"==a||"secondaryInsurance"==a)null!=b.secondaryValue&&(c=b.secondaryValue),e={days:c,splitOpted:b.rentalModel.availedSplitbill,estimateCall:!0,secondaryCreditCard:b.secondaryCardSelected.number,rentalNumber:b.rentalNumber,selectedProducts:E.selectedProducts,selectedInsurances:E.selectedInsurances,splitType:""},y.addToSplitDetails(e),b.splitByTypeAPICall(e)}else if("primary"==a&&angular.isDefined(c)&&"PER_RENTAL"==c.category){E=u.itemizedDropdown(b.prodItemizedPri,
b.prodItemizedSec,b.rentalDetails,e,"product");for(a=0;a<E.selectedProducts.length;a++)if(c=E.selectedProducts[a],e===c.code){E.selectedProducts.splice(a,1);break}c={quantity:"1",code:e,days:0};E.selectedProducts.push(c);e={days:0,splitOpted:b.rentalModel.availedSplitbill,estimateCall:!0,secondaryCreditCard:b.secondaryCardSelected.number,rentalNumber:b.rentalNumber,selectedProducts:E.selectedProducts,selectedInsurances:E.selectedInsurances,splitType:""};y.addToSplitDetails(e);b.splitByTypeAPICall(e)}else if("secondary"==
a&&angular.isDefined(c)&&"PER_RENTAL"==c.category){E=u.itemizedDropdown(b.prodItemizedPri,b.prodItemizedSec,b.rentalDetails,e,"product");for(a=0;a<E.selectedProducts.length;a++)if(c=E.selectedProducts[a],e===c.code){E.selectedProducts.splice(a,1);break}c={quantity:"1",code:e,days:b.rentalDetails.reservationSummary.lengthOfRental};E.selectedProducts.push(c);e={days:0,splitOpted:b.rentalModel.availedSplitbill,estimateCall:!0,secondaryCreditCard:b.secondaryCardSelected.number,rentalNumber:b.rentalNumber,
selectedProducts:E.selectedProducts,selectedInsurances:E.selectedInsurances,splitType:""};y.addToSplitDetails(e);b.splitByTypeAPICall(e)}};b._populateAddressFields=function(){b.rentalModel.epIndicator?angular.isDefined(b.rentalDetails.reservationSummary.address)&&angular.isDefined(b.rentalDetails.reservationSummary.addresses)?(b.addresses=b.rentalDetails.reservationSummary.addresses,b.prefilledZipcode=b.rentalDetails.reservationSummary.addresses[0].zipCode):angular.isDefined(b.rentalDetails.reservationSummary.address)&&
!angular.isDefined(b.rentalDetails.reservationSummary.addresses)?(b.addresses.push(b.rentalDetails.reservationSummary.address),b.prefilledZipcode=b.rentalDetails.reservationSummary.address.zipCode):angular.isDefined(b.rentalDetails.reservationSummary.addresses)&&!angular.isDefined(b.rentalDetails.reservationSummary.address)&&(b.addresses=b.rentalDetails.reservationSummary.addresses,b.prefilledZipcode=b.rentalDetails.reservationSummary.addresses[0].zipCode):b.rentalDetails.reservationSummary&&b.rentalDetails.reservationSummary.addresses?
(b.state=b.rentalDetails.reservationSummary.addresses[0].state,b.billingAddress=b.rentalDetails.reservationSummary.addresses[0],b.prefilledZipcode=b.rentalDetails.reservationSummary.addresses[0].zipCode):angular.isDefined(b.rentalDetails.reservationSummary.userState)&&"ANONYMOUS"==b.rentalDetails.reservationSummary.userState&&(b.state=b.rentalDetails.reservationSummary.address.state,b.billingAddress=b.rentalDetails.reservationSummary.address,b.prefilledZipcode=b.rentalDetails.reservationSummary.address.zipCode)};
b.hideStickySection=!1;b.getExtrasDays=function(b){angular.forEach(b,function(c,a){b[a]="string"==typeof c?parseInt(c.replace(/^[^0-9]+/,"")):c});angular.forEach(b,function(c,a){null==c&&(b[a]=0)});return b};b.findFeatureByKeyName=function(a){return angular.isDefined(b.rentalDetails.reservationSummary.vehicle)&&angular.isDefined(b.rentalDetails.reservationSummary.vehicle.vehicleFeatures)?b.rentalDetails.reservationSummary.vehicle.vehicleFeatures.filter(function(b){return b.name==a}).length?b.rentalDetails.reservationSummary.vehicle.vehicleFeatures.filter(function(b){return b.name==
a})[0]:"":!1};b.checkUserStatus=function(){a.requestInProgress=!0;x.trackVehicleExchangeEvents("CHANGE_V_CTA","clicked");u.checkUserForVehicleExchange(b.rentalDetails.reservationSummary.rentalAgreementNumber,b.rentalDetails.reservationSummary.confirmationNumber).then(function(e){angular.isDefined(e.instructionList)&&0<e.instructionList.length?"20024"==e.instructionList[0].code||"20023"==e.instructionList[0].code?(b.vehicleExchangeObj.flow=!0,t.setStorageData("vehicleExchangeObj",b.vehicleExchangeObj),
x.trackVehicleExchangeEvents("SIGN_IN_MODAL","OPEN"),a.$broadcast("LoginActivity",{requestType:"Login",variance:"Small",redirectFlow:"vehicleExchangeFromRD"})):(b.thresholdMsg=e.instructionList[0].message,b.vehicleExchangeObj.thresholdError=!0,t.setStorageData("vehicleExchangeObj",b.vehicleExchangeObj)):(b.vehicleExchangeObj.flow=!0,x.trackVehicleExchangeEvents("SIGN_IN_MODAL","AlreayAuthenticated"),t.setStorageData("vehicleExchangeObj",b.vehicleExchangeObj),k.location.href=a.contextPath+"/"+a.locale+
"/rental"+htmlExtension+"#/select-vehicle");a.requestInProgress=!1},function(e){a.requestInProgress=!1;e&&e.fieldErrors?(e=n.processErrorMessage(e),b.errorDisplayList=e):e&&e.errorList&&(b.errorDisplayList=e.errorList);a.requestInProgress=!1})};b.getZoneNumber=function(){var a=t.getStorageData("onLotConfirmVehicleData");return angular.isDefined(a)?a.reservationSummary.pickLoc.zoneNumber:Q.mapZoneDetails(b.rentalDetails.reservationSummary).pickLoc.zoneNumber};V={rentalLocation:""};var P=!1,W="";b.hideVehicleInfo=
!0;b.footerClass=function(){u.calculatePaddingFooter(b.rentalModel.tabFocus)};b.leaveSplitChanges=function(){P=b.rentalModel.showAlertMessage=!1;b.splitPaymentConfirm(W)};b.saveCard=function(e){a.requestInProgress=!0;b.oldSecondaryCardSummary=angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary)&&null!=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary)?b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary.number:
"";l.validate(e).success(function(){var c={cardNumber:b.creditCardNumber,secureCode:b.secureCode,saveCreditCard:b.rentalModel.saveCreditCard,nickName:b.nickName,primary:b.rentalModel.primary};b.billingAddress&&""!=b.billingAddress.address1&&(""!=b.reservationModel.paymentRq.address.state&&(b.state=b.reservationModel.paymentRq.address.state),b.reservationModel.paymentRq.address.address1=b.billingAddress.address1,b.reservationModel.paymentRq.address.address2=b.billingAddress.address2,b.reservationModel.paymentRq.address.address3=
b.billingAddress.address3,b.reservationModel.paymentRq.address.city=b.billingAddress.city,b.reservationModel.paymentRq.address.state=b.billingAddress.state,b.reservationModel.paymentRq.address.zipCode=b.billingAddress.zipCode,/^[a-zA-Z0-9]*$/.test(b.reservationModel.paymentRq.address.address1)||angular.isDefined(b.reservationModel.paymentRq.address.address2)&&/^[a-zA-Z0-9]*$/.test(b.reservationModel.paymentRq.address.address2)||angular.isDefined(b.reservationModel.paymentRq.address.address3)&&/^[a-zA-Z0-9]*$/.test(b.reservationModel.paymentRq.address.address3)||
angular.isDefined(b.reservationModel.paymentRq.address.zipCode)&&/^[a-zA-Z0-9]*$/.test(b.reservationModel.paymentRq.address.zipCode)||angular.isDefined(b.reservationModel.paymentRq.address.city)&&/^[a-zA-Z0-9]*$/.test(b.reservationModel.paymentRq.address.city)||b.state!=b.billingAddress.state)&&(b.indicatorMap.address_id=b.reservationModel.saveAddress?"0":"-1");/^[0-9]*$/.test(b.creditCardNumber)&&(b.indicatorMap.credit_id=b.rentalModel.saveCreditCard?"0":"-1");var e={address_id:angular.isDefined(b.indicatorMap.address_id)&&
""!=b.indicatorMap.address_id?b.indicatorMap.address_id:"",credit_id:angular.isDefined(b.indicatorMap.credit_id)&&""!=b.indicatorMap.credit_id?b.indicatorMap.credit_id:"",epIndicator:b.rentalModel.epIndicator};y.addToSplitDetails({splitOpted:b.rentalDetails.reservationSummary.gebUser?!0:b.rentalModel.availedSplitbill});y.addToIndicatorMap(e);y.addToCreditCardData(c);q.setReservationModel(b.reservationModel);b.error=[];b.errorDisplayList=[];b.rentalModel.formValidated=!1;u.addCreditCardToRental(b.rentalNumber,
b.rentalState.tab).then(function(c){b.rentalDetails.reservationSummary=c.reservationSummary;angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary)&&(b.primaryCard=angular.copy(c.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary));angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.creditcards)&&
angular.isDefined(0<c.reservationSummary.creditcards.length)&&(b.secondaryCardSelected=angular.copy(c.reservationSummary.creditcards[c.reservationSummary.creditcards.length-1]));angular.isDefined(c.reservationSummary.gebUser)&&c.reservationSummary.gebUser&&angular.isDefined(c.reservationSummary.splitBillSummary)&&c.reservationSummary.splitBillSummary.splitBillSecondary&&(b.rentalModel.availedSplitbill=!0);b.errorDisplayList=[];b.rentalModel.formValidated=!1;b.creditCardNumber="";b.nickName="";b.reservationModel.paymentRq.expMonth=
null;b.reservationModel.paymentRq.expYear=null;b.secureCode="";b.reservationModel.addAuthUserEdit=!1;b._getAddressList(b.addresses);V.rentalLocation=b.reservationModel.paymentRq.address.country=b.rentalDetails.reservationSummary.pickLoc.address.country;a.$broadcast("setReviewCreditCard",V);b.getStatesForCountry(b.reservationModel.paymentRq.address.country,"onload");!b.rentalDetails.reservationSummary||b.rentalDetails.reservationSummary.addresses[0]||b.rentalDetails.reservationSummary.address||(b.billingAddress=
{address1:"",address2:"",address3:"",city:"",state:null,zipCode:""});b.rentalModel.saveCreditCard=!1;b.reservationModel.saveAddress=!1;b.oldSecondaryCardSummary!=b.secondaryCardSelected.number&&(b.rentalModel.changedCard=!0);$("#modalAddCreditCard").modal("hide");angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.creditcards)&&2==c.reservationSummary.creditcards.length&&angular.isDefined(c.reservationSummary.splitBillSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary)&&
null==c.reservationSummary.splitBillSummary.splitBillSecondary&&"Rental-Summary"==b.rentalState.tab&&(H(function(){$("#splitAmount").modal("show")},1E3),b.events.showPaymentOption());b.extrasSplitEnable("addCard");var E="Extras"==b.rentalState.tab?f.addCcExtraSave:"Modify-Return"==b.rentalState.tab?f.addCcModifySave:f.addCcSummarySave;c=angular.isDefined(c)&&angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.gateExitDone)?"Mid Rental":"Pre Rental";M(!1,E,"splitbill",c);
a.requestInProgress=!1},function(c){angular.isDefined(c.errorList)&&0<c.errorList.length&&(b.errorDisplayList=c.errorList);a.requestInProgress=!1})}).error(function(c){b.secureCode="";b.formError=ABG.getFormValidationError(c,!1)[0].message;b.rentalModel.formValidated=!0;var e=c.errorCount;1===e?b.pageError=v.trustAsHtml(c.MSG[0]):1<e&&(b.pageError=Dictionary.I18n.get("err.global.multi.errorMessage"));a.requestInProgress=!1})};b.productVisible=!1;b.insuranceVisible=!1;b.os=ABG.getMobileOperatingSystem();
b.productSelected=function(e,c,d,E,N){if(b.productCheckbox[c])1==e.selected&&ea(c,!0),e.selected=!0,void 0==N||""==N?N=e.quantity=1:e.quantity=N,b.analytics(!1,"rental-"+e.code,"select"),E&&(-1==E.indexOf("_ext")?e.productId=E:e.productId=e.code+"chk_ext"),e={quantity:e.quantity,code:e.code,selected:e.selected},b.product.selectedProduct.push(e);else if(!b.productCheckbox[c]&&angular.isDefined(N)&&""!=N)e.selected=!0,e.quantity=N,e={quantity:e.quantity,code:e.code,selected:e.selected},b.product.selectedProduct.push(e);
else{ea(c,!0);b.cssDropDown[c]=0;if("CSSG"==c)for(E=0;E<e.subProducts.length;E++){var z=e.subProducts[E].code;b.productCheckbox[z]=!1;b.cssDropDown[z]=0;ea(z,!0)}b.analytics(!1,"rental-"+e.code,"unselect")}y.addRentalProducts(b.product.selectedProduct);angular.isDefined(N)&&(angular.isDefined(b.cssDropDown[c])&&(N=b.cssDropDown[c]),d?0==N?b.productCheckbox[c]=!1:0<N&&(b.productCheckbox[c]=!0):b.productCheckbox[c]?0==N&&(N=b.cssDropDown[c]=1):N=b.cssDropDown[c]=0,g.checkDropDownSelected(b.product,
b.cssDropDown)||(b.productCheckbox.CSSG=!1));angular.isDefined(b.rentalDetails.reservationSummary.gebUser)&&b.rentalDetails.reservationSummary.gebUser&&angular.isDefined(b.secondaryCardSelected.number)&&""==b.secondaryCardSelected.number&&(b.rentalModel.availedSplitbill=!1);y.addToSplitDetails({splitOpted:b.rentalModel.availedSplitbill,cardNumber:b.secondaryCardSelected&&b.secondaryCardSelected.number&&""!=b.secondaryCardSelected.number?b.secondaryCardSelected.number:""});a.requestInProgress=!0;u.AddOnExtras(b.rentalNumber).then(function(c){a.requestInProgress=
!0;angular.isDefined(c.errorList)&&0<c.errorList.length?(b.errorDisplayProduct=n.processErrorMessage(c).errorList,b.error=n.processErrorMessage(c).errorList,"5313"!=b.error[0].code&&(b.product.selectedProduct=[],y.addRentalProducts(b.product.selectedProduct),Y(),b.rentalState={value:"estimate"==c.reservationSummary.rentalState||"EmailSmsNotification"==c.reservationSummary.rentalState?!0:!1,tab:"Extras"})):(b.rateSummary=c.reservationSummary.rateSummary,b.rentalDetails.reservationSummary.splitBillSummary=
c.reservationSummary.splitBillSummary,angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&(b.rentalDetails.reservationSummary.splitBillSummary=c.reservationSummary.splitBillSummary),angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillEnabled)&&(b.rentalModel.availedSplitbill=c.reservationSummary.splitBillSummary.splitBillEnabled),b.rentalDetails.reservationSummary.gebUser&&
angular.isUndefined(b.rateSummary.totalAdditonalCharges)&&(b.rateSummary.totalAdditonalCharges=0),b._loadMnthYrDropdown(),b._populateBillingInfoCountryList(),angular.isDefined(b.addresses)&&!$.isEmptyObject(b.addresses)&&b._getAddressList(b.addresses),angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.personalInfo)&&angular.isDefined(c.reservationSummary.personalInfo.residency)&&angular.isDefined(c.reservationSummary.personalInfo.residency.value)&&(b.reservationModel.paymentRq.address.country=
c.reservationSummary.personalInfo.residency.value),"avis"==b.brand&&b.getStatesForCountry(b.reservationModel.paymentRq.address.country,"onload"),angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.rateSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&"estimate"==c.reservationSummary.rentalState&&(0<c.reservationSummary.rateSummary.totalAdditonalCharges||null!=c.reservationSummary.splitBillSummary.splitBillSecondary&&0<c.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount)?
b.rentalModel.showSplitOpt=!0:b.rentalModel.showSplitOpt=!1,angular.isDefined(c.reservationSummary.splitBillSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillEnabled)&&(b.rentalModel.availedSplitbill=c.reservationSummary.splitBillSummary.splitBillEnabled),angular.isDefined(c.reservationSummary.gebUser)&&c.reservationSummary.gebUser&&angular.isDefined(c.reservationSummary.splitBillSummary)&&c.reservationSummary.splitBillSummary.splitBillSecondary&&(b.rentalModel.availedSplitbill=
!0),b.error=[],b.errorDisplayInsurance=[],b.errorDisplayProduct=[],b.rentalState={value:"estimate"==c.reservationSummary.rentalState||"EmailSmsNotification"==c.reservationSummary.rentalState?!0:!1,tab:"Extras"});H(function(){a.requestInProgress=!1},1E3)},function(c){angular.isDefined(c.errorList)&&0<c.errorList.length&&(b.errorDisplayProduct=n.processErrorMessage(c).errorList,b.error=n.processErrorMessage(c).errorList,"5313"!=b.error[0].code&&(b.product.selectedProduct=[],y.addRentalProducts(b.product.selectedProduct),
b.rentalDetails=c.reservationSummary,b.rentalState={value:"estimate"==c.reservationSummary.rentalState?!0:!1,tab:"Extras"}));a.requestInProgress=!1})};b.insuranceSelected=function(e,c,d,E){b.insuranceCheckbox[c]?(e.selected=!0,b.analytics(!1,"rental-"+e.code,"select"),E&&(-1==E.indexOf("_ext")?e.productId=E:e.productId=e.code+"chk_ext"),b.Insurance.selectedInsurance.push({code:e.code,selected:e.selected})):(ka(c,!0),b.analytics(!1,"rental-"+e.code,"unselect"));y.addRentalInsurances(b.Insurance.selectedInsurance);
y.addToSplitDetails({splitOpted:b.rentalModel.availedSplitbill,cardNumber:b.secondaryCardSelected&&b.secondaryCardSelected.number&&""!=b.secondaryCardSelected.number?b.secondaryCardSelected.number:""});a.requestInProgress=!0;u.AddOnExtras(b.rentalNumber).then(function(c){a.requestInProgress=!0;angular.isDefined(c.errorList)&&0<c.errorList.length?(b.errorDisplayInsurance=n.processErrorMessage(c).errorList,b.error=n.processErrorMessage(c).errorList,b.Insurance.selectedInsurance=[],y.addRentalInsurances(b.Insurance.selectedInsurance),
ha(),b.rentalState={value:"estimate"==c.reservationSummary.rentalState?!0:!1,tab:"Extras"}):(b.rateSummary=c.reservationSummary.rateSummary,b.rentalDetails.reservationSummary.splitBillSummary=c.reservationSummary.splitBillSummary,angular.isDefined(c.reservationSummary.splitBillSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillEnabled)&&(b.rentalModel.availedSplitbill=c.reservationSummary.splitBillSummary.splitBillEnabled),b.rentalDetails.reservationSummary.gebUser&&angular.isUndefined(b.rateSummary.totalAdditonalCharges)&&
(b.rateSummary.totalAdditonalCharges=0),angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.rateSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&"estimate"==c.reservationSummary.rentalState&&(0<c.reservationSummary.rateSummary.totalAdditonalCharges||null!=c.reservationSummary.splitBillSummary.splitBillSecondary&&0<c.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount)?b.rentalModel.showSplitOpt=!0:b.rentalModel.showSplitOpt=!1,angular.isDefined(c.reservationSummary.gebUser)&&
c.reservationSummary.gebUser&&angular.isDefined(c.reservationSummary.splitBillSummary)&&c.reservationSummary.splitBillSummary.splitBillSecondary&&(b.rentalModel.availedSplitbill=!0),b._loadMnthYrDropdown(),b._populateBillingInfoCountryList(),angular.isDefined(b.addresses)&&!$.isEmptyObject(b.addresses)&&b._getAddressList(b.addresses),angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.personalInfo)&&angular.isDefined(c.reservationSummary.personalInfo.residency)&&angular.isDefined(c.reservationSummary.personalInfo.residency.value)&&
(b.reservationModel.paymentRq.address.country=c.reservationSummary.personalInfo.residency.value),"avis"==b.brand&&b.getStatesForCountry(b.reservationModel.paymentRq.address.country,"onload"),b.error=[],b.errorDisplayInsurance=[],b.errorDisplayProduct=[],b.rentalState={value:"estimate"==c.reservationSummary.rentalState?!0:!1,tab:"Extras"},b.errorDisplayInsurance=[]);a.requestInProgress=!1},function(c){angular.isDefined(c.errorList)&&0<c.errorList.length&&(b.errorDisplayInsurance=n.processErrorMessage(c).errorList,
b.error=n.processErrorMessage(c).errorList,b.Insurance.selectedInsurance=[],y.addRentalInsurances(b.Insurance.selectedInsurance),ha(),b.rentalState={value:"estimate"==c.reservationSummary.rentalState?!0:!1,tab:"Extras"},a.requestInProgress=!1)})};b.extrasSplitEnable=function(e){if(b.rentalModel.availedSplitbill){b.rentalModel.unsplit=!1;var c="";"addCard"==e?c=b.secondaryCardSelected.number:angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary)&&
null!=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary?c=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary.number:angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.creditcards)&&angular.isDefined(b.rentalDetails.reservationSummary.creditcards[1])&&angular.isDefined(b.rentalDetails.reservationSummary.creditcards[1].number)?(b.secondaryCardSelected=b.rentalDetails.reservationSummary.creditcards[1],
b.secondaryCCType=f.masterListForCC.filter(function(c){return c.code==b.secondaryCardSelected.type}),c=b.rentalDetails.reservationSummary.creditcards[1].number,b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary={ccSummary:{number:c,type:b.secondaryCardSelected.type}}):c="";""!=c&&""!=b.rentalState.tab&&b.rentalState.value?(y.addToSplitDetails({splitOpted:b.rentalModel.availedSplitbill,estimateCall:b.rentalModel.availedSplitbill,secondaryCreditCard:c}),"Extras"==b.rentalState.tab)?
(a.requestInProgress=!0,b.rentalDetails.reservationSummary.splitBillSummary.splitBillEnabled)?"addCard"!=e&&(b.secondaryCardSelected=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary,b.secondaryCCType=f.masterListForCC.filter(function(c){return c.code==b.secondaryCardSelected.type})):u.extrasSplit(b.rentalNumber).then(function(c){b.rentalModel.availedSplitbill=!0;angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary)&&
angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary)&&(b.primaryCard=angular.copy(c.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary));angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary)&&(b.secondaryCardSelected=angular.copy(c.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary));
angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.rateSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&(b.rentalDetails.reservationSummary.splitBillSummary=c.reservationSummary.splitBillSummary);a.requestInProgress=!1;c=angular.isDefined(c)&&angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.gateExitDone)?"Mid Rental":"Pre Rental";M(!1,f.toggleExtraCheck,"splitbill",!0,c)},function(c){c.errorList&&0<c.errorList.length&&
(b.error=n.processErrorMessage(c).errorList,b.rentalModel.availedSplitbill=c.reservationSummary&&c.reservationSummary.splitBillSummary&&c.reservationSummary.splitBillSummary.splitBillEnabled?c.reservationSummary.splitBillSummary.splitBillEnabled:!1,a.requestInProgress=!1)}):"Modify-Return"==b.rentalState.tab&&((a.requestInProgress=!0,b.rentalDetails.reservationSummary.splitBillSummary.splitBillEnabled)?"addCard"!=e&&(b.secondaryCardSelected=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary,
b.secondaryCCType=f.masterListForCC.filter(function(c){return c.code==b.secondaryCardSelected.type})):(e={secondaryCreditCard:angular.isDefined(b.secondaryCardSelected)&&angular.isDefined(b.secondaryCardSelected.number)?b.secondaryCardSelected.number:"",splitOpted:b.rentalModel.availedSplitbill},y.addToSplitDetails(e),u.rentalSplit(b.modifiedData).then(function(c){b.rentalModel.availedSplitbill=!0;angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary)&&
angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary)&&(b.primaryCard=angular.copy(c.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary));angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary)&&null!=c.reservationSummary.splitBillSummary.splitBillSecondary&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary)&&
(b.secondaryCardSelected=angular.copy(c.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary));angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.rateSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&(b.rateSummary=c.reservationSummary.rateSummary,b.rentalDetails.reservationSummary.splitBillSummary=c.reservationSummary.splitBillSummary);a.requestInProgress=!1;c=angular.isDefined(c)&&angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.gateExitDone)?
"Mid Rental":"Pre Rental";M(!1,f.toggleModifyCheck,"splitbill",!0,c)},function(c){c.errorList&&0<c.errorList.length&&(b.error=n.processErrorMessage(c).errorList,b.rentalModel.availedSplitbill=c.reservationSummary&&c.reservationSummary.splitBillSummary&&c.reservationSummary.splitBillSummary.splitOpted?c.reservationSummary.splitBillSummary.splitOpted:!1,b.rentalDetails.reservationSummary.splitBillSummary.splitBillEnabled=c.reservationSummary.splitBillSummary.splitBillEnabled,b.rentalDetails.reservationSummary.splitBillSummary.splitOpted=
c.reservationSummary.splitBillSummary.splitOpted,b.rentalDetails.reservationSummary.gebUser&&(b.rentalDetails.reservationSummary.splitBillSummary=c.reservationSummary.splitBillSummary),a.requestInProgress=!1)}))):""==c||"Rental-Summary"!=b.rentalState.tab||b.rentalState.value?""==c&&(b.primary=!1,$("#modalAddCreditCard").modal("show"),x.enableModal("add credit card modal",b.rentalState.tab)):(b.rentalModel.availedSplitbill=!0,1==b.rentalDetails.reservationSummary.splitBillSummary.splitBillEnabled?
(a.requestInProgress=!0,"addCard"==e?(b.secondaryCCType=f.masterListForCC.filter(function(c){return c.code==b.secondaryCardSelected.type}),b.selectSecondaryCC(b.secondaryCardSelected)):(b.secondaryCardSelected=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary,b.secondaryCCType=f.masterListForCC.filter(function(c){return c.code==b.secondaryCardSelected.type}),b.selectSecondaryCC(b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary))):"addCard"!=
e&&(b.secondaryCardSelected=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary,b.secondaryCCType=f.masterListForCC.filter(function(c){return c.code==b.secondaryCardSelected.type}),null!=b.rentalDetails.reservationSummary.rateSummary&&(b.itemizedPrimaryAmount=b.rentalDetails.reservationSummary.rateSummary.estimatedTotal,b.itemizedSecondaryAmount="0.00"),$("#splitAmount").modal("show"),b.events.showPaymentOption(),e=angular.isDefined(data)&&angular.isDefined(data.reservationSummary)&&
angular.isDefined(data.reservationSummary.gateExitDone)?"Mid Rental":"Pre Rental",M(!1,f.toggleSummaryCheck,"splitbill",!0,e)))}else b.rentalDetails.reservationSummary.splitBillSummary.splitBillEnabled?(b.rentalModel.unsplit=!0,b.rentalModel.availedSplitbill=!1,b.rentalDetails.reservationSummary.splitBillSummary.splitOpted=!1,$("html, body").animate({scrollTop:$("#tabStart").position().top})):!b.rentalDetails.reservationSummary.splitBillSummary.splitBillEnabled&&b.rentalDetails.reservationSummary.splitBillSummary.splitOpted&&
(b.rentalDetails.reservationSummary.splitBillSummary.splitOpted=!1)};b.splitDisable=function(){b.rentalModel.availedSplitbill=!1;var e={splitOpted:b.rentalModel.availedSplitbill,estimateCall:b.rentalModel.availedSplitbill,secondaryCreditCard:""},c="Extras"==b.rentalState.tab?f.unsplitExtraYes:"Modify-Return"==b.rentalState.tab?f.unsplitModifyYes:f.unsplitSummaryYes,d=angular.isDefined(b.rentalDetails)&&angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.gateExitDone)?
"Mid Rental":"Pre Rental";M(!1,c,"splitbill",d);y.addToSplitDetails(e);a.requestInProgress=!0;u.getUnsplitSummary().then(function(c){angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillEnabled)&&(b.rentalModel.availedSplitbill=c.reservationSummary.splitBillSummary.splitBillEnabled,b.rentalDetails.reservationSummary=angular.copy(c.reservationSummary),S(c),null!=c.reservationSummary.splitBillSummary&&
null==c.reservationSummary.splitBillSummary.splitBillSecondary&&(b.secondaryCardSelected={}));b.rentalModel.unsplit=!1;a.requestInProgress=!1;c="Extras"==b.rentalState.tab?f.toggleExtraUncheck:"Modify-Return"==b.rentalState.tab?f.toggleModifyUncheck:f.toggleSummaryUncheck;var e=angular.isDefined(b.rentalDetails)&&angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.gateExitDone)?"Mid Rental":"Pre Rental";M(!1,c,"splitbill",e)},function(c){angular.isDefined(c.errorList)&&
0<c.errorList.length&&(b.error=n.processErrorMessage(c).errorList,b.rentalModel.unsplit=!1,b.rentalModel.availedSplitbill=!0,a.requestInProgress=!1)})};b.selectedAddressList=function(a){"1"==a.code?(angular.forEach(b.countryList,function(c){c.code==b.rentalDetails.reservationSummary.addresses[0].country&&(b.reservationModel.paymentRq.address.country=c.name)}),angular.forEach(b.rentalDetails.reservationSummary.addresses,function(c){1==c.primary&&(b.reservationModel.paymentRq.address.address1=c.address1,
b.reservationModel.paymentRq.address.address2=c.address2,b.reservationModel.paymentRq.address.address3=c.address3,b.reservationModel.paymentRq.address.city=c.city,b.reservationModel.paymentRq.address.state=c.state,b.reservationModel.paymentRq.address.zipCode=c.zipCode,b.indicatorMap.address_id=c.maskId,b.selectedAddress="Primary Address")})):"2"==a.code&&(angular.forEach(b.countryList,function(c){c.code==b.rentalDetails.reservationSummary.addresses[1].country&&(b.reservationModel.paymentRq.address.country=
c.name)}),angular.forEach(b.rentalDetails.reservationSummary.addresses,function(c){0==c.primary&&(b.reservationModel.paymentRq.address.address1=c.address1,b.reservationModel.paymentRq.address.address2=c.address2,b.reservationModel.paymentRq.address.address3=c.address3,b.reservationModel.paymentRq.address.city=c.city,b.reservationModel.paymentRq.address.state=c.state,b.reservationModel.paymentRq.address.zipCode=c.zipCode,b.indicatorMap.address_id=c.maskId,b.selectedAddress="Secondary Address")}))};
b.selectSecondaryCC=function(e){b.warningMsgSC={};b.error=[];var c=e.number;b.oldSecondaryCardSummary=angular.copy(e);if("Modify-Return"==b.rentalState.tab&&angular.isDefined(0==b.rentalDetails.reservationSummary.splitBillSummary.splitBillEnabled)&&angular.isDefined(1==b.rentalDetails.reservationSummary.splitBillSummary.splitOpted)){a.requestInProgress=!0;b.error=[];var d={secondaryCreditCard:e.number,splitOpted:b.rentalModel.availedSplitbill};y.addToSplitDetails(d);u.rentalSplit(b.extentionSplitData).then(function(c){b.rentalModel.availedSplitbill=
c.reservationSummary.splitBillSummary.splitBillEnabled;angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary)&&null!=c.reservationSummary.splitBillSummary.splitBillSecondary&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary)&&(b.secondaryCardSelected=angular.copy(c.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary));angular.isDefined(c.reservationSummary)&&
angular.isDefined(c.reservationSummary.splitBillSummary)&&(b.rentalDetails.reservationSummary.splitBillSummary=c.reservationSummary.splitBillSummary);a.requestInProgress=!1},function(c){c.errorList&&0<c.errorList.length&&(b.error=n.processErrorMessage(c).errorList,b.rentalModel.availedSplitbill=c.reservationSummary&&c.reservationSummary.splitBillSummary&&c.reservationSummary.splitBillSummary.splitOpted?c.reservationSummary.splitBillSummary.splitOpted:!1,a.requestInProgress=!1)})}angular.isDefined(e.expiryMsg)&&
(b.warningMsgSC=n.processErrorMessage(e).expiryMsg);"Rental-Summary"==b.rentalState.tab&&b.rentalDetails.reservationSummary.splitBillSummary.splitBillEnabled?(a.requestInProgress=!0,d={splitOpted:b.rentalModel.availedSplitbill,estimateCall:!1,secondaryCreditCard:e.number,rentalNumber:b.rentalNumber},y.addToSplitDetails(d),b.cardError={},u.getSplitInRental(b.rentalNumber).then(function(e){a.requestInProgress=!0;angular.isDefined(e.reservationSummary)&&angular.isDefined(e.reservationSummary.splitBillSummary)&&
angular.isDefined(e.reservationSummary.splitBillSummary.splitBillSecondary)&&null!=e.reservationSummary.splitBillSummary.splitBillSecondary&&angular.isDefined(e.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary)&&null!=e.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary&&(b.secondaryCardSelected=e.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary,b.secondaryCCType=f.masterListForCC.filter(function(c){return c.code.toLowerCase()==b.secondaryCardSelected.type.toLowerCase()}),
angular.isDefined(c)&&c!=b.secondaryCardSelected.number&&(b.rentalModel.changedCard=!0));a.requestInProgress=!1},function(e){angular.isDefined(e.errorList)&&0<e.errorList.length&&(b.oldSecondaryCardSummary&&(b.secondaryCardSelected=b.oldSecondaryCardSummary,b.secondaryCCType=f.masterListForCC.filter(function(c){return c.code==b.oldSecondaryCardSummary.type}),angular.isDefined(c)&&c!=b.secondaryCardSelected.number&&(b.rentalModel.changedCard=!1)),b.cardError=e.errorList,$("html, body").animate({scrollTop:$("#tabStart").position().top}),
setTimeout(function(){l.resetError("vm.secondaryCardSelected.number",!1)},100));a.requestInProgress=!1})):(b.secondaryCardSelected=e,b.secondaryCCType=f.masterListForCC.filter(function(b){return b.code==e.type}),b.rentalModel.changedCard=!0)};b.selectPrimaryCC=function(a){b.warningMsgPC={};b.primaryCard=angular.copy(a);b.primaryCCType=f.masterListForCC.filter(function(b){return b.code.toLowerCase()==a.type.toLowerCase()});angular.isDefined(a.expiryMsg)&&(b.warningMsgPC=n.processErrorMessage(a).expiryMsg)};
b.splitPaymentAmount=function(a,c){b.rentalModel.amountSplitConfirmCTA=!1;a!=f.splitInRental.PRIMARYAMOUNT||!angular.isDefined(b.split.primaryAmount)||""==b.split.primaryAmount||!angular.isUndefined(c)&&angular.element(c.target).hasClass("ng-invalid")?a!=f.splitInRental.SECONDARYAMOUNT||!angular.isDefined(b.split.secondaryAmount)||""==b.split.secondaryAmount||!angular.isUndefined(c)&&angular.element(c.target).hasClass("ng-invalid")?angular.isDefined(b.split.primaryAmount)||angular.isDefined(b.split.secondaryAmount)||
(b.rentalModel.amountSplitConfirmCTA=!1):(b.split.secondaryAmount=parseFloat(b.split.secondaryAmount).toFixed(2),b.secondaryAmountOldValue!=b.split.secondaryAmount||""==b.split.primaryAmount||angular.element("#primaryAmount").hasClass("ng-invalid")?(b.secondaryAmountOldValue=b.split.secondaryAmount,c={splitType:f.splitInRental.AMOUNT,dollarAmount:b.split.secondaryAmount,splitOpted:b.rentalModel.availedSplitbill,estimateCall:!0,primary:!1,secondaryCreditCard:b.secondaryCardSelected.number,rentalNumber:b.rentalNumber},
y.addToSplitDetails(c),b.splitByTypeAPICall(c,a)):(b.split.primaryAmount=b.primaryAmountOldValue,b.rentalModel.amountSplitConfirmCTA=!0)):(b.split.primaryAmount=parseFloat(b.split.primaryAmount).toFixed(2),b.primaryAmountOldValue!=b.split.primaryAmount||""==b.split.secondaryAmount||angular.element("#secondaryAmount").hasClass("ng-invalid")?(b.primaryAmountOldValue=b.split.primaryAmount,c={splitType:f.splitInRental.AMOUNT,dollarAmount:b.split.primaryAmount,splitOpted:b.rentalModel.availedSplitbill,
estimateCall:!0,primary:!0,secondaryCreditCard:b.secondaryCardSelected.number,rentalNumber:b.rentalNumber},y.addToSplitDetails(c),b.splitByTypeAPICall(c,a)):(b.split.secondaryAmount=b.secondaryAmountOldValue,b.rentalModel.amountSplitConfirmCTA=!0))};b.splitByTypeAPICall=function(e,c){W=e.splitType;e.splitType==f.splitInRental.DAY?(a.requestInProgress=!0,u.getSplitInRental(b.rentalNumber).then(function(c){a.requestInProgress=!0;angular.isDefined(c.instructionList)&&0<c.instructionList.length&&"5319"==
c.instructionList[0].code?P=!0:(b.previousSplitType=e.splitType,P=!1);if(angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary))if(c.reservationSummary.rentalState==f.splitInRental.ESTIMATE){b.errorDaySplit="";var E=angular.element("#primaryAmount");angular.element(E).hasClass("ng-invalid")&&l.removeError(E,!0);E=angular.element("#secondaryAmount");angular.element(E).hasClass("ng-invalid")&&l.removeError(E,!0);b.split.primaryAmount="";b.split.secondaryAmount=
"";b.primaryAmountOldValue="";b.secondaryAmountOldValue="";b.rentalModel.amountSplitConfirmCTA=!1;b.errorAmountSplit="";b.splitByDayPrimaryCardAmount=c.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount;b.splitByDaySecondaryCardAmount=c.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount;b.rentalModel.daySplitConfirmCTA=!0}else b.rentalDetails.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount=c.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount,
b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount=c.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount,1==c.reservationSummary.splitBillSummary.numberOfDays&&(b.rentalDetails.reservationSummary.splitBillSummary=c.reservationSummary.splitBillSummary),angular.isDefined(b.primaryDayValue)&&angular.isDefined(b.secondaryDayValue)&&(b.primaryValue=c.reservationSummary.splitBillSummary.splitBillPrimary.lengthOfRental,b.secondaryValue=c.reservationSummary.splitBillSummary.splitBillSecondary.lengthOfRental,
b.primaryValue=1<b.primaryValue||0==b.primaryValue?b.primaryValue+" Days":b.primaryValue+" Day",b.secondaryValue=1<b.secondaryValue||0==b.secondaryValue?b.secondaryValue+" Days":b.secondaryValue+" Day",b.secondaryValue&&b.primaryValue&&b._itemizedDropdown(),b.prodItemizedPri=null==c.reservationSummary.splitBillSummary.splitBillPrimary.productmap?{}:c.reservationSummary.splitBillSummary.splitBillPrimary.productmap,b.insuranceItemizedPri=null==c.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap?
{}:c.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap,E=u.displayDropDown(b.prodItemizedPri,b.insuranceItemizedPri,"primary",c),b.dropDownValue.insDropDownPri=E.insDrop,b.dropDownValue.proDropDownPri=E.proDrop,b.prodItemizedSec=null==c.reservationSummary.splitBillSummary.splitBillSecondary.productmap?{}:c.reservationSummary.splitBillSummary.splitBillSecondary.productmap,b.insuranceItemizedSec=null==c.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap?
{}:c.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap,E=u.displayDropDown(b.prodItemizedSec,b.insuranceItemizedSec,"secondary",c),b.dropDownValue.insDropDownSec=E.insDrop,b.dropDownValue.proDropDownSec=E.proDrop),b.errorDaySplit="",b.rentalModel.daySplitConfirmCTA=!1,$("#splitAmount").modal("hide"),E=angular.isDefined(c)&&angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.gateExitDone)?"Mid Rental":"Pre Rental",M(!0,"Rental Summary - Confirm",
"splitByType",angular.copy(c),E);a.requestInProgress=!1},function(c){angular.isDefined(c.errorList)&&0<c.errorList.length&&(b.errorDaySplit=n.processErrorMessage(c).errorList,b.rentalModel.daySplitConfirmCTA=!1,a.requestInProgress=!1)})):e.splitType==f.splitInRental.AMOUNT?(a.requestInProgress=!0,u.getSplitInRental(b.rentalNumber).then(function(e){a.requestInProgress=!0;angular.isDefined(e.instructionList)&&0<e.instructionList.length&&"5319"==e.instructionList[0].code&&b.rentalDetails.reservationSummary&&
b.rentalDetails.reservationSummary.splitBillSummary&&b.rentalDetails.reservationSummary.splitBillSummary.counterProducts||b.rentalDetails.reservationSummary.splitBillSummary.numberOfDays||b.rentalDetails.reservationSummary.splitBillSummary.counterProducts.optionalServices?(b.previousSplitType="",P=!0):(b.previousSplitType="amount",P=!1);angular.isDefined(e.reservationSummary)&&angular.isDefined(e.reservationSummary.splitBillSummary)&&(e.reservationSummary.rentalState==f.splitInRental.ESTIMATE?(da(),
b.primaryAmount=e.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount,b.secondaryAmount=null==e.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount?"0.00":e.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount,b.rentalModel.amountSplitConfirmCTA=!0,!e.reservationSummary||!e.reservationSummary.splitBillSummary||e.reservationSummary.splitBillSummary.counterProducts||e.reservationSummary.splitBillSummary.numberOfDays||e.reservationSummary.splitBillSummary.optionalServices||
(b.rentalModel.enableCta=!1,angular.isDefined(e.reservationSummary)&&angular.isDefined(e.reservationSummary.lengthOfRental)&&null!=e.reservationSummary.lengthOfRental&&(b.rentalDays.vehicleDays=[],b.rentalDays.productDays.primaryValues=[],b.rentalDays.productDays.secondaryValues=[],b.rentalDays.insuranceDays.primaryValues=[],b.rentalDays.insuranceDays.secondaryValues=[],b._populateRentalDays(e.reservationSummary.lengthOfRental)),S(e)),c==f.splitInRental.PRIMARYAMOUNT?(b.split.secondaryAmount=e.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount,
b.secondaryAmountOldValue=b.split.secondaryAmount,e=angular.element("#secondaryAmount")):(b.split.primaryAmount=e.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount,b.primaryAmountOldValue=b.split.primaryAmount,e=angular.element("#primaryAmount")),angular.element(e).hasClass("ng-invalid")&&l.removeError(e,!0)):(e.reservationSummary&&e.reservationSummary.splitBillSummary&&1==e.reservationSummary.splitBillSummary.dollarAmount&&(b.rentalDetails.reservationSummary.splitBillSummary=angular.copy(e.reservationSummary.splitBillSummary),
b.itemizedPrimaryAmount=e.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount,b.itemizedSecondaryAmount=e.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount),S(e),b.errorAmountSplit="",b.rentalModel.amountSplitConfirmCTA=!1,$("#splitAmount").modal("hide"),M(!0,"Rental Summary - Confirm","splitByType",angular.copy(e),f.splitInRental.AMOUNT)));a.requestInProgress=!1},function(c){angular.isDefined(c.errorList)&&0<c.errorList.length&&(b.errorAmountSplit=n.processErrorMessage(c).errorList,
b.rentalModel.amountSplitConfirmCTA=!1,a.requestInProgress=!1)})):(a.requestInProgress=!0,u.getSplitInRental(b.rentalNumber).then(function(c){a.requestInProgress=!0;angular.isDefined(c.instructionList)&&0<c.instructionList.length&&"5319"==c.instructionList[0].code&&b.rentalDetails.reservationSummary&&b.rentalDetails.reservationSummary.splitBillSummary&&b.rentalDetails.reservationSummary.splitBillSummary.dollarAmount?(P=!0,b.previousSplitType="amount"):(b.previousSplitType="",P=!1);if(angular.isDefined(c.reservationSummary)&&
angular.isDefined(c.reservationSummary.splitBillSummary))if(da(),c.reservationSummary.rentalState==f.splitInRental.ESTIMATE){b.itemizedPrimaryAmount=c.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount;b.itemizedSecondaryAmount=c.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount;b.itemizedSecondaryAmount=null==c.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount?"0.00":c.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount;b.rentalModel.enableCta=
!0;c.reservationSummary&&c.reservationSummary.splitBillSummary&&0==c.reservationSummary.splitBillSummary.dollarAmount&&(b.split.primaryAmount=b.rentalDetails.reservationSummary.rateSummary.estimatedTotal,b.split.secondaryAmount="0.00",b.rentalModel.amountSplitConfirmCTA=!1);if(angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary)){angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary.productmap)&&(b.prodItemizedPri=b.rentalDetails.reservationSummary.splitBillSummary.splitBillPrimary.productmap=
null==c.reservationSummary.splitBillSummary.splitBillPrimary.productmap?{}:c.reservationSummary.splitBillSummary.splitBillPrimary.productmap);angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap)&&(b.insuranceItemizedPri=b.rentalDetails.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap=null==c.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap?{}:c.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap);
var e=angular.copy(b.prodItemizedPri),d=angular.copy(b.insuranceItemizedPri);e=u.displayDropDown(e,d,"primary",c);b.insuranceItemizedPri=b.dropDownValue.insDropDownPri=e.insDrop;b.prodItemizedPri=b.dropDownValue.proDropDownPri=e.proDrop}if(angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary)){if(angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary.productmap)){if(null==b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary||null==b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.productmap)b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary=
c.reservationSummary.splitBillSummary.splitBillSecondary;b.prodItemizedSec=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.productmap=null==c.reservationSummary.splitBillSummary.splitBillSecondary.productmap?{}:c.reservationSummary.splitBillSummary.splitBillSecondary.productmap}angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap)&&(b.insuranceItemizedSec=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap=
null==c.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap?{}:c.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap);e=angular.copy(b.prodItemizedSec);d=angular.copy(b.insuranceItemizedSec);e=u.displayDropDown(e,d,"secondary",c);b.insuranceItemizedSec=b.dropDownValue.insDropDownSec=e.insDrop;b.prodItemizedSec=b.dropDownValue.proDropDownSec=e.proDrop}angular.forEach(c.reservationSummary.productSummaryList,function(c){c.subProducts&&0<c.subProducts.length?
angular.forEach(c.subProducts,function(c){"PER_RENTAL"==c.category&&(b.cubsideSelected[c.code]=b.prodItemizedPri[c.code]==b.rentalDetails.reservationSummary.lengthOfRental?"primary":b.prodItemizedSec[c.code]==b.rentalDetails.reservationSummary.lengthOfRental?"secondary":null)}):"PER_RENTAL"==c.category&&(b.cubsideSelected[c.code]=b.prodItemizedPri[c.code]==b.rentalDetails.reservationSummary.lengthOfRental?"primary":b.prodItemizedSec[c.code]==b.rentalDetails.reservationSummary.lengthOfRental?"secondary":
null)});null!=b.secondaryValue&&null!=b.primaryValue?b._itemizedDropdown():angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.lengthOfRental)&&null!=c.reservationSummary.lengthOfRental&&(b.rentalDays.vehicleDays=[],b.rentalDays.productDays.primaryValues=[],b.rentalDays.productDays.secondaryValues=[],b.rentalDays.insuranceDays.primaryValues=[],b.rentalDays.insuranceDays.secondaryValues=[],b._populateRentalDays(c.reservationSummary.lengthOfRental));c.reservationSummary&&
c.reservationSummary.splitBillSummary&&c.reservationSummary.splitBillSummary.numberOfDays&&(b.rentalDetails.reservationSummary.splitBillSummary.numberOfDays=c.reservationSummary.splitBillSummary.numberOfDays)}else{if(!c.reservationSummary||!c.reservationSummary.splitBillSummary||1!=c.reservationSummary.splitBillSummary.counterProducts&&1!=c.reservationSummary.splitBillSummary.optionalServices&&1!=c.reservationSummary.splitBillSummary.numberOfDays)b.rentalModel.availedSplitbill=c.reservationSummary.splitBillSummary.splitBillEnabled;
b.rentalDetails.reservationSummary.splitBillSummary=angular.copy(c.reservationSummary.splitBillSummary);c.reservationSummary&&c.reservationSummary.splitBillSummary&&0==c.reservationSummary.splitBillSummary.dollarAmount&&(b.split.primaryAmount=b.rentalDetails.reservationSummary.rateSummary.estimatedTotal,b.split.secondaryAmount="0.00");S(c);b.rentalModel.enableCta=!1;$("#splitAmount").modal("hide");M(!0,"Rental Summary - Confirm","splitByType",angular.copy(c))}a.requestInProgress=!1},function(c){angular.isDefined(c.errorList)&&
0<c.errorList.length&&(b.errorItemized=n.processErrorMessage(c).errorList,c.reservationSummary&&(b.rentalDays.vehicleDays=[],b.rentalDays.productDays.primaryValues=[],b.rentalDays.productDays.secondaryValues=[],b.rentalDays.insuranceDays.primaryValues=[],b.rentalDays.insuranceDays.secondaryValues=[],b._populateRentalDays(c.reservationSummary.lengthOfRental),S(c)),b.rentalModel.enableCta=!1,a.requestInProgress=!1)}))};b.splitPaymentConfirm=function(a){if(P)b.rentalModel.showAlertMessage=!0,W=a;else{if(a==
f.splitInRental.AMOUNT)a={splitType:f.splitInRental.AMOUNT,dollarAmount:b.split.secondaryAmount,splitOpted:b.rentalModel.availedSplitbill,estimateCall:!1,secondaryCreditCard:b.secondaryCardSelected.number,rentalNumber:b.rentalNumber};else if(a==f.splitInRental.DAY)a={splitType:f.splitInRental.DAY,days:b.secondaryDayValue,splitOpted:b.rentalModel.availedSplitbill,estimateCall:!1,secondaryCreditCard:b.secondaryCardSelected.number,rentalNumber:b.rentalNumber};else{var c=[],e=[];angular.forEach(b.prodItemizedSec,
function(b,a){b={code:a,days:"string"==typeof b?parseInt(b.replace(/^[^0-9]+/,"")):b};c.push(b)});angular.forEach(b.insuranceItemizedSec,function(c,b){c={code:b,days:"string"==typeof c?parseInt(c.replace(/^[^0-9]+/,"")):c};e.push(c)});a={days:angular.isDefined(b.secondaryValue)&&""!=b.secondaryValue?b.secondaryValue:null,splitOpted:b.rentalModel.availedSplitbill,estimateCall:!1,secondaryCreditCard:b.secondaryCardSelected.number,rentalNumber:b.rentalNumber,selectedProducts:c,selectedInsurances:e,splitType:""}}y.addToSplitDetails(a);
b.splitByTypeAPICall(a)}};b.pointCheckbox={};b.productCheckbox={};b.insuranceCheckbox={};b.selectedProductsCodeForExpansion={};b.confirmAddOn=function(){if(b.rentalModel.showExtras||b.rentalModel.failExtras)b.rentalModel.showExtras=!1,b.rentalModel.failExtras=!1,a.requestInProgress=!0,R();else{a.requestInProgress=!0;var e=angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary.dollarAmount)&&b.rentalDetails.reservationSummary.splitBillSummary.dollarAmount?
{dollarAmount:null!=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount)?b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount:"",splitOpted:b.rentalModel.availedSplitbill,cardNumber:angular.isDefined(b.secondaryCardSelected.number)?b.secondaryCardSelected.number:""}:{splitOpted:b.rentalModel.availedSplitbill,cardNumber:angular.isDefined(b.secondaryCardSelected)&&
angular.isDefined(b.secondaryCardSelected.number)&&""!=b.secondaryCardSelected.number?b.secondaryCardSelected.number:""};y.addToSplitDetails(e);u.confirmAddOn(b.rentalNumber).then(function(c){a.requestInProgress=!0;if(c.errorList&&0<c.errorList.length)b.error=n.processErrorMessage(c).errorList,b.Insurance.selectedInsurance=[],y.addRentalInsurances(b.Insurance.selectedInsurance),b.product.selectedProduct=[],y.addRentalProducts(b.product.selectedProduct),"5313"!=c.errorList[0].code&&(b.addtionalTrue=
!1,R());else{angular.isDefined(c.instructionList)&&0<c.instructionList.length&&(b.instructionMessageList=[],angular.forEach(c.instructionList,function(c){b.instructionMessageList.push(c)}));if(1<=b.instructionMessageList.length&&c.reservationSummary.productSummaryList&&0<c.reservationSummary.productSummaryList.length&&c.reservationSummary.insuranceSummaryList&&0<c.reservationSummary.insuranceSummaryList.length){var e=c.reservationSummary.productSummaryList.concat(c.reservationSummary.insuranceSummaryList);
b.Extras=[];angular.forEach(e,function(c){angular.forEach(b.instructionMessageList,function(a){a.code=="5305-"+c.code&&b.Extras.push(c);"CSSG"==c.code&&angular.forEach(c.subProducts,function(e){a.code=="5305-"+e.code&&b.Extras.push(c)})})})}else 1<=b.instructionMessageList.length&&c.reservationSummary.productSummaryList&&0<c.reservationSummary.productSummaryList.length&&!c.reservationSummary.insuranceSummaryList?(e=c.reservationSummary.productSummaryList,b.Extras=[],angular.forEach(e,function(c){angular.forEach(b.instructionMessageList,
function(a){a.code=="5305-"+c.code&&b.Extras.push(c)})})):1<=b.instructionMessageList.length&&!c.reservationSummary.productSummaryList&&c.reservationSummary.insuranceSummaryList&&0<c.reservationSummary.insuranceSummaryList.length&&(b.Extras=[],angular.forEach(e,function(c){angular.forEach(b.instructionMessageList,function(a){a.code=="5305-"+c.code&&b.Extras.push(c)})}));b.error=[];b.errorDisplayInsurance=[];b.errorDisplayProduct=[];b.rentalState={value:"estimate"==c.reservationSummary.rentalState?
!0:!1,tab:"Extras"};b.Insurance.selectedInsurance=[];y.addRentalInsurances(b.Insurance.selectedInsurance);b.product.selectedProduct=[];y.addRentalProducts(b.product.selectedProduct);var E=!1,d=!1;angular.forEach(c.reservationSummary.insuranceSummaryList,function(c){1==c.visible?E=b.rentalDetails.insuranceVisible=!0:E||(b.rentalDetails.insuranceVisible=!1)});angular.forEach(c.reservationSummary.productSummaryList,function(c){1==c.visible?d=b.rentalDetails.productVisible=!0:d||(b.rentalDetails.productVisible=
!1)});1<=b.instructionMessageList.length&&(767>=jQuery(window).width()&&b.close("Rental Extras"),q.addGTMScript(),$("#successAddon").appendTo("body").modal("show"));e="";angular.isDefined(b.rateSummary)&&angular.isDefined(b.rateSummary.totalAdditonalCharges)&&null!=b.rateSummary.totalAdditonalCharges&&(e=b.rateSummary.totalAdditonalCharges);angular.isDefined(c.reservationSummary.splitBillSummary)&&c.reservationSummary.splitBillSummary.splitBillEnabled?x.analyticsRentalDetails(c,"addExtras",!0,e):
x.analyticsRentalDetails(c,"addExtras",!1,e);angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.vehicle)&&angular.isDefined(c.reservationSummary.vehicle.fiveStarSafetyRate)&&x.analyticsRentalClickEvents(c,"","")}a.requestInProgress=!1},function(c){c.errorList&&0<c.errorList.length&&(b.error=n.processErrorMessage(c).errorList,b.Insurance.selectedInsurance=[],y.addRentalInsurances(b.Insurance.selectedInsurance),b.product.selectedProduct=[],y.addRentalProducts(b.product.selectedProduct),
"5313"!=c.errorList[0].code&&(b.addtionalTrue=!1,R()),a.requestInProgress=!1)})}b.rentalModel.confirmSuccess=!1;$("html, body").animate({scrollTop:$("#tabStart").position().top})};b.confirmRentalExt=function(){if(b.rentalModel.showModifiedReturns)b.rentalModel.showModifiedReturns=!1,a.requestInProgress=!0;else{a.requestInProgress=!0;var e=F.getDateFormat(C.getCustomerModel());e=$.datepicker.parseDate(e.dateFormat.format,b.dropDate);e=h("date")(e,"MM/dd/yyyy");e={splitOpted:b.rentalModel.availedSplitbill,
rentalNumber:b.rentalNumber,dropLocCode:angular.isDefined(b.selectedLoc)?b.selectedLoc:b.rentalExtension.reservationSummary.dropLoc.locationCode,dropDate:angular.isDefined(b.dropDate)?e:h("date")(b.rentalExtension.reservationSummary.dropDateTime,"MM/dd/yyyy"),dropTime:angular.isDefined(b.selectedTime)?b.selectedTime:h("date")(b.rentalExtension.reservationSummary.dropDateTime,"h:mm a")};b.extentionSplitData=e;var c={secondaryCreditCard:angular.isDefined(b.secondaryCardSelected)&&angular.isDefined(b.secondaryCardSelected.number)?
b.secondaryCardSelected.number:""};y.addToSplitDetails(c);u.confirmRentalExtension(e).then(function(c){if(angular.isDefined(c.errorList)&&0<c.errorList.length){if(b.error=n.processErrorMessage(c).errorList,b.rentalModel.modifyReturnActive=!1,b.rentalState.value=angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.rentalState)&&"estimate"==c.reservationSummary.rentalState?!0:!1,"34027"==b.error[0].code||"34031"==b.error[0].code||"34003"==b.error[0].code)b.rentalModel.date=
!1,b.rentalModel.loc=!1,b.rentalModel.time=!1,b.rentalState.value=!1,angular.isDefined(c.reservationSummary)&&(b.returnLoc=c.reservationSummary.dropLoc.name+", "+c.reservationSummary.dropLoc.locationCode,b.returnDate=h("ModifiedDate")(c.reservationSummary.dropDateTime),b.dropDate=b.returnDate,b.dropTime=h("date")(c.reservationSummary.dropDateTime,"h:mm a"))}else{b.rentalModel.time=!1;b.rentalModel.loc=!1;b.rentalModel.date=!1;b.rentalExtension=c;b.rentalModel.showModifiedReturns=!0;b.rentalModel.dateTimeSelected=
!1;b.rentalModel.confirmMessage=!0;b.rentalModel.modifyReturnActive=!1;b.rentalState.value=!1;b.returnLoc=b.rentalExtension.reservationSummary.dropLoc.name+", "+b.rentalExtension.reservationSummary.dropLoc.locationCode;b.returnDate=h("ModifiedDate")(b.rentalExtension.reservationSummary.dropDateTime);b.dropTime=h("date")(b.rentalExtension.reservationSummary.dropDateTime,"h:mm a");var e=C.getCustomerModel();angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&
angular.isDefined(c.reservationSummary.splitBillSummary.splitBillEnabled)&&(b.rentalDetails.reservationSummary.splitBillSummary=c.reservationSummary.splitBillSummary);aa(e,c);ca(e,c);e={balanceDays:b.rentalExtension.reservationSummary.rentalEndsIn,rentalNumber:b.rentalNumber};b.rentalDetails.reservationSummary.rentalEndsIn=e.balanceDays;a.$emit("Rental.balanceDays",e);767>=jQuery(window).width()&&b.close("Modify Return");$("html, body").animate({scrollTop:$("#tabStart").position().top});$("#successModifyReturn").appendTo("body").modal("show");
angular.isDefined(c.reservationSummary.splitBillSummary)&&c.reservationSummary.splitBillSummary.splitBillEnabled?x.analyticsRentalDetails(c,"modifyReturn",!0,""):x.analyticsRentalDetails(c,"modifyReturn",!1,"");angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.vehicle)&&angular.isDefined(c.reservationSummary.vehicle.fiveStarSafetyRate)&&x.analyticsRentalClickEvents(c,"","")}a.requestInProgress=!1},function(c){angular.isDefined(c.errorList)&&0<c.errorList.length&&(b.error=
c.errorList,b.rentalModel.modifyReturnActive=!1,b.rentalState.value=angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.rentalState)&&"estimate"==c.reservationSummary.rentalState?!0:!1,"34027"==b.error[0].code||"34031"==b.error[0].code||"34003"==b.error[0].code)&&(b.rentalModel.date=!1,b.rentalModel.loc=!1,b.rentalModel.time=!1,b.rentalState.value=!1,angular.isDefined(c.reservationSummary)&&(b.returnLoc=c.reservationSummary.dropLoc.name+", "+c.reservationSummary.dropLoc.locationCode,
b.returnDate=h("ModifiedDate")(c.reservationSummary.dropDateTime),b.dropDate=b.returnDate,b.dropTime=h("date")(c.reservationSummary.dropDateTime,"h:mm a")));a.requestInProgress=!1})}};b.updateTime=function(a){b.selectedTime=a.value;if(b.dropTime!=b.selectedTime){a=F.getDateFormat(C.getCustomerModel());a=$.datepicker.parseDate(a.dateFormat.format,angular.isDefined(b.dropDate)?b.dropDate:h("date")(b.rentalExtension.reservationSummary.dropDateTime,"dd/mm/yyyy"));a=h("date")(a,"MM/dd/yyyy");a={splitOpted:b.rentalModel.availedSplitbill,
rentalNumber:b.rentalNumber,dropLocCode:angular.isDefined(b.selectedLoc)?b.selectedLoc:b.rentalExtension.reservationSummary.dropLoc.locationCode,dropDate:a,dropTime:b.selectedTime};b.extentionSplitData=a;var c={secondaryCreditCard:angular.isDefined(b.secondaryCardSelected)&&angular.isDefined(b.secondaryCardSelected.number)?b.secondaryCardSelected.number:""};y.addToSplitDetails(c);b.rentalModel.time=!0;T(a,"Return Time");b.dropTime=b.selectedTime;$(".sp-time-dropdown").hasClass("open")&&jQuery(".sp-time-dropdown").removeClass("open")}};
b.updateLoc=function(a){$(".locations-form").find("input").val("");b.rentalModel.dateTimeSelected=!1;b.selectedLoc=a.locationCode;var c=F.getDateFormat(C.getCustomerModel());c=$.datepicker.parseDate(c.dateFormat.format,angular.isDefined(b.dropDate)?b.dropDate:h("date")(b.rentalExtension.reservationSummary.dropDateTime,"dd/mm/yyyy"));c=h("date")(c,"MM/dd/yyyy");c={splitOpted:b.rentalModel.availedSplitbill,rentalNumber:b.rentalNumber,dropLocCode:a.locationCode,dropDate:c,dropTime:angular.isDefined(b.selectedTime)?
b.selectedTime:h("date")(b.rentalExtension.reservationSummary.dropDateTime,"h:mm a")};b.extentionSplitData=c;var e={secondaryCreditCard:angular.isDefined(b.secondaryCardSelected)&&angular.isDefined(b.secondaryCardSelected.number)?b.secondaryCardSelected.number:""};y.addToSplitDetails(e);b.rentalModel.loc=!0;T(c,"Return Location");b.returnLoc=a.description+", "+a.locationCode};b.close=function(e){"Modify Return"==e&&L(!0);b.accordianClicked=e;b.rentalState.value?"Modify Return"==e?(L(!0),b.rentalModel.modifyReturnActive=
!0):"Rental Extras"==e&&(b.rentalModel.confirmSuccess=!0,L(!0),jQuery("#tab1").css("padding-bottom","")):k.location.href=a.contextPath+"/"+a.locale+"/rental/rental-dashboard"+htmlExtension;$("html, body").animate({scrollTop:$("#tabStart").offset().top-100})};b.analytics=M;b.displayPromo=function(){b.showPromo=b.showPromo?!1:!0};b.clearLoc=function(e){e?b.hideStickySection=!1:b.hideStickySection=!0;L(b.hideStickySection);$(".locations-form").find("input").val("");$(".locations-form").removeClass(".platform-element-error");
a.$broadcast("removeLocation",function(){})};b.setPickupHeader=function(){var a=h("date")(b.rentalDetails.reservationSummary.pickDateTime,"yyyy-MM-dd");a=jQuery.datepicker.parseDate("yy-mm-dd",a);jQuery(".start-date-input").datepicker("setDate",a).trigger("change");jQuery(".start-date-input").datepicker("option","dpheaderlabel",ba(a))};b._setDateFormatPreference=aa;b._displayFunction=function(a){b.rentalModel.showCity=a==f.countryCodeCA||a==f.countryCodePR||a==f.countryCodeUS||a==f.countryCodeCX||
a==f.countryCodeCV||a==f.countryCodeVI?!0:!1;b.rentalModel.showState=a==f.countryCodeAU||a==f.countryCodeCA||a==f.countryCodeUS||a==f.countryCodeNZ?!0:!1;b.rentalModel.showSuburb=a==f.countryCodeAU||a==f.countryCodeNZ?!0:!1;b.rentalModel.showZipcode=b.rentalModel.showSuburb||b.rentalModel.showCity?!0:!1};b._setTimeFormatPreference=ca;b._populateBillingInfoCountryList=function(){var a=k.countryList;b.countryList=[];b.countryList=angular.fromJson(a?a:{})};b.loadHelpModal=function(a){a=a.target.parentElement;
if(angular.isDefined(b.rentalExtension)&&angular.isDefined(b.rentalExtension.reservationSummary))var c=b.rentalExtension.reservationSummary.pickLoc.address.country;else angular.isDefined(b.rentalDetails)&&angular.isDefined(b.rentalDetails.reservationSummary)?c=b.rentalDetails.reservationSummary.pickLoc.address.country:angular.isDefined(b.rentalDetails)&&angular.isDefined(b.rentalDetails.reservationSummary)&&(c=b.rentalDetails.reservationSummary.pickLoc.address.country);b.helpURL=A.getUrl(a,c)};b.expandChildSafety=
function(){b.expandCSS?$(".cssProd").after($("#childSaftey")):b.expandCSSServ&&$(".cssProd").after($("#childSaftey2"))};b.checkForMaxDaysExtras=function(a,c,e){"primary"==e?(angular.forEach(a,function(c,a){"0 Days"==c&&b.rentalDays.productDays.primaryValues.unshift("0 Days")}),angular.forEach(c,function(c,a){"0 Days"==c&&b.rentalDays.insuranceDays.primaryValues.unshift("0 Days")})):"secondary"==e&&(angular.forEach(a,function(c,a){"0 Days"==c&&b.rentalDays.productDays.secondaryValues.unshift("0 Days")}),
angular.forEach(c,function(c,a){"0 Days"==c&&b.rentalDays.insuranceDays.secondaryValues.unshift("0 Days")}))};d("ExceptionHandlerController",{$scope:n});angular.isUndefinedOrNull=function(b){return angular.isUndefined(b)||null===b};var ia=function(){var b=new URL(window.location);window.history.pushState(b.href,"",b)};b.events={focusDropDown:function(){setTimeout(function(){ABG.focusBootstrapDropdown($("#timeDropDown .sp-dmenu-inner"),"value",b.dropTime,180)},100)},showPaymentOption:function(){b.errorAmountSplit=
[];b.errorItemized=[];b.rentalModel.enableCta=!1;b.rentalModel.amountSplitConfirmCTA=!1;var a=angular.element("#primaryAmount");angular.element(a).hasClass("ng-invalid")&&l.removeError(a,!0);a=angular.element("#secondaryAmount");angular.element(a).hasClass("ng-invalid")&&l.removeError(a,!0);b.split.primaryAmount=b.rentalDetails.reservationSummary.rateSummary.estimatedTotal;b.split.secondaryAmount="0.00";u.displaySplitOption(angular.copy(b.rentalDetails)).then(function(c){if(angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary)){b.splitOptionTab=
c;var a=b.rentalDetails.reservationSummary.splitBillSummary;if(a.numberOfDays){b.primaryValue=a.splitBillPrimary.lengthOfRental;b.secondaryValue=a.splitBillSecondary.lengthOfRental;b.primaryValue=1<b.primaryValue||0==b.primaryValue?b.primaryValue+" Days":b.primaryValue+" Day";b.secondaryValue=1<b.secondaryValue||0==b.secondaryValue?b.secondaryValue+" Days":b.secondaryValue+" Day";b.prodItemizedPri=null==b.rentalDetails.reservationSummary.splitBillSummary.splitBillPrimary.productmap?{}:b.rentalDetails.reservationSummary.splitBillSummary.splitBillPrimary.productmap;
b.insuranceItemizedPri=null==b.rentalDetails.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap?{}:b.rentalDetails.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap;var e=u.displayDropDown(b.prodItemizedPri,b.insuranceItemizedPri,"primary",b.rentalDetails);b.dropDownValue.insDropDownPri=e.insDrop;b.dropDownValue.proDropDownPri=e.proDrop;null!=b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary&&(b.prodItemizedSec=null==b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.productmap?
{}:b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.productmap,b.insuranceItemizedSec=null==b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap?{}:b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap);e=u.displayDropDown(b.prodItemizedSec,b.insuranceItemizedSec,"secondary",b.rentalDetails);b.dropDownValue.insDropDownSec=e.insDrop;b.dropDownValue.proDropDownSec=e.proDrop}else b.primaryValue=null,b.secondaryValue=
null,b.rentalDays.vehicleDays=[],b.rentalDays.productDays.primaryValues=[],b.rentalDays.productDays.secondaryValues=[],b.rentalDays.insuranceDays.primaryValues=[],b.rentalDays.insuranceDays.secondaryValues=[],b._populateRentalDays(b.rentalDetails.reservationSummary.lengthOfRental);$(".showTab-itemized, .showTab-amount").removeClass("active");angular.element("#tabItemized, #tabAmount").removeClass("active");!0===c.tab1.active?(b.itemizedPrimaryAmount=b.split.primaryAmount=a.splitBillPrimary.cardAmount,
b.itemizedSecondaryAmount=b.split.secondaryAmount=a.splitBillSecondary.cardAmount,$(".showTab-amount").addClass("active"),angular.element("#tabAmount").addClass("active"),b.rentalModel.amountSplitConfirmCTA=!1):!0===c.tab3.active?($(".showTab-itemized").addClass("active"),angular.element("#tabItemized").addClass("active"),b.rentalModel.enableCta=!1):(b.itemizedPrimaryAmount=b.split.primaryAmount=b.rentalDetails.reservationSummary.rateSummary.estimatedTotal,b.itemizedSecondaryAmount=b.split.secondaryAmount=
"0.00",$(".showTab-amount").addClass("active"),angular.element("#tabAmount").addClass("active"),b.rentalModel.amountSplitConfirmCTA=!1,b.splitOptionTab.tab1.active=!0)}c=angular.isDefined(b.rentalDetails)&&angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.gateExitDone)?"Mid Rental":"Pre Rental";M(!0,"Rental Summary - Split Payment","splitbill",c)})},redirect:function(d,c){b.rentalModel.tabFocus=!1;b.rentalModel.confirmMessage=!1;b.shuttleError=
!1;b.error=[];b.errorDisplayInsurance=[];b.errorDisplayProduct=[];b.clickedtab=d;b.cardError=[];b.isBackButton=!0;d&&!c&&(b.isBackButton=!1,ja(d,function(){dataLayer.push(["_trackPageview",e.path()])}));if(b.rentalState.value||b.rentalModel.unsplit)b.rentalState.value&&!b.rentalModel.unsplit&&(1==b.rentalDetails.tabDisplayControl.tab1.active?(b.rentalDetails.tabDisplayControl.tab1.disabled=!0,b.rentalModel.confirmSuccess=!0):1==b.rentalDetails.tabDisplayControl.tab2.active&&(b.rentalDetails.tabDisplayControl.tab2.disabled=
!0,b.rentalModel.modifyReturnActive=!0));else if(b.rentalModel.confirmSuccess=!1,Z(!0,d),1==b.rentalDetails.tabDisplayControl.tab3.active)a.requestInProgress=!0,b.oldSecondaryCardSummary={},u.getRentalSummary().then(function(c){b.rentalDetails=c;b.rentalDetails.tabDisplayControl.tab1.active=!1;b.rentalDetails.tabDisplayControl.tab2.active=!1;b.rentalDetails.tabDisplayControl.tab3.active=!0;b.rentalDetails.tabDisplayControl.tab4.active=!1;jQuery(".showTab-tab3").addClass("active");jQuery(".sp-rental-container").find(".sp-nav-wrap").addClass("cus-d-sm-none");
a.requestInProgress=!0;angular.isDefined(c.errorList)&&0<c.errorList.length?b.errorList=n.processErrorMessage(c).errorList:(b.errorList=[],l.resetError("vm.secondaryCardSelected.number",!0),angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)&&(angular.isDefined(c.reservationSummary.splitBillSummary.splitBillEnabled)&&(b.rentalModel.availedSplitbill=c.reservationSummary.splitBillSummary.splitBillEnabled),angular.isDefined(c.reservationSummary.gebUser)&&
c.reservationSummary.gebUser&&(b.rentalModel.availedSplitbill=!0),(b.rentalDetails.reservationSummary.splitBillSummary=c.reservationSummary.splitBillSummary)&&null!=c.reservationSummary.splitBillSummary.splitBillSecondary&&null!=c.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary&&(b.secondaryCardSelected=c.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary),b.hidePaymentInfo=b.rentalDetails.reservationSummary.gebUser&&(""==b.secondaryCardSelected.number||""!==b.secondaryCardSelected.number&&
void 0!==b.secondaryCardSelected.number&&null===b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount)?!0:!1),b.rentalModel.changedCard=!1,angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.lengthOfRental)&&null!=c.reservationSummary.lengthOfRental&&(b.rentalDays.vehicleDays=[],b.rentalDays.productDays.primaryValues=[],b.rentalDays.productDays.secondaryValues=[],b.rentalDays.insuranceDays.primaryValues=[],b.rentalDays.insuranceDays.secondaryValues=
[],b._populateRentalDays(c.reservationSummary.lengthOfRental)),angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitEligible)&&(b.rentalModel.showSplitOpt=c.reservationSummary.splitEligible),b.rentalState.tab="Rental-Summary",b.rentalModel.unsplit=!1,b.rentalModel.availedSplitbill&&angular.isDefined(c.reservationSummary.splitBillSummary)&&c.reservationSummary.splitBillSummary.dollarAmount&&null!=c.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount&&null!=
c.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount&&(b.split.primaryAmount=h("currency")(c.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount),b.split.secondaryAmount=h("currency")(c.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount)),b.rentalModel.availedSplitbill&&angular.isDefined(c.reservationSummary.splitBillSummary)&&!c.reservationSummary.gebUser&&(c.reservationSummary.splitBillSummary.counterProducts||c.reservationSummary.splitBillSummary.optionalServices||
(angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary.lengthOfRental)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary.lengthOfRental)&&c.reservationSummary.splitBillSummary.numberOfDays&&(b.primaryValue=c.reservationSummary.splitBillSummary.splitBillPrimary.lengthOfRental,b.secondaryValue=c.reservationSummary.splitBillSummary.splitBillSecondary.lengthOfRental,
b.primaryValue=1<b.primaryValue||0==b.primaryValue?b.primaryValue+" Days":b.primaryValue+" Day",b.secondaryValue=1<b.secondaryValue||0==b.secondaryValue?b.secondaryValue+" Days":b.secondaryValue+" Day"),b.secondaryValue&&b.primaryValue&&b._itemizedDropdown()),S(c)),angular.isDefined(b.rentalDetails.reservationSummary.productSummaryList)&&0==b.rentalDetails.reservationSummary.productSummaryList.length&&angular.isDefined(b.rentalDetails.reservationSummary.insuranceSummaryList)&&0==b.rentalDetails.reservationSummary.insuranceSummaryList.length&&
(b.rentalModel.hideItemizedTab=!0),angular.isDefined(b.addresses)&&!$.isEmptyObject(b.addresses)&&b._getAddressList(b.addresses),angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.personalInfo)&&angular.isDefined(b.rentalDetails.reservationSummary.personalInfo.residency)&&angular.isDefined(b.rentalDetails.reservationSummary.personalInfo.residency.value)&&(b.reservationModel.paymentRq.address.country=b.rentalDetails.reservationSummary.personalInfo.residency.value),
b.rentalDetails&&b.rentalDetails.reservationSummary&&b.rentalDetails.reservationSummary.splitBillSummary&&b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary&&b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary&&(b.secondaryCardSelected=angular.copy(b.rentalDetails.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary),angular.isDefined(b.secondaryCardSelected.expiryMsg)&&(b.warningMsgSC=n.processErrorMessage(b.secondaryCardSelected).expiryMsg)),
angular.isDefined(b.rentalDetails&&b.rentalDetails.reservationSummary&&b.rentalDetails.reservationSummary.splitBillSummary&&b.rentalDetails.reservationSummary.splitBillSummary.splitBillPrimary&&b.rentalDetails.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary)&&(b.primaryCard=angular.copy(b.rentalDetails.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary),angular.isDefined(b.primaryCard.expiryMsg)&&(b.warningMsgPC=n.processErrorMessage(b.primaryCard).expiryMsg)),b._loadMnthYrDropdown(),
b._populateBillingInfoCountryList(),"avis"==b.brand&&b.getStatesForCountry(b.reservationModel.paymentRq.address.country,"onload"));a.requestInProgress=!1;b.rentalModel.availedSplitbill?M(!0,"rental summary-Tab","splitbill"):M(!0,"rental summary-Tab")},function(c){k.location.href=a.contextPath+"/"+a.locale+"/reservation/view-modify-cancel"+htmlExtension});else if(1==b.rentalDetails.tabDisplayControl.tab1.active)b.rentalDetails.reservationSummary.gebUser?b.rentalState.tab="Extras":null,b.requestInProgress=
!0,a.requestInProgress=!0,b.rentalModel.showExtras=!1,R(),jQuery(".showTab-tab1").addClass("active"),jQuery(".sp-rental-container").find(".sp-nav-wrap").addClass("cus-d-sm-none"),b.rentalModel.availedSplitbill?M(!0,"add rental extras-Tab","splitbill"):M(!0,"add rental extras-Tab");else if(1==b.rentalDetails.tabDisplayControl.tab2.active)b.rentalDetails.reservationSummary.gebUser?b.rentalState.tab="Modify-Return":null,a.requestInProgress=!0,b.clearLoc(!0),u.getRentalExtension().then(function(c){a.requestInProgress=
!0;b.rentalDetails.tabDisplayControl.tab1.active=!1;b.rentalDetails.tabDisplayControl.tab2.active=!0;b.rentalDetails.tabDisplayControl.tab3.active=!1;b.rentalDetails.tabDisplayControl.tab4.active=!1;jQuery(".showTab-tab2").addClass("active");jQuery(".sp-rental-container").find(".sp-nav-wrap").addClass("cus-d-sm-none");b.rentalExtension=c;angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.rateSummary)&&(b.rateSummary=c.reservationSummary.rateSummary);angular.isDefined(c.reservationSummary)&&
angular.isDefined(c.reservationSummary.splitBillSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillEnabled)&&(b.rentalModel.availedSplitbill=c.reservationSummary.splitBillSummary.splitBillEnabled,angular.isDefined(b.rentalExtension.reservationSummary.splitBillSummary.splitBillSecondary)&&null!=b.rentalExtension.reservationSummary.splitBillSummary.splitBillSecondary&&angular.isDefined(b.rentalExtension.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary)&&null!=
b.rentalExtension.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary&&(b.secondaryCardSelected=b.rentalExtension.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary));angular.isDefined(b.rentalExtension.reservationSummary)&&angular.isDefined(b.rentalExtension.reservationSummary.splitBillSummary)&&angular.isDefined(b.rentalExtension.reservationSummary.splitBillSummary.splitBillPrimary)&&null!=b.rentalExtension.reservationSummary.splitBillSummary.splitBillPrimary&&angular.isDefined(b.rentalExtension.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary)&&
null!=b.rentalExtension.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary&&(b.primaryCard=b.rentalExtension.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary);angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.rentalState)&&(b.rentalState={value:"estimate"==c.reservationSummary.rentalState?!0:!1,tab:"Modify-Return"});b.rentalDetails.reservationSummary.gebUser&&c.reservationSummary.splitBillSummary.splitBillSecondary&&c.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary&&
c.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary.number&&(b.rentalModel.availedSplitbill=!0);if(angular.isDefined(b.rentalExtension.reservationSummary.splitBillSummary))var e={splitOpted:b.rentalExtension.reservationSummary.splitBillSummary.splitBillEnabled,secondaryCreditCard:angular.isDefined(b.rentalExtension.reservationSummary.splitBillSummary.splitBillSecondary)&&null!=b.rentalExtension.reservationSummary.splitBillSummary.splitBillSecondary&&angular.isDefined(b.rentalExtension.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary)&&
angular.isDefined(b.rentalExtension.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary.number)?b.rentalExtension.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary.number:""};b.rentalDetails.reservationSummary.gebUser&&(b.rateSummary.totalAdditonalCharges=0);y.addToSplitDetails(e);b.returnLoc=b.rentalExtension.reservationSummary.dropLoc.name+", "+b.rentalExtension.reservationSummary.dropLoc.locationCode;b.returnDate=h("ModifiedDate")(b.rentalExtension.reservationSummary.dropDateTime);
b.dropTime=h("date")(b.rentalExtension.reservationSummary.dropDateTime,"h:mm a");e=C.getCustomerModel();aa(e,c);ca(e,c);a.requestInProgress=!1;b.rentalModel.availedSplitbill?M(!0,"modify return-Tab","splitbill"):M(!0,"modify return-Tab")},function(c){angular.isDefined(c.errorList)&&0<c.errorList.length&&(b.errorList=n.processErrorMessage(c).errorList,a.requestInProgress=!1)}),b.rentalDetails.reservationSummary.gebUser&&jQuery(".showTab-tab2").addClass("sp-tab-geb-user");else if(1==b.rentalDetails.tabDisplayControl.tab4.active){b.rentalDetails.tabDisplayControl.tab1.active=
!1;b.rentalDetails.tabDisplayControl.tab2.active=!1;b.rentalDetails.tabDisplayControl.tab3.active=!1;b.rentalDetails.tabDisplayControl.tab4.active=!0;jQuery(".showTab-tab4").addClass("active");jQuery(".sp-rental-container").find(".sp-nav-wrap").addClass("cus-d-sm-none");a.requestInProgress=!0;var z=angular.element($(".bingMap")).injector().get("$rootScope");navigator.geolocation.getCurrentPosition(function(c){u.getShuttleDetails("42.2379436","-83.3297705").then(function(c){b.shuttleDetails=c;b.shuttleDetails.position=
b.rentalDetails.reservationSummary.pickLoc.position;z.LoadMap("42.2379436","-83.3297705",15,b.shuttleDetails);H(function(){a.requestInProgress=!1},1E3)},function(c){c.errorList&&0<c.errorList.length&&(b.error=n.processErrorMessage(c).errorList,b.shuttleError=!0,a.requestInProgress=!1)})},function(c){b.shuttleError=!0;H(function(){a.requestInProgress=!1},1E3)})}angular.isDefined(d)?$("html, body").animate({scrollTop:$("#tabStart").position().top}):k.scrollTo(0,0)},leaveChanges:function(e){"splitPaymentModal"==
e?(a.requestInProgress=!0,u.getRentalExtension().then(function(c){a.requestInProgress=!0;angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.splitBillSummary)?(b.rentalDetails.reservationSummary.splitBillSummary=c.reservationSummary.splitBillSummary,angular.isDefined(c.reservationSummary.splitBillSummary)&&c.reservationSummary.splitBillSummary.numberOfDays&&(angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary)&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary.lengthOfRental)&&
(b.primaryValue=b.primaryDayValue=c.reservationSummary.splitBillSummary.splitBillPrimary.lengthOfRental),angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary)&&null!=c.reservationSummary.splitBillSummary.splitBillSecondary&&angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary.lengthOfRental)&&angular.isDefined(null!=c.reservationSummary.splitBillSummary.splitBillSecondary.lengthOfRental)&&(b.secondaryValue=b.secondaryDayValue=c.reservationSummary.splitBillSummary.splitBillSecondary.lengthOfRental)),
angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary)&&(angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap)||angular.isDefined(c.reservationSummary.splitBillSummary.splitBillPrimary.productmap))&&(b.insuranceItemizedPri=null==c.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap?{}:c.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap,b.prodItemizedPri=null==c.reservationSummary.splitBillSummary.splitBillPrimary.productmap?
{}:c.reservationSummary.splitBillSummary.splitBillPrimary.productmap),angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary)&&null!=c.reservationSummary.splitBillSummary.splitBillSecondary&&(angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap)||angular.isDefined(c.reservationSummary.splitBillSummary.splitBillSecondary.productmap))?(b.insuranceItemizedSec=null==c.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap?
{}:c.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap,b.prodItemizedSec=null==c.reservationSummary.splitBillSummary.splitBillSecondary.productmap?{}:c.reservationSummary.splitBillSummary.splitBillSecondary.productmap):null==c.reservationSummary.splitBillSummary.splitBillSecondary&&(b.insuranceItemizedSec={},b.prodItemizedSec={}),b.cubsideSelected={},angular.forEach(c.reservationSummary.productSummaryList,function(c){c.subProducts&&0<c.subProducts.length?angular.forEach(c.subProducts,
function(c){"PER_RENTAL"==c.category&&(b.cubsideSelected[c.code]=b.prodItemizedPri[c.code]==b.rentalDetails.reservationSummary.lengthOfRental?"primary":b.prodItemizedSec[c.code]==b.rentalDetails.reservationSummary.lengthOfRental?"secondary":null)}):"PER_RENTAL"==c.category&&(b.cubsideSelected[c.code]=b.prodItemizedPri[c.code]==b.rentalDetails.reservationSummary.lengthOfRental?"primary":b.prodItemizedSec[c.code]==b.rentalDetails.reservationSummary.lengthOfRental?"secondary":null)}),b.events.showPaymentOption()):
(c=angular.element("#primaryAmount"),angular.element(c).hasClass("ng-invalid")&&l.removeError(c,!0),c=angular.element("#secondaryAmount"),angular.element(c).hasClass("ng-invalid")&&l.removeError(c,!0),b.split.primaryAmount="",b.primaryAmountOldValue="",b.split.secondaryAmount="",b.secondaryAmountOldValue="",b.rentalModel.amountSplitConfirmCTA=!1,b.primaryDayValue="",b.secondaryDayValue="",b.primaryValue="",b.secondaryValue="",b.prodItemizedPri={},b.prodItemizedSec={},b.insuranceItemizedPri={},b.insuranceItemizedSec=
{},b.rentalModel.daySplitConfirmCTA=!1);a.requestInProgress=!1},function(c){angular.isDefined(c.errorList)&&0<c.errorList.length&&(b.errorList=n.processErrorMessage(c).errorList,a.requestInProgress=!1)})):(a.requestInProgress=!0,b.rentalModel.confirmSuccess=!1,b.rentalState.value=!1,b.rentalModel.modifyReturnActive=!1,b.shuttleError=!1,b.rentalModel.time=!1,b.rentalModel.loc=!1,b.product.selectedProduct=[],b.close(b.accordianClicked),u.getRentalExtension().then(function(c){b.returnDate=h("ModifiedDate")(c.reservationSummary.dropDateTime);
a.requestInProgress=!1},function(c){}))},showMap:function(a){m.getLangLat(a).then(function(c){c.errorList&&0<c.errorList.length?b.rentalModel.latError=!0:(b.rentalModel.latError=!1,window.open("http://www.google.com/maps/dir//"+c.stationInfoList[0].latitude+","+c.stationInfoList[0].longitude+"/@"+c.stationInfoList[0].latitude+","+c.stationInfoList[0].longitude+",12z","_blank"))},function(c){console.log("error in lat-lng call")})},goBack:function(){1==b.rentalDetails.tabDisplayControl.tab1.active&&
(b.rentalModel.confirmSuccess=!1,b.rentalModel.showExtras=!1,b.rentalState.value?L(!0):L(!1),1==b.rentalModel.unsplit&&(b.rentalModel.unsplit=!1,b.rentalModel.availedSplitbill=!0));1==b.rentalDetails.tabDisplayControl.tab2.active&&(b.rentalModel.modifyReturnActive=!1,b.rentalState.value?L(!0):L(!1),1==b.rentalModel.unsplit&&(b.rentalModel.unsplit=!1,b.rentalModel.availedSplitbill=!0));1==b.rentalDetails.tabDisplayControl.tab3.active&&(1==b.rentalModel.unsplit&&(b.rentalModel.unsplit=!1,b.rentalModel.availedSplitbill=
!0),b.rentalModel.showAlertMessage&&($(".showTab-itemized, .showTab-days, .showTab-amount").removeClass("active"),angular.element("#tabItemized, #tabRentalDays, #tabAmount").removeClass("active"),W==f.splitInRental.AMOUNT?($(".showTab-amount").addClass("active"),angular.element("#tabAmount").addClass("active"),b.amountSplitConfirmCTA=!1):W==f.splitInRental.DAY?($(".showTab-days").addClass("active"),angular.element("#tabRentalDays").addClass("active"),b.daySplitConfirmCTA=!1):($(".showTab-itemized").addClass("active"),
angular.element("#tabItemized").addClass("active")),b.rentalModel.showAlertMessage=!1));1==b.rentalDetails.tabDisplayControl.tab4.active&&(jQuery(".showTab-tab4").removeClass("active"),jQuery(".sp-nav-wrap").removeClass("cus-d-sm-none"));if("Extras"==b.rentalState.tab)var a=f.unsplitExtraGoback;else"Modify-Return"==b.rentalState.tab?(b.rentalModel.tabFocus?L(!0):L(!1),a=f.unsplitModifyGoback):a=f.unsplitSummaryGoback;var c=angular.isDefined(b.rentalDetails)&&angular.isDefined(b.rentalDetails.reservationSummary)&&
angular.isDefined(b.rentalDetails.reservationSummary.gateExitDone)?"Mid Rental":"Pre Rental";M(!1,a,"splitbill",c)}};n.$watch("vm.dropDate",function(a,c){if(angular.isDefined(a)&&angular.isDefined(c)){var e=F.getDateFormat(C.getCustomerModel());a=$.datepicker.parseDate(e.dateFormat.format,a);a=h("ModifiedDate")(a);b.rentalModel.date=!1;a==c||(new Date(a)).getDate()==(new Date(b.returnDate)).getDate()&&(new Date(a)).getMonth()==(new Date(b.returnDate)).getMonth()&&(new Date(a)).getFullYear()==(new Date(b.returnDate)).getFullYear()||
(e=F.getDateFormat(C.getCustomerModel()),a=$.datepicker.parseDate(e.dateFormat.format,b.dropDate),b.returnDate=h("ModifiedDate")(a),e=F.getDateFormat(C.getCustomerModel()),a=$.datepicker.parseDate(e.dateFormat.format,b.dropDate),a=h("date")(a,"MM/dd/yyyy"),c={splitOpted:b.rentalModel.availedSplitbill,rentalNumber:b.rentalNumber,dropLocCode:angular.isDefined(b.selectedLoc)?b.selectedLoc:b.rentalExtension.reservationSummary.dropLoc.locationCode,dropDate:a,dropTime:angular.isDefined(b.selectedTime)?
b.selectedTime:h("date")(b.rentalExtension.reservationSummary.dropDateTime,"h:mm a")},b.extentionSplitData=c,a={secondaryCreditCard:angular.isDefined(b.secondaryCardSelected)&&angular.isDefined(b.secondaryCardSelected.number)?b.secondaryCardSelected.number:""},y.addToSplitDetails(a),b.rentalModel.date=!0,T(c,"Return Date"))}});$("#modalAddCreditCard").on("hidden.bs.modal",function(){l.resetError("vm.reservationModel.paymentRq.expMonth",!0);l.resetError("vm.reservationModel.paymentRq.expYear",!0);
l.resetError("vm.billingAddress",!0);l.resetError("vm.creditCardNumber",!0);l.resetError("vm.secureCode",!0);""!=b.secondaryCardSelected.number||b.rentalDetails.reservationSummary.gebUser||($("#pay-CC").prop("checked",!1),H(function(){b.rentalModel.availedSplitbill=!1},1));b.errorDisplayList=[];a.$broadcast("setReviewCreditCard",V)});$("#splitAmount").on("hidden.bs.modal",function(){angular.isDefined(b.rentalDetails.reservationSummary)&&angular.isDefined(b.rentalDetails.reservationSummary.splitBillSummary)&&
0==b.rentalDetails.reservationSummary.splitBillSummary.splitBillEnabled&&($("#pay-CC").prop("checked",!1),H(function(){b.rentalModel.availedSplitbill=!1},1))});n.$on("$locationChangeSuccess",function(a,c,d,E,z){-1!=d.indexOf("#")&&c!=d?1==b.isBackButton?(a=e.url(),""!=a?($("#successAddon").modal("hide"),a=f.modifyRentalStateTabMap[a],b.events.redirect(a,!0)):history.go(-1)):b.isBackButton=!0:-1==d.indexOf("#")&&c!=d&&1==b.isBackButton&&(a=e.url(),""!=a&&(a=f.modifyRentalStateTabMap[a],b.events.redirect(a,
!0)))});$("#successAddon").on("hidden.bs.modal",function(){b.events.redirect("tab3")});$("#successModifyReturn").on("hidden.bs.modal",function(){b.events.redirect("tab3")});a.$on("Profile.successAuthentication",function(e,c){"rental-dashboard"==p.current.name&&(c.reservationSummary.userState==f.userStateAuthenticated?(b.vehicleExchangeObj.flow=!0,t.setStorageData("vehicleExchangeObj",b.vehicleExchangeObj),k.location.href=a.contextPath+"/"+a.locale+"/rental"+htmlExtension+"#/select-vehicle"):(b.loginValidated=
!0,b.loginFormPageError=Dictionary.I18n.get("err.prof.login.authenticationFailedAction")))});D()}angular.module("reservation").controller("rentalExtController",t);t.$inject="rentalService $scope $rootScope $filter $state $controller $window $validation reservationModelService gaService carRentalConstant travelService lookupService locationService getDataService vehicleService authenticationService confirmCancelService BackButtonFactory storageService geoservices datePickerInit $timeout getVehicles $sce $location optionalService rentalUtil utilityService".split(" ")})();
(function(){function t(u,n,a){function h(a){return angular.element(document).injector().get(a)}function p(){document.getElementById("qr-details-card").scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}var d=this;d.data={};d.walkingDirectionContent="";d.exitQRCode="";d.errorMessage="";d.qrAction={generate:!0,view:!1};d.exitQRCodePrivacy={termsAccepted:!1,dlVerify:!1};d.walkingDirectionShowCard=!1;d.init=function(){d.expressExitData=h("storageService").getStorageData("expressExit");if(angular.isUndefined(d.expressExitData)||
angular.isUndefined(d.expressExitData.exitQRCode))d.expressExitData={},d.expressExitData.exitQRCode={};if(angular.isDefined(d.expressExitData)&&angular.isDefined(d.expressExitData.exitQRCode)){var k=d.expressExitData.exitQRCode;"50002"==k.errorCode&&null===k.qrCode&&(d.qrAction={generate:!1,view:!0})}d.customerInfo=a.loadCustomerInfo();d.wizardNum=angular.isDefined(d.customerInfo)&&angular.isDefined(d.customerInfo.wizardNumberMasked)?d.customerInfo.wizardNumberMasked:"";a.expressExitPass()&&h("gaService").trackExpressExitPass("initiated",
d.data.reservationSummary,d.wizardNum)};d.closeModal=function(a,l){"QR"==a?(d.walkingDirectionShowCard=!1,p(),$("#myModal").modal("hide"),p()):"TNC"==a?(d.walkingDirectionShowCard=!1,p(),$("#myModal-terms-condition").modal("hide"),$window.scroll(0,0)):"walking-direction"==a&&(d.walkingDirectionShowCard=!1,p())};d.gateExitQRCode=function(){var a=d.expressExitData;angular.isDefined(a)&&angular.isDefined(a.exitQRCode)&&a.termsAccepted&&angular.isDefined(a.exitQRCode.qrCode)&&angular.isDefined(a.exitQRCode.message)?
50002==d.expressExitData.exitQRCode.errorCode?(d.qrAction={generate:!1,view:!0},d.errorMessage=d.expressExitData.exitQRCode.message):5E4==d.expressExitData.exitQRCode.errorCode&&d.expressExitData.exitQRCode.qrCode&&d.QrCodeAction._callService(!0):angular.isDefined(d.expressExitData)&&(angular.isUndefined(d.expressExitData.exitQRCode)&&!d.expressExitData.exitQRCode.termsAccepted||0===Object.keys(d.expressExitData.exitQRCode).length)&&$("#myModal-terms-condition").modal({backdrop:"static",keyboard:!1});
h("gaService").trackExpressExitPass("requested",d.data.reservationSummary,d.wizardNum)};d.action={submit:function(a){"walking-direction"==a&&(a=h("storageService").getStorageData("expressExit"),angular.isDefined(a)&&angular.isDefined(a.expressExitParams)&&angular.isDefined(a.expressExitParams.walkingDirections)&&0<a.expressExitParams.walkingDirections.length?d.walkingDirectionContent=a.expressExitParams.walkingDirections:(a=angular.isDefined(d.data)&&angular.isDefined(d.data.reservationSummary)&&
angular.isDefined(d.data.reservationSummary.pickLoc)&&angular.isDefined(d.data.reservationSummary.pickLoc.locationCode)?d.data.reservationSummary.pickLoc.locationCode:"",u.requestInProgress=!0,d.action._callService({locationCode:a,type:"lat_long",rqHeader:{locale:u.locale,domain:h("$window").domain.toLowerCase()}})),d.walkingDirectionShowCard=!0,setTimeout(function(){jQuery("html, body").animate({scrollTop:jQuery(".walking_direction_box").offset().top-100},1E3)},100))},_callService:function(a){var l=
{walkingDirections:""};d.action._latLong(a).then(function(a){u.requestInProgress=!1;angular.isDefined(a)&&angular.isDefined(a.stationInfoList)&&0<a.stationInfoList.length?(a=a.stationInfoList[0],angular.isDefined(a.augmentDataMap)&&(a=a.augmentDataMap,angular.isDefined(a.CTR2LOT_DIR)?(d.walkingDirectionContent=a.CTR2LOT_DIR,l.walkingDirections=d.walkingDirectionContent):angular.isUndefined(a.CTR2LOT_DIR)&&(d.walkingDirectionContent=Dictionary.I18n.get("walking_direction_error_message"),l.walkingDirections=
d.walkingDirectionContent))):angular.isDefined(a)&&angular.isDefined(a.errorList)&&0<a.errorList.length&&(d.walkingDirectionContent=Dictionary.I18n.get("walking_direction_error_message"),l.walkingDirections=d.walkingDirectionContent)},function(a){u.requestInProgress=!1;angular.isDefined(a)&&angular.isDefined(a.errorList)&&0<data.errorList.length&&(d.walkingDirectionContent=Dictionary.I18n.get("walking_direction_error_message"),l.walkingDirections=d.walkingDirectionContent)});d.expressExitData.expressExitParams=
l;h("storageService").setStorageData("expressExit",d.expressExitData)},_latLong:function(a){a={locationCode:a.locationCode,type:a.type,rqHeader:{locale:a.locale,domain:a.domain}};var d=h("$q").defer(),k=apiurl+"/station/lat-long";h("$http")({method:"POST",url:k,data:a}).then(function(a){a=a.data;h("$window").brand!=h("carRentalConstant").brandName.PAYLESS&&ABG.updateContextStores();a=h("exceptionHandler").processError(a,h("reservationModelService").modelMap);angular.isDefined(a)&&angular.isUndefined(a.errorList)?
d.resolve(a):d.reject(a)}).catch(function(a){d.reject(a.data)});return d.promise}};d.QrCodeAction={_callService:function(a){u.requestInProgress=!0;d.QrCodeAction._genarateQR(a).then(function(l){angular.isDefined(l.reservationSummary)&&l.reservationSummary.qrSummary&&(d.exitQRCode=l.reservationSummary.qrSummary,angular.isDefined(d.expressExitData)&&angular.isDefined(d.expressExitData.exitQRCode)&&angular.isUndefined(d.expressExitData.termsAccepted)&&(d.expressExitData.termsAccepted=a),d.expressExitData.exitQRCode=
d.exitQRCode,h("storageService").setStorageData("expressExit",d.expressExitData),d.exitQRCode.qrCode?(h("gaService").trackExpressExitPass("success",d.data.reservationSummary,d.wizardNum),d.exitQRCode.secondsUntilExpire&&(d.exitQRCode.timeOfExpired=Math.floor(d.exitQRCode.secondsUntilExpire/60)+" Minutes")):"50002"==d.exitQRCode.errorCode&&(d.errorMessage=d.exitQRCode.message,h("gaService").expressExitPassErrorTracking("Your Express Exit Pass has expired")),$("#myModal-terms-condition").modal("hide"),
null!=d.exitQRCode.qrCode&&null!=d.exitQRCode.expireDate&&"50002"!=d.exitQRCode.errorCode&&$("#myModal").modal({backdrop:"static",keyboard:!1}),d.qrAction={generate:!1,view:!0});u.requestInProgress=!1},function(a){u.requestInProgress=!1;a&&a.fieldErrors?(a=$scope.processErrorMessage(a),d.errorDisplayList=a):a&&a.errorList&&(d.errorMessage=a.errorList[0].message);u.requestInProgress=!1;$("#myModal-terms-condition").modal("hide")})},_genarateQR:function(a){a={rentalAgreementNumber:d.data.reservationSummary.rentalAgreementNumber,
consentTermsAccepted:a};var l=h("$q").defer(),k=apiurl+"/self-checkout/gateExitQRCode";h("$http")({method:"POST",url:k,data:a}).then(function(a){a=a.data;h("$window").brand!=h("carRentalConstant").brandName.PAYLESS&&ABG.updateContextStores();a=h("exceptionHandler").processError(a,h("reservationModelService").modelMap);angular.isDefined(a)&&angular.isUndefined(a.errorList)?l.resolve(a):l.reject(a)}).catch(function(a){l.reject(a.data)});return l.promise}};u.$on("walkingDirection",function(a,l){d.action.submit(l.value)});
u.$on("getRentalDetails",function(a,l){d.data=l;d.init()})}angular.module("reservation").controller("expressExitController",t);t.$inject=["$rootScope","utilityService","rentalUtil"]})();
(function(){function t(u){var n={},a={},h=function(){var a=u.getStorageData("rentalDetails"),d=a&&a.customerInfo,k=u.getStorageData("reservationModelSelfCheckOut"),f=u.getStorageData("equipmentCSSList");return{reservationSummary:angular.isDefinedAndNotNull(a)&&angular.isDefinedAndNotNull(a.reservationSummary)?a.reservationSummary:angular.isDefinedAndNotNull(k)&&angular.isDefinedAndNotNull(k.reservationSummary)?k.reservationSummary:{},customer:angular.isDefinedAndNotNull(d)?d:angular.isDefinedAndNotNull(k)&&
angular.isDefinedAndNotNull(k.customerInfo)?k.customerInfo:{},equipmentCSSList:angular.isDefinedAndNotNull(f)?f:{},webHeader:a&&a.webHeader?a.webHeader:k&&k.webHeader?k.webHeader:{}}};n=h().reservationSummary;a=h().customer;var p={isAuthenticated:function(){return angular.isDefined(n)&&angular.isDefined(n.userState)&&"AUTHENTICATED"===n.userState?!0:!1},isPreferred:function(){return angular.isDefined(a)&&angular.isDefined(a.preferred)&&a.preferred&&angular.isDefined(a.ftpreferred)&&!a.ftpreferred}},
d={mobileSelectLocation:function(){return angular.isDefined(n)&&angular.isDefined(n.pickLoc.airportIndicator)&&n.pickLoc.airportIndicator&&angular.isDefined(n.onAirportIndicator)&&n.onAirportIndicator?!0:!1},airportLocation:function(){return angular.isDefined(n)&&angular.isDefined(n.pickLoc.airportIndicator)&&n.pickLoc.airportIndicator&&angular.isDefined(n.onAirportIndicator)&&!n.onAirportIndicator?!0:!1},cityLocation:function(){return angular.isDefined(n)&&angular.isDefined(n.pickLoc.airportIndicator)&&
!1===n.pickLoc.airportIndicator?!0:!1}},k=function(){return angular.isDefined(n)&&angular.isDefined(n.pseudoMVARental)&&n.pseudoMVARental?!0:!1};return{spaceNumber:function(){for(var a=angular.isDefined(n.vehicle)&&angular.isDefined(n.vehicle.vehicleFeatures)?n.vehicle.vehicleFeatures:[],d=0;d<a.length;d++)if("lotSpaceNumber"===a[d].name&&"See Counter"!==a[d].value)return!0;return!1},vehicleReady:function(){return d.cityLocation()},fuelDetails:function(){return k()?!1:!0},bannerContent:function(){return!this.vehicleReady()},
expressExitPass:function(){return h().webHeader&&"PRE_RENTAL_DASHBOARD_EXPRSS_PASS"==h().webHeader.viewIndicator?!0:!1},isOnLotScanned:function(){return angular.isDefined(u.getStorageData("onLotConfirmVehicleData"))?!0:!1},vehicleExchange:function(){return("avis"===window.brand||window.location.href.includes("avis"))&&p.isPreferred()&&d.mobileSelectLocation()&&!k()&&!n.gateExitDone&&angular.isDefined(n.timeLapsedFromCheckOut)&&120>=n.timeLapsedFromCheckOut},licensePlateNumber:function(){return k()?
!1:!0},carModalName:function(a){return k()?a.includes("or similar")?a:a+" or similar":a},loadActualCarImage:function(){return k()?!1:!0},loadCustomerInfo:function(){return h().customer}}}angular.module("reservation").service("rentalUtil",t);t.$inject=["storageService"]})();
(function(){function t(u,n,a,h,p,d,k,l,q,x){function f(d){var f=a.defer();if(d&&d.productSummaryList){var y=d.productSummaryList;l.loadSupportedExtras("und").then(function(a){a=z(a.supportedProducts,y);d.productSummaryList=a;f.resolve(d)})}else f.resolve(d);return f.promise}function z(a,d,z){var f=[];angular.forEach(a,function(a,z){angular.forEach(d,function(d){a.code===d.code&&(d={name:a.name,description:a.description,information:a.information,image:a.image,additionalnote:a.additionalnote,displayQuantity:a.quantity,
code:d.code,dailyCharge:d.dailyCharge,quantity:d.quantity,totalPrice:d.totalPrice,inclRateInEstTotal:d.inclRateInEstTotal,selected:void 0!=d.productDisplay&&void 0!=d.productDisplay.selected&&"TRUE"==d.productDisplay.selected,disabled:void 0!=d.productDisplay&&void 0!=d.productDisplay.editable&&"FALSE"==d.productDisplay.editable,supported:d.supported,type:d.type,additionalDetails:d.additionalDetails,productMessage:angular.isDefined(d.productMessage)&&angular.isDefined(d.productMessage.type)&&"INSTRUCTION"===
d.productMessage.type?d.productMessage.code:"",productInfoMessage:Dictionary.I18n.get(angular.isDefined(d.productMessage)&&angular.isDefined(d.productMessage.type)?d.productMessage.code:""),included:d.included},f.push(d))})});return f}return{loadProducts:function(){var d=apiurl+"/notification/event/rental",z=a.defer(),l={uniqueId:q.readQuery("id")};u({method:"POST",url:d,data:l}).then(function(a){var d=a.data;d=h.processError(d);f(d).then(function(a){z.resolve(d)})}).catch(function(a){z.reject(a.data)});
n.requestInProgress=!1;return z.promise},productSelection:function(){var d=apiurl+"/notification/rental/extras",z=a.defer(),f={selectedProducts:p.getReservationModel().selectedProducts};u({method:"POST",url:d,data:f}).then(function(a){a=a.data;a=h.processError(a);z.resolve(a)}).catch(function(a){z.reject(a.data)});return z.promise},confirmProduct:function(){var d={selectedProducts:p.getReservationModel().selectedProducts},z=a.defer();u({method:"POST",url:apiurl+"/notification/rental/modify",data:d}).then(function(a){a=
a.data;a=h.processError(a);z.resolve(a)}).catch(function(a){z.reject(a.data)});return z.promise},mergeAvailableProductDetails:f,getCurbsideData:function(d){d=x.endPointArray[d];var z=a.defer();u({method:"GET",url:apiurl+"/summary/reservation?url\x3d"+d}).then(function(a){a=a.data;a=h.processError(a);z.resolve(a)}).catch(function(a){z.reject(a.data)});return z.promise}}}angular.module("reservationServices").service("curbsideService",t);t.$inject="$http $rootScope $q exceptionHandler reservationModelService getDataService authenticationService optionalService locationService carRentalConstant".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x){function f(){a.requestInProgress=!0;-1!==h.location.pathname.indexOf("rental/confirmation")&&d.getCurbsideData("CURBIDE_CONFIRMATION_URL").then(function(d){a.requestInProgress=!0;B.taxesAndFees=d.webHeader.i18nSummary.lbl_taxesAndFees_included;B.anAdditional=d.webHeader.i18nSummary.lbl_anAdditional;if(angular.isDefined(d.rentalSummary.selectedProducts)&&0<d.rentalSummary.selectedProducts.length){angular.forEach(d.rentalSummary.selectedProducts,function(a,
z){1<d.rentalSummary.selectedProducts.length?(B.hazardAndXmrInstruction=!0,B.productDescription=a.selectedProductDesc,"CSD"==a.code&&(B.additionalProductChargeCSD=a.dailyCharge),"XMR"==a.code&&(B.additionalProductChargeXMR=a.dailyCharge),B.instruction=d.rentalSummary.instruction):"CSD"==a.code?(B.hazardInstruction=!0,B.productDescription=a.selectedProductDesc,B.instruction=d.rentalSummary.instruction,B.additionalProductChargeCSD=a.dailyCharge):(B.xmrInformation=!0,B.productDescription=a.selectedProductDesc,
B.additionalProductChargeXMR=a.dailyCharge)});try{B.reservationModel&&x.analyticsDimension(d.rentalSummary.selectedProducts,"curbside-conf",d)}catch(r){}}a.requestInProgress=!1});l.getXsrfToken()&&B.curbsideLanding==q.curbside&&(F=!0,z())}function z(){a.requestInProgress=!0;d.loadProducts().then(function(d){B.products=d.productSummaryList.reverse();B.products&&B.products.errorList&&0<B.products.errorList.length&&(h.location.href=a.contextPath+"/"+a.locale+"/reservation"+htmlExtension+"#/time-and-place");
a.requestInProgress=!1;try{x.analyticsDimension(B.products,"curbside-anc",d)}catch(r){}})}function t(a,d){if(d)for(d=0;d<B.reservationModel.selectedProducts.length;d++)if(a===B.reservationModel.selectedProducts[d].code){B.reservationModel.selectedProducts.splice(d,1);break}}var B=this;B.reservationModel=p.bookingModel;B.productSelected=function(a,z,f,l){B.productCheckbox[z]&&(y=1);angular.forEach(B.reservationModel.selectedProducts,function(a,d){a.code===z&&B.reservationModel.selectedProducts.splice(d,
1)});B.productCheckbox[z]?(a.selected=!0,a.quantity=y,l&&(-1==l.indexOf("_ext")?a.productId=l:a.productId=a.code+"chk_ext"),B.reservationModel.selectedProducts.push(a)):t(z,!0);p.setReservationModel(B.reservationModel);d.productSelection().then(function(a){B.additionalCharges=a.totalAdditionalCharges;B.addtionalTrue=0<B.additionalCharges?!0:!1})};B.productCheckbox={};var y=0;B.confirm=function(){a.requestInProgress=!0;d.confirmProduct().then(function(d){h.location.href=d&&d.errorList&&0<d.errorList.length?
a.contextPath+"/"+a.locale+"/reservation"+htmlExtension+"#/time-and-place":a.contextPath+"/"+a.locale+"/rental/confirmation"+htmlExtension},function(a){})};B.cancel=function(){h.location.href=a.contextPath+"/"+a.locale+"/reservation"+htmlExtension+"#/time-and-place"};B.additionalCharges="";var F=!1;B._init=f;B.curbsideLanding=h.Ancillary;B.productDescription="";B.hazardInstruction=!1;B.xmrInformation=!1;B.hazardAndXmrInstruction=!1;B.instruction="";a.$on("TCInitSuccess",function(a,d){l.getXsrfToken()&&
!1===F&&B.curbsideLanding==q.curbside&&z()});f()}angular.module("reservation").controller("curbsideController",t);t.$inject="$scope $state $rootScope $window reservationModelService curbsideService getDataService authenticationService carRentalConstant gaService".split(" ")})();
(function(){function t(){return{validateOfflineProfileModel:{dlNumber:"",lastName:"",wizardNumber:""},validateOfflineProfileModelMap:{dlNumber:"vm.validateOfflineProfileModel.dlNumber",lastName:"vm.validateOfflineProfileModel.lastName",wizardNumber:"vm.validateOfflineProfileModel.wizardNumber",ccNumber:"vm.validateOfflineProfileModel.ccNumber"},saveIdentityModel:{awdNumber:"",eRecieptEmailOptin:!0,emailAddress:"",password:"",promotionalEmailOptin:!0},saveIdentityModelMap:{emailAddress:"vm.saveIdentityModel.emailAddress",
password:"vm.saveIdentityModel.password",discountNumber:"vm.saveIdentityModel.AWDNumber"},accountModel:{contactInfoRQ:{address:{address1:"",address2:"",address3:"",city:"",country:"",locationDescription:"",state:"",suburb:"",zipCode:""},emailAddress:"",phoneNumber:""},creditCardRQ:{cardNumber:"",cardType:"",expMonth:"",expYear:"",secureCode:""},identityPwdRQ:{currentPassword:"",eRecieptEmailOptin:!1,emailAddress:"",firstName:"",lastName:"",newPassword:"",promotionalEmailOptin:!1,title:""},driversLicenseRQ:{country:"",
dateOfBirth:"",dlNumber:"",expMonth:"",expYear:"",state:""},preferenceRQ:{company:"",discountNumber:"",eRecieptOptin:!0,emailOptin:!0,freqPickUpLoc:"",prefcarGroup:"",profExtrasRQ:{productRQs:[{code:"",quantity:0,redeemedQty:0,selected:!0,type:""}],protectionsRQs:[{code:"",included:!0,selected:!0}]},sitePrefRQ:{dateFormat:"",language:"",timeFormat:""},smsOptin:""},profPersonalInfoRQ:{firstName:"",lastName:"",title:"",userName:""},rewardsRQ:{},termsAcceptanceRQ:{termsConditionAcceptance:!0},password:"",
program:{pointsProgram:!1,partnerProgram:!1}},accountModelMap:{"contactInfoRQ.addressRQs[0].address1":"vm.accountModel.contactInfoRQ.address.address1","contactInfoRQ.addressRQs[0].address2":"vm.accountModel.contactInfoRQ.address.address2","contactInfoRQ.addressRQs[0].address3":"vm.accountModel.contactInfoRQ.address.address3","contactInfoRQ.addressRQs[0].city":"vm.accountModel.contactInfoRQ.address.city","contactInfoRQ.address.country":"vm.accountModel.contactInfoRQ.address.country","contactInfoRQ.address.locationDescription":"vm.accountModel.contactInfoRQ.address.locationDescription",
"contactInfoRQ.addressRQs[0].state":"vm.accountModel.contactInfoRQ.address.state","contactInfoRQ.address.suburb":"vm.accountModel.contactInfoRQ.address.suburb","contactInfoRQ.addressRQs[0].zipCode":"vm.accountModel.contactInfoRQ.address.zipCode","contactInfoRQ.contactEmailRQs[0].emailAddress":"vm.accountModel.contactInfoRQ.emailAddress","contactInfoRQ.contactPhoneRQs[0].phoneNumber":"vm.accountModel.contactInfoRQ.telephone","contactInfoRQ.telephone":"vm.accountModel.contactInfoRQ.phoneNumber","creditCardRQ.cardNumber":"vm.accountModel.cardNumber",
"creditCardRQ.cardType":"vm.accountModel.cardType","creditCardRQ.expMonth":"vm.accountModel.expMonth","creditCardRQ.expYear":"vm.accountModel.expYear","creditCardRQ.secureCode":"vm.accountModel.secureCode","identityPwdRQ.emailAddress":"","identityPwdRQ.firstName":"","identityPwdRQ.lastName":"",promotionalEmailOptin:"vm.accountModel.identityPwdRQ.promotionalEmailOptin","driversLicenseRQ.country":"","driversLicenseRQ.dateOfBirth":"","driversLicenseRQ.dlNumber":"","driversLicenseRQ.expMonth":"","driversLicenseRQ.expYear":"",
"driversLicenseRQ.state":"",company:"","preferenceRQ.discountNumberRQs[0].discountNumber":"vm.accountModel.preferenceRQ.discountNumber","preferenceRQ.eRecieptOptin":!0,"preferenceRQ.emailOptin":!0,"preferenceRQ.freqPickUpLoc":"","preferenceRQ.prefcarGroup":"","profPersonalInfoRQ.firstName":"vm.accountModel.profPersonalInfoRQ.firstName","profPersonalInfoRQ.lastName":"vm.accountModel.profPersonalInfoRQ.lastName","profPersonalInfoRQ.title":"vm.accountModel.profPersonalInfoRQ.title","profPersonalInfoRQ.userName":"vm.accountModel.profPersonalInfoRQ.userName",
pointsProgram:"vm.accountModel.program.pointsProgram",partnerProgram:"vm.accountModel.program.partnerProgram"},credentialModalMap:{firstName:"vm.credentialModal.firstName",lastName:"vm.credentialModal.lastName",emailAddress:"vm.credentialModal.emailAddress",zipcode:"vm.credentialModal.zipCode",dlLastFourChar:"vm.credentialModal.dlLastFourChar",password:"vm.credentialModal.password",currentPassword:"vm.credentialModal.updatePassword.currentPassword",wizard:"vm.credentialModal.wizard",newPassword:"vm.credentialModal.updatePassword.newPassword",
dobMonth:"vm.credentialModal.dobMonth",dobDate:" vm.credentialModal.dobDate",dobYear:" vm.credentialModal.dobYear"},credentialModal:{firstName:"",lastName:"",emailAddress:"",zipCode:"",dlLastFourChar:"",dobMonth:"",dobDate:"",updatePassword:{currentPassword:"",newPassword:""},wizard:"",dobYear:""}}}angular.module("accountServices").factory("accountModelService",t);t.$inject=[]})();
(function(){function t(u,n,a){return{generateOtp:function(){var a=n.defer();u({method:"GET",url:apiurl+"/profile/otp"}).then(function(h){a.resolve(h.data)}).catch(function(h){a.reject(ABG.evaluateError(h.data))});return a.promise},validateOtp:function(a){var h=n.defer();u({method:"POST",url:apiurl+"/profile/otp",data:a}).then(function(a){h.resolve(a.data)}).catch(function(a){h.reject(ABG.evaluateError(a.data))});return h.promise}}}angular.module("accountServices").service("securityService",t);t.$inject=
["$http","$q","$validation"]})();
(function(){function t(u,n,a,h,p,d,k,l){function q(a,d){d={contactInfoRQ:{addressRQs:[{address1:a.contactInfoRQ.address.address1,address2:a.contactInfoRQ.address.address2,address3:a.contactInfoRQ.address.address3,city:a.contactInfoRQ.address.city,country:a.contactInfoRQ.address.country,maskId:"",operation:"add",primary:!0,state:a.contactInfoRQ.address.state,suburb:a.contactInfoRQ.address.suburb,zipCode:a.contactInfoRQ.address.zipCode}],contactEmailRQs:[{eRecieptOptin:angular.isDefined(a.preferenceRQ.eRecieptOptin)&&1==
a.preferenceRQ.eRecieptOptin?"Y":"N",emailAddress:a.contactInfoRQ.emailAddress,emailOptin:angular.isDefined(a.preferenceRQ.emailOptin)&&1==a.preferenceRQ.emailOptin?"Y":"N",maskId:angular.isDefined(a.maskId)?a.maskId:"1",operation:"add",primary:!0}],contactPhoneRQs:[{phoneNumber:a.contactInfoRQ.phoneNumber,primary:!0,smsOptIn:angular.isDefined(a.contactInfoRQ.smsOptin)&&1==a.contactInfoRQ.smsOptin?"T":"N",operation:"add",maskId:angular.isDefined(a.maskId)?a.maskId:"1"}]},identityRQ:{password:a.identityRQ.password},
profPersonalInfoRQ:{firstName:a.profPersonalInfoRQ.firstName,lastName:a.profPersonalInfoRQ.lastName,userName:a.profPersonalInfoRQ.userName,dateOfBirth:a.profPersonalInfoRQ.dateOfBirth},recCheck:angular.isDefined(d)&&""!=d?!0:!1};angular.isDefined(a.preferenceRQ.discountNumber)&&""!=a.preferenceRQ.discountNumber&&(d.preferenceRQ={},d.preferenceRQ.discountNumberRQs=[{discountNumber:a.preferenceRQ.discountNumber,maskId:"",operation:"add",primary:!0}]);angular.isDefined(a.preferenceRQ.costControlNumber)&&
""!=a.preferenceRQ.costControlNumber&&(d.preferenceRQ.costControlNumber=a.preferenceRQ.costControlNumber);return d}var x={supported:!1,optin:!1},f={};return{validateIdentity:function(a){var d=n.defer();u({method:"POST",url:apiurl+"/profile/validate-offlineProfile",data:a}).then(function(a){a=a.data;a=p.processError(a,k.expressValidateModelMap);l.setCustomerModel(l.setCustomerData(a));l.setSessionModel(l.setSessionData(a));d.resolve(a)}).catch(function(a){d.reject(ABG.evaluateError(a.data))});return d.promise},
createProfile:function(z,f){z=q(z,f);var h=n.defer();u({method:"POST",url:apiurl+"/profile/create",data:z,headers:{"g-recaptcha-response":f?f:""}}).then(function(z){z=z.data;angular.isDefined(z.iconographyList)&&d.setStorageData("iconographyList",z.iconographyList);z=p.processError(z,k.accountModelMap);l.setCustomerModel(l.setCustomerData(z));l.setAdditionalCustomerInfoModel(l.setAdditionalCustomerInfo(z));l.setSessionModel(l.setSessionData(z));a.$broadcast("Update.Notificationdisplay");h.resolve(z)}).catch(function(a){h.reject(ABG.evaluateError(a.data))});
return h.promise},resendActivationEmail:function(){var a=n.defer();u({method:"POST",url:apiurl+"/profile/send-activationemail"}).then(function(d){a.resolve(d.data)}).catch(function(d){a.reject(ABG.evaluateError(d.data))});return a.promise},validateUserName:function(a,d){var z=n.defer();u({method:"POST",url:apiurl+"/profile/validate-username",data:{emailAddress:a},headers:{"g-recaptcha-response":d?d:""}}).then(function(a){z.resolve(a.data)}).catch(function(a){z.reject(a.data)});return z.promise},getAccountData:function(a){return{contactInfoRQ:{address:{address1:angular.isDefined(a.customerInfo)&&
angular.isDefined(a.customerInfo.contacts)&&angular.isDefined(a.customerInfo.contacts.address)?a.customerInfo.contacts.address.address1:angular.isDefined(a.partnerCustomerInfo)&&angular.isDefined(a.partnerCustomerInfo.address)&&angular.isDefined(a.partnerCustomerInfo.address.address1)?a.partnerCustomerInfo.address.address1:"",address2:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.contacts)&&angular.isDefined(a.customerInfo.contacts.address)?a.customerInfo.contacts.address.address2:
angular.isDefined(a.partnerCustomerInfo)&&angular.isDefined(a.partnerCustomerInfo.address)&&angular.isDefined(a.partnerCustomerInfo.address.address2)?a.partnerCustomerInfo.address.address2:"",address3:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.contacts)&&angular.isDefined(a.customerInfo.contacts.address)?a.customerInfo.contacts.address.address3:angular.isDefined(a.partnerCustomerInfo)&&angular.isDefined(a.partnerCustomerInfo.address)&&angular.isDefined(a.partnerCustomerInfo.address.address3)?
a.partnerCustomerInfo.address.address3:"",city:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.contacts)&&angular.isDefined(a.customerInfo.contacts.address)?a.customerInfo.contacts.address.city:angular.isDefined(a.partnerCustomerInfo)&&angular.isDefined(a.partnerCustomerInfo.address)&&angular.isDefined(a.partnerCustomerInfo.address.city)?a.partnerCustomerInfo.address.city:"",country:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.address)&&angular.isDefined(a.customerInfo.address.country)?
a.customerInfo.address.country:angular.isDefined(a.partnerCustomerInfo)&&angular.isDefined(a.partnerCustomerInfo.address)?a.partnerCustomerInfo.address.country:"",state:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.contacts)&&angular.isDefined(a.customerInfo.contacts.address)?a.customerInfo.contacts.address.state:angular.isDefined(a.partnerCustomerInfo)&&angular.isDefined(a.partnerCustomerInfo.address)&&angular.isDefined(a.partnerCustomerInfo.address.state)?a.partnerCustomerInfo.address.state:
"",suburb:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.contacts)&&angular.isDefined(a.customerInfo.contacts.address)?a.customerInfo.contacts.address.address3:angular.isDefined(a.partnerCustomerInfo)&&angular.isDefined(a.partnerCustomerInfo.address)&&angular.isDefined(a.partnerCustomerInfo.address.address3)?a.partnerCustomerInfo.address.address3:"",zipCode:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.contacts)&&angular.isDefined(a.customerInfo.contacts.address)?
a.customerInfo.contacts.address.zipCode:angular.isDefined(a.partnerCustomerInfo)&&angular.isDefined(a.partnerCustomerInfo.address)&&angular.isDefined(a.partnerCustomerInfo.address.zipCode)?a.partnerCustomerInfo.address.zipCode:""},emailAddress:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.contacts)&&angular.isDefined(a.customerInfo.contacts.email)?a.customerInfo.contacts.email:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.email)?a.customerInfo.email:angular.isDefined(a.partnerCustomerInfo)&&
angular.isDefined(a.partnerCustomerInfo.email)?a.partnerCustomerInfo.email:"",telephone:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.cellPhone)?a.customerInfo.cellPhone:""},preferenceRQ:{discountNumber:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.awd)?a.customerInfo.awd:angular.isDefined(a.partnerCustomerInfo)&&angular.isDefined(a.partnerCustomerInfo.discountNumber)?a.partnerCustomerInfo.discountNumber:""},profPersonalInfoRQ:{firstName:angular.isDefined(a.customerInfo)&&
angular.isDefined(a.customerInfo.firstName)?a.customerInfo.firstName:angular.isDefined(a.partnerCustomerInfo)&&angular.isDefined(a.partnerCustomerInfo.firstName)?a.partnerCustomerInfo.firstName:"",lastName:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.lastName)?a.customerInfo.lastName:angular.isDefined(a.partnerCustomerInfo)&&angular.isDefined(a.partnerCustomerInfo.lastName)?a.partnerCustomerInfo.lastName:"",userName:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.userName)?
a.customerInfo.userName:angular.isDefined(a.partnerCustomerInfo)&&angular.isDefined(a.partnerCustomerInfo.userName)?a.partnerCustomerInfo.userName:""},identityPwdRQ:{eRecieptEmailOptin:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.eRecieptEmailOptin)?a.customerInfo.eRecieptEmailOptin:void 0,promotionalEmailOptin:angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.promoMails)?a.customerInfo.promoMails:void 0}}},setConcurCustomerInfo:function(a){angular.isDefined(a)&&
(f=a)},getConcurCustomerInfo:function(){return angular.isDefined(f)?f:{}},geteOffersSupportedCountry:function(a){var d=h.expressConsentCountries;-1!=h.eOffersSupportedCountries.indexOf(a.toUpperCase())&&(x.supported=!0);-1!=d.indexOf(a.toUpperCase())?x.optin=!1:x.optin=!0;return x},geteReceiptSupportedCountry:function(a){var d=h.expressConsentCountries,f={};-1!=h.eReceiptSupportedCountries.indexOf(a.toUpperCase())&&(f.supported=!0);-1!=d.indexOf(a.toUpperCase())?f.optin=!1:f.optin=!0;return f},getAccountModel:function(a){return a=
{contactInfoRQ:{address:{address1:a.contactInfoRQ.address.address1,address2:a.contactInfoRQ.address.address2,address3:a.contactInfoRQ.address.address3,city:a.contactInfoRQ.address.city,country:a.contactInfoRQ.address.country,state:a.contactInfoRQ.address.state,suburb:a.contactInfoRQ.address.address3,zipCode:a.contactInfoRQ.address.zipCode},emailAddress:a.contactInfoRQ.emailAddress,phoneNumber:a.contactInfoRQ.telephone,smsOptin:a.contactInfoRQ.smsOptin},identityRQ:{password:a.password},preferenceRQ:{discountNumber:a.preferenceRQ.discountNumber,
eRecieptOptin:a.identityPwdRQ.eRecieptEmailOptin,emailOptin:a.identityPwdRQ.promotionalEmailOptin,costControlNumber:a.preferenceRQ.costControlNumber},profPersonalInfoRQ:{firstName:a.profPersonalInfoRQ.firstName,lastName:a.profPersonalInfoRQ.lastName,userName:a.profPersonalInfoRQ.userName,dateOfBirth:angular.isDefined(a.dobMonth)?a.dobMonth+"/"+a.dobDate+"/"+a.dobYear:void 0}}},rulesToRedirect:function(d){return angular.isDefined(d.enrollmentStep)?"credit-card-section"==d.enrollmentStep?a.contextPath+
"/"+a.locale+h.contentRoot+"/credit-card"+htmlExtension:"dl-section"==d.enrollmentStep?a.contextPath+"/"+a.locale+h.contentRoot+"/driving-licence"+htmlExtension:"protections-coverages-section"==d.enrollmentStep?a.contextPath+"/"+a.locale+h.contentRoot+"/protections-coverages"+htmlExtension:"tnc-section"==d.enrollmentStep?a.contextPath+"/"+a.locale+h.contentRoot+"/terms-condition"+htmlExtension:"enroll-rewards-section"==d.enrollmentStep&&angular.isDefined(d.loyaltyEligible)&&d.loyaltyEligible.visible?
a.contextPath+"/"+a.locale+h.contentRoot+"/rewards"+htmlExtension:a.contextPath+"/"+a.locale+h.contentRoot+"/activation"+htmlExtension:a.contextPath+"/"+a.locale+h.contentRoot+"/activation"+htmlExtension},validatePartnerCustomerInfo:function(a,d){var f=n.defer();u({method:"POST",url:apiurl+"/partner/segmentDetails",data:{discountNumber:a,country:d}}).then(function(a){f.resolve(a.data)}).catch(function(a){f.reject(a.data)});return f.promise}}}angular.module("accountServices").service("signupService",
t);t.$inject="$http $q $rootScope $window exceptionHandler storageService accountModelService authenticationService".split(" ")})();
(function(){function t(u,n,a,h){return{setCbpData:function(a){h.setStorageData("cbpData",a)},getCbpData:function(){return h.getStorageData("cbpData")},deleteCbpData:function(){h.deleteStorageData("cbpData")},getChildSegmentInfo:function(a){var d=n.defer();u({method:"GET",url:apiurl+"/profile/cbpsegment-form/"+a}).then(function(a){d.resolve(a.data)}).catch(function(a){d.reject(a.data)});return d.promise},validateCbp:function(a){var d=n.defer();u({method:"GET",url:apiurl+"/profile/validate-cbpsegment/"+
a}).then(function(a){d.resolve(a.data)}).catch(function(a){d.reject(a.data)});return d.promise}}}angular.module("accountServices").service("corporateService",t);t.$inject=["$http","$q","$validation","storageService"]})();
(function(){function t(u,n,a,h){return{forgotUserName:function(p,d){var k=n.defer();ABG.isDefined(p,"firstName")&&(p.firstName=p.firstName.toUpperCase());ABG.isDefined(p,"lastName")&&(p.lastName=p.lastName.toUpperCase());ABG.isDefined(p,"emailAddress")&&(p.emailAddress=p.emailAddress.toUpperCase());p={firstName:p.firstName,lastName:p.lastName,emailAddress:p.emailAddress,zipcode:p.zipCode,dlLastFourChar:p.dlLastFourChar,dateOfBirth:angular.isDefined(p.dobMonth)?p.dobMonth+"/"+p.dobDate+"/"+p.dobYear:
void 0};u({method:"POST",url:apiurl+"/profile/wizard-lookup",data:p,headers:{"g-recaptcha-response":d?d:""}}).then(function(d){d=d.data;d=a.processError(d,h.credentialModalMap);k.resolve(d)}).catch(function(a){k.reject(ABG.evaluateError(a.data))});return k.promise},forgotPassword:function(p,d){var k=n.defer();ABG.isDefined(p,"firstName")&&(p.firstName=p.firstName.toUpperCase());ABG.isDefined(p,"lastName")&&(p.lastName=p.lastName.toUpperCase());ABG.isDefined(p,"emailAddress")&&(p.emailAddress=p.emailAddress.toUpperCase());
ABG.isDefined(p,"zipCode")&&(p.zipCode=p.zipCode.toUpperCase());ABG.isDefined(p,"dlLastFourChar")&&(p.dlLastFourChar=p.dlLastFourChar.toUpperCase());p={firstName:p.firstName,lastName:p.lastName,emailAddress:p.emailAddress,zipcode:p.zipCode,dlLastFourChar:p.dlLastFourChar,dateOfBirth:angular.isDefined(p.dobMonth)?p.dobMonth+"/"+p.dobDate+"/"+p.dobYear:void 0};u({method:"POST",url:apiurl+"/profile/forget-password",data:p,headers:{"g-recaptcha-response":d?d:""}}).then(function(d){d=d.data;d=a.processError(d,
h.credentialModalMap);k.resolve(d)}).catch(function(a){k.reject(ABG.evaluateError(a.data))});return k.promise},forgotPasswordNew:function(p,d){var k=n.defer();ABG.isDefined(p,"wizard")&&(p.wizard=p.wizard.toUpperCase());ABG.isDefined(p,"lastName")&&(p.lastName=p.lastName.toUpperCase());p={userName:p.wizard,dateOfBirth:angular.isDefined(p.dobMonth)?p.dobDate+"/"+p.dobMonth+"/"+p.dobYear:void 0,lastName:p.lastName};u({method:"POST",url:apiurl+"/profile/forget-password",data:p,headers:{"g-recaptcha-response":d?
d:""}}).then(function(d){d=d.data;d=a.processError(d,h.credentialModalMap);k.resolve(d)}).catch(function(a){k.reject(ABG.evaluateError(a.data))});return k.promise},getPasswordExpireLogin:function(){var a=n.defer();u({method:"GET",url:apiurl+"/profile/loginid"}).then(function(d){a.resolve(d.data)}).catch(function(d){a.reject(ABG.evaluateError(d.data))});return a.promise}}}angular.module("accountServices").service("credentialService",t);t.$inject=["$http","$q","exceptionHandler","accountModelService"]})();
(function(){function t(u,n,a,h,p,d,k){var l="",q="",x="",f="";return{analyticsDimension:function(d,k){var n=angular.isDefined(d.partnerCustomerInfo)&&angular.isDefined(d.partnerCustomerInfo.partnerType)?!0:!1,y=angular.isDefined(d.webHeader)&&d.webHeader.offlineUser?!0:!1;!n&&angular.isDefined(d)&&angular.isDefined(d.activationStatus)?("0"!=d.activationStatus||y?"0"==d.activationStatus&&y?(l=d.membershipStatus,q="Offline to Online"):"1"==d.activationStatus&&30<d.profileCompletionPercentage&&100>d.profileCompletionPercentage?
(x=d.profileCompletionPercentage,f=angular.isDefined(k)?k:""):"1"==d.activationStatus&&100==d.profileCompletionPercentage&&(l=d.membershipStatus,q="Profile Upgrade",x=f=""):(l=d.membershipStatus,q="Basic SignUp"),dataLayer.push({event:"profileTrigger",memberShipStatus:l,enrollmentFlow:q,profilePercentage:x,pageName:f})):n&&angular.isDefined(d.customerInfo)&&angular.isDefined(d.customerInfo.webCustomer)&&angular.isDefined(d.customerInfo.profileCompletionPercentage)&&(30<d.customerInfo.profileCompletionPercentage&&
100>d.customerInfo.profileCompletionPercentage?(x=d.customerInfo.profileCompletionPercentage,f=angular.isDefined(k)?k:""):"1"==d.customerInfo.webCustomer.activationStatus&&100==d.customerInfo.profileCompletionPercentage&&(l=d.customerInfo.membershipStatus,q=a.brand==h.brandName.BUDGET?"Mandatory FastBreak":"Mandatory Preferred",x=f=""),dataLayer.push({event:"profileTrigger",memberShipStatus:l,enrollmentFlow:q,profilePercentage:x,pageName:f}))},paylessDimension:function(a,d){angular.isDefined(a)&&
angular.isDefined(a.activationStatus)&&"1"==a.activationStatus&&(l=a.membershipStatus,q="Basic SignUp");dataLayer.push({event:"profileTrigger",memberShipStatus:l,enrollmentFlow:q})}}}angular.module("accountServices").service("accountgaService",t);t.$inject="$http $q $window carRentalConstant $locale $filter $rootScope".split(" ")})();
(function(){angular.module("dashboard").directive("typeAhead",["$http","carRentalConstant","$filter",function(t,u,n){return{restrict:"EA",scope:{list:"\x3d",listName:"\x3d",listCode:"\x3d",modelObject:"\x3d",disableInput:"\x3d",inputId:"@",placeholder:"@",inputClass:"@",inputName:"@",dropdownClass:"@",requiredErrorMessage:"@",searchDelayMsg:"@",validationList:"@",validMethod:"@"},link:function(a,h,p,d){a.$on("clearPartnerDetails",function(d,l){a.searchStr=""});a.filterList=function(d){a.showSuggestions=
!0;angular.isDefined(d)&&2<d.length?(a.showSuggestions=!0,a.suggestions=[],a.tempList=[],angular.forEach(a.list,function(k){-1!=k[a.listName].toUpperCase().indexOf(d.toUpperCase())&&a.tempList.push(k)}),a.suggestions=a.tempList):a.hideDropdownList()};a.openDropdownList=function(){angular.isDefined(a.searchStr)&&""!=a.searchStr?a.filterList(a.searchStr):a.suggestions=a.list;a.showSuggestions=!0;"ie"==ABG.getClientInfo().browser?$("#"+a.inputId).val():$("#"+a.inputId).select()};a.selectSuggestion=function(d){a.searchStr=
d[a.listName];a.modelObject=d[a.listCode];a.showSuggestions=!1;a.onChangeOfPartner(a.modelObject)};a.hideDropdownList=function(){a.showSuggestions=!1;a.suggestions=[]};a.rewardspartnertogtm=function(a,d){if("airlines"==d)var k="rewardsairlinepartner",l="dropdown";else"hotels"==d?(k="rewardshotelpartner",l="dropdown"):"others"==d&&(k="rewardsotherpartner",l="dropdown");if("text"==l)var f=a?"Filled In":"Skipped";else"checkbox"==l?f=a?"Selected as Y":"Selected as N":"dropdown"==l&&(f=a?"Selected":"Not Selected");
dataLayer.push({event:"trackEvent",eventCategory:"Tracking Form: Profile-Form",eventLabel:k,eventAction:f})};a.removeText=function(d){angular.element(d.target).prev("input").focus();a.searchStr="";a.modelObject="";d.target.style.display="none"};a.onChangeOfPartner=function(d){if(a.$parent.vm&&angular.isDefined(a.$parent.vm.onChangeRewardPreference))a.$parent.vm.onChangeRewardPreference(!0,"partnerPrgm",d)};(function(){if(angular.isDefined(a.list)&&angular.isDefined(a.modelObject)&&""!==a.list&&""!==
a.modelObject&&0<a.list.length){var d=a.list.indexOf(n("filter")(a.list,function(d){return d[a.listCode]===a.modelObject})[0]);a.searchStr=angular.isDefined(a.list[d])?a.list[d][a.listName]:"";angular.isDefined(a.searchStr)&&(a.filterList(a.searchStr),a.hideDropdownList())}})()},template:'\x3cinput type\x3d"text" class\x3d"{{inputClass}}" id\x3d"{{inputId}}" name\x3d"{{inputName}}" ng-model\x3d"searchStr"ng-blur\x3d"hideDropdownList();rewardspartnertogtm(searchStr, inputId);"ng-keyup\x3d"filterList(searchStr)"ng-focus\x3d"openDropdownList()"placeholder\x3d"{{placeholder}}" valid-method\x3d"blur"filtered-length\x3d"{{tempList.length}}"validator\x3d"{{validationList}}"required-error-message\x3d"{{requiredErrorMessage}}"valid-method\x3d"blur"\x3e\x3cdiv ng-click\x3d"removeText($event)" ng-if\x3d"searchStr.length \x3e 0" class\x3d"clearTxt" style\x3d"display: block;"\x3e\x3c/div\x3e\x3cbutton ng-click\x3d"openDropdownList()"\x3e\x3cspan class\x3d"s-dropdown wrap-down-arrow"\x3e\x3c/span\x3e\x3c/button\x3e\x3cdiv class\x3d"wrap-angucomplete-dropdown {{dropdownClass}}" ng-if\x3d"showSuggestions"\x3e\x3cdiv class\x3d"angucomplete-dropdown toKeepDropdown" \x3e\x3cdiv class\x3d"angucomplete-searching" ng-show\x3d"searching"\x3e{{searchDelayMsg}}\x3c/div\x3e\x3cdiv class\x3d"angucomplete-results"\x3e\x3cdiv ng-repeat\x3d"suggestion in suggestions" ng-mousedown\x3d"selectSuggestion(suggestion)"\x3e\x3cdiv\x3e{{suggestion[listName]}}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'}}])})();
(function(){angular.module("dashboard").directive("preventcutcopypaste",function(){return{restrict:"A",link:function(t,u){u.on("cut copy paste",function(n){n.preventDefault()})}}})})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,z,t,B){function y(a){g.initializeDisplayElementMap.costControlNumber.visible=angular.isDefined(a.costControlVisible)&&"Y"==a.costControlVisible?!0:!1;g.costControlNumberRequired="optional";g.costControlNumberRequired=angular.isDefined(a.costControlRequired)&&"Y"==a.costControlRequired?"required":"optional";g.accountModel.preferenceRQ.costControlNumber=angular.isDefined(a.costControlNumber)?a.costControlNumber:"";g.initializeDisplayElementMap.costControlNumber.editable=
angular.isDefined(a.costControlReadOnly)&&"Y"==a.costControlReadOnly?!1:!0;g.initializeDisplayElementMap.costControlTitle=angular.isDefined(a.costControlTitle)?a.costControlTitle:Dictionary.I18n.get("msg.enroll.CostControl")}function F(e,d){g.customerData=e;g.nonEditEReceipt=!1;e&&e.displayControl&&e.displayControl.displayElementMap&&(g.initializeDisplayElementMap=e.displayControl.displayElementMap,g.initializeDisplayElementMap.password.visible&&(O=Dictionary.I18n.get("msg.profile.password.reenter")));
g.customerData&&(g.accountModel=l.getAccountData(g.customerData),g.accountModel.profPersonalInfoRQ.userName&&""!=g.accountModel.profPersonalInfoRQ.userName&&(g.emailAddressAsUsername=!1,g.showUniquenessCheckbox=!1));var f=t.getCBPInfoData();angular.isDefined(f)&&angular.isDefined(f.country)&&""!=f.country&&0!=f.country.length?(f=angular.isDefined(f.country[0])?f.country[0].toUpperCase():"US",g.country=-1==f.indexOf("US")&&-1!=f.indexOf("CA")?"CA":"US"):angular.isDefined(e)&&angular.isDefined(e.partnerCustomerInfo)&&
angular.isDefined(e.partnerCustomerInfo.partnerType)?(angular.isDefined(e.partnerCustomerInfo.address)&&angular.isDefined(e.partnerCustomerInfo.address.country)&&""!=e.partnerCustomerInfo.address.country&&(g.country=e.partnerCustomerInfo.address.country),"PARTNER_CBP"==e.partnerCustomerInfo.partnerType&&a.$broadcast("CBPImageName",e.partnerCustomerInfo),e.partnerCustomerInfo.partnerType==k.partnerTypeConcur&&(g.nonEditEReceipt=!0),A(e)):angular.isDefined(e.oneClickEnrollmentInfo)&&(angular.isDefined(e.oneClickEnrollmentInfo.country)&&
""!=e.oneClickEnrollmentInfo.country&&null!=e.oneClickEnrollmentInfo.country&&(g.country=e.oneClickEnrollmentInfo.country),g.accountModel.preferenceRQ.discountNumber=e.oneClickEnrollmentInfo.discountNumber);angular.isDefined(e)&&angular.isDefined(e.partnerCustomerInfo)&&y(e.partnerCustomerInfo);g.getPartnerType=p.getPartnerInfoModel();!angular.isDefined(g.getPartnerType)||g.getPartnerType!=k.partnerTypeCBP&&g.getPartnerType!=k.partnerTypeConcur?g.saveIdentityModel.emailAddress=angular.isDefined(g.customerData.contacts)?
g.customerData.contacts.email:"":(g.cbpconcurCustomerInfo=l.getConcurCustomerInfo(),angular.isDefined(g.cbpconcurCustomerInfo)&&angular.isDefined(g.cbpconcurCustomerInfo.customerInfo)&&(g.accountModel.contactInfoRQ.emailAddress=angular.isDefined(g.cbpconcurCustomerInfo.partnerCustomerInfo.email)?g.cbpconcurCustomerInfo.partnerCustomerInfo.email:"",g.accountModel.preferenceRQ.discountNumber=angular.isDefined(g.cbpconcurCustomerInfo.partnerCustomerInfo.discountNumber)?g.cbpconcurCustomerInfo.partnerCustomerInfo.discountNumber:
"",g.accountModel.preferenceRQ.costControlNumber=angular.isDefined(g.cbpconcurCustomerInfo.partnerCustomerInfo.costControlNumber)?g.cbpconcurCustomerInfo.partnerCustomerInfo.costControlNumber:""));e=l.geteOffersSupportedCountry(d);g.eOffersDisplay=e.supported;g.eOffersDisplay&&angular.isUndefined(g.accountModel.identityPwdRQ.promotionalEmailOptin)&&(g.accountModel.identityPwdRQ.promotionalEmailOptin=e.optin);e=l.geteReceiptSupportedCountry(d);g.eReceiptDisplay=!1;g.eReceiptDisplay&&angular.isUndefined(g.accountModel.identityPwdRQ.eRecieptEmailOptin)&&
(g.accountModel.identityPwdRQ.eRecieptEmailOptin=e.optin);g.eReceiptDisplay||(g.accountModel.identityPwdRQ.eRecieptEmailOptin=!0);g.showEmailReceipt=d==k.countryCodeCA?!0:!1;setTimeout(function(){angular.isDefined(g.customerData)&&angular.isDefined(g.customerData.userState)&&angular.equals(g.customerData.userState,k.userStatePartnerAuthenticated)&&G(!0)},1500)}function C(e){a.requestInProgress=!0;p.displayControlProfile(e).then(function(f){g.instruction=u.processErrorMessage(f);F(f,e);g.accountModel.contactInfoRQ.address.country=
d("filter")(g.countryData,{code:e},!0)[0].code;a.$broadcast("Profile.inProfileEnrollFlow",!0);a.requestInProgress=!1},function(e){a.requestInProgress=!1;angular.isDefined(e.errorList)&&0<e.errorList.length&&(g.enrollmentPageError=e.errorList[0].message,g.accountFormValidation=!0,$("body").animate({scrollTop:0},"slow"))})}function r(a,e){if(g.countryData&&void 0!=a&&""!=a&&(a===k.countryCodeAU||a===k.countryCodeCA||a===k.countryCodeUS)){var f=g.countryData.indexOf(d("filter")(g.countryData,function(e){return e.code===
a})[0]);g.statesForCountry=g.countryData[f].stateList}e&&(g.hideStateTextBox=g.hideStateFunction(a),g.accountModel.contactInfoRQ.address.address1="",g.accountModel.contactInfoRQ.address.zipCode="",g.accountModel.contactInfoRQ.address.city="",C(a),angular.element("#addressline1").val(""),angular.element("#addressline1").trigger("change"),angular.element("#zip").val(""),angular.element("#zip").trigger("change"));""==g.accountModel.contactInfoRQ.address.state&&1<g.statesForCountry.length&&(g.accountModel.contactInfoRQ.address.state=
null)}function G(e,d){g.userName="";g.bindErrTo="";g.showUniquenessError=!1;1==g.emailAddressAsUsername?(g.userName=g.accountModel.contactInfoRQ.emailAddress,g.bindErrTo="vm.accountModel.contactInfoRQ.emailAddress",g.accountModel.profPersonalInfoRQ.userName=""):0==g.emailAddressAsUsername&&1==e&&setTimeout(function(){angular.element("#email").blur()},5);""!=g.userName&&("true"==enableCaptcha?(grecaptcha.execute(),a.calledFrom="checkUserName"):I());0==e&&g.createAccount(d)}function I(){angular.isDefined(g.userName)&&
l.validateUserName(g.userName,g.recaptcha).then(function(a){g.usernameLookupCalled=!0;g.prod=a;angular.isDefined(a.customerInfo)&&0==a.customerInfo.uniqueEmail&&1==g.emailAddressAsUsername?1==g.emailAddressAsUsername&&(q.displayServiceError(g.bindErrTo),g.showUniquenessError=!0):g.showUniquenessError=!1;"true"==enableCaptcha&&ABG.resetCaptcha(!0)},function(e){a.requestInProgress=!1;"true"==enableCaptcha&&ABG.resetCaptcha(!0)})}function m(){a.requestInProgress=!0;brand==k.brandName.PAYLESS&&""!=g.accountModel.contactInfoRQ.address.country&&
g.accountModel.contactInfoRQ.address.country!=k.countryCodeAU&&g.accountModel.contactInfoRQ.address.country!=k.countryCodeCA&&g.accountModel.contactInfoRQ.address.country!=k.countryCodeUS&&(g.accountModel.contactInfoRQ.address.state="Others");l.getAccountModel(g.accountModel);g.accountFormValidation=!1;1==g.showUniquenessError?(g.accountModel.password="",g.enrollmentPageError=Dictionary.I18n.get("err.prof.username.exists")+"\x3c/br\x3e"+O,g.accountFormValidation=!0,q.displayServiceError(g.bindErrTo),
a.requestInProgress=!1,$("body").animate({scrollTop:0},"slow")):"true"==enableCaptcha&&0==g.captchaExecuted&&brand!=k.brandName.PAYLESS?(grecaptcha.execute(),a.calledFrom="createProfile"):(g.recaptcha="",w())}function w(){var e=l.getAccountModel(g.accountModel);l.createProfile(e,g.recaptcha).then(function(e){e=u.processErrorMessage(e);g.prod=e;!(angular.isDefined(g.prod.errorList)&&0<g.prod.errorList.length)||angular.isDefined(g.prod.warningList)&&0<g.prod.warningList.length?(g.getPartnerType=p.getPartnerInfoModel(),
angular.isDefined(g.prod.partnerCustomerInfo)&&angular.isDefined(g.prod.partnerCustomerInfo.partnerType)?(e=l.rulesToRedirect(g.prod.displayControl),h.location.href=e):(h.brand==k.brandName.AVIS||h.brand==k.brandName.BUDGET)&&"/en/loyalty-profile/member-rates-enrollment"===h.location.pathname&&angular.isDefined(g.prod)&&angular.isDefined(g.prod.customerInfo)&&angular.isDefined(g.prod.customerInfo.cor)&&"US"==g.prod.customerInfo.cor&&angular.isDefined(g.accountModel)&&angular.isDefined(g.accountModel.preferenceRQ)&&
angular.isDefined(g.accountModel.preferenceRQ.discountNumber)&&(""==g.accountModel.preferenceRQ.discountNumber||g.accountModel.preferenceRQ.discountNumber==g.prod.customerInfo.memberShipDiscountNumber)?($(".show-generic-modal").hide(),$(".modal-backdrop").hide(),sessionStorage.setItem("genericmodaldisplay","yes"),sessionStorage.setItem("benefitsmodaldisplay","false"),h.brand==k.brandName.AVIS?(e=a.contextPath+"/"+a.locale+g.avisMemberRedirect,h.location.href=e):h.brand==k.brandName.BUDGET&&(e=a.contextPath+
"/"+a.locale+g.memberRedirect,h.location.href=e)):(e=h.brand==k.brandName.AVIS?l.rulesToRedirect(g.prod.displayControl):a.contextPath+"/"+a.locale+h.contentRoot+g.redirectionPage+htmlExtension+"?signup\x3dtrue",h.location.href=e)):(angular.isDefined(g.prod)&&angular.isDefined(g.prod.errorList)&&"06012"===g.prod.errorList[0].code&&(q.displayServiceError(g.bindErrTo),g.showUniquenessError=!0),angular.isDefined(g.prod)&&angular.isDefined(g.prod.errorList)&&"13002"===g.prod.errorList[0].code&&(g.prod.errorList[0].message=
Dictionary.I18n.get("err.res.checkout.firstname.minAlphabets"),q.displayServiceError("vm.accountModel.profPersonalInfoRQ.firstName","invalid")),angular.isDefined(g.prod)&&angular.isDefined(g.prod.errorList)&&angular.isDefined(g.prod.errorList[0].message)&&(g.prod.errorList[0].message=g.prod.errorList[0].message+"\x3c/br\x3e"+O,angular.element(document).injector().get("anchorSmoothScroll").scrollTo("signUp")),g.accountModel.password="",q.displayServiceError("vm.accountModel.password","required"),$("body").animate({scrollTop:0},
"slow"));a.requestInProgress=!1;"true"==enableCaptcha&&0==g.captchaExecuted&&ABG.resetCaptcha(!0)},function(e){a.requestInProgress=!1;angular.isDefined(e.errorList)&&0<e.errorList.length&&(g.accountModel.password="",g.enrollmentPageError=e.errorList[0].message+"\x3c/br\x3e"+Dictionary.I18n.get("msg.profile.password.reenter"),g.accountFormValidation=!0,$("body").animate({scrollTop:0},"slow"));"true"==enableCaptcha&&0==g.captchaExecuted&&ABG.resetCaptcha(!0)})}function H(e){a.requestInProgress=!1;g.prod=
{};var d=e.errorCount;2==d&&e.MSG[0]===e.MSG[1]&&(d=1);1===d?(g.enrollmentPageError=e.MSG[0]+"\x3c/br\x3e"+O,g.accountFormValidation=!0,g.accountModel.password="",q.displayServiceError("vm.accountModel.password","required")):1<d&&(g.enrollmentPageError=Dictionary.I18n.get("err.global.multi.errorMessage")+"\x3c/br\x3e"+O,g.accountFormValidation=!0,g.accountModel.password="",q.displayServiceError("vm.accountModel.password","required"));$("body").animate({scrollTop:0},"slow")}function A(a){g.accountModel=
l.getAccountData(a);angular.isDefined(g.customerData.partnerCustomerInfo)&&angular.isDefined(g.customerData.partnerCustomerInfo.costControlNumber)&&y(g.customerData.partnerCustomerInfo);angular.isDefined(g.accountModel.contactInfoRQ)&&angular.isDefined(g.accountModel.contactInfoRQ.address)&&setTimeout(function(){angular.element("#addressline1").val(g.accountModel.contactInfoRQ.address.address1);angular.element("#addressline1").trigger("change");angular.element("#zip").val(g.accountModel.contactInfoRQ.address.zipCode);
angular.element("#zip").trigger("change")},5)}function v(){p.displayControlProfile("").then(function(e){if(h.brand===k.brandName.AVIS){var f=document.referrer.substring(document.referrer.lastIndexOf("/"),61);angular.isDefined(e.customerInfo)&&angular.isDefined(e.customerInfo.preferred)&&e.customerInfo.preferred&&"/avis-preferred"===f&&ABG.redirectPage(a.contextPath+"/"+a.locale+h.contentRoot+"/dashboard/rewards"+htmlExtension)}angular.isDefined(e.customerInfo)&&(angular.equals(e.customerInfo.userState,
k.userStateRecognized)||angular.equals(e.customerInfo.userState,k.userStateRememberMe))&&e.customerInfo.onlineStatus&&(h.location.href=h.contextPath+"/"+h.locale+h.contentRoot+"/login"+htmlExtension);angular.isDefined(e.customerInfo)&&angular.isDefined(e.customerInfo.cor)?F(e,e.customerInfo.cor):F(e,g.country);g.countryData=z.getCountryList(e);g.accountModel.contactInfoRQ.address.country=d("filter")(g.countryData,{code:g.country},!0)[0].code;r(g.accountModel.contactInfoRQ.address.country);a.requestInProgress=
!1;a.$broadcast("Profile.inProfileEnrollFlow",!0);a.requestInProgress=!1;setTimeout(function(){jQuery(".hide-on-load-profile").removeClass("hide-on-load-profile")},1E3)},function(e){a.requestInProgress=!1;angular.isDefined(e.errorList)&&0<e.errorList.length&&(g.enrollmentPageError=e.errorList[0].message,g.accountFormValidation=!0,$("body").animate({scrollTop:0},"slow"));setTimeout(function(){jQuery(".hide-on-load-profile").removeClass("hide-on-load-profile")},1E3)})}function e(){var a=g.hasPartnerInfo?
angular.isDefined(g.customerData.partnerCustomerInfo.minAge)?g.customerData.partnerCustomerInfo.minAge:k.ageLimit.lower:k.ageLimit.lower;a=z.loadCalendarDropdown(a);g.monthsList=a.monthsList;g.yearsList=a.yearsList;g.datesList=a.datesList}x("ExceptionHandlerController",{$scope:u});var g=this;g.statesForCountry=[];g.accountFormValidation=!1;g.showUniquenessError=!1;g.showEmailReceipt=!1;g.csUpdation=!1;g.countryData="";g.enrollmentPageError="";g.showSmsOptIn=!0;g.emailAddressAsUsername=!0;g.showUniquenessCheckbox=
!0;g.usernameLookupCalled=!1;g.country=h.domain.toUpperCase();g.suggestions=[];g.accountModel=f.accountModel;g.saveIdentityModel={};g.pageName=n.current.name;var O="";g.domain=h.domain.toUpperCase();g.enableCaptcha=enableCaptcha;g.captchaExecuted=!1;g.showInvalidPhoneNumberError=!1;a.requestInProgress=!0;g.hideStateTextBox=!1;g.redirectionPage="/activation";g.memberRedirect="/member-benefits";g.avisMemberRedirect="/member-rental-prices";g.selectAddress=function(a,e){e===k.address&&angular.isDefined(a.address.postalCode)&&
(g.accountModel.contactInfoRQ.address.zipCode=a.address.postalCode,angular.element("#zip").val(a.address.postalCode),angular.element("#zip").trigger("change"),setTimeout(function(){angular.element("#zip").blur()},5));angular.isDefined(a.address.locality)&&(g.accountModel.contactInfoRQ.address.city!=a.address.locality&&(g.csUpdation=!0),g.accountModel.contactInfoRQ.address.city=a.address.locality);angular.isDefined(a.address.adminDistrict)&&(a=d("filter")(g.statesForCountry,{stateCode:a.address.adminDistrict},
!0)[0],a=g.statesForCountry.indexOf(a),-1<a&&(g.accountModel.contactInfoRQ.address.state!=g.statesForCountry[a].stateCode&&(g.csUpdation=!0),g.accountModel.contactInfoRQ.address.state=g.statesForCountry[a].stateCode))};g.passwordFieldValidation=function(a){a?setTimeout(function(){angular.element("#PasswordHide").blur()},5):setTimeout(function(){angular.element("#PasswordShow").blur()},5)};g.getState=r;g.hideStateFunction=function(){return!1};g.createAccount=function(a){q.validate(a).success(m).error(H);
B.addGTMScript()};g.checkUsernameUniqueness=G;g.gtmBlur=function(a,e,d){var f;"text"==d?f=a?"Filled In":"Skipped":"checkbox"==d?f=a?"Selected as Y":"Selected as N":"dropdown"==d&&(f=a?"Selected":"Not Selected");dataLayer.push({event:"trackEvent",eventCategory:"Tracking Form: Enrollment-Form",eventLabel:e,eventAction:f})};g.clearAddress=function(a){a===k.address&&(angular.element("#zip").val(""),angular.element("#zip").trigger("change"),g.accountModel.contactInfoRQ.address.address1="",g.accountModel.contactInfoRQ.address.address2=
"",g.accountModel.contactInfoRQ.address.address3="",g.accountModel.contactInfoRQ.address.suburb="");g.accountModel.contactInfoRQ.address.zipCode="";g.accountModel.contactInfoRQ.address.city="";g.accountModel.contactInfoRQ.address.state=null};g.enableUserName=function(a){a?(setTimeout(function(){angular.element("#email").blur()},5),g.emailAddressAsUsername=!1):(g.accountModel.contactInfoRQ.emailAddress="",angular.element("#email").focus());g.showUniquenessError=!1};g.validateCBPAwdNumber=function(e,
d){angular.isDefined(e)&&6>e.length?(g.initializeDisplayElementMap.costControlNumber.visible=!1,g.costControlNumberRequired="optional"):l.validatePartnerCustomerInfo(e,d).then(function(e){angular.isDefined(e.fieldErrors)&&0<e.fieldErrors.length&&q.displayServiceError("vm.accountModel.preferenceRQ."+e.fieldErrors[0].fieldName,e.fieldErrors[0].classifier);e.errorList?a.requestInProgress=!1:y(e)},function(e){a.requestInProgress=!1})};g.loadHelpModal=function(a){g.country=h.countrySelect?h.countrySelect:
"US";g.helpURL=getVehicles.getUrl(a.target.parentElement,country)};g._validationSuccess=m;g._validationError=H;g._mapPartnerCustomerInfo=A;g._onCallOfDisplayControl=F;g._loadCalendarDropdown=e;g._UpdateCostControlfield=y;g.firstNamekeycount=function(){g.fcount+=1;storageService.setStorageData("Keystrokecount",g.fcount)};g.firstNamecopyPaste=function(){--g.fcount;storageService.setStorageData("Keystrokecount",g.fcount)};g.lastNamekeycount=function(){g.lcount+=1;storageService.setStorageData("Keystrokecount",
g.lcount)};g.lastNamecopyPaste=function(){--g.lcount;storageService.setStorageData("Keystrokecount",g.lcount)};a.$on("publishCbpInfo",function(a,e){g.country=e.country});var Q=!0;a.$on("initSuccess",function(a,e){Q&&v()});a.requestInProgress=!0;brand==k.brandName.PAYLESS&&e();angular.isDefined(p.getXsrfToken())&&(Q=!1,v());n=x("SignupExnController",{$scope:u});angular.extend(this,n);a.$on("recaptcha",function(a,e){g.recaptcha=e;angular.isDefined(e)&&""!=e&&"checkUserName"==a.currentScope.calledFrom?
(I(),g.captchaExecuted=!0):angular.isDefined(e)&&""!=e&&"createProfile"==a.currentScope.calledFrom&&w()})}angular.module("account").controller("SignupController",t);t.$inject="$scope $state $rootScope $window authenticationService $filter carRentalConstant signupService $validation $controller accountModelService accountUtilityService getDataService reservationModelService".split(" ")})();
(function(){function t(u,n,a,h,p,d,k){function l(){p.getCustomerAdditionalInfo().then(function(a){setTimeout(function(){jQuery(".hide-on-load-profile").removeClass("hide-on-load-profile");h.requestInProgress=!1},1E3)},function(a){d.deleteAllStorageData();var f=setInterval(function(){null==window.sessionStorage.getItem("ngStorage-xsrf")&&(clearInterval(f),ABG.redirectPage(n.contextPath+"/"+n.locale+n.contentRoot+"/login"+htmlExtension+"#/"+a.errorList[0].code))},5)});setTimeout(function(){var a=d.getStorageData("addNewDisount");
angular.isDefined(a)&&a&&("avis"==n.brand&&angular.element("#addNewDiscountNumber").click(),"budget"==n.brand&&angular.element("#edit-travel").click(),d.deleteStorageData("addNewDisount"),k.scrollTo("profileUpgradeWrapper"))},3E3)}u("ExceptionHandlerController",{$scope:a});var q=this,x=!0;q.isProfileComplete=!1;h.requestInProgress=!0;h.$on("initSuccess",function(a,d){x&&l()});h.$on("Profile.Enrollmentstep",function(a,d){!d||"profile-completed"!=d&&"enroll-rewards-section"!=d||(q.isProfileComplete=
!0)});jQuery(document).ready(function(){ABG.amazonRedirect()});angular.isDefined(p.getXsrfToken())&&(x=!1,l())}angular.module("account").controller("DashboardWrapperController",t);t.$inject="$controller $window $scope $rootScope authenticationService storageService anchorSmoothScroll".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,z,t,B,y){function F(){y.accountSummaryload("ACCOUNT_DIVISIONS_URL").then(function(d){a.requestInProgress=!1;if(h.brand==k.brandName.BUDGET){var f=B.cbpFlag;f.cbpFlow=!0;B.setCbpFlag(f)}C.segments=angular.isDefined(d)&&angular.isDefined(d.partnerCustomerInfo)&&angular.isDefined(d.partnerCustomerInfo.childSegments)?d.partnerCustomerInfo.childSegments:"";a.$broadcast("CBPImageName",d.partnerCustomerInfo)},function(d){a.requestInProgress=!1})}x("ExceptionHandlerController",
{$scope:u});var C=this,r=!0;C.formValidated=!1;C.callChildSegment=function(d){t.getChildSegmentInfo(d).then(function(d){a.requestInProgress=!0;h.location.href=a.contextPath+"/"+a.locale+h.contentRoot+"/enrollment"+htmlExtension},function(d){angular.isDefined(d.errorList[0])&&0<d.errorList.length&&(C.formError=d.errorList[0].message,C.formValidated=!0);a.requestInProgress=!1})};a.requestInProgress=!0;a.$on("initSuccess",function(a,d){r&&F()});angular.isDefined(p.getXsrfToken())&&(r=!1,F())}angular.module("account").controller("DivisionController",
t);t.$inject="$scope $state $rootScope $window authenticationService $filter carRentalConstant signupService $validation $controller accountModelService $location corporateService reservationModelService getVehicles".split(" ")})();
(function(){function t(u,n,a,h,p,d,k){u("ExceptionHandlerController",{$scope:n});var l=this;l.resendEmailSuccess=!1;l.resendEmailError=!1;l.disableLeftNavLink=!1;l.customerData={};a.requestInProgress=!0;l.resendActivationEmail=function(){h.resendActivationEmail().then(function(a){a=n.processErrorMessage(a);l.prod=a;!a||angular.isDefined(a.errorList)&&0<a.errorList.length||angular.isDefined(a.warningList)&&0<a.warningList.length?l.resendEmailSuccess=!1:l.resendEmailSuccess=!0},function(d){l.prod=n.processErrorMessage(d);
a.requestInProgress=!1})};a.$on("Profile.CustomerAdditionalInfo",function(d,h){l.customerData=h;k.analyticsDimension(l.customerData,"");l.disableLeftNavLink=!0;a.requestInProgress=!1})}angular.module("account").controller("ActivationController",t);t.$inject="$controller $scope $rootScope signupService authenticationService $validation accountgaService".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,z){function t(){z.accountSummaryload("preferredFlow").then(function(d){y.customerResponce=d;B();setTimeout(function(){jQuery(".hide-on-load-profile").removeClass("hide-on-load-profile");a.requestInProgress=!1});a.requestInProgress=!1},function(){setTimeout(function(){jQuery(".hide-on-load-profile").removeClass("hide-on-load-profile");a.requestInProgress=!1});a.requestInProgress=!1})}function B(){angular.isDefined(y.customerResponce)&&angular.isDefined(y.customerResponce.partnerCustomerInfo)&&
!angular.equals({},y.customerResponce.partnerCustomerInfo)&&"PARTNER_CBP"==y.customerResponce.partnerCustomerInfo.partnerType&&a.$broadcast("CBPImageName",y.customerResponce.partnerCustomerInfo)}u("ExceptionHandlerController",{$scope:n});var y=this;y.expressEnrollmentPageError="";y.expressEnrollmentFormValidated=!1;y.validateOfflineProfileModel=k.validateOfflineProfileModel;y.domain=x.domain.toUpperCase();y.verifyIdentity=function(a){d.validate(a).success(y._validationSuccess).error(y._validationError)};
y.gtmBlur=function(a,d,f,l){null==l||x.brand!=q.brandName.BUDGET&&x.brand!=q.brandName.AVIS||(d=Dictionary.I18n.get("lbl.global.wizardNumber,"+brand));if("text"==f)var h=a?"Filled In":"Skipped";else"check"==f?h=a?"Checked In":"Skipped":"drop"==f&&(h=a?"Selected":"Not Selected");dataLayer.push({event:"trackEvent",eventCategory:"Tracking Form: express-enrollmentForm",eventLabel:d,eventAction:h})};y.forgotWizard=function(){ABG.redirectPage(a.contextPath+"/"+a.locale+x.contentRoot+"/forgot-username"+
htmlExtension)};y._onPageLoad=t;y._checkForCbpUser=B;y._validationSuccess=function(){a.requestInProgress=!0;p.validateIdentity(y.validateOfflineProfileModel).then(function(d){d=n.processErrorMessage(d);p.setConcurCustomerInfo(d);y.prod=d;if(angular.isDefined(d.errorList)&&0<d.errorList.length||angular.isDefined(d.warningList)&&0<d.warningList.length||angular.isDefined(d.instructionList)&&0<d.instructionList.length){if(angular.isDefined(d.instructionList)&&angular.isDefined(d.instructionList[0]))angular.equals(d.instructionList[0].code,
"06041")?ABG.redirectPage(a.contextPath+"/"+a.locale+x.contentRoot+"/concur-already-linked-denied"+htmlExtension):angular.isDefined(d.instructionList)&&angular.equals(d.instructionList[0].code,"06038")&&ABG.redirectPage(a.contextPath+"/"+a.locale+x.contentRoot+"/login"+htmlExtension+"#/06038");else if(angular.isDefined(d.errorList)&&angular.isDefined(d.errorList[0])&&angular.isDefined(y.customerResponce)&&angular.isDefined(y.customerResponce.partnerCustomerInfo)&&!angular.equals({},y.customerResponce.partnerCustomerInfo)&&
"PARTNER_CBP"==y.customerResponce.partnerCustomerInfo.partnerType&&angular.equals(d.errorList[0].code,"06012")){ABG.redirectPage(a.contextPath+"/"+a.locale+x.contentRoot+"/login"+htmlExtension+"#/06012");return}$("body").animate({scrollTop:0},"slow")}else ABG.redirectPage(a.contextPath+"/"+a.locale+x.contentRoot+"/enrollment"+htmlExtension);a.requestInProgress=!1},function(d){a.requestInProgress=!1;y.prod=n.processErrorMessage(d);y.accountFormValidation=!0;$("body").animate({scrollTop:0},"slow")})};
y._validationError=function(d){a.requestInProgress=!1;var f=d.errorCount;angular.isDefined(y.prod)&&angular.isDefined(y.prod.errorList)&&(y.prod.errorList.length=0);1===f?(y.expressEnrollmentPageError=d.MSG[0],y.expressEnrollmentFormValidated=!0):1<f&&(y.expressEnrollmentPageError=Dictionary.I18n.get("err.global.multi.errorMessage"),y.expressEnrollmentFormValidated=!0)};t()}angular.module("account").controller("VerifyIdentityController",t);t.$inject="$controller $scope $rootScope $state signupService $validation accountModelService getDataService carRentalConstant $window authenticationService getVehicles".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q){function x(){$("[data-toggle\x3d'custom-dropdown']").on("click",function(){var a=$(this);a.closest(".dropdown");l.getEditMode().editMode||a.dropdown("toggle")})}u("ExceptionHandlerController",{$scope:n});var f=this;q.getXsrfToken()||(h.requestInProgress=!0);f.disableLink=!1;f.displayLoyaltyProgressBar=!1;f.editSection=function(a){var d=l.getEditMode().editMode;d?d&&(a=l.getEditMode().editSection,l.anchorToMsg(a),f.showSectionMessage=!0,h.$broadcast("Profile.ShowSaveCancelMsg",
f.showSectionMessage)):(h.requestInProgress=!0,p.location.href=a)};f.currentPage="";f.disableLink=!1;f.amazonUserStatus="";f.hideModalBackdrop=function(){$(".modal-backdrop").remove()};f.showPreferredPlusMsg=!1;var z=["A8885","B8885","C8885","M8885"];f._expandSubNavigation=x;f.setPassword=function(){jQuery("html,body").animate({scrollTop:$("#identityPasswordSection").offset().top+150},"slow")};h.$on("Profile.CustomerAdditionalInfo",function(a,d){f.customerData=d;angular.isDefined(f.customerData.loyaltyDetails)&&
angular.isDefined(f.customerData.loyaltyDetails.nextTierName)&&""!=f.customerData.loyaltyDetails.nextTierName&&(f.displayLoyaltyProgressBar=!0);angular.isDefined(f.customerData.secDiscNumber)&&angular.isDefined(f.customerData.membershipStatus)&&angular.isDefined(f.customerData.loyaltyDetails)&&angular.isDefined(f.customerData.loyaltyDetails.totalRentals)&&angular.isDefined(f.customerData.loyaltyDetails.totalSpend)&&25<=f.customerData.loyaltyDetails.totalRentals&&7E3<=f.customerData.loyaltyDetails.totalSpend&&
("Preferred Plus Premium"==f.customerData.membershipStatus||"Preferred Plus"==f.customerData.membershipStatus)&&z.forEach(function(a){-1!=f.customerData.secDiscNumber.indexOf(a)&&(f.showPreferredPlusMsg=!0)});f.domain=p.domain.toUpperCase();l.setEditMode(!1);x();f.amazonUserStatus=q.amazonLoginStatus();h.requestInProgress=!1});h.$on("updateMemberStatus",function(a,d){f.customerData=angular.copy(d.customerInfo);f.customerData.wizardNumber=d.customerInfo.wizardNumberMasked});h.$on("Partner.partnerInfo",
function(a,d){angular.isDefined(d)&&(f.amazonUserStatus=q.amazonLoginStatus())});$(".left-sidebar").on("click tap",".navbar-toggle",function(){$(".navbar-toggle span").toggleClass("wrap-dropdown-close")})}angular.module("account").controller("NavigationController",t);t.$inject="$controller $scope carRentalConstant $rootScope $window storageService $validation myProfileService authenticationService".split(" ")})();
(function(){function t(u,n,a,h){u("ExceptionHandlerController",{$scope:n});var p=this;p.loadHelpModal=function(a){p.helpURL=h.getUrl(a.target.parentElement,"US")};a.$on("Profile.CustomerAdditionalInfo",function(a,h){p.customerData=h})}angular.module("account").controller("StaticPageController",t);t.$inject=["$controller","$scope","$rootScope","getVehicles"]})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,z,t,B,y,F,C,r,G,I,m,w,H,A){function v(){var b=$("#profileCreditCardForm");angular.isDefined(c.captchaFlag)&&1==b.length&&(c.captchaFlag=!0);H.getStorageData("displayAlexaSuccessMsg")&&(c.displaySuccessMsg=!0,c.alexaSuccessMessage=Dictionary.I18n.get("lbl.amazonBenefits.alexaSuccessMessage"),H.deleteStorageData("displayAlexaSuccessMsg"));a.scrollTo(0,0);"credit-card-section"==c.customerData.enrollmentStep&&(c.accountModel.cardType=c.customerData.ccSummary.type,
M());"true"==m.getUrlParameter("signup")&&(c.signUpFlow=!0);angular.isDefined(c.customerData)&&!angular.equals({},c.customerData)&&(angular.isDefined(c.customerData.webCustomer)&&!angular.equals({},c.customerData.webCustomer)&&"0"===c.customerData.webCustomer.activationStatus&&a.brand!=l.brandName.AVIS&&(a.location.href=f.contextPath+"/"+f.locale+a.contentRoot+"/activation"+htmlExtension),c.accountModel=d.getAccountData(c.customerData),a.brand===l.brandName.PAYLESS&&c.customerData.iscreateProfileFlow?
I.paylessDimension(c.customerData,""):(a.brand===l.brandName.AVIS||a.brand===l.brandName.BUDGET)&&I.analyticsDimension(c.customerData,""),c.amazonUserStatus=x.amazonLoginStatus(),X(),e(),angular.isDefined(c.customerData.errorList)&&(c.summaryError=n.processErrorMessage(c.customerData)),a.brand==l.brandName.AVIS&&c.customerData.resetPasswordFlow&&(c.resetPasswordFlow=c.customerData.resetPasswordFlow,c.sectionInEdit="password-section",d.anchorToMsg(c.sectionInEdit)),c.showProminentForm="profile-completed"!=
c.customerData.enrollmentStep&&"enroll-rewards-section"!=c.customerData.enrollmentStep?!0:!1,f.$broadcast("Profile.Enrollmentstep",c.customerData.enrollmentStep),a.brand===l.brandName.BUDGET&&angular.isDefined(c.accountModel)&&""!=c.accountModel&&(c.tempAccountModel=angular.copy(c.accountModel)));c.updateCdhUnAvailable()}function e(){if(angular.isDefined(c.customerData)&&!angular.equals({},c.customerData)){J();angular.isDefined(x.getLoyaltyDetails())&&x.getLoyaltyDetails();angular.isDefined(c.customerData.ftpPartnerDetails);
angular.isDefined(c.customerData.optOut);D();g();c.customerData.enrollmentMonth=d.getMonths(c.customerData.enrollmentMonth);c.customerData.pwdLastUpdatedMonth=d.getMonths(c.customerData.pwdLastUpdatedMonth);c.accountModel=d.getAccountData(c.customerData);if("protections-coverages-section"==c.customerData.enrollmentStep||-1!=a.location.href.indexOf("preferences")){if(c.hasPartnerInfo&&angular.isDefined(c.customerData.partnerCustomerInfo.insuranceMap))var b=c.customerData.partnerCustomerInfo.insuranceMap;
d.loadSupportedExtras(c.customerData,b).then(function(b){c.accountModel.extrasData=b;c.accountModel.tempList=angular.copy(c.accountModel.extrasData)})}c.accountModel.tempAwdList=angular.copy(c.customerData.awd);Z();Q();c.accountModel.contactAddress.address&&ea();c._loadEmail();c._loadCarPreferenceList();d.setEditMode(!1);c._checkForExpiredCC();c._setCreditCardSection();c._setDlSection();da();ba();ca();c._setProtectionCoverageSection();ja();c._setEnrollRewardsSection();W();U();aa();c.multiValuesEnable&&
c.carEdit()}f.requestInProgress=!1}function g(){angular.isDefined(c.getTnCCountryList)&&""!=c.getTnCCountryList&&(angular.isDefined(c.accountModel)&&c.accountModel.showConnectedCarTncModal||"tnc-section"==c.customerData.enrollmentStep)&&(c.showTnCPage=z.gettermsMapURL(c.getTnCCountryList,c.domain)+".partial.html")}function O(){angular.isDefined(c.customerData.ccSummary)&&angular.isDefined(c.customerData.ccSummary.expiryMsg)&&angular.isDefined(c.customerData.ccSummary.expiryMsg.code)&&"06015"===c.customerData.ccSummary.expiryMsg.code?
(c.creditCardExpired=!0,c.profilePageLevelError=!0,c.profilePageLevelErrorMsg=c.customerData.ccSummary.expiryMsg.fieldLevelMessage,c.formValidated=!0,c.sectionInEdit="credit-card-section",c.formError=c.customerData.ccSummary.expiryMsg.fieldLevelMessage):(c.creditCardExpired=!1,c.profilePageLevelError=!1,c.profilePageLevelErrorMsg="",c.formValidated=!1,c.formError="")}function Q(){angular.forEach(c.customerData.contacts.address,function(c){angular.isDefined(c)&&(angular.isDefined(c.address1)&&""!=
c.address1&&(angular.element("#addressline1"+c.maskId).val(c.address1),angular.element("#addressline1"+c.maskId).trigger("change")),angular.isDefined(c.address2)&&""!=c.address2&&(angular.element("#addressline2"+c.maskId).val(c.address2),angular.element("#addressline2"+c.maskId).trigger("change")),""!=c.zipCode&&(angular.element("#zip"+c.maskId).val(c.zipCode),angular.element("#zip"+c.maskId).trigger("change")))});angular.isDefined(c.addProperty.Address)&&(angular.isDefined(c.addProperty.Address.address1)&&
""!=c.addProperty.Address.address1&&(angular.element("#addressline").val(c.addProperty.Address.address1),angular.element("#addressline").trigger("change")),""!=c.addProperty.Address.zipCode&&(angular.element("#addZip").val(c.addProperty.Address.zipCode),angular.element("#addZip").trigger("change")))}function D(){if(angular.isDefined(c.customerData.cor)){var b=p.geteOffersSupportedCountry(c.customerData.cor);c.eOffersDisplay=b.supported;c.eOffersDisplay&&angular.isDefined(c.accountModel.profileIdentity)&&
angular.isDefined(c.accountModel.profileIdentity.promotionalEmailOptin)&&(c.accountModel.profileIdentity.promotionalEmailOptin=b.optin);b=p.geteReceiptSupportedCountry(c.customerData.cor);c.eReceiptDisplay=b.supported;c.eReceiptDisplay&&angular.isDefined(c.accountModel.profileIdentity)&&angular.isDefined(c.accountModel.profileIdentity.eRecieptEmailOptin)&&(c.accountModel.profileIdentity.eRecieptEmailOptin=b.optin)}}function J(){c.conflictedSection="";angular.isDefined(c.customerData.partnerCustomerInfo)&&
!angular.equals({},c.customerData.partnerCustomerInfo)?(c.hasPartnerInfo=!0,angular.isDefined(c.customerData.enrollmentStep)&&""!=c.customerData.enrollmentStep&&c.customerData.conflictCDBPartnerFlag&&(c.conflictedSection=c.customerData.enrollmentStep,"credit-card-section"==c.conflictedSection&&(c.customerData.ccSummary.expDate="",c.customerData.ccSummary.number="",c.customerData.ccSummary.type=""))):c.hasPartnerInfo=!1}function U(){var b=c.hasPartnerInfo?angular.isDefined(c.customerData.partnerCustomerInfo.minAge)?
c.customerData.partnerCustomerInfo.minAge:l.ageLimit.lower:l.ageLimit.lower;b=G.loadCalendarDropdown(b);c.monthsList=b.monthsList;c.yearsList=b.yearsList;c.datesList=b.datesList}function Z(){c.addProperty={awd:{},ccSummary:{},email:{},phone:{},Address:{},Car:{}};c.phone={}}function aa(){if(c.customerData&&c.customerData.freqPickUpLocation){c.travelPreferences.freqPickUpLocationDisp="";var b=c.customerData.freqPickUpLocation.indexOf(":");c.travelPreferences.freqPickUpLocationDisp=c.customerData.freqPickUpLocation.substring(b+
1,c.customerData.freqPickUpLocation.length);c.travelPreferences.frequentPickUpLocationInitial=c.travelPreferences.freqPickUpLocationDisp}}function ba(){c.siteLanguageDropDown=l.sitePreferenceLanguageList;c.hasPartnerInfo&&angular.isDefined(c.customerData.partnerCustomerInfo.supportedLanguages)&&0<c.customerData.partnerCustomerInfo.supportedLanguages.length&&(c.siteLanguageDropDown=d.getSupportedLanguageList(c.siteLanguageDropDown,c.customerData.partnerCustomerInfo.supportedLanguages));if(angular.isDefined(c.customerData)&&
angular.isDefined(c.customerData.preferences)&&angular.isDefined(c.customerData.preferences.siteLanguage))for(var b=0;b<c.siteLanguageDropDown.length;b++)c.siteLanguageDropDown[b].code.toUpperCase()==c.customerData.webCustomer.siteLanguage.toUpperCase()&&(c.accountModel.siteLanguage=c.siteLanguageDropDown[b].code,c.siteLanguage=c.siteLanguageDropDown[b].value);for(b=0;b<c.countryList.length;b++)c.countryList[b].code.toUpperCase()==c.customerData.webCustomer.siteCountry.toUpperCase()&&(c.siteCountry=
c.countryList[b].name)}function ca(){var b=G.getDateTimeFormat();c.dateFormat=b.dateFormat;c.timeFormat=b.timeFormat;if(angular.isDefined(c.customerData.preferences)&&angular.isDefined(c.customerData.preferences.timeFmt))for(b=0;b<c.timeFormat.length;b++)c.customerData.preferences.timeFmt==c.timeFormat[b].code&&(c.timeFormatToDisplay=c.timeFormat[b].value)}function da(){var b=G.loadMnthYrDropdown();c.expMonths=b.expMonths;c.expYears=b.expYears;angular.isDefined(c.accountModel.creditCardList)&&1<=
c.accountModel.creditCardList.length&&angular.forEach(c.accountModel.creditCardList,function(b,a){if(angular.isDefined(b)&&angular.isDefined(b.expDate)){var e=b.expDate.split("/");a=c.expMonths.indexOf(q("filter")(c.expMonths,function(c){return c.key==e[0]})[0]);-1!=a&&("fr_US"!=window.locale&&"fr_CA"!=window.locale&&"fr"!=window.locale||"budget"!==window.brand&&"avis"!==window.brand||(c.expMonths=K),b.expMonth=c.expMonths[a].key,b.expMonthPreviewMode=c.expMonths[a].desc);b.expYear=e[2];b.expYearPreviewMode=
e[2]}angular.isDefined(b)&&angular.isDefined(b.creditCardToken)&&(b.creditCardToken=b.creditCardToken)});if(angular.isDefined(c.customerData.ccSummary)&&angular.isDefined(c.customerData.ccSummary.expDate)){var a=c.customerData.ccSummary.expDate.split("/");b=c.expMonths.indexOf(q("filter")(c.expMonths,function(c){return c.key==a[0]})[0]);-1!=b&&("fr_US"!=window.locale&&"fr_CA"!=window.locale&&"fr"!=window.locale||"budget"!==window.brand&&"avis"!==window.brand||(c.expMonths=K),c.customerData.ccSummary.expMonth=
c.expMonths[b].key,c.customerData.ccSummary.expMonthPreviewMode=c.expMonths[b].desc);c.customerData.ccSummary.expYear=a[2];c.customerData.ccSummary.expYearPreviewMode=a[2]}}function M(b){angular.isDefined(c.accountModel)&&angular.isDefined(c.accountModel.ccSummary)&&angular.isDefined(c.accountModel.creditCardList)&&1==c.accountModel.creditCardList.length&&(c.hideCVV="AV"==c.accountModel.ccSummary.type?!1:!0,c.hideExpMonthYear="AV"==c.accountModel.ccSummary.type?!1:!0,c.isCVVMandatory="CX"==c.accountModel.ccSummary.type||
"CM"==c.accountModel.ccSummary.type||"CA"==c.accountModel.ccSummary.type||"CS"==c.accountModel.ccSummary.type||"CJ"==c.accountModel.ccSummary.type||"CD"==c.accountModel.ccSummary.type?!0:!1);angular.isDefined(c.accountModel)&&angular.isDefined(c.accountModel.creditCardList)&&1<=c.accountModel.creditCardList.length&&angular.forEach(c.accountModel.creditCardList,function(c){c.hideCVV=!0;c.hideExpMonthYear=!0;c.hideCVV="AV"==c.type?!1:!0;c.hideExpMonthYear="AV"==c.type?!1:!0;c.isCVVMandatory="CX"==c.type||
"CM"==c.type||"CA"==c.type||"CS"==c.type||"CJ"==c.type||"CD"==c.type?!0:!1});angular.isDefined(b)&&angular.isDefined(c.addProperty)&&angular.isDefined(c.addProperty.ccSummary)&&angular.isDefined(c.addProperty.ccSummary.type)&&(c.hideCVV="AV"==c.addProperty.ccSummary.type?!1:!0,c.hideExpMonthYear="AV"==c.addProperty.ccSummary.type?!1:!0,c.isCVVMandatory="CX"==c.addProperty.ccSummary.type||"CM"==c.addProperty.ccSummary.type||"CA"==c.addProperty.ccSummary.type||"CS"==c.addProperty.ccSummary.type||"CJ"==
c.addProperty.ccSummary.type||"CD"==c.addProperty.ccSummary.type?!0:!1)}function ja(){(angular.isDefined(d.getCreateStatus())&&d.getCreateStatus().protectionStatus||c.insuranceOpted)&&0==c.customerData.preferred&&c.dlSectionDisplay&&c.credtiCardSectionToDisplay&&"protections-coverages-section"!=c.conflictedSection?(c.termsConditionSectionDisplay=!0,I.analyticsDimension(c.customerData,"terms-and-condition")):(c.termsConditionSectionDisplay=!1,angular.isDefined(c.customerData.profileCompletionPercentage)&&
80==c.customerData.profileCompletionPercentage&&I.analyticsDimension(c.customerData,"terms-and-condition"))}function S(){d.getPartnerDetails().then(function(b){angular.isDefined(b.fieldErrors)&&0<b.fieldErrors.length&&angular.isDefined(b.errorList)&&0<b.errorList.length?n.processErrorMessage(b):c.partnerDetails=b;1==c.customerData.preferred&&"enroll-rewards-section"==c.customerData.enrollmentStep&&c.customerData.loyaltyEligible.visible&&(c.accountModel.program.pointsProgram=!0,c.accountModel.program.partnerProgram=
!1)},function(b){1==c.customerData.preferred&&"enroll-rewards-section"==c.customerData.enrollmentStep&&c.customerData.loyaltyEligible.visible&&(c.accountModel.program.pointsProgram=!0,c.accountModel.program.partnerProgram=!1)})}function ea(){c.countryList=G.getCountryList(c.customerData);c.accountModel.dlSummary.country=angular.isDefined(c.customerData.dlSummary)&&angular.isDefined(c.customerData.dlSummary.country)?c.customerData.dlSummary.country:c.customerData.cor;angular.forEach(c.accountModel.contactAddress.address,
function(c){ha(c,"",!0)});c.showSmsOptIn="US"==c.customerData.cor||"CA"==c.customerData.cor?!0:!1}function Y(b){c.countryList=G.getCountryList(c.customerData);if(angular.isDefined(c.countryList)){var a=c.countryList.indexOf(q("filter")(c.countryList,function(b){return b.code===c.accountModel.contactAddress.address[0].country})[0]);-1<a&&(c.addProperty.Address.country=c.countryList[a].code)}b=d.getSectionInEdit(b);angular.isDefined(c.customerData)&&angular.isDefined(c.customerData.dlSummary)&&angular.isDefined(c.customerData.dlSummary.country)&&
"dl-section"==b?(c.sectionInEdit="dl-section",fa(c.accountModel.dlSummary.country)):fa(c.accountModel.contactAddress.address[0].country)}function fa(b,a){a=angular.isDefined(a)&&0<a.length?G.getStateListBasedOnCounty(b,a):G.getStateListBasedOnCounty(b,c.countryList);c.adrTelCountryName=a.countryName;c.statesForCountry=a.statesForCountry;c.statesForDL=a.statesForDL;c.hideDLState=!angular.isUndefined(c.statesForDL)&&"Not Applicable"!=c.statesForDL[0].stateCode||"dl-section"!=c.customerData.enrollmentStep&&
"dl-section"!=c.sectionInEdit?!1:!0;1==c.hideDLState&&(c.accountModel.dlSummary.state="Not Applicable");c.showCity=b==l.countryCodeCA||b==l.countryCodePR||b==l.countryCodeUS||b==l.countryCodeCX||b==l.countryCodeCV||b==l.countryCodeVI?!0:!1;c.showState=b==l.countryCodeAU||b==l.countryCodeCA||b==l.countryCodeUS?!0:!1;b==l.countryCodeNZ&&(c.showCity=!0);c.showSuburb=b==l.countryCodeAU||b==l.countryCodeNZ?!0:!1;c.showZipcode=c.showSuburb||c.showCity?!0:!1;angular.isDefined(c.accountModel.dlSummary.state)&&
angular.isDefined(c.statesForDL)&&"Not Applicable"==c.accountModel.dlSummary.state&&1<c.statesForDL.length&&(c.accountModel.dlSummary.state=null)}function ha(b,a,e){e?(a=G.getStateListBasedOnCounty(b.country,c.countryList),b.adrTelCountryName=a.countryName,b.statesForCountry=a.statesForCountry,b.statesForDL=a.statesForDL,b.showCity=b.country==l.countryCodeCA||b.country==l.countryPR||b.country==l.countryCodeUS||b.country==l.countryCodeCX||b.country==l.countryCodeCV||b.country==l.countryCodeVI?!0:!1,
b.showState=b.country==l.countryCodeAU||b.country==l.countryCodeCA||b.country==l.countryCodeUS?!0:!1,b.country==l.countryCodeNZ&&(b.showCity=!0),b.showSuburb=b.country==l.countryCodeAU||b.country==l.countryCodeNZ?!0:!1,b.showZipcode=b.showSuburb||b.showCity?!0:!1,c.hideDLState=!angular.isUndefined(b.statesForDL)&&"Not Applicable"!=b.statesForDL[0].stateCode||"dl-section"!=c.customerData.enrollmentStep&&"dl-section"!=c.sectionInEdit?!1:!0,1==c.hideDLState&&(c.accountModel.dlSummary.state="Not Applicable"),
angular.isDefined(c.accountModel.dlSummary.state)&&angular.isDefined(b.statesForDL)&&""==c.accountModel.dlSummary.state&&1<b.statesForDL.length&&(c.accountModel.dlSummary.state=null)):fa(b)}function ka(){c.accountModel.program.partnerProgram=!0;c.accountModel.program.pointsProgram=!1;c.isFtpEnrollmentFlow=!0;c.rewardsSectionDisplay=!1;if(c.customerData.cor==l.countryCodeAU||c.customerData.cor==l.countryCodeNZ)c.displayPromoField=!0}function R(b){c.sectionInEdit=d.getSectionInEdit(b)}function T(){c.accountModel.updatePassword.newPassword=
"";c.accountModel.updatePassword.currentPassword=""}function L(a,e){if(a)if(c.showSuccessMsg=!1,d.checkEditMode())d.getSectionInEdit(e),"telephone-section"==c.sectionInEdit&&(c.sectionInEdit="address-section"),d.anchorToMsg(c.sectionInEdit),c.showSectionMessage=c.customerData.passwordGraceWindow?!1:!0;else{var g=d.getSectionInEdit(e);c.tdCheck||"dl-section"==g?b(a,e):(f.requestInProgress=!0,w.generateOtp().then(function(d){d.promptOtpFlag?b(a,e):!d.promptOtpFlag&&angular.isUndefined(d.errorList)?
(c.tdCheck=!0,d=x.getSessionModel(),d.tdCheck=!0,x.setSessionModel(d),b(a,e)):$(".profile-edit-error").modal("show");f.requestInProgress=!1},function(c){$(".profile-edit-error").modal("show");f.requestInProgress=!1}))}else c.resendOtpSuccess=!1,c.resendOtpError=!1,c.showSectionMessage=!1,b(a,e)}function b(b,e){a.brand==l.brandName.AVIS&&c.resetPasswordFlow&&(c.resetPasswordFlow=!1);c.formValidated=!1;var f={},g={};f=angular.copy(c.accountModel.tempList);g=angular.copy(c.accountModel.extrasData);b&&
(c.tempAccountModel=angular.copy(c.accountModel));c.accountModel.tempList=f;c.accountModel.extrasData=g;da();U();Z();Y(e);c._loadCarPreferenceList();c.onChangeCreditCardType();f=angular.element(".wrap-auto-sugg #addressline1");k.removeError(f);k.resetError("vm.addProperty.Address.address2");c.multiValuesEnable&&c.carEdit();c.formValidated=!1;O();k.resetError("vm.addProperty.email.email",!0);k.resetError("vm.addProperty.phone.phoneNumber",!0);k.resetError("vm.addProperty.ccSummary.type",!0);k.resetError("vm.addProperty.ccSummary.number",
!0);k.resetError("vm.addProperty.ccSummary.expMonth",!0);k.resetError("vm.addProperty.ccSummary.expYear",!0);k.resetError("vm.addProperty.ccSummary.secureCode",!0);k.resetError("vm.addProperty.awd.discountNumber",!0);"dl-section"==c.sectionInEdit&&k.resetError("vm.accountModel.dlSummary.dlNumber");"name-section"==c.sectionInEdit&&(k.resetError("vm.accountModel.profileIdentity.firstName"),k.resetError("vm.accountModel.profileIdentity.lastName"),k.resetError("vm.accountModel.profileIdentity.userName"));
b||(c.accountModel=angular.copy(c.tempAccountModel));setTimeout(function(){Q()},5);if(b)if(c.showSuccessMsg=!1,c.showUpdateMsg=!1,d.checkEditMode())$(".profile-edit-progress-alert").modal("show");else{R(e);if("protections-coverages-section"==c.sectionInEdit||"travel-preferences-section"==c.sectionInEdit)c.accountModel.extrasData=angular.copy(c.accountModel.tempList);d.setEditMode(!0,c.sectionInEdit);d.triggerEditMode(e,b,c.sectionInEdit)}else d.setEditMode(!1),d.triggerEditMode(e,b,c.sectionInEdit)}
function V(){var b;f.requestInProgress=!0;x.getSessionModel();x.logout().then(function(e){x.setLoginAuthenticate(!1);b=f.contextPath+"/"+f.locale+"/home"+htmlExtension;H.setStorageData("lockedUser",c.customerData.contacts.email);h.remove("resModelDisplayControls");setTimeout(function(){a.location.href=b},1)},function(c){f.requestInProgress=!1})}function P(c){setTimeout(function(){var c=$(".wrap-profile-progress").find(".card-outer-content:visible");c.find(".card-inner-content").addClass("editable-mode");
c.find(".modal").modal("show")},1500)}function W(){$(".modal").on("shown.bs.modal",function(){$("[data-toggle\x3dpopover]").popover()})}function ia(c,b,e,d){null==d||a.brand!=l.brandName.BUDGET&&a.brand!=l.brandName.AVIS||(b=Dictionary.I18n.get("lbl.global.wizardNumber,"+brand));if("text"==e)var f=c?"Filled In":"Skipped";else"checkbox"==e?f=c?"Selected as Y":"Selected as N":"dropdown"==e&&(f=c?"Selected":"Not Selected");dataLayer.push({event:"trackEvent",eventCategory:"Tracking Form: Profile-Form",
eventLabel:b,eventAction:f})}function X(){angular.isDefined(c.accountModel)&&c.accountModel.retrieveExpressConsentInd&&angular.isDefined(c.retriveCallSuccess)&&!c.retriveCallSuccess&&d.retrieveExpressConsentTerms().then(function(b){H.setStorageData("showExpressConsent",!b.customerInfo.expressConsentTerms);H.setStorageData("retriveCallSuccess",!0);angular.isDefined(b)&&angular.isDefined(b.customerInfo)&&angular.isDefined(b.customerInfo.expressConsentTerms)&&!b.customerInfo.expressConsentTerms&&angular.isDefined(b.customerInfo.preferred)&&
b.customerInfo.preferred&&(c.accountModel.showConnectedCarTncModal=!0,c.rewardPreferredTnC=!1,c.showTnCPage=z.gettermsMapURL(c.getTnCCountryList,c.domain)+".partial.html",setTimeout(function(){$("#temporary-modalTnC .modal.connected-car-tnc").modal("show")},2E3))});c.showExpressConsent=H.getStorageData("showExpressConsent");angular.isDefined(c.showExpressConsent)&&c.showExpressConsent&&(c.accountModel.showConnectedCarTncModal=!0,c.rewardPreferredTnC=!1,c.showTnCPage=z.gettermsMapURL(c.getTnCCountryList,
c.domain)+".partial.html",setTimeout(function(){$("#temporary-modalTnC .modal.connected-car-tnc").modal("show")},2E3))}u("ExceptionHandlerController",{$scope:n});f.requestInProgress=!0;var c=this;c.captchaFlag=!1;c.showSmsOptIn=!0;c.makeList=[];c.modelList=[];c.primaryCheckbox="";c.sectionInEdit="";c.invalidPhoneNumber=!1;c.credtiCardSectionToDisplay=!1;c.dlSectionDisplay=!1;c.creditCardType="";c.customerData={};c.accountModel={};c.tempAccountModel={};c.cityDisplay=!1;c.amazonPrimaryValue=!1;c.creditCardExpired=
!1;c.profilePageLevelError=!1;c.emailReceiptPreferenceHidden=!0;c.emailOffersPreferenceHidden=!0;c.isFtpEnrollmentFlow=!1;c.displayPromoField=!1;c.enableCaptcha=enableCaptcha;c.maskedDlNumber="";c.profilePageLevelErrorMsg="";c.expMonths=[];c.countryList=[];c.expMonthPreviewMode="";c.expYearPreviewMode="";c.hideCVV=!0;c.hideExpMonthYear=!0;c.displayFTPSection=!1;c.siteLanguage="";c.siteCountry="";c.ccDetailList=[];c.declineTermsCondition="";c.termsConditionSectionDisplay="";c.carGroupPreferenceList=
[];c.carModelList=[];c.titleList=d.getTitleList();c.carGroupPreferredName="";c.travelPreferences={getFrequentPickUpLocation:""};c.partnerDetails="";c.sectionDeleted="";c.displayLoyaltyMessage=!1;c.displayFTPMessage=!1;c.displayOptoutMessage=!1;c.insuranceOpted=!1;c.showUpdateMsg=!1;c.protectionCoverageSectionDisplay=!1;c.timeFormatToDisplay="";c.showSuccessMsg=!1;c.showErrorMsg=!1;c.formValidated=!1;c.deleteFail=!1;c.domain=a.domain.toUpperCase();c.brand=a.brand;c.getTnCCountryList=a.termsandconditionsMap;
c.getAvisPreferredTermsList=a.termsandconditionsRewardsMap;c.hasPartnerInfo=!1;c.showFTPDeclinedMsg=!1;c.showFTPSuccessMsg=!1;c.rewardPreferredTnC=!1;c.conflictedSection="";c.summaryError={};c.primaryChecked=!1;c.sectionDeleted="";c.displayRewardsSection=!0;c.signUpFlow=!1;c.resetPasswordFlow=!1;c.profileOtp="";c.resendOtpSuccess=!1;c.resendOtpError=!1;c.tdCheck=!0;c.showProminentForm=!1;c.collapseProminentForm=!1;c.alexaSuccessMessage="";c.displaySuccessMsg=!1;c.multiValuesEnable=!1;c.showDelete=
!1;c.hideDLState=!1;c.showMessage=!1;c.ccpresent=!1;c.amazonUserStatus="";c.showSectionMessage=!1;c.showExpressConsent=angular.isDefined(H.getStorageData("showExpressConsent"))?!0:!1;c.retriveCallSuccess=angular.isDefined(H.getStorageData("retriveCallSuccess"))?!0:!1;c.isEnterManual=!1;c.showBiometricScan=!1;c.saveProfileDetail=function(b,g){R(g);var h=c.accountModel;if(angular.isDefined(c.accountModel.awd)&&0<c.accountModel.awd.length)var E=c.accountModel.awd[0].discountNumber;"credit-card-section"==
c.sectionInEdit&&c.saveProfileCC.submit(b);"name-section"==c.sectionInEdit&&"payless"==a.brand&&angular.isDefined(h.profileIdentity.emails)&&(h.profileIdentity.emails[0].operation="update");"travel-preferences-section"==c.sectionInEdit&&angular.isDefined(h.travelPreferences)&&angular.isDefined(h.travelPreferences.awd)&&0==c.multiValuesEnable&&a.brand!=l.brandName.BUDGET&&(angular.isDefined(h.travelPreferences.awd[0])&&angular.isDefined(h.travelPreferences.awd[0].maskId)&&""!=h.travelPreferences.awd[0].maskId&&
!$.isEmptyObject(c.accountModel.tempAwdList)&&angular.isDefined(c.accountModel.tempAwdList)&&""!=c.accountModel.tempAwdList[0].discountNumber?(h.travelPreferences.awd[0].operation="update",h.travelPreferences.awd[0].discountNumber=c.accountModel.tempAwdList[0].discountNumber):angular.isDefined(c.accountModel.tempAwdList)&&!$.isEmptyObject(c.accountModel.tempAwdList)&&angular.isDefined(c.accountModel.tempAwdList[0].discountNumber)&&angular.isDefined(c.accountModel.tempAwdList[0].discountNumber)&&""!=
c.accountModel.tempAwdList[0].discountNumber?h.travelPreferences.awd=[{discountNumber:c.accountModel.tempAwdList[0].discountNumber,operation:"add",maskId:"",primary:!0,nickName:""}]:angular.isDefined(c.accountModel.tempAwdList)&&!$.isEmptyObject(c.accountModel.tempAwdList)&&""===c.accountModel.tempAwdList[0].discountNumber&&angular.isDefined(c.accountModel.awd)&&0<c.accountModel.awd.length&&(h.travelPreferences.companyName=" ",h.travelPreferences.awd=[{discountNumber:E,operation:"delete",maskId:1,
primary:!0,nickName:""}]));"travel-preferences-section"==c.sectionInEdit&&angular.isDefined(h.travelPreferences)&&angular.isDefined(h.travelPreferences.awd)&&(1==c.multiValuesEnable||a.brand===l.brandName.BUDGET)&&(c.accountModel.travelPreferences.awd=[]);"dl-section"==c.sectionInEdit&&angular.isDefined(h.dlSummary.telephone)&&angular.isDefined(h.contactAddress)&&angular.isDefined(h.contactAddress.telephone)&&""!=h.contactAddress.telephone&&(h.dlSummary.maskId=h.contactAddress.telephone[0].maskId,
h.dlSummary.primary=h.contactAddress.telephone[0].primary,h.dlSummary.operation="update");"credit-card-section"!=c.sectionInEdit&&k.validate(b).success(function(){f.requestInProgress=!0;c.customerData.costControlCode=c.accountModel.costControlCode;d.updateProfile(c.customerData,h,c.sectionInEdit).then(function(b){b=n.processErrorMessage(b);if(angular.isDefined(b.errorList)&&0<b.errorList.length)c.showPrefilled&&"dl-section"==c.sectionInEdit&&(m.addGTMScript(),A.trackMitekVerEventsDuringProfileEnroll("DL_UPDATED",
"Failure",c.customerData)),c.accountModel.secureCode="",c.formError="06042"==b.errorList[0].code?n.$eval(b.errorList[0].message):b.errorList[0].message,c.updateCdhUnAvailable(b),c.formValidated=!0,c.showSuccessMsg=!1,f.requestInProgress=!1,d.anchorToMsg(c.sectionInEdit);else{c.customerData=b;c.showPrefilled&&"dl-section"==c.sectionInEdit&&(m.addGTMScript(),A.trackMitekVerEventsDuringProfileEnroll("DL_UPDATED","Success",c.customerData));a.brand==l.brandName.AVIS&&"profile-completed"!=c.customerData.enrollmentStep&&
f.$broadcast("Profile.SelfInvoke",b);var g=m.getReservationModel();angular.isDefined(g)&&angular.isDefined(g.coupon)&&angular.isDefined(g.coupon.discountNumber)&&angular.isDefined(c.customerData.awd)&&""!=c.customerData.awd&&(g.coupon.discountNumber=c.customerData.awd[0].discountNumber);c.formValidated=!1;c.showSuccessMsg=!0;c.updateCdhUnAvailable(b);f.requestInProgress=!1;d.anchorToMsg(c.sectionInEdit);L(!1);e()}},function(b){angular.isDefined(b.errorList)&&0<b.errorList.length&&(c.formError=b.errorList[0].message,
c.formValidated=!0,c.showSuccessMsg=!1);c.showPrefilled&&"dl-section"==c.sectionInEdit&&(m.addGTMScript(),A.trackMitekVerEventsDuringProfileEnroll("DL_UPDATED","Failure",c.customerData));c.accountModel.secureCode="";f.requestInProgress=!1})}).error(function(b){c.showPrefilled&&"dl-section"==c.sectionInEdit&&(m.addGTMScript(),A.trackMitekVerEventsDuringProfileEnroll("DL_UPDATED","Failure",c.customerData));c.accountModel.secureCode="";c.formError=ABG.getFormValidationError(b,!1)[0].message;c.formValidated=
!0;c.showSuccessMsg=!1;f.requestInProgress=!1;1<b.errorCount?d.anchorToMsg(c.sectionInEdit):1==b.errorCount&&document.getElementsByName(b.fieldName)[0].focus()});"discount-codes-section"==c.sectionInEdit&&angular.isDefined(h.travelPreferences)&&angular.isDefined(h.travelPreferences.awd)&&a.brand==l.brandName.BUDGET&&(angular.isDefined(h.travelPreferences.awd[0])&&angular.isDefined(h.travelPreferences.awd[0].maskId)&&""!=h.travelPreferences.awd[0].maskId&&!$.isEmptyObject(c.accountModel.tempAwdList)&&
angular.isDefined(c.accountModel.tempAwdList)&&""!=c.accountModel.tempAwdList[0].discountNumber?(h.travelPreferences.awd[0].operation="update",h.travelPreferences.awd[0].discountNumber=c.accountModel.tempAwdList[0].discountNumber):angular.isDefined(c.accountModel.tempAwdList)&&!$.isEmptyObject(c.accountModel.tempAwdList)&&angular.isDefined(c.accountModel.tempAwdList[0].discountNumber)&&""!=c.accountModel.tempAwdList[0].discountNumber?h.travelPreferences.awd=[{discountNumber:c.accountModel.tempAwdList[0].discountNumber,
operation:"add",maskId:"",primary:!0,nickName:""}]:angular.isDefined(c.accountModel.tempAwdList)&&!$.isEmptyObject(c.accountModel.tempAwdList)&&""===c.accountModel.tempAwdList[0].discountNumber&&angular.isDefined(c.accountModel.awd)&&0<c.accountModel.awd.length&&(h.travelPreferences.companyName=" ",h.travelPreferences.awd=[{discountNumber:E,operation:"delete",maskId:1,primary:!0,nickName:""}]))};c.saveDetails=function(b,g,h,m){R(h);c.showDelete=!1;if(angular.isDefined(c.accountModel.awd)&&0<c.accountModel.awd.length)var E=
c.accountModel.awd[0].discountNumber;angular.isDefined(g.number)&&(-1==g.number.indexOf("*")?c.showMessage=!0:c.showMessage=!1);angular.isDefined(g.maskId)&&""!=g.maskId&&"address-telephone-section"!=c.sectionInEdit&&"amazon-discount-section"!=c.sectionInEdit?g.operation="update":"amazon-discount-section"!=c.sectionInEdit&&(g.operation="add",g.maskId="");"discount-number-section"==c.sectionInEdit&&angular.isDefined(c.accountModel.tempAwdList)&&0<c.accountModel.tempAwdList.length&&""===c.accountModel.tempAwdList[0].discountNumber&&
angular.isDefined(c.accountModel.awd)&&0<c.accountModel.awd.length&&(g.operation="delete",g.maskId=1,g.discountNumber=E,g.primary=!0);"address-telephone-section"==c.sectionInEdit&&(angular.isDefined(g.address[0].maskId)&&""!=g.address[0].maskId?g.address[0].operation="update":(g.address[0].operation="add",g.address[0].maskId=""),angular.isDefined(g.telephone)&&""!=g.telephone&&angular.isDefined(g.telephone[0].maskId)&&""!=g.telephone[0].maskId?(g.telephone[0].operation="update",g.telephone[0].smsOptIn=
angular.isDefined(g.telephone[0].smsOptIn)&&1==g.telephone[0].smsOptIn?"T":"N"):angular.isDefined(g.telephone)&&""!=g.telephone&&(g.telephone[0].operation="add",g.telephone[0].maskId="",g.telephone[0].smsOptIn=angular.isDefined(g.telephone[0].smsOptIn)&&1==g.telephone[0].smsOptIn?"T":"N",g.telephone[0].primary=!0));"amazon-discount-section"==c.sectionInEdit&&angular.forEach(c.accountModel.awd,function(b){if("-1"==b.maskId){b.primary=c.amazonPrimaryValue;b.operation="update";var a=[];a.push(b);g=a}});
"identity-password-section"==c.sectionInEdit&&(g.promoMails=angular.isDefined(g.promoMails)&&1==g.promoMails?"Y":"N",g.eRecieptEmailOptin=c.customerData.cor==l.countryCodeUS||c.customerData.cor==l.countryCodeCA||angular.isDefined(g.eRecieptEmailOptin)&&1==g.eRecieptEmailOptin?"Y":"N");"discount-number-section"==c.sectionInEdit&&!angular.isDefined(g.primary)&&1<=c.accountModel.awd.length&&(g.primary=!1);"car-preference-section"==c.sectionInEdit&&!angular.isDefined(g.primary)&&1<=c.accountModel.carPreference.length&&
(g.primary=!1);"telephone-section"==c.sectionInEdit&&(g.smsOptIn=angular.isDefined(g.smsOptIn)&&1==g.smsOptIn?"T":"N");"telephone-section"!=c.sectionInEdit||!angular.isUndefined(g.primary)||""!=c.customerData.contacts.phoneNumbers&&void 0!=c.customerData.contacts.phoneNumbers||(g.primary=!0);"discount-number-section"==c.sectionInEdit&&"add"==g.operation&&1>c.accountModel.awd.length&&(g.primary=!0);"car-preference-section"==c.sectionInEdit&&"add"==g.operation&&1>c.accountModel.carPreference.length&&
(g.primary=!0);if("discount-number-section"==c.sectionInEdit&&(E=[],E.push(g),g=E,a.brand===l.brandName.AVIS&&"add"===g[0].operation))for(E=0;E<c.customerData.awd.length;E++)if("J328400"===c.customerData.awd[E].discountNumber){E=c.customerData.awd[E];E.operation="delete";g[0].operation="update";g[0].genericPartnerAWD=E.genericPartnerAWD;g[0].maskId=E.maskId;g[0].selected=E.selected;g.push(E);break}"credit-card-section"==c.sectionInEdit&&(c.updateProfileCC.submit(b,g,h,m),angular.isDefined(c.formError)&&
document.getElementById("profileAvisCreditCardForm").scrollIntoView());"credit-card-section"!=c.sectionInEdit&&k.validate(b).success(function(){f.requestInProgress=!0;d.updateProfile(c.customerData,g,c.sectionInEdit).then(function(b){b=n.processErrorMessage(b);angular.isDefined(b.errorList)&&0<b.errorList.length?(c.formError="06042"==b.errorList[0].code?n.$eval(b.errorList[0].message):b.errorList[0].message,"17414"==b.errorList[0].code&&(c.cdhError="Your details were not saved,please try again."),
c.formValidated=!0,c.showUpdateMsg=!1,f.requestInProgress=!1,c.updateCdhUnAvailable(b),!c.formValidated&&c.cdhError&&d.anchorToMsg(c.sectionInEdit,m)):(c.customerData=b,c.formValidated=!1,c.showUpdateMsg=!0,c.showSuccessMsg=!0,f.requestInProgress=!1,c.updateCdhUnAvailable(b),d.anchorToMsg(c.sectionInEdit,m),L(!1),e(),$(".add-"+c.sectionInEdit).modal("hide"),$("body").removeClass("modal-open"),"true"==enableCaptcha&&ABG.resetCaptcha(!0))},function(b){angular.isDefined(b.errorList)&&0<b.errorList.length&&
(c.formError=b.errorList[0].message,c.updateCdhUnAvailable(data),c.formValidated=!0,c.showSuccessMsg=!1);g.secureCode="";!c.formValidated&&c.cdhError&&d.anchorToMsg(c.sectionInEdit,m);f.requestInProgress=!1})}).error(function(b){g.secureCode="";c.formError=2<=b.errorCount?Dictionary.I18n.get("err.global.multi.errorMessage"):b.MSG[0];c.formValidated=!0;c.showSuccessMsg=!1;f.requestInProgress=!1;c.updateCdhUnAvailable(b);1<b.errorCount||!c.formValidated&&c.cdhError?d.anchorToMsg(c.sectionInEdit):1==
b.errorCount&&document.getElementsByName(b.fieldName)[0].focus()})};c.getStateBasedOnCounty=ha;c.selectAddress=function(b,a){if(angular.isDefined(c.addProperty.Address.address1)||angular.isDefined(c.addProperty.Address.zipCode)){a===l.address&&angular.isDefined(b.address.postalCode)&&(c.addProperty.Address.zipCode=b.address.postalCode,angular.element("#addZip").val(b.address.postalCode),angular.element("#addZip").trigger("change"),setTimeout(function(){angular.element("#addZip").blur()},5));angular.isDefined(b.address.locality)&&
(c.addProperty.Address.city=b.address.locality,c.cityDisplay=!0);if(angular.isDefined(b.address.adminDistrict)){var e=q("filter")(c.statesForCountry,{stateCode:b.address.adminDistrict},!0)[0];e=c.statesForCountry.indexOf(e);-1<e&&(c.addProperty.Address.state=c.statesForCountry[e].stateCode)}angular.isDefined(b.address3)&&0<b.address3.length?c.displayAddressLine3=!0:c.displayAddressLine3=!1}angular.forEach(c.accountModel.contactAddress.address,function(e){if(/^[a-zA-Z0-9 ]*$/.test(e.address1)||/^[a-zA-Z0-9 ]*$/.test(e.zipCode)){a===
l.address&&angular.isDefined(b.address.postalCode)&&(e.zipCode=b.address.postalCode,angular.element("#zip"+e.maskId).val(b.address.postalCode),angular.element("#zip"+e.maskId).trigger("change"),setTimeout(function(){angular.element("#zip"+e.maskId).blur()},5));angular.isDefined(b.address.locality)&&(e.city=b.address.locality);if(angular.isDefined(b.address.adminDistrict)){var d=q("filter")(e.statesForCountry,{stateCode:b.address.adminDistrict},!0)[0];d=e.statesForCountry.indexOf(d);-1<d&&(e.state=
e.statesForCountry[d].stateCode)}angular.isDefined(b.address3)&&0<b.address3.length?c.displayAddressLine3=!0:c.displayAddressLine3=!1}})};c.updatePassword=function(b,g){R(g);c.accountModel.updatePassword.currentPassword==c.accountModel.updatePassword.newPassword&&""!=c.accountModel.updatePassword.currentPassword&&""!=c.accountModel.updatePassword.newPassword?(c.formError=Dictionary.I18n.get("error.profile.common.samepassword,"+brand)+"\x3c/br\x3e"+Dictionary.I18n.get("msg.profile.password.reenter"),
c.formValidated=!0,T(),d.anchorToMsg(c.sectionInEdit)):""==c.accountModel.updatePassword.currentPassword&&""!=c.accountModel.updatePassword.newPassword?(c.formError=Dictionary.I18n.get("error.profile.oldPassword.required,"+brand)+"\x3c/br\x3e"+Dictionary.I18n.get("msg.profile.password.reenter"),c.formValidated=!0,T(),d.anchorToMsg(c.sectionInEdit)):k.validate(b).success(function(){f.requestInProgress=!0;d.updatePassword(c.customerData,c.accountModel,c.sectionInEdit).then(function(b){b=n.processErrorMessage(b);
angular.isDefined(b.errorList)&&0<b.errorList.length?angular.equals(b.errorList[0].code,"30033")?(c.summaryError=n.processErrorMessage(b),x.deleteAllStorageData(),H.setStorageData("authMsg",c.summaryError.errorList[0].message),ABG.redirectPage(f.contextPath+"/"+f.locale+a.contentRoot+"/login"+htmlExtension)):(c.formError=b.errorList[0].message,c.formValidated=!0,T()):(c.customerData=b,c.formValidated=!1,c.showSuccessMsg=!0,e(),L(!1),setTimeout(function(){angular.element("#cancel-password").click();
d.anchorToMsg(c.sectionInEdit)},10));f.requestInProgress=!1;d.anchorToMsg(c.sectionInEdit)},function(b){angular.isDefined(b.errorList)&&0<b.errorList.length&&(c.formError=b.errorList[0].message,c.formValidated=!0,c.showSuccessMsg=!1);d.anchorToMsg(c.sectionInEdit);T();f.requestInProgress=!1})}).error(function(b){c.formError=2<=b.errorCount?Dictionary.I18n.get("err.global.multi.errorMessage")+"\x3c/br\x3e"+Dictionary.I18n.get("msg.profile.password.reenter"):b.MSG[0]+"\x3c/br\x3e"+Dictionary.I18n.get("msg.profile.password.reenter");
c.formValidated=!0;T();f.requestInProgress=!1;d.anchorToMsg(c.sectionInEdit)})};c.editSection=L;c.cancelEdit=function(b){k.reset(b)};c.clearError=function(b){$(".error").empty();$("input").removeClass("platform-element-error ng-invalid")};c.carEdit=function(){d.getCarPreferenceListFromServlet(c.customerData.cor).then(function(b){c.favouriteCars=b;angular.forEach(c.favouriteCars,function(b){c.makeList.push(b.make)});var a=[];angular.forEach(c.makeList,function(b){angular.isDefined(b)&&a.push(b)});
c.makeList=q("unique")(a,"make");c.addProperty.Car.make=c.favouriteCars[0].make;c.accountModel.carPreference&&(angular.forEach(c.accountModel.carPreference,function(b){angular.forEach(c.favouriteCars,function(c){b.makeModelCd==c.makeModelCd&&(b.make=c.make,b.description=c.model,b.carClass=c.carGroup)})}),angular.forEach(c.accountModel.carPreference,function(b){b.carModelList!=[]&&(b.carModelList=[],angular.forEach(c.favouriteCars,function(c){if(b.make==c.make){b.carModelList.push({makeModelCd:c.makeModelCd,
modelName:c.model});var a=[];angular.forEach(b.carModelList,function(b){angular.isDefined(b)&&a.push(b)});b.carModelList=q("unique")(a,"modelName")}}))}));c.addProperty.Car&&(c.addProperty.Car.carModelList=[],angular.forEach(c.favouriteCars,function(b){if(c.addProperty.Car.make==b.make){c.addProperty.Car.carModelList.push({makeModelCd:b.makeModelCd,modelName:b.model});var a=[];angular.forEach(c.addProperty.Car.carModelList,function(b){angular.isDefined(b)&&a.push(b)});c.addProperty.Car.carModelList=
q("unique")(a,"modelName")}}),c.addProperty.Car.makeModelCd=c.addProperty.Car.carModelList[0].makeModelCd,angular.forEach(c.favouriteCars,function(b){c.addProperty.Car.makeModelCd==b.makeModelCd&&(c.addProperty.Car.carClass=b.carGroup)}))})};c.getSuggestions=function(b,a,e){if(e&&c.session&&(c.session.status===l.userStateAuthenticated||c.session.status===l.userStateRecognized))return b=$q.defer(),c.suggestions=x.getPreviousRateShopModel(),b.resolve(c.suggestions),b.promise;if(b)return 83<b.userInputString.length&&
(b.userInputString=b.userInputString.slice(0,80)),a={userInputString:b.userInputString},angular.isDefined(b.lat)&&angular.isDefined(b.lon)&&(a.lat=b.lat,a.lon=b.lon),c.suggestions=[],b=F.loadLocation(a),b.then(function(b){b&&b.data&&(c.suggestions=b.data.suggestions)}),b;b=$q.defer();b.reject({});return b.promise};c.validatePhoneNumber=function(b,a,e,g,h,m,l,k){f.requestInProgress=!0;d.validatePhoneNumber(b,a,e,g,c.accountModel).then(function(b){angular.isDefined(b.errorList)&&0<b.errorList.length||
angular.isDefined(b.fieldErrors)&&0<b.fieldErrors.length?(f.requestInProgress=!1,"dl-section"==g&&C.scrollTo("email-offers"),"telephone-section"!=g&&"address-telephone-section"!=g||C.scrollTo("profileAddressForm")):("dl-section"==g&&c.saveProfileDetail(h,l),"telephone-section"!=g&&"address-telephone-section"!=g||c.saveDetails(h,m,l,k))},function(b){angular.isDefined(b.errorList)&&0<b.errorList.length&&(c.formError=b.errorList[0].message,c.formValidated=!0);f.requestInProgress=!1})};c.onChangeCreditCardType=
M;c.modifyTempList=function(b,a,e){for(var d=0;d<c.accountModel.tempList[e].length;d++)if(b.code===c.accountModel.tempList[e][d].code){c.accountModel.tempList[e][d].value=a;break}};c.validatecurrentPasswordField=function(b){b?setTimeout(function(){angular.element("#currentPasswordHide").blur()},5):setTimeout(function(){angular.element("#currentPasswordShow").blur()},5)};c.validatenewPasswordField=function(b){b?setTimeout(function(){angular.element("#newPasswordHide").blur()},5):setTimeout(function(){angular.element("#newPasswordShow").blur()},
5)};c.cancelTempListModifications=function(){c.accountModel.tempList=angular.copy(c.accountModel.extrasData)};c.declineProfileTermsCondition=function(b){R(b);c.declineTermsCondition=!0};c.clearFtpDetails=function(b){c.accountModel=y.clearFtpDetails(c.accountModel,b);c.formValidated=!1};c.setFtpEnrollment=ka;c.gtmBlur=ia;c.clearAddress=function(b){b===l.address&&(angular.element("#zip").val(""),angular.element("#zip").trigger("change"),c.accountModel.contactAddress.address.address1="",c.accountModel.contactAddress.address.address2=
"",c.accountModel.contactAddress.address.address3="",c.accountModel.contactAddress.address.suburb="");c.accountModel.contactAddress.address.zipCode="";c.accountModel.contactAddress.address.city="";c.accountModel.contactAddress.address.state=""};c.acceptConnectedCarTnC=function(b){c.sectionInEdit="tnc-section";$("#temporary-modalTnC .modal.connected-car-tnc").modal("hide");c.customerData.expressConsentTerms=!0;c.accountModel.acceptTermsConditions=!0;d.updateProfile(c.customerData,c.accountModel,c.sectionInEdit).then(function(b){b=
n.processErrorMessage(b);angular.isDefined(b.errorList)&&0<b.errorList.length?f.requestInProgress=!1:(c.customerData=b,f.requestInProgress=!1,H.setStorageData("showExpressConsent",!1),e())},function(b){f.requestInProgress=!1})};c.closeConnectedCarTnc=function(){$("#temporary-modalTnC .modal.connected-car-tnc").modal("hide")};c.validatePromoCode=function(){k.setExpression({promocode:l.validatePromoCode.pc})};c.loadHelpModal=function(b){c.country=a.countrySelect?a.countrySelect:"US";c.helpURL=z.getUrl(b.target.parentElement,
country)};c.verifyProfileOtp=function(b){c.resendOtpSuccess=!1;c.resendOtpError=!1;var a=angular.element(b.target)[0].form.name;b=angular.element("[name\x3d'"+a+"']").controller("form");k.validate(b).success(function(){var b={otpNumber:c.profileOtp};f.requestInProgress=!0;w.validateOtp(b).then(function(b){b.errorList&&(b=n.processErrorMessage(b));b.errorList&&0<b.errorList.length?1==b.errorList.length&&("110033"==b.errorList[0].code?k.displayServiceError("vm.profileOtp","invalidotp",!1,a):"110034"==
b.errorList[0].code?k.displayServiceError("vm.profileOtp","expiredotp",!1,a):"110023"==b.errorList[0].code?V():k.displayServiceError("vm.profileOtp","genericotp",!1,a)):b.promptOtpFlag||(c.tdCheck=!0,setTimeout(function(){Q()},5),c.sectionInEdit="enroll-rewards-section",ka(),b=x.getSessionModel(),b.tdCheck=!0,x.setSessionModel(b));f.requestInProgress=!1},function(b){f.requestInProgress=!1})}).error(function(b){})};c.resendOtp=function(){c.resendOtpSuccess=!1;c.resendOtpError=!1;f.requestInProgress=
!0;w.generateOtp().then(function(b){f.requestInProgress=!1;b.errorList&&0<b.errorList.length?(n.processErrorMessage(b),c.resendOtpError=!0):b.promptOtpFlag?c.resendOtpSuccess=!0:!b.promptOtpFlag&&angular.isUndefined(b.errorList)&&(c.tdCheck=!0,b=x.getSessionModel(),b.tdCheck=!0,x.setSessionModel(b))},function(b){f.requestInProgress=!1;c.resendOtpError=!0})};c.unlinkAmazonProfile=function(){c.sectionInEdit="unlink-amazon-profile";angular.element(".unlink-prime-modal").modal("show")};c.deleteConfirm=
function(b,a,g,h){c.showUpdateMsg=!1;c.sectionDeleted=b;c.sectionInEdit=b;c.tempAccountModel=angular.copy(c.accountModel);if("discount-number-section"==b){if(2<a.length){angular.forEach(a,function(b,c){c!=g&&1==b.primary?(b.primary=!1,b.operation="delete"):c==g?(b.primary=!0,b.operation="update"):b.operation=""});for(var m=[],k=0;k<a.length;k++)""==a[k].operation&&m.push(k);for(k=m.length-1;0<=k;k--)a.splice(m[k],1)}else 2==a.length?angular.forEach(a,function(b){1==b.primary?(b.operation="delete",
b.primary=!1):(b.operation="update",b.primary=!0)}):1==a.length?angular.forEach(a,function(b){b.operation="delete"}):(a.operation="delete",m=[],m.push(a),a=m);$(".delete-"+b).modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove();f.requestInProgress=!0}else if("identity-password-section"==b)a.promoMails=angular.isDefined(a.promoMails)&&1==a.promoMails?"Y":"N",a.eRecieptEmailOptin=angular.isDefined(a.eRecieptEmailOptin)&&1==a.eRecieptEmailOptin?"Y":"N";else if("telephone-section"==
b)a.smsOptIn=angular.isDefined(a.smsOptIn)&&1==a.smsOptIn?"T":"N";else if("unlink-amazon-section"==b){angular.forEach(a,function(b,c){b.maskId!=g&&1==b.primary?(b.primary=!1,b.operation="delete"):b.maskId==g?(b.primary=!0,b.operation="update"):b.operation=""});m=[];for(k=0;k<a.length;k++)""==a[k].operation&&m.push(k);for(k=m.length-1;0<=k;k--)a.splice(m[k],1);$(".delete-"+b).modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove();f.requestInProgress=!0}"discount-number-section"!=
b&&"unlink-amazon-section"!=b&&(a.operation="delete",$(".delete-"+b+"-"+a.maskId).modal("hide"),$("body").removeClass("modal-open"),$(".modal-backdrop").remove());f.requestInProgress=!0;"credit-card-section"!=c.sectionInEdit||1!=c.accountModel.showDCC||a.type!=l.creditCardTypeVisaId&&a.type!==l.creditCardTypeMasterId||(a.dccPreference=c.accountModel.dccPreference);d.updateProfile(c.customerData,a,b).then(function(a){f.requestInProgress=!0;a=n.processErrorMessage(a);angular.isDefined(a.errorList)&&
0<a.errorList.length?(c.accountModel=angular.copy(c.tempAccountModel),"17414"==a.errorList[0].code&&(c.cdhError="Your details were not saved,please try again."),c.updateCdhUnAvailable(a),c.formError=a.errorList[0].message,c.deleteFail=!0,c.showUpdateMsg=!1,f.requestInProgress=!1,d.anchorToMsg(b,h)):(c.customerData=a,c.showDelete=!0,c.showUpdateMsg=!0,c.deleteFail=!1,c.updateCdhUnAvailable(a),f.requestInProgress=!1,d.anchorToMsg(b,h),L(!1),e())},function(b){angular.isDefined(b.errorList)&&0<b.errorList.length&&
(c.formError=b.errorList[0].message,c.updateCdhUnAvailable(data),c.formValidated=!0,c.showSuccessMsg=!1,c.deleteFail=!0);f.requestInProgress=!1})};c.loadGetStateBasedOnCounty=fa;c.displayCarClass=function(b,a){c.accountModel.carPreference&&angular.forEach(c.accountModel.carPreference,function(e){a==e.maskId&&angular.forEach(c.favouriteCars,function(c){b==c.makeModelCd&&(e.carClass=c.carGroup)})});c.addProperty.Car&&angular.forEach(c.favouriteCars,function(a){b==a.makeModelCd&&(c.addProperty.Car.carClass=
a.carGroup)})};c.updateCdhUnAvailable=function(b){angular.isDefined(c.customerData.cdhUnAvailable)&&1==c.customerData.cdhUnAvailable&&(c.cdhErrors=H.getStorageData("epCdhDownErrorList"),void 0==c.cdhErrors&&angular.isDefined(b)&&angular.isDefined(b.instructionList&&1<b.instructionList.length)&&(angular.forEach(b.instructionList,function(b){"17435"==b.code&&"INSTRUCTION"==b.type&&(c.cdhDownError=b.message)}),H.setStorageData("epCdhDownErrorList",c.cdhDownError)))};c.displayModel=function(b,a){angular.isDefined(c.addProperty.Car)&&
(c.addProperty.Car.carModelList=[],angular.forEach(c.favouriteCars,function(a){if(a.make==b){c.addProperty.Car.carModelList.push({makeModelCd:a.makeModelCd,modelName:a.model});var e=[];angular.forEach(c.addProperty.Car.carModelList,function(b){angular.isDefined(b)&&e.push(b)});c.addProperty.Car.carModelList=q("unique")(e,"modelName");c.addProperty.Car.makeModelCd=c.addProperty.Car.carModelList[0].makeModelCd;c.addProperty.Car.makeModelCd==a.makeModelCd&&(c.addProperty.Car.carClass=a.carGroup)}}));
c.accountModel.carPreference&&angular.forEach(c.accountModel.carPreference,function(e){a==e.maskId&&(e.carModelList=[],angular.forEach(c.favouriteCars,function(c){if(c.make==b){e.carModelList.push({makeModelCd:c.makeModelCd,modelName:c.model});var a=[];angular.forEach(e.carModelList,function(b){angular.isDefined(b)&&a.push(b)});e.carModelList=q("unique")(a,"modelName");e.makeModelCd=e.carModelList[0].makeModelCd;e.makeModelCd==c.makeModelCd&&(e.carClass=c.carGroup)}}))})};c._loadCountry=ea;c._loadDefaultCountry=
Y;c._setCreditCardSection=function(){if(angular.isDefined(c.customerData.ccSummary)&&angular.isDefined(c.customerData.ccSummary.supportedCctypes)&&0<c.customerData.ccSummary.supportedCctypes.length)var b=d.getCreditCardDetails(c.customerData.ccSummary);else angular.isDefined(c.customerData.partnerCustomerInfo)&&angular.isDefined(c.customerData.partnerCustomerInfo.ccSummary)&&angular.isDefined(c.customerData.partnerCustomerInfo.ccSummary.supportedCctypes)&&0<c.customerData.partnerCustomerInfo.ccSummary.supportedCctypes.length?
(angular.isDefined(c.customerData.ccSummary)&&angular.isDefined(c.customerData.ccSummary.type)&&0<c.customerData.ccSummary.type.length&&(c.customerData.partnerCustomerInfo.ccSummary.type=c.customerData.ccSummary.type),b=d.getCreditCardDetails(c.customerData.partnerCustomerInfo.ccSummary)):b=d.getCreditCardDetails();c.ccDetailList=b.masterListForCC;angular.isDefined(b.customerCcDetails)&&(c.credtiCardSectionToDisplay=!0,c.customerData.ccSummary.cardTypeValue=b.customerCcDetails.value,c.customerData.ccSummary.type=
b.customerCcDetails.code,c.creditCardType=b.customerCcDetails.value,c.accountModel.type=b.customerCcDetails.code);angular.isDefined(c.accountModel.creditCardList)&&angular.forEach(c.accountModel.creditCardList,function(a,e){a.supportedCctypes=c.customerData.ccSummary.supportedCctypes;b=d.getCreditCardDetails(a);angular.isDefined(b.customerCcDetails)&&(c.credtiCardSectionToDisplay=!0,a.cardTypeValue=b.customerCcDetails.value,a.type=b.customerCcDetails.code)});c.credtiCardSectionToDisplay||P("credit-card-section");
c.customerData.conflictCDBPartnerFlag&&"credit-card-section"==c.conflictedSection&&(c.credtiCardSectionToDisplay=!1,P("credit-card-section"),c.formValidated=!0,c.sectionInEdit="credit-card-section",c.formError=c.customerData.errorList[0].message)};c._setDlSection=function(){c.countryListForDriverLicense=G.getCountryList(c.customerData,a.countryListForDriverLicense);if(angular.isDefined(c.countryListForDriverLicense)&&0<c.countryListForDriverLicense.length&&angular.isDefined(c.customerData)&&angular.isDefined(c.customerData.dlSummary)&&
angular.isDefined(c.customerData.dlSummary.dlNumber)&&""!==c.customerData.dlSummary.dlNumber){c.showDOBField=!1;c.dlSectionDisplay=!0;for(var b=0;b<c.countryListForDriverLicense.length;b++)if(c.countryListForDriverLicense[b].code==c.customerData.dlSummary.country){c.dlCountryName=c.countryListForDriverLicense[b].name;for(var e=c.countryListForDriverLicense[b].stateList,d=0;d<e.length;d++)e[d].stateCode==c.customerData.dlSummary.state&&(c.dlStateName=e[d].stateName)}}else c.showDOBField=!0;angular.isDefined(c.customerData)&&
angular.isDefined(c.customerData.dlSummary)&&angular.isDefined(c.customerData.dlSummary.country)?c.statesForDL=G.getStateListBasedOnCounty(c.customerData.dlSummary.country,c.countryListForDriverLicense).statesForDL:angular.isDefined(c.accountModel.dlSummary.country)&&(c.statesForDL=G.getStateListBasedOnCounty(c.accountModel.dlSummary.country,c.countryListForDriverLicense).statesForDL);c.hideDLState=angular.isUndefined(c.statesForDL)||"Not Applicable"==c.statesForDL[0].stateCode?!0:!1;1==c.hideDLState&&
(c.accountModel.dlSummary.state="Not Applicable");"dl-section"==c.customerData.enrollmentStep&&(P("dl-section"),I.analyticsDimension(c.customerData,"driver-license"))};c._loadMnthYrDropdown=da;c._loadLanguagePreference=ba;c._dateTimeFormatDropDown=ca;c._setProtectionCoverageSection=function(){angular.isDefined(d.getCreateStatus())&&d.getCreateStatus().protectionStatus?c.protectionCoverageSectionDisplay=!0:angular.isDefined(c.customerData.insuranceMap)&&(angular.forEach(c.customerData.insuranceMap,
function(b){angular.equals(b.value,!0)&&(c.insuranceOpted=!0)}),!c.dlSectionDisplay||c.customerData.preferred||c.insuranceOpted?c.protectionCoverageSectionDisplay=!0:(P("protections-coverages-section"),c.protectionCoverageSectionDisplay=!1,angular.isDefined(c.customerData.profileCompletionPercentage)&&50<=c.customerData.profileCompletionPercentage&&70>=c.customerData.profileCompletionPercentage&&I.analyticsDimension(c.customerData,"protections-coverages")));c.customerData.conflictCDBPartnerFlag&&
"protections-coverages-section"==c.conflictedSection&&(P("protections-coverages-section"),c.protectionCoverageSectionDisplay=!1,c.formValidated=!0,c.sectionInEdit="protections-coverages-section",c.formError=c.customerData.errorList[0].message)};c._setTermsConditionSection=ja;c._loadCarPreferenceList=function(){if(-1!=a.location.href.indexOf("preferences")){var b=angular.isDefined(c.hasPartnerInfo)&&angular.isDefined(c.customerData.partnerCustomerInfo.carGroupPreferences)?c.customerData.partnerCustomerInfo.carGroupPreferences:
"";d.getCarPreferenceList(c.customerData.cor,c.customerData.carPreference,b).then(function(b){c.carGroupPreferenceList=b.carList;c.carGroupPreferredName=b.selectedCar})}};c._setEnrollRewardsSection=function(){1==c.customerData.preferred&&"enroll-rewards-section"==c.customerData.enrollmentStep&&c.customerData.loyaltyEligible.visible?(c.displayFTPSection=!0,S(),P("enroll-rewards-section"),I.analyticsDimension(c.customerData,""),c.rewardsSectionDisplay=!0,angular.isDefined(c.getAvisPreferredTermsList)&&
""!=c.getAvisPreferredTermsList&&(c.customerData.expressConsentTerms?(c.showTnCModal=z.gettermsMapURL(c.getAvisPreferredTermsList,c.domain)+".partial.html",c.rewardPreferredTnC=!0,c.accountModel.showConnectedCarTncModal=!0):c.rewardPreferredTnC=!1)):(c.customerData.loyaltyEligible.visible||S(),angular.isDefined(c.customerData.profileCompletionPercentage)&&100==c.customerData.profileCompletionPercentage&&I.analyticsDimension(c.customerData,""),c.rewardsSectionDisplay=!1)};c._getPartnerDetails=S;c._initPopoverOnModal=
W;c._loadCalendarDropdown=U;c._loadEditSection=Z;c._setFreqPickUpLoc=aa;c._getSectionInEdit=R;c._checkForConnectedCarTnCModalDisplay=X;c._checkForPartnerCustomerInfo=J;c._checkForExpiredCC=O;c._clearPasswordFields=T;c._setValueForPromoEmails=D;c._setAddressDetails=Q;c._setTnCLink=g;c._loadEmail=function(){angular.forEach(c.accountModel.profileIdentity.emails,function(b){b.promoMails=!angular.isDefined(b.promoMails)||"Y"!=b.promoMails&&1!=b.promoMails?!1:!0;b.eRecieptEmailOptin=!angular.isDefined(b.eRecieptEmailOptin)||
"Y"!=b.eRecieptEmailOptin&&1!=b.eRecieptEmailOptin?!1:!0;b.prefilledemail=b.email});angular.forEach(c.accountModel.contactAddress.telephone,function(b){angular.isDefined(b.smsOptIn)&&(b.smsOptIn=!angular.isDefined(b.smsOptIn)||"T"!=b.smsOptIn&&1!=b.smsOptIn?!1:!0)});angular.forEach(c.accountModel.contactAddress.address,function(b){b.prefilledZipCode=b.zipCode});angular.isUndefined(c.customerData.contacts.phoneNumbers)||""==c.customerData.contacts.phoneNumbers?(c.addProperty.phone={primary:!1},c.primaryPhone=
!0):(c.addProperty.phone={primary:!1},c.primaryPhone=!1);if(c.amazonUserStatus==l.amazonLinked)for(var b=0;b<c.accountModel.tempAwdList.length;b++)"-1"==c.accountModel.tempAwdList[b].maskId&&(c.amazonPrimaryValue=c.accountModel.tempAwdList[b].primary,c.accountModel.tempAwdList.splice(b,1));2>c.accountModel.awd.length&&(1>c.accountModel.awd.length?c.primaryAwd=!0:1==c.accountModel.awd.length?c.amazonUserStatus==l.amazonLinked&&0==c.amazonPrimaryValue&&(c.primaryAwd=!0):c.primaryAwd=!1)};c.saveProfile=
function(b,a,e,d,g,m,h,k){if(angular.isDefined(e)&&(1==e||"T"==e)&&angular.isDefined(a))c.validatePhoneNumber(b,a,e,d,g,m,h,k);else if("dl-section"==d&&c.saveProfileDetail(g,h),"telephone-section"==d||"address-telephone-section"==d)"AU"===c.domain||"NZ"===c.domain?(angular.isDefined(a)&&(a.startsWith("0000")?(c.invalidPhoneNumber=!0,f.requestInProgress=!1,C.scrollTo("profileAddressForm")):(c.invalidPhoneNumber=!1,f.requestInProgress=!0)),c.invalidPhoneNumber||c.saveDetails(g,m,h,k)):c.saveDetails(g,
m,h,k)};c.setPassword=function(){jQuery("html,body").animate({scrollTop:$("#identityPasswordSection").offset().top+150},"slow")};c.custDetailsUpdate=function(){var b=c.customerData,a=c.accountModel;c.reqField=!1;c.sectionInEdit="customer-details-section";"customer-details-section"==c.sectionInEdit&&(void 0!=b.contacts.email[0]&&angular.isDefined(b.contacts.phoneNumbers)?(a.enteredEmail=c.custDetailsUpdateEmail,a.emailMaskId="1",a.primaryEmail="true",a.emailOperation="update",a.enteredPhone=b.contacts.cellPhone,
a.primaryPhoneNo="true",a.phoneMaskId="1",a.phoneOperation="update"):void 0==b.contacts.email[0]||angular.isDefined(b.contacts.phoneNumbers)?void 0==b.contacts.email[0]&&angular.isDefined(b.contacts.phoneNumbers)?(angular.isDefined(c.modelEmailAddress)&&""!=c.modelEmailAddress?a.enteredEmail=c.modelEmailAddress:(c.reqField=!0,jQuery("#emailAddErr")[0].innerHTML="\x3cspan class\x3d'error'\x3e"+Dictionary.I18n.get("err.res.checkout.email.required")+"\x3c/span\x3e",c.reqField&&""!=jQuery("#emailAddErr")[0].innerText&&
jQuery(".platform-error-message").hide()),a.emailMaskId=" ",a.primaryEmail="true",a.emailOperation="add",a.enteredPhone=b.contacts.cellPhone,a.primaryPhoneNo="true",a.phoneMaskId="1",a.phoneOperation="update"):(angular.isDefined(c.modelEmailAddress)&&""!=c.modelEmailAddress?a.enteredEmail=c.modelEmailAddress:(c.reqField=!0,jQuery("#emailAddErr")[0].innerHTML="\x3cspan class\x3d'error'\x3e"+Dictionary.I18n.get("err.res.checkout.email.required")+"\x3c/span\x3e",c.reqField&&""!=jQuery("#emailAddErr")[0].innerText&&
jQuery(".platform-error-message").hide()),a.emailMaskId=" ",a.primaryEmail="true",a.emailOperation="add",angular.isDefined(c.modelPhoneNumber)&&""!=c.modelPhoneNumber?a.enteredPhone=c.modelPhoneNumber:(c.reqField=!0,jQuery("#phoneReqError")[0].innerHTML="\x3cspan class\x3d'error'\x3e"+Dictionary.I18n.get("117")+" \x3c/span\x3e",c.reqField&&""!=jQuery("#phoneReqError")[0].innerText&&jQuery(".platform-error-message").hide()),a.primaryPhoneNo="true",a.phoneMaskId=" ",a.phoneOperation="add"):(a.enteredEmail=
b.contacts.email[0].email,a.emailMaskId="1",a.primaryEmail="true",a.emailOperation="update",angular.isDefined(c.modelPhoneNumber)&&""!=c.modelPhoneNumber?a.enteredPhone=c.modelPhoneNumber:(c.reqField=!0,jQuery("#phoneReqError")[0].innerHTML="\x3cspan class\x3d'error'\x3e"+Dictionary.I18n.get("117")+" \x3c/span\x3e",c.reqField&&""!=jQuery("#phoneReqError")[0].innerText&&jQuery(".platform-error-message").hide()),a.primaryPhoneNo="true",a.phoneMaskId=" ",a.phoneOperation="add"),setTimeout(function(){d.updateProfile(b,
a,c.sectionInEdit).then(function(b){b=n.processErrorMessage(b);angular.isDefined(b.errorList)&&0<b.errorList.length?(angular.isDefined(b.fieldErrors)&&"invalid"==b.fieldErrors[0].classifier&&(jQuery("#invalidEmailMessage")[0].innerHTML="\x3cspan class\x3d'error'\x3e"+Dictionary.I18n.get("err.res.checkout.email.invalid")+"\x3c/span\x3e"),f.requestInProgress=!1):(c.customerData=b,f.requestInProgress=!1,jQuery(".customer-details-modal").modal("hide"),$(".modal-backdrop").remove(),jQuery(".confirmed-modal").modal("show"))},
function(b){f.requestInProgress=!1})},100))};c.clearEmailPhoneError=function(){$("#phoneReqError").find("span").remove();$("#emailAddErr").find("span").remove();$("#invalidEmailMessage").find("span").remove()};c.reloadPage=function(){a.location.reload(!0)};c.validateEmailPhoneNo=!1;c.initiateMitekVerification=function(){m.addGTMScript();A.trackMitekVerEventsDuringProfileEnroll("START_SCAN_CTA","Click",c.customerData.customerInfo);a.location.href=f.contextPath+"/"+f.locale+a.contentRoot+"/biometric-validation/mitek-validation"+
htmlExtension+"#/front-scan"};c.showManualDlForm=function(){m.addGTMScript();A.trackMitekVerEventsDuringProfileEnroll("ENTER_MANUAL_CTA","Click",c.customerData.customerInfo);c.isEnterManual=!0};var K=[{key:"01",desc:"janvier"},{key:"02",desc:"f\u00e9vrier"},{key:"03",desc:"mars"},{key:"04",desc:"avril"},{key:"05",desc:"mai"},{key:"06",desc:"juin"},{key:"07",desc:"juillet"},{key:"08",desc:"ao\u00fbt"},{key:"09",desc:"septembre"},{key:"10",desc:"octobre"},{key:"11",desc:"novembre"},{key:"12",desc:"d\u00e9cembre"}];
f.$on("Profile.CustomerAdditionalInfo",function(b,e){c.customerData=e;if("US"==c.customerData.cor||"CA"==c.customerData.cor)c.showBiometricScan=!0;c.showPrefilled=H.getStorageData("dlVerifiedWithMitek");c.showPrefilled&&c.customerData.dlSummary?(console.log(JSON.stringify(c.customerData.dlSummary)),c.countryListForBiometricDl=G.getCountryList(c.customerData,a.countryListForDriverLicense),angular.isDefined(c.countryListForBiometricDl)&&c.countryListForBiometricDl.length&&(b=c.countryListForBiometricDl.indexOf(q("filter")(c.countryListForBiometricDl,
function(b){return b.code===c.customerData.dlSummary.country})[0]),c.dlCountryName=c.countryListForBiometricDl[b].name),A.trackMitekVerEventsDuringProfileEnroll("PREFILLED_DL","Success",c.customerData)):c.showPrefilled&&!angular.isDefined(c.customerData.dlSummary)&&A.trackMitekVerEventsDuringProfileEnroll("PREFILLED_DL","Failure",c.customerData);b=x.getSessionModel();angular.isDefined(b)&&angular.isDefined(b.tdCheck)&&(c.tdCheck=b.tdCheck);angular.isDefined(c.customerData.cor)&&("us"==c.customerData.cor.toLowerCase()||
"ca"==c.customerData.cor.toLowerCase())&&a.brand==l.brandName.AVIS&&angular.isDefined(c.customerData.userState)&&"AUTHENTICATED"==c.customerData.userState&&(c.multiValuesEnable=!0);v()});f.$on("Profile.SelfInvoke",function(b,a){c.customerData=a;v()});c.updateProfileCC={formObj:"",index:"",profileForm:"",submit:function(b,a,e,g){c.updateProfileCC.formObj=a;c.updateProfileCC.index=g;c.updateProfileCC.profileForm=b;"addCreditCardForm"===b.$name&&angular.isDefined(c.updateProfileCC.formObj.primary)&&
1==c.updateProfileCC.formObj.primary&&(c.showMessage=!0);"creditCardFieldForm"===b.$name&&angular.isDefined(c.updateProfileCC.formObj.primary)&&1==c.updateProfileCC.formObj.primary&&0!=c.updateProfileCC.index&&(c.showMessage=!1);"credit-card-section"!=c.sectionInEdit||1!=c.accountModel.showDCC||c.updateProfileCC.formObj.type!=l.creditCardTypeVisaId&&c.updateProfileCC.formObj.type!==l.creditCardTypeMasterId||(c.updateProfileCC.formObj.dccPreference=c.accountModel.dccPreference);"credit-card-section"==
c.sectionInEdit&&"AV"==c.updateProfileCC.formObj.type&&(c.updateProfileCC.formObj.expMonth="",c.updateProfileCC.formObj.expYear="");k.validate(b).success(function(){f.requestInProgress=!0;c.updateProfileCC.validationSuccess()}).error(function(b){c.updateProfileCC.formObj.secureCode="";c.formError=2<=b.errorCount?Dictionary.I18n.get("err.global.multi.errorMessage"):b.MSG[0];c.formValidated=!0;c.showSuccessMsg=!1;f.requestInProgress=!1;c.updateCdhUnAvailable(b);1<b.errorCount||!c.formValidated&&c.cdhError?
d.anchorToMsg(c.sectionInEdit):1==b.errorCount&&document.getElementsByName(b.fieldName)[0].focus()})},validationSuccess:function(){"true"==enableCaptcha?grecaptcha.execute():c.updateProfileCC.successCreditCardUpdate()},successCreditCardUpdate:function(){d.updateProfile(c.customerData,c.updateProfileCC.formObj,c.sectionInEdit,c.recaptcha).then(function(b){b=n.processErrorMessage(b);angular.isDefined(b.errorList)&&0<b.errorList.length?(c.formError="06042"==b.errorList[0].code?n.$eval(b.errorList[0].message):
b.errorList[0].message,"17414"==b.errorList[0].code&&(c.cdhError="Your details were not saved,please try again."),c.formValidated=!0,c.showUpdateMsg=!1,f.requestInProgress=!1,c.updateCdhUnAvailable(b),!c.formValidated&&c.cdhError&&d.anchorToMsg(c.sectionInEdit,c.updateProfileCC.index),ABG.resetCaptcha(!0)):(c.customerData=b,c.formValidated=!1,c.showUpdateMsg=!0,c.showSuccessMsg=!0,f.requestInProgress=!1,c.updateCdhUnAvailable(b),d.anchorToMsg(c.sectionInEdit,c.updateProfileCC.index),L(!1),e(),$(".add-"+
c.sectionInEdit).modal("hide"),$("body").removeClass("modal-open"),"true"==enableCaptcha&&ABG.resetCaptcha(!0))},function(b){angular.isDefined(b.errorList)&&0<b.errorList.length&&(c.formError=b.errorList[0].message,c.updateCdhUnAvailable(data),c.formValidated=!0,c.showSuccessMsg=!1);c.updateProfileCC.formObj.secureCode="";!c.formValidated&&c.cdhError&&d.anchorToMsg(c.sectionInEdit,c.updateProfileCC.index);f.requestInProgress=!1;ABG.resetCaptcha(!0)})}};c.saveProfileCC={profileForm:"",submit:function(b){c.saveProfileCC.profileForm=
b;k.validate(b).success(function(){f.requestInProgress=!0;c.saveProfileCC.validationSuccess()}).error(function(b){c.accountModel.secureCode="";c.formError=ABG.getFormValidationError(b,!1)[0].message;c.formValidated=!0;c.showSuccessMsg=!1;f.requestInProgress=!1;1<b.errorCount?d.anchorToMsg(c.sectionInEdit):1==b.errorCount&&document.getElementsByName(b.fieldName)[0].focus()})},validationSuccess:function(){"true"==enableCaptcha?grecaptcha.execute():c.saveProfileCC.successCreditCardUpdate()},successCreditCardUpdate:function(){var b=
c.accountModel;"credit-card-section"==c.sectionInEdit&&(!angular.isDefined(c.accountModel.ccSummary.maskId)||angular.isDefined(c.accountModel.ccSummary.maskId)&&""==c.accountModel.ccSummary.maskId)?(b=c.accountModel.ccSummary,b.primary=!0):"credit-card-section"==c.sectionInEdit&&(b=c.accountModel.ccSummary,b.operation="update",b.dccPreference=c.accountModel.dccPreference);d.updateProfile(c.customerData,b,c.sectionInEdit,c.recaptcha).then(function(b){b=n.processErrorMessage(b);if(angular.isDefined(b.errorList)&&
0<b.errorList.length)c.accountModel.secureCode="",c.formError="06042"==b.errorList[0].code?n.$eval(b.errorList[0].message):b.errorList[0].message,c.updateCdhUnAvailable(b),c.formValidated=!0,c.showSuccessMsg=!1,f.requestInProgress=!1,d.anchorToMsg(c.sectionInEdit),ABG.resetCaptcha(!0);else{c.customerData=b;a.brand==l.brandName.AVIS&&"profile-completed"!=c.customerData.enrollmentStep&&f.$broadcast("Profile.SelfInvoke",b);var g=m.getReservationModel();angular.isDefined(g)&&angular.isDefined(g.coupon)&&
angular.isDefined(g.coupon.discountNumber)&&angular.isDefined(c.customerData.awd)&&""!=c.customerData.awd&&(g.coupon.discountNumber=c.customerData.awd[0].discountNumber);c.formValidated=!1;c.showSuccessMsg=!0;c.updateCdhUnAvailable(b);f.requestInProgress=!1;d.anchorToMsg(c.sectionInEdit);L(!1);e();"true"==enableCaptcha&&ABG.resetCaptcha(!0)}},function(b){angular.isDefined(b.errorList)&&0<b.errorList.length&&(c.formError=b.errorList[0].message,c.formValidated=!0,c.showSuccessMsg=!1);c.accountModel.secureCode=
"";f.requestInProgress=!1;ABG.resetCaptcha(!0)})}};$(".wrap-dashboard").on("click",".wrap-toggle-link",function(b){b=$(this);var c=b.parent().find(".wrap-toggle-text");b.hasClass("view-more")?(b.text(b.data("viewlesslabel")).addClass("view-less").removeClass("view-more"),c.removeClass("hidden-xs")):(b.text(b.data("viewmorelabel")).addClass("view-more").removeClass("view-less"),c.addClass("hidden-xs"))});n.$on("AugCompleteBlurEvent",function(b,c){ia(angular.isDefined(c.userInput)&&!angular.equals(c.userInput,
""),"frequentLocation","text")});n.$on("Profile.ShowSaveCancelMsg",function(b,a){c.showSectionMessage=a});f.$on("Partner.partnerInfo",function(b,a){angular.isDefined(a)&&(c.amazonUserStatus=x.amazonLoginStatus())});u=u("MyProfileExnController",{$scope:n});setTimeout(function(){var b=$(".wrap-profile-progress").find(".card-outer-content:visible");b.find(".card-inner-content").addClass("editable-mode");b.find(".modal").modal("show")},1500);angular.extend(this,u);f.$on("recaptcha",function(b,a){c.recaptcha=
a;angular.isDefined(a)&&""!=a&&("creditCardFieldForm"===c.updateProfileCC.profileForm.$name||"addCreditCardForm"===c.updateProfileCC.profileForm.$name?c.updateProfileCC.successCreditCardUpdate():"profileCreditCardForm"===c.saveProfileCC.profileForm.$name&&c.saveProfileCC.successCreditCardUpdate())});angular.element(document).ready(function(){setTimeout(function(){angular.isDefined(c.customerData)&&c.customerData.passwordGraceWindow&&(C.scrollTo("changePasswordForm"),angular.element("#edit-password").click(),
c.resetPwdMsg=Dictionary.I18n.get("err.msg.profile.resetPassword"));angular.isDefined(c.customerData)&&angular.isDefined(c.customerData.creditCardList)&&1<=c.customerData.creditCardList.length&&(angular.isDefined(c.customerData.creditCardList[0])&&angular.isDefined(c.customerData.creditCardList[0].badCard)&&1==c.customerData.creditCardList[0].badCard||angular.isDefined(c.customerData.creditCardList[1])&&angular.isDefined(c.customerData.creditCardList[1].badCard)&&1==c.customerData.creditCardList[1].badCard||
angular.isDefined(c.customerData.creditCardList[2])&&angular.isDefined(c.customerData.creditCardList[2].badCard)&&1==c.customerData.creditCardList[2].badCard||angular.isDefined(c.customerData.creditCardList[3])&&angular.isDefined(c.customerData.creditCardList[3].badCard)&&1==c.customerData.creditCardList[3].badCard?c.showAlertIcon=!0:c.showAlertIcon=!1);c.session=x.getSessionModel();angular.isDefined(c.session)&&c.session.status==l.userStateAuthenticated&&angular.isDefined(c.customerData)&&angular.isDefined(c.customerData.webCustomer)&&
(""==c.customerData.contacts.email||void 0==c.customerData.contacts.phoneNumbers||c.customerData.webCustomer.promptContactInfoValidation)&&(angular.element(".customer-details-modal").modal("show"),angular.isDefined(c.customerData.contacts.phoneNumbers)||angular.element("#phoneNum").addClass("platform-element-error"),""==c.customerData.contacts.email&&angular.element("#emailAddr").addClass("platform-element-error"),angular.isDefined(c.customerData.contacts.email[0])&&angular.isDefined(c.customerData.contacts.email[0].email)&&
(c.custDetailsUpdateEmail=c.customerData.contacts.email[0].email))},2E3)})}angular.module("account").controller("MyProfileController",t);t.$inject="$controller $scope $window $cookies signupService myProfileService $validation carRentalConstant $filter authenticationService $rootScope getVehicles datePickerInit $locale rewardsProgramService locationService anchorSmoothScroll $compile accountUtilityService accountgaService reservationModelService securityService storageService gaService".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,z,t,B,y,F){function C(a){m.hideCVV="AV"==a?!1:!0;m.hideExpMonthYear="AV"==a?!1:!0;m.isCVVMandatory="CX"==a||"CM"==a||"CA"==a||"CS"==a||"CD"==a||"CJ"==a?!0:!1}function r(){var a=t.loadMnthYrDropdown();m.expMonths=a.expMonths;m.expYears=a.expYears;var d=[];angular.isDefined(m.customerResponce.customerInfo)&&angular.isDefined(m.customerResponce.customerInfo.ccSummary)&&angular.isDefined(m.customerResponce.customerInfo.ccSummary.expDate)?d=m.customerResponce.customerInfo.ccSummary.expDate.split("/"):
angular.isDefined(m.customerResponce.partnerCustomerInfo)&&angular.isDefined(m.customerResponce.partnerCustomerInfo.ccSummary)&&angular.isDefined(m.customerResponce.partnerCustomerInfo.ccSummary.expDate)&&(d=m.customerResponce.partnerCustomerInfo.ccSummary.expDate.split("/"));angular.isDefined(d.length)&&0<d.length&&(a=m.expMonths.indexOf(x("filter")(m.expMonths,function(a){return a.key==d[0]})[0]),-1!=a&&(m.accountModel.expMonth=m.expMonths[a].key),m.accountModel.expYear=d[2])}function G(){if("US"==
m.domain||"CA"==m.domain)var a=m.hasPartnerInfo?angular.isDefined(m.customerResponce.partnerCustomerInfo.ccSummary)?k.getCreditCardDetails(m.customerResponce.partnerCustomerInfo.ccSummary):k.getCreditCardDetails():k.getCreditCardDetails();if("AU"==m.domain||"NZ"==m.domain)a=m.hasPartnerInfo?angular.isDefined(m.customerResponce.partnerCustomerInfo.ccSummary)?k.getCreditCardDetails(m.customerResponce.partnerCustomerInfo.ccSummary):k.getCreditCardDetails():angular.isDefined(m.customerResponce.customerInfo.ccSummary)?
k.getCreditCardDetails(m.customerResponce.customerInfo.ccSummary):k.getCreditCardDetails();m.ccDetailList=a.masterListForCC;m.ccDetailListAUNZ=a.masterListForCCAUNZ;m.customerResponce.customerInfo&&angular.isDefined(m.customerResponce.customerInfo.ccSummary)&&angular.isDefined(m.customerResponce.customerInfo.ccSummary.number)?(m.creditCardType=m.customerResponce.customerInfo.ccSummary.number,m.accountModel.cardType=m.customerResponce.customerInfo.ccSummary.type):angular.isDefined(a.customerCcDetails)&&
(m.creditCardType=a.customerCcDetails.value,m.accountModel.cardType=a.customerCcDetails.code)}function I(){y.accountSummaryload("preferredFlow").then(function(a){m.customerResponce=a;angular.isDefined(m.customerResponce.customerInfo)&&angular.isDefined(m.customerResponce.customerInfo.profileCompletionPercentage)&&angular.isDefined(m.customerResponce.customerInfo.profCompStep)&&(m.customerData.profileCompletionPercentage=m.customerResponce.customerInfo.profileCompletionPercentage,m.customerData.profCompStep=
m.customerResponce.customerInfo.profCompStep);angular.isDefined(m.customerResponce)&&angular.isDefined(m.customerResponce.partnerCustomerInfo)&&!angular.equals({},m.customerResponce.partnerCustomerInfo)?m.hasPartnerInfo=!0:m.hasPartnerInfo=!1;m.hasPartnerInfo&&angular.isDefined(m.customerResponce.partnerCustomerInfo.partnerType)&&"PARTNER_CBP"==m.customerResponce.partnerCustomerInfo.partnerType&&h.$broadcast("CBPImageName",m.customerResponce.partnerCustomerInfo);!angular.isDefined(m.customerResponce.partnerCustomerInfo)||
angular.isDefined(m.customerResponce.customerInfo)&&angular.isDefined(m.customerResponce.customerInfo.ccSummary)&&angular.isDefined(m.customerResponce.customerInfo.ccSummary.number)?m.accountModel=k.getAccountData(m.customerResponce.customerInfo):m.accountModel=k.getAccountData(m.customerResponce.partnerCustomerInfo);angular.isDefined(m.customerResponce.displayControl)&&angular.isDefined(m.customerResponce.displayControl.enrollmentStep)&&(a=m.customerResponce.displayControl.enrollmentStep,m.customerData.enrollmentStep=
a,k.triggerEditMode(void 0,!0,a));r();G();C()},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&(m.formError=a.errorList[0].message,m.formValidated=!0);h.requestInProgress=!1})}u("ExceptionHandlerController",{$scope:n});var m=this,w=!0;m.hideExpMonthYear=!0;m.hasPartnerInfo=!1;m.captchaFlag=!1;m.enableCaptcha=enableCaptcha;m.customerData={};m.customerData.preferred=!0;m.hideCVV=!0;m.tdCheck=!0;m.formValidated=!1;m.domain=p.domain.toUpperCase();m.onChangeCreditCardType=C;m._setCreditCardSection=
G;m._loadMnthYrDropdown=r;h.$on("initSuccess",function(a,d){w&&I()});m.saveCredit={submit:function(a,d){h.requestInProgress=!0;m.sectionInEdit=k.getSectionInEdit(d);f.validate(a).success(function(){m.saveCredit.validationSuccess()}).error(function(a){m.accountModel.secureCode="";m.formError=ABG.getFormValidationError(a,!1)[0].message;m.formValidated=!0;h.requestInProgress=!1;1<a.errorCount?k.anchorToMsg(m.sectionInEdit):1==a.errorCount&&document.getElementsByName(a.fieldName)[0].focus()})},validationSuccess:function(){"true"==
enableCaptcha?grecaptcha.execute():m.saveCredit.successCreditCardUpdate()},successCreditCardUpdate:function(){var a=m.accountModel;"credit-card-section"==m.sectionInEdit&&(!angular.isDefined(m.accountModel.ccSummary.maskId)||angular.isDefined(m.accountModel.ccSummary.maskId)&&""==m.accountModel.ccSummary.maskId)&&(a=m.accountModel.ccSummary,a.primary=!0,k.updateProfile(m.customerResponce.customerInfo,a,m.sectionInEdit,m.recaptcha).then(function(a){a=n.processErrorMessage(a);angular.isDefined(a.errorList)&&
0<a.errorList.length?(m.accountModel.secureCode="",m.formError=a.errorList[0].message,m.formValidated=!0,h.requestInProgress=!1,k.anchorToMsg(m.sectionInEdit)):(a=B.rulesToRedirect(a),p.location.href=a)},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&(m.formError=a.errorList[0].message,m.formValidated=!0,k.anchorToMsg(m.sectionInEdit),"true"==enableCaptcha&&ABG.resetCaptcha(!0));m.accountModel.secureCode="";h.requestInProgress=!1}));"true"==enableCaptcha&&ABG.resetCaptcha(!0)}};
$(".enrollment-form").on("click",".wrap-toggle-link",function(a){a=$(this);var d=a.parent().find(".wrap-toggle-text");a.hasClass("view-more")?(a.text(a.data("viewlesslabel")).addClass("view-less").removeClass("view-more"),d.removeClass("hidden-xs")):(a.text(a.data("viewmorelabel")).addClass("view-more").removeClass("view-less"),d.addClass("hidden-xs"))});(function(){F.addGTMScript();var a=$("#profileCreditCardForm");angular.isDefined(m.captchaFlag)&&1==a.length&&(m.captchaFlag=!0);angular.isDefined(d.getXsrfToken())&&
(w=!1,I())})();h.$on("recaptcha",function(a,d){m.recaptcha=d;angular.isDefined(d)&&""!=d&&m.saveCredit.successCreditCardUpdate()})}angular.module("account").controller("PreferredCreditCardController",t);t.$inject="$controller $scope carRentalConstant $rootScope $window authenticationService myProfileService datePickerInit $locale $filter $validation rewardsProgramService accountUtilityService signupService getVehicles reservationModelService".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,z,t,B,y,F,C,r,G,I){function m(){e.countryList=t.getCountryList();e.accountModel.dlSummary.country=angular.isDefined(e.customerResponce.customerInfo.dlSummary)&&angular.isDefined(e.customerResponce.customerInfo.dlSummary.country)?e.customerResponce.customerInfo.dlSummary.country:e.customerResponce.customerInfo.cor;w(e.accountModel.dlSummary.country);e.showSmsOptIn="US"==e.customerResponce.customerInfo.cor||"CA"==e.customerResponce.customerInfo.cor?!0:!1}
function w(a,d){a=angular.isDefined(d)&&0<d.length?t.getStateListBasedOnCounty(a,d):t.getStateListBasedOnCounty(a,e.countryList);e.adrTelCountryName=a.countryName;e.statesForDL=a.statesForDL;e.hideDLState=(angular.isUndefined(e.statesForDL)||"Not Applicable"==e.statesForDL[0].stateCode)&&angular.isDefined(e.customerResponce.displayControl&&e.customerResponce.displayControl.enrollmentStep)&&"dl-section"==e.customerResponce.displayControl.enrollmentStep?!0:!1;1==e.hideDLState&&angular.isDefined(e.accountModel.dlSummary.state)?
e.accountModel.dlSummary.state="Not Applicable":angular.isDefined(e.accountModel.dlSummary.state)&&(e.accountModel.dlSummary.state=null);angular.isDefined(e.statesForDL)&&x("filter")(e.statesForDL,{stateCode:e.accountModel.dlSummary.state})[0]&&(e.disableDLState=!0);angular.isDefined(e.accountModel.dlSummary.state)&&angular.isDefined(e.statesForDL)&&""==e.accountModel.dlSummary.state&&1<e.statesForDL.length&&(e.accountModel.dlSummary.state=null)}function H(){var d=e.hasPartnerInfo?angular.isDefined(e.customerResponce.partnerCustomerInfo.minAge)?
e.customerResponce.partnerCustomerInfo.minAge:a.ageLimit.lower:a.ageLimit.lower;d=t.loadCalendarDropdown(d);e.monthsList=d.monthsList;e.yearsList=d.yearsList;e.datesList=d.datesList;if(angular.isDefined(e.customerResponce.customerInfo)&&angular.isDefined(e.customerResponce.customerInfo.dlSummary)&&angular.isUndefined(e.customerResponce.customerInfo.dlSummary.dlNumber)&&angular.isDefined(e.customerResponce.partnerCustomerInfo)&&angular.isDefined(e.customerResponce.partnerCustomerInfo.dob)&&angular.isDefined(e.monthsList)&&
""!=e.monthsList&&0<e.monthsList.length&&angular.isDefined(e.accountModel)){var g=e.customerResponce.customerInfo.dob.split("/");d=e.monthsList.indexOf(x("filter")(e.monthsList,function(a){return a.key==g[0]})[0]);angular.isDefined(d)&&-1!=d&&(e.accountModel.dobMonth=e.monthsList[d].key);e.accountModel.dobDate=g[1];e.accountModel.dobYear=g[2]}}function A(){e.accountModel.dlSummary.telephone=e.customerResponce.customerInfo.cellPhone;e.countryListForDriverLicense=t.getCountryList(e.customerResponce,
p.countryListForDriverLicense);angular.isDefined(e.customerResponce)&&angular.isDefined(e.customerResponce.customerInfo)&&angular.isDefined(e.customerResponce.customerInfo.dlSummary)&&angular.isDefined(e.customerResponce.customerInfo.dlSummary.country)&&(e.statesForDL=t.getStateListBasedOnCounty(e.customerResponce.customerInfo.dlSummary.country,e.countryListForDriverLicense).statesForDL);if(e.statesForDL&&angular.isDefined(e.customerResponce.partnerCustomerInfo)&&angular.isDefined(e.customerResponce.partnerCustomerInfo.dlSummary)&&
angular.isDefined(e.customerResponce.partnerCustomerInfo.dlSummary.state)&&""!==e.customerResponce.customerInfo.dlSummary.state){var a=e.statesForDL.indexOf(x("filter")(e.statesForDL,function(a){return a.stateCode.toUpperCase()===e.customerResponce.partnerCustomerInfo.dlSummary.state.toUpperCase()||a.stateName.toUpperCase()===e.customerResponce.partnerCustomerInfo.dlSummary.state.toUpperCase()})[0]);-1<a&&(e.disableDLState=!0,e.accountModel.dlSummary.state=e.statesForDL[a].stateCode)}e.countryListForDriverLicense&&
angular.isDefined(e.customerResponce.customerInfo)&&angular.isDefined(e.customerResponce.customerInfo.dlSummary)&&angular.isDefined(e.customerResponce.customerInfo.dlSummary.dlNumber)&&""!==e.customerResponce.customerInfo.dlSummary.dlNumber?e.showDOBField=!1:e.showDOBField=!0}function v(){F.accountSummaryload("preferredFlow").then(function(a){e.customerResponce=a;if("US"==e.customerResponce.customerInfo.cor||"CA"==e.customerResponce.customerInfo.cor)e.showBiometricScan=!0;e.showPrefilled=r.getStorageData("dlVerifiedWithMitek");
I.addGTMScript();e.showPrefilled&&e.customerResponce.customerInfo.dlSummary?(console.log(JSON.stringify(e.customerResponce.customerInfo.dlSummary)),e.countryListForBiometricDl=t.getCountryList(e.customerResponce.customerInfo,p.countryListForDriverLicense),angular.isDefined(e.countryListForBiometricDl)&&e.countryListForBiometricDl.length&&(a=e.countryListForBiometricDl.indexOf(x("filter")(e.countryListForBiometricDl,function(a){return a.code===e.customerResponce.customerInfo.dlSummary.country})[0]),
e.dlCountryName=e.countryListForBiometricDl[a].name),G.trackMitekVerEventsDuringProfileEnroll("PREFILLED_DL","Success",e.customerResponce.customerInfo)):e.showPrefilled&&!angular.isDefined(e.customerResponce.customerInfo.dlSummary)&&G.trackMitekVerEventsDuringProfileEnroll("PREFILLED_DL","Failure",e.customerResponce.customerInfo);angular.isDefined(e.customerResponce.customerInfo)&&angular.isDefined(e.customerResponce.customerInfo.profileCompletionPercentage)&&angular.isDefined(e.customerResponce.customerInfo.profCompStep)&&
(e.customerData.profileCompletionPercentage=e.customerResponce.customerInfo.profileCompletionPercentage,e.customerData.profCompStep=e.customerResponce.customerInfo.profCompStep);angular.isDefined(e.customerResponce)&&angular.isDefined(e.customerResponce.partnerCustomerInfo)&&!angular.equals({},e.customerResponce.partnerCustomerInfo)?e.hasPartnerInfo=!0:e.hasPartnerInfo=!1;e.hasPartnerInfo&&angular.isDefined(e.customerResponce.partnerCustomerInfo.partnerType)&&"PARTNER_CBP"==e.customerResponce.partnerCustomerInfo.partnerType&&
h.$broadcast("CBPImageName",e.customerResponce.partnerCustomerInfo);!angular.isDefined(e.customerResponce.partnerCustomerInfo)||angular.isDefined(e.customerResponce.customerInfo)&&angular.isDefined(e.customerResponce.customerInfo.dlSummary)&&angular.isDefined(e.customerResponce.customerInfo.dlSummary.dlNumber)?e.accountModel=k.getAccountData(e.customerResponce.customerInfo):e.accountModel=k.getAccountData(e.customerResponce.partnerCustomerInfo);angular.isDefined(e.accountModel)&&angular.isDefined(e.accountModel.dlSummary)&&
angular.isDefined(e.accountModel.dlSummary.telephone)&&""!=e.accountModel.dlSummary.telephone&&(e.accountModel.dlSummary.maskId="1",e.accountModel.dlSummary.operation="update");angular.isDefined(e.customerResponce.displayControl)&&angular.isDefined(e.customerResponce.displayControl.enrollmentStep)&&(a=e.customerResponce.displayControl.enrollmentStep,e.customerData.enrollmentStep=a,k.triggerEditMode(void 0,!0,a));y.analyticsDimension(e.customerResponce,"driver-license");m();A();H();angular.isDefined(e.customerResponce.customerInfo)&&
e.customerResponce.customerInfo.quickPassUpdateFlow&&(e.accountModel.dlSummary.state=e.customerResponce.customerInfo.dlSummary.state);angular.isDefined(e.customerResponce.customerInfo)&&angular.isDefined(e.customerResponce.customerInfo.preferred)&&e.customerResponce.customerInfo.preferred?e.disableSaveCTA=!0:e.disableSaveCTA=!1},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&(e.formError=a.errorList[0].message,e.formValidated=!0);h.requestInProgress=!1})}u("ExceptionHandlerController",
{$scope:n});var e=this,g=!0;e.hideExpMonthYear=!0;e.hasPartnerInfo=!1;e.customerData={};e.customerData.preferred=!0;e.hideCVV=!0;e.disableDLState=!1;e.hideDLState=!1;e.domain=p.domain.toUpperCase();e.hideDLForm=!1;e.isEnterManual=!1;e.dlCountryName="";e.showBiometricScan=!1;e.brand=p.brand;e.saveProfileDetail=function(a,d){h.requestInProgress=!0;e.showPrefilled&&(I.addGTMScript(),G.trackMitekVerEventsDuringProfileEnroll("SAVE_DL_CTA","Click",e.customerResponce.customerInfo));e.sectionInEdit=k.getSectionInEdit(d);
"dl-section"==e.sectionInEdit&&angular.isDefined(e.accountModel.dlSummary.telephone)&&angular.isDefined(e.accountModel.contactAddress)&&angular.isDefined(e.accountModel.contactAddress.telephone)&&""!=e.accountModel.contactAddress.telephone&&(e.accountModel.dlSummary.maskId=e.accountModel.contactAddress.telephone[0].maskId,e.accountModel.dlSummary.primary=e.accountModel.contactAddress.telephone[0].primary,e.accountModel.dlSummary.operation="update");angular.isDefined(e.accountModel.dlSummary.dlNumber)&&
(e.accountModel.dlSummary.dlNumber=e.accountModel.dlSummary.dlNumber.replace(/-|\s/g,""));f.validate(a).success(function(){k.updateProfile(e.customerResponce.customerInfo,e.accountModel,e.sectionInEdit).then(function(a){a=n.processErrorMessage(a);angular.isDefined(a.errorList)&&0<a.errorList.length?(e.formError="06042"==a.errorList[0].code?n.$eval(a.errorList[0].message):a.errorList[0].message,e.showPrefilled&&(I.addGTMScript(),G.trackMitekVerEventsDuringProfileEnroll("DL_UPDATED","Failure",e.customerResponce.customerInfo)),
e.formValidated=!0,h.requestInProgress=!1,k.anchorToMsg(e.sectionInEdit)):(e.showPrefilled&&(I.addGTMScript(),G.trackMitekVerEventsDuringProfileEnroll("DL_UPDATED","Success",e.customerResponce.customerInfo)),a=B.rulesToRedirect(a),p.location.href=a)},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&(e.formError=a.errorList[0].message,e.formValidated=!0,k.anchorToMsg(e.sectionInEdit),e.showPrefilled&&(I.addGTMScript(),G.trackMitekVerEventsDuringProfileEnroll("DL_UPDATED","Failure",
e.customerResponce.customerInfo)));h.requestInProgress=!1})}).error(function(a){e.formError=ABG.getFormValidationError(a,!1)[0].message;e.formValidated=!0;h.requestInProgress=!1;e.showPrefilled&&(I.addGTMScript(),G.trackMitekVerEventsDuringProfileEnroll("DL_UPDATED","Failure",e.customerResponce.customerInfo));1<a.errorCount?k.anchorToMsg(e.sectionInEdit):1==a.errorCount&&document.getElementsByName(a.fieldName)[0].focus()})};e.validatePhoneNumber=function(a,d,g,m,l,r,n,q){h.requestInProgress=!0;f.validate(l).success(function(){k.validatePhoneNumber(a,
d,g,m,e.accountModel).then(function(a){angular.isDefined(a.errorList)&&0<a.errorList.length||angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length?(h.requestInProgress=!1,C.scrollTo("email-offers")):e.saveProfileDetail(l,n)},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&(e.formError=a.errorList[0].message,e.formValidated=!0);h.requestInProgress=!1})}).error(function(a){e.formError=ABG.getFormValidationError(a,!1)[0].message;e.formValidated=!0;h.requestInProgress=!1;1<a.errorCount?
k.anchorToMsg(e.sectionInEdit):1==a.errorCount&&document.getElementsByName(a.fieldName)[0].focus()})};e.getStateBasedOnCounty=w;e.loadHelpModal=function(a){e.country=p.countrySelect?p.countrySelect:"US";e.helpURL=F.getUrl(a.target.parentElement,country)};e.saveProfile=function(a,d,g,f,m,h,k,l){angular.isDefined(g)&&g&&angular.isDefined(d)?e.validatePhoneNumber(a,d,g,f,m,h,k,l):e.saveProfileDetail(m,k)};e.initiateMitekVerification=function(){I.addGTMScript();G.trackMitekVerEventsDuringProfileEnroll("START_SCAN_CTA",
"Click",e.customerResponce.customerInfo);p.location.href=h.contextPath+"/"+h.locale+p.contentRoot+"/biometric-validation/mitek-validation"+htmlExtension+"#/front-scan"};e.showManualDlForm=function(){I.addGTMScript();G.trackMitekVerEventsDuringProfileEnroll("ENTER_MANUAL_CTA","Click",e.customerResponce.customerInfo);e.isEnterManual=!0};e._setDlSection=A;e._loadCalendarDropdown=H;e._loadCountry=m;h.$on("initSuccess",function(a,e){g&&v()});$(".enrollment-form").on("click",".wrap-toggle-link",function(a){a=
$(this);var e=a.parent().find(".wrap-toggle-text");a.hasClass("view-more")?(a.text(a.data("viewlesslabel")).addClass("view-less").removeClass("view-more"),e.removeClass("hidden-xs")):(a.text(a.data("viewmorelabel")).addClass("view-more").removeClass("view-less"),e.addClass("hidden-xs"))});angular.isDefined(d.getXsrfToken())&&(g=!1,v());$(document).on("DOMNodeInserted",function(a){angular.element(".driver-info-success").length&&!e.successScroll&&(setTimeout(function(){$("html, body").animate({scrollTop:$(".driver-info-success").offset().top-
90})},1E3),e.successScroll=!0)})}angular.module("account").controller("PreferredDriverLicenseController",t);t.$inject="$controller $scope carRentalConstant $rootScope $window authenticationService myProfileService datePickerInit $locale $filter $validation rewardsProgramService accountUtilityService signupService accountgaService getVehicles anchorSmoothScroll storageService gaService reservationModelService".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,z,t,B,y){function F(){y.accountSummaryload("preferredFlow").then(function(a){C.customerResponce=a;angular.isDefined(C.customerResponce.customerInfo)&&angular.isDefined(C.customerResponce.customerInfo.profileCompletionPercentage)&&angular.isDefined(C.customerResponce.customerInfo.profCompStep)&&(C.customerData.profileCompletionPercentage=C.customerResponce.customerInfo.profileCompletionPercentage,C.customerData.profCompStep=C.customerResponce.customerInfo.profCompStep);
angular.isDefined(C.customerResponce)&&angular.isDefined(C.customerResponce.partnerCustomerInfo)&&!angular.equals({},C.customerResponce.partnerCustomerInfo)?C.hasPartnerInfo=!0:C.hasPartnerInfo=!1;C.hasPartnerInfo&&angular.isDefined(C.customerResponce.partnerCustomerInfo.partnerType)&&"PARTNER_CBP"==C.customerResponce.partnerCustomerInfo.partnerType&&h.$broadcast("CBPImageName",C.customerResponce.partnerCustomerInfo);C.accountModel=k.getAccountData(C.customerResponce.customerInfo);if(C.hasPartnerInfo&&
angular.isDefined(C.customerResponce.partnerCustomerInfo.insuranceMap))var d=C.customerResponce.partnerCustomerInfo.insuranceMap;k.loadSupportedExtras(C.customerResponce.customerInfo,d).then(function(a){C.accountModel.extrasData=a;C.accountModel.tempList=angular.copy(C.accountModel.extrasData)});angular.isDefined(C.customerResponce.displayControl)&&angular.isDefined(C.customerResponce.displayControl.enrollmentStep)&&(a=C.customerResponce.displayControl.enrollmentStep,C.customerData.enrollmentStep=
a,k.triggerEditMode(void 0,!0,a));B.analyticsDimension(C.customerResponce,"protection-and-coverages")},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&(C.formError=a.errorList[0].message,C.formValidated=!0);h.requestInProgress=!1})}u("ExceptionHandlerController",{$scope:n});var C=this,r=!0;C.hideExpMonthYear=!0;C.hasPartnerInfo=!1;C.customerData={};C.customerData.preferred=!0;C.hideCVV=!0;C.tdCheck=!0;C.modifyTempList=function(a,d,f){for(var m=0;m<C.accountModel.tempList[f].length;m++)if(a.code===
C.accountModel.tempList[f][m].code){C.accountModel.tempList[f][m].value=d;break}};C.cancelTempListModifications=function(){C.accountModel.tempList=angular.copy(C.accountModel.extrasData)};C.saveProfileDetail=function(a,d){h.requestInProgress=!0;C.sectionInEdit=k.getSectionInEdit(d);f.validate(a).success(function(){k.updateProfile(C.customerResponce.customerInfo,C.accountModel,C.sectionInEdit).then(function(a){a=n.processErrorMessage(a);angular.isDefined(a.errorList)&&0<a.errorList.length?(C.formError=
a.errorList[0].message,C.formValidated=!0,h.requestInProgress=!1,k.anchorToMsg(C.sectionInEdit)):(a=t.rulesToRedirect(a),p.location.href=a)},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&(C.formError=a.errorList[0].message,C.formValidated=!0,k.anchorToMsg(C.sectionInEdit));h.requestInProgress=!1})}).error(function(a){C.formError=ABG.getFormValidationError(a,!1)[0].message;C.formValidated=!0;h.requestInProgress=!1;k.anchorToMsg(C.sectionInEdit)})};h.$on("initSuccess",function(a,
d){r&&F()});$(".enrollment-form").on("click",".wrap-toggle-link",function(a){a=$(this);var d=a.parent().find(".wrap-toggle-text");a.hasClass("view-more")?(a.text(a.data("viewlesslabel")).addClass("view-less").removeClass("view-more"),d.removeClass("hidden-xs")):(a.text(a.data("viewmorelabel")).addClass("view-more").removeClass("view-less"),d.addClass("hidden-xs"))});angular.isDefined(d.getXsrfToken())&&(r=!1,F())}angular.module("account").controller("PreferredProtectionCoverageController",t);t.$inject=
"$controller $scope carRentalConstant $rootScope $window authenticationService myProfileService datePickerInit $locale $filter $validation rewardsProgramService signupService accountgaService getVehicles".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,z,t,B,y,F){function C(){F.accountSummaryload("preferredFlow").then(function(d){r.customerResponce=d;angular.isDefined(r.customerResponce.customerInfo)&&angular.isDefined(r.customerResponce.customerInfo.profileCompletionPercentage)&&angular.isDefined(r.customerResponce.customerInfo.profCompStep)&&(r.customerData.profileCompletionPercentage=r.customerResponce.customerInfo.profileCompletionPercentage,r.customerData.profCompStep=r.customerResponce.customerInfo.profCompStep);
angular.isDefined(r.customerResponce)&&angular.isDefined(r.customerResponce.partnerCustomerInfo)&&!angular.equals({},r.customerResponce.partnerCustomerInfo)?r.hasPartnerInfo=!0:r.hasPartnerInfo=!1;r.hasPartnerInfo&&angular.isDefined(r.customerResponce.partnerCustomerInfo.partnerType)&&"PARTNER_CBP"==r.customerResponce.partnerCustomerInfo.partnerType&&h.$broadcast("CBPImageName",r.customerResponce.partnerCustomerInfo);r.accountModel=k.getAccountData(r.customerResponce.customerInfo);r.accountModel.showConnectedCarTnC=
!0;r.accountModel.showConnectedCarTncModal=!1;angular.isDefined(r.customerResponce.displayControl)&&angular.isDefined(r.customerResponce.displayControl.enrollmentStep)&&k.triggerEditMode(void 0,!0,r.customerResponce.displayControl.enrollmentStep);angular.isDefined(r.getTnCCountryList)&&""!=r.getTnCCountryList&&(r.showTnCPage=F.gettermsMapURL(r.getTnCCountryList,r.domain)+".partial.html");y.analyticsDimension(r.customerResponce,"terms-and-conditions");angular.isDefined(r.customerResponce.customerInfo)&&
!r.customerResponce.customerInfo.preferred&&(a.showConnectedCarTncArray.includes(r.customerResponce.customerInfo.cor.toUpperCase())?r.accountModel.showConnectedCarTnC=!0:r.accountModel.showConnectedCarTnC=!1);r.disableDeclineButton=r.customerResponce.customerInfo.preferred?!0:!1;r.termsConditionSectionDisplay=!1},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&(r.formError=a.errorList[0].message,r.formValidated=!0);h.requestInProgress=!1})}u("ExceptionHandlerController",{$scope:n});
var r=this,G=!0;r.hideExpMonthYear=!0;r.hasPartnerInfo=!1;r.customerData={};r.customerData.preferred=!0;r.hideCVV=!0;r.saveProfileDetail=function(a,d){h.requestInProgress=!0;r.sectionInEdit=k.getSectionInEdit(d);f.validate(a).success(function(){k.updateProfile(r.customerResponce.customerInfo,r.accountModel,r.sectionInEdit).then(function(a){a=n.processErrorMessage(a);angular.isDefined(a.errorList)&&0<a.errorList.length?(r.formError=a.errorList[0].message,r.formValidated=!0,h.requestInProgress=!1):
(a=B.rulesToRedirect(a),p.location.href=a);k.anchorToMsg(r.sectionInEdit)},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&(r.formError=a.errorList[0].message,r.formValidated=!0,k.anchorToMsg(r.sectionInEdit));h.requestInProgress=!1})}).error(function(a){r.formError=ABG.getFormValidationError(a,!1)[0].message;r.formValidated=!0;h.requestInProgress=!1;k.anchorToMsg(r.sectionInEdit)})};r.declineProfileTermsCondition=function(a){B.resendActivationEmail().then(function(a){p.location.href=
h.contextPath+"/"+h.locale+p.contentRoot+"/activation"+htmlExtension},function(){p.location.href=h.contextPath+"/"+h.locale+p.contentRoot+"/activation"+htmlExtension})};r.getTnCCountryList=p.termsandconditionsMap;r.domain=p.domain.toUpperCase();h.$on("initSuccess",function(a,d){G&&C()});$(".enrollment-form").on("click",".wrap-toggle-link",function(a){a=$(this);var d=a.parent().find(".wrap-toggle-text");a.hasClass("view-more")?(a.text(a.data("viewlesslabel")).addClass("view-less").removeClass("view-more"),
d.removeClass("hidden-xs")):(a.text(a.data("viewmorelabel")).addClass("view-more").removeClass("view-less"),d.addClass("hidden-xs"))});angular.isDefined(d.getXsrfToken())&&(G=!1,C())}angular.module("account").controller("PreferredTermsConditionController",t);t.$inject="$controller $scope carRentalConstant $rootScope $window authenticationService myProfileService datePickerInit $locale $filter $validation rewardsProgramService accountUtilityService signupService accountgaService getVehicles".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,z,t,B,y){function F(){angular.isDefined(m.customerResponce)&&angular.isDefined(m.customerResponce.partnerCustomerInfo)&&!angular.equals({},m.customerResponce.partnerCustomerInfo)?m.hasPartnerInfo=!0:m.hasPartnerInfo=!1}function C(){m.accountModel.program.pointsProgram=!0;m.accountModel.program.partnerProgram=!1;r();m.rewardsSectionDisplay=!0;angular.isDefined(m.getAvisPreferredTermsList)&&""!=m.getAvisPreferredTermsList&&(m.showTnCModal=y.gettermsMapURL(m.getAvisPreferredTermsList,
m.domain)+".partial.html",m.rewardPreferredTnC=!0,m.accountModel.showConnectedCarTncModal=!0)}function r(){k.getPartnerDetails().then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length&&angular.isDefined(a.errorList)&&0<a.errorList.length?n.processErrorMessage(a):m.partnerDetails=a},function(a){h.requestInProgress=!1})}function G(a){m.sectionInEdit=k.getSectionInEdit(a)}function I(){y.accountSummaryload("preferredFlow").then(function(a){m.customerResponce=a;m.customerData.loyaltyEligible.visible=
m.customerResponce.displayControl.displayElementMap.loyaltyEligible.visible;angular.isDefined(m.customerResponce.customerInfo)&&angular.isDefined(m.customerResponce.customerInfo.profileCompletionPercentage)&&angular.isDefined(m.customerResponce.customerInfo.profCompStep)&&(m.customerData.profileCompletionPercentage=m.customerResponce.customerInfo.profileCompletionPercentage,m.customerData.profCompStep=m.customerResponce.customerInfo.profCompStep);F();m.hasPartnerInfo&&angular.isDefined(m.customerResponce.partnerCustomerInfo.partnerType)&&
"PARTNER_CBP"==m.customerResponce.partnerCustomerInfo.partnerType&&h.$broadcast("CBPImageName",m.customerResponce.partnerCustomerInfo);m.accountModel=k.getAccountData(m.customerResponce.customerInfo);angular.isDefined(m.customerResponce.displayControl)&&angular.isDefined(m.customerResponce.displayControl.enrollmentStep)&&(a=m.customerResponce.displayControl.enrollmentStep,m.customerData.enrollmentStep=a,k.triggerEditMode(void 0,!0,a));angular.isDefined(m.customerResponce.displayControl)&&angular.isDefined(m.customerResponce.displayControl.enrollmentStep)&&
m.hasPartnerInfo&&angular.isDefined(m.customerResponce.partnerCustomerInfo.partnerType)&&angular.isDefined(m.customerResponce.customerInfo)&&angular.isDefined(m.customerResponce.customerInfo.amazonLinked)&&m.customerResponce.customerInfo.amazonLinked&&"PARTNER_AMAZON"==m.customerResponce.partnerCustomerInfo.partnerType&&"enroll-rewards-section"==m.customerResponce.displayControl.enrollmentStep&&(m.showAmazonRewardsMsg=!0,m.amazonRewardsMessage=Dictionary.I18n.get("lbl.amazonBenefits.rewardsSuccessMessage"));
t.analyticsDimension(m.customerResponce,"");C()},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&(m.formError=a.errorList[0].message,m.formValidated=!0);h.requestInProgress=!1})}u("ExceptionHandlerController",{$scope:n});var m=this,w=!0;m.hideExpMonthYear=!0;m.hasPartnerInfo=!1;m.customerData={loyaltyEligible:{visible:!1},profileCompletionPercentage:"",profCompStep:""};m.customerData.preferred=!0;m.getAvisPreferredTermsList=p.termsandconditionsRewardsMap;m.saveProfileDetail=function(a,
d){h.requestInProgress=!0;G(d);f.validate(a).success(function(){k.updateProfile(m.customerResponce.customerInfo,m.accountModel,m.sectionInEdit).then(function(a){a=n.processErrorMessage(a);angular.isDefined(a.errorList)&&0<a.errorList.length?(m.formError=a.errorList[0].message,m.formValidated=!0,h.requestInProgress=!1,k.anchorToMsg(m.sectionInEdit)):p.location.href=h.contextPath+"/"+h.locale+p.contentRoot+"/activation"+htmlExtension},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&
(m.formError=a.errorList[0].message,m.formValidated=!0,k.anchorToMsg(m.sectionInEdit));h.requestInProgress=!1})}).error(function(a){m.formError=ABG.getFormValidationError(a,!1)[0].message;m.formValidated=!0;h.requestInProgress=!1;k.anchorToMsg(m.sectionInEdit)})};m.displayRewardsSection=!0;m.tdCheck=!0;m.showAmazonRewardsMsg=!1;m.amazonRewardsMessage="";m._checkForPartnerCustomerInfo=F;m._setEnrollRewardsSection=C;m.clearFtpDetails=function(a){m.accountModel=z.clearFtpDetails(m.accountModel,a);m.accountModel=
z.setFTPSection(m.customerData,m.accountModel)};m._getPartnerDetails=r;m._getSectionInEdit=G;m.onChangeRewardPreference=function(a,d,f,e,g){angular.isDefined(m.formError)&&""!=m.formError&&(m.formValidated=!1,m.formError="",m.accountModel.airlineMembershipNumber="",m.accountModel.otherMembershipNumber="",m.accountModel.airlinePartner="",n.$broadcast("clearPartnerDetails"));"pointsPrgm"==d?(a&&m.accountModel.program.partnerProgram&&(m.accountModel.program.partnerProgram=!1),m.disableSaveButton=!1):
"partnerPrgm"==d?(a&&m.accountModel.program.pointsProgram&&(m.accountModel.program.pointsProgram=!1),m.disableSaveButton=!1):m.accountModel.program.pointsProgram||m.accountModel.program.partnerProgram||(m.disableSaveButton=!1)};h.$on("initSuccess",function(a,d){w&&I()});$(".enrollment-form").on("click",".wrap-toggle-link",function(a){a=$(this);var d=a.parent().find(".wrap-toggle-text");a.hasClass("view-more")?(a.text(a.data("viewlesslabel")).addClass("view-less").removeClass("view-more"),d.removeClass("hidden-xs")):
(a.text(a.data("viewmorelabel")).addClass("view-more").removeClass("view-less"),d.addClass("hidden-xs"))});angular.isDefined(d.getXsrfToken())&&(w=!1,I())}angular.module("account").controller("PreferredRewardsController",t);t.$inject="$controller $scope carRentalConstant $rootScope $window authenticationService myProfileService datePickerInit $locale $filter $validation rewardsProgramService accountgaService accountUtilityService getVehicles".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,z,t,B,y,F,C,r,G){function I(){var a=q.getStorageData("upcomingReservations");angular.isDefined(a)&&(A.upcomingRes=A._processReservations(a));a&&a.resSummaryList&&0<a.resSummaryList.length&&0<a.resSummaryList.filter(function(a){return a.onAirportIndicator}).length&&(a=a.resSummaryList.filter(function(a){return a.onAirportIndicator}))&&0<a.length&&A.selectVehicle.push(a[0])}function m(a){if(-1<navigator.userAgent.indexOf("msie")||0<navigator.appVersion.indexOf("Trident/")||
navigator.userAgent.toLowerCase().indexOf("edge")||navigator.userAgent.toLowerCase().indexOf("edg")||navigator.userAgent.toLowerCase().indexOf("safari")&&!window.chrome)var e=setTimeout(function(){w()},2E3);navigator.geolocation.getCurrentPosition(function(d){clearTimeout(e);angular.element("#locationDisabledWarning").modal("hide");x.requestInProgress=!0;G.getVehicleDetails({uniqueId:"",geoCoordinate:{longitude:d.coords.longitude,latitude:d.coords.latitude},confirmationNumber:a}).then(function(a){if(angular.isDefined(a.errorList)&&
0<a.errorList.length)x.requestInProgress=!1,A.vehErrorList=a.errorList,A.errorTrack=h.processErrorMessage(a);else if(angular.element(document).injector().get("getDataService").setVehiclesResponse(a),F.analyticsSelfserviceClickEvents("my activity dashboard"),1<=a.vehicleSummaryList.length&&!angular.equals(a.vehicleSummaryList,{}))k.location.href=x.contextPath+"/"+x.locale+"/rental"+htmlExtension+"#/select-vehicle";else{a=Dictionary.I18n.get("err.res.genericerrormsg,"+brand);var e=[];e.push({message:a});
A.vehErrorList=e;console.log("empty response")}},function(a){a=Dictionary.I18n.get("err.res.genericerrormsg,"+brand);var e=[];e.push({message:a});x.requestInProgress=!1;A.errorTrack=h.processErrorMessage(e);A.vehErrorList=e})},function(a){clearTimeout(e);w()})}function w(){x.requestInProgress=!1;angular.element("#locationDisabledWarning").modal("show")}function H(a){a&&!n.current.name?setTimeout(function(){ABG.redirectPage(a)},1):a&&n.go(a,{},{reload:!0})}u("ExceptionHandlerController",{$scope:h});
var A=this;A.openRental={detailsAvailable:!1,detailsError:!1,itineraries:null,inProgress:!0,showCampaign:!1};A.upcomingRes={detailsAvailable:!1,detailsError:!1,itineraries:null,inProgress:!0,showCampaign:!1};A.pastRental={detailsAvailable:!1,detailsError:!1,itineraries:null,inProgress:!0,showCampaign:!1};A.cancelledRes={detailsAvailable:!1,detailsError:!1,itineraries:null,inProgress:!0,showCampaign:!1};A.showProminentForm=!1;A.profileUrl=k.contextPath+"/"+k.locale+"/loyalty-profile/avis-preferred/dashboard/profile"+
htmlExtension;A.receiptRequest=l.receiptRequest;A.customerData={};A.prod={};A.brand=k.brand;A.rangeSelector={};A.Math=Math;A.imageNotAvailable=!0;A.viewAll=!1;A.domain=k.domain.toUpperCase();A._processReservations=t.processItenaries;A.viewReservationDetails=function(a){angular.isDefined(A.customerData)&&x.$broadcast("viewReservationDetails",a)};A.getPastRentalReceipt=function(a){x.requestInProgress=!0;A.receiptRequest={rentalAgreementNum:a.rentalAgreementNumber};B.load(A.receiptRequest,!0).then(function(a){A.validateResponse=
a;if(angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.warningList)&&0<a.warningList.length)A.prod=h.processErrorMessage(a),x.requestInProgress=!1;else if(angular.isDefined(a.errorList)&&0<a.errorList.length)x.requestInProgress=!1,A.prod=h.processErrorMessage(a),A.scrollUp();else if(null==a.errorList||void 0==a.errorList)q.setStorageData("receiptRequest",A.receiptRequest),q.setStorageData("receiptResponse",A.validateResponse),x.requestInProgress=!1,ABG.redirectPage(x.contextPath+
"/"+x.locale+"/reservation/receipt-details"+htmlExtension)},function(a){x.requestInProgress=!1;A.prod=h.processErrorMessage(a);A.scrollUp()})};A.toResDetailsPage=function(a,e){x.requestInProgress=!0;var g={};g.lastName=d.getCustomerModel().lastName;g.confirmationNumber=a.confirmationNumber;z.setLookUpModel(g);C.load().then(function(a){A.prod=h.processErrorMessage(a);angular.isDefined(A.prod.errorList)&&0<A.prod.errorList.length?$("html, body").animate({scrollTop:$(".my-activity").position().top}):
(p.addToReservationData(A.prod),z.load(A.prod,!1,!0),p.addToConfirmationData(A.prod),e?ABG.redirectPage(x.contextPath+"/"+x.locale+"/reservation/"+l.getReservationPage):ABG.redirectPage(x.contextPath+"/"+x.locale+"/reservation"+htmlExtension+"#/confirmation/lookup"));x.requestInProgress=!1},function(a){x.requestInProgress=!1;A.prod=h.processErrorMessage(a);A.scrollUp()})};A.initRangeSelector=function(a){A.rangeSelector=t.initRangeSelector(a);angular.equals(x.deviceType,"handheld")&&angular.isDefined(A.rangeSelector.range)&&
10==A.pageSize&&(A.pageSize=5)};A.dateRangeFilter=function(a,e){var d=A.convertToDateTime(A.rangeSelector.minSelected),f=A.convertToDateTime(A.rangeSelector.maxSelected);return function(a){if(null===a)return!1;a=A.convertToDateTime(a.pickDateTime);return a>=d&&a<=f?!0:!1}};A.convertToDateTime=t.convertToDateTime;A.dateFilterUtil=function(){return function(a){return null===a?!1:A.convertToDateTime(a.pickDateTime).getTime()}};A.scrollUp=function(){$("body").animate({scrollTop:0},"slow")};A.profileDashboardImagePath=
t.profileDashboardImagePath;A.bookAgain=function(a){x.requestInProgress=!0;var e=z.bookingModel;e.rentalAgreementNumber=a;e.bookAgain.bookAgainFlow=!0;z.setReservationModel(e);var d=x.contextPath+"/"+x.locale+"/reservation/book-again"+htmlExtension+"#/book-again";r.getBookAgainData(!1).then(function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&(h.processErrorMessage(a),d=x.contextPath+"/"+x.locale+"/reservation"+htmlExtension+"#/time-and-place",e.bookAgain.bookAgainFlow=!1,z.setReservationModel(e));
ABG.redirectPage(d)},function(a){A.isAnonymous=!0;x.requestInProgress=!1})};A.getRentalExt=function(a){x.requestInProgress=!0;y.fetchRentalDetails(a).then(function(a){x.requestInProgress=!0;angular.isDefined(a)&&angular.isUndefined(a.errorList)&&(F.analyticsRentalClickEvents(a,"rental lookup"),H(x.contextPath+"/"+x.locale+"/rental/rental-dashboard"+htmlExtension))},function(a){H(x.contextPath+"/"+x.locale+"/reservation/view-modify-cancel"+htmlExtension)})};A.getVehicle=function(a){navigator.permissions?
navigator.permissions.query({name:"geolocation"}).then(function(e){"none"!=e.state&&"granted"!=e.state||!navigator.geolocation?(x.requestInProgress=!1,a&&m(a),angular.element("#locationDisabledWarning").modal("show")):m(a)}):m(a)};A.getLocationAndRedirect=m;A.retrieveUpcomingRes=I;A.selectVehicle=[];A.errorList=null;A.vehErrorList=null;A.errorTrack={};angular.element(document).ready(function(){setTimeout(function(){h.$broadcast("reCalcViewDimensions")},2E3)});x.$on("Profile.CustomerAdditionalInfo",
function(a,e){x.requestInProgress=!0;A.customerData=e;A.showProminentForm="profile-completed"!=A.customerData.enrollmentStep&&"enroll-rewards-section"!=A.customerData.enrollmentStep?!0:!1;angular.isDefined(e)&&angular.isDefined(e.userState)&&angular.equals(e.userState,l.userStateRememberMe)&&ABG.redirectPage(k.contextPath+"/"+k.locale+k.contentRoot+"/login"+htmlExtension);(a=d.getSessionModel())&&angular.isDefined(a)&&angular.isDefined(a.status)&&("AUTHENTICATED"===a.status||"REMEMBER_ME"===a.status)&&
(void 0!=d.getOpenRentals()?(A.openRental=A._processReservations(d.getOpenRentals()),null!=A.openRental.itineraries&&angular.isDefined(A.openRental.itineraries.errorList)&&0<A.openRental.itineraries.errorList.length&&(A.errorList=h.processErrorMessage(A.openRental.itineraries).errorList)):(A.openRental.inProgress=!1,A.openRental.showCampaign=!0),void 0!=d.getUpcomingReservations()&&(A.upcomingRes=A._processReservations(d.getUpcomingReservations())),void 0!=d.getPastReservations()&&(A.pastRental=A._processReservations(d.getPastReservations())),
void 0!=d.getCancelledReservations()&&(A.cancelledRes=A._processReservations(d.getCancelledReservations())));angular.equals(x.deviceType,"handheld")&&angular.isDefined(A.rangeSelector.range)&&10==A.pageSize&&(A.pageSize=5);x.requestInProgress=!1});x.$on("Profile.noshowCancelledRes",function(a,e){A.cancelledRes=A._processReservations(e)});x.$on("Profile.pastRentals",function(a,e){A.pastRental=A._processReservations(e)});x.$on("Profile.upcomingReservation",function(a,e){A.upcomingRes=A._processReservations(e)});
x.$on("Profile.openRentals",function(a,e){A.openRental=A._processReservations(e)});x.$on("Profile.rentalHistory",function(a,e){angular.isDefined(e)&&!angular.equals(e,{})?(angular.forEach(e,function(a,e){a.onAirportIndicator&&A.selectVehicle.push(a)}),A.upcomingRes=A._processReservations(d.getUpcomingReservations())):I();q.getStorageData("getVehicleError")&&(A.vehErrorList=q.getStorageData("getVehicleError"));0==A.selectVehicle.length&&(A.prod.errorList=A.vehErrorList);setTimeout(function(){q.deleteStorageData("getVehicleError")},
3E3)})}angular.module("account").controller("MyActivityController",t);t.$inject="$controller $state $filter $scope getDataService authenticationService $window carRentalConstant storageService $rootScope $sce reservationModelService accountUtilityService ReceiptLookupService rentalService gaService lookupService vehicleService rentalVehicleService".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l){u("ExceptionHandlerController",{$scope:a});var q=this;l.deleteAllStorageData();q._activateProfileCall=function(n){p.activateProfileInit(n).then(function(f){f=a.processErrorMessage(f);angular.isDefined(f.instructionList&&1<f.instructionList.length)&&(angular.forEach(f.instructionList,function(a){"17435"==a.code&&"INSTRUCTION"==a.type&&(q.cdhDownError=a.message)}),l.setStorageData("epCdhDownErrorList",q.cdhDownError));!(angular.isDefined(f.errorList)&&0<f.errorList.length)||
angular.isDefined(f.warningList)&&0<f.warningList.length?angular.isDefined(f.customerInfo.userState)&&angular.equals(f.customerInfo.userState,h.userStateAuthenticated)&&"1"===f.customerInfo.webCustomer.activationStatus?ABG.redirectPage(d.contextPath+"/"+d.locale+k.contentRoot+"/dashboard/profile"+htmlExtension):ABG.redirectPage(d.contextPath+"/"+d.locale+k.contentRoot+"/login"+htmlExtension):ABG.redirectPage(d.contextPath+"/"+d.locale+k.contentRoot+"/login"+htmlExtension+"#/"+f.errorList[0].code)},
function(a){var f="";angular.isDefined(a.errorList[0])&&0<a.errorList.length&&(f=a.errorList[0].code);ABG.redirectPage(d.contextPath+"/"+d.locale+k.contentRoot+"/login"+htmlExtension+"#/"+f)})};(function(){var a="";a=n.search();var f={};angular.forEach(a,function(a,d){f[d]=a});a=!0;k.sessionStorage.profileKey&&k.sessionStorage.profileKey===f.WIZARD_NUMBER?a=!1:!0===l.sessionStorageSupport()&&(k.sessionStorage.profileKey=f.WIZARD_NUMBER);a?setTimeout(function(){q._activateProfileCall(f)},10):p.init().then(function(){p.getCustomerAdditionalInfo().then(function(){},
function(a){ABG.redirectPage(k.contextPath+"/"+k.locale+k.contentRoot+"/login"+htmlExtension+"#/"+a.errorList[0].code)})},function(a){d.requestInProgress=!1})})()}angular.module("account").controller("EmailActivationController",t);t.$inject="$controller $location $scope carRentalConstant authenticationService $rootScope $window storageService".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,t,J,B,y,F,C){function r(a){"loyalty"==a?v.customerData.preferred?(z("enroll-rewards-section"),v.accountModel.program.pointsProgram=!0,v.accountModel.program.partnerProgram=!1):h.location.href=n.contextPath+"/"+n.locale+h.contentRoot+htmlExtension:"ftp"==a&&(z("enroll-rewards-section"),v.accountModel.program.partnerProgram=!0,v.accountModel.program.pointsProgram=!1);v.displayRewardsSection=!0;v.hidePromoCampaign=!0;v.disableSaveButton=!1;y.scrollTo("enrollRewardsForm")}
function z(a){setTimeout(function(){d.triggerEditMode(void 0,!0,"enroll-rewards-section")},10)}function I(a,g){a?(v.sectionInEdit=d.getSectionInEdit(g),v.tdCheck||"enroll-rewards-section"==v.customerData.enrollmentStep?(d.triggerEditMode(g,a,v.sectionInEdit),v.tempAccountModel=angular.copy(v.accountModel)):(n.requestInProgress=!0,J.generateOtp().then(function(e){e.promptOtpFlag?(d.triggerEditMode(g,a,v.sectionInEdit),v.tempAccountModel=angular.copy(v.accountModel)):$(".profile-edit-error").modal("show");
n.requestInProgress=!1},function(a){$(".profile-edit-error").modal("show");n.requestInProgress=!1}))):(angular.isDefined(v.tempAccountModel)&&!angular.equals({},v.tempAccountModel)&&(v.accountModel=angular.copy(v.tempAccountModel)),d.triggerEditMode(g,a,v.sectionInEdit));v.hidePromoCampaign=!1}function m(){H();var a=h.location.href.split("/");if(0!=a.length&&-1!=a[a.length-1].indexOf("rewards")){a=q.rewardsDefaultSelection(v.customerData);"pointsProgram"==a?(v.accountModel.program.pointsProgram=!0,
v.accountModel.program.partnerProgram=!1):"partnerProgram"==a?(v.accountModel.program.partnerProgram=!0,v.accountModel.program.pointsProgram=!1):"optOutProgram"==a&&(v.accountModel.program.partnerProgram=!1,v.accountModel.program.pointsProgram=!1);v.rewardsSectionDisplay=!v.customerData.loyaltyEligible.visible||v.customerData.ftpPartnerDetails.ftpOptIn||v.customerData.optOut||v.customerData.loyaltyDetails.loyaltyOptIn?!1:!0;if(v.customerData.cor==x.countryCodeAU||v.customerData.cor==x.countryCodeNZ)v.displayPromoField=
!0;angular.isDefined(v.showTnCModal)?(v.rewardPreferredTnC=!0,v.accountModel.showConnectedCarTncModal=!0):v.rewardPreferredTnC=!1;v.accountModel=q.setFTPSection(v.customerData,v.accountModel);v.disableSaveButton=!0;w()}}function w(){d.getPartnerDetails().then(function(e){angular.isDefined(e.fieldErrors)&&0<e.fieldErrors.length&&angular.isDefined(e.errorList)&&0<e.errorList.length?a.processErrorMessage(e):v.partnerDetails=e},function(a){n.requestInProgress=!1})}function H(){var a=navigator.vendor&&
-1<navigator.vendor.indexOf("Apple")&&navigator.userAgent&&!navigator.userAgent.match("CriOS");v.customerData.ftpPartnerDetails.ftpOptIn||v.customerData.loyaltyEligible.visible||a||(v.displayRewardsSection=!1);if("AU"==v.customerData.cor||"NZ"==v.customerData.cor)v.displayRewardsSection=!0}function A(){var a;n.requestInProgress=!0;k.getSessionModel();k.logout().then(function(e){k.setLoginAuthenticate(!1);a=n.contextPath+"/"+n.locale+"/home"+htmlExtension;B.setStorageData("lockedUser",v.customerData.contacts.email);
p.remove("resModelDisplayControls");setTimeout(function(){h.location.href=a},1)},function(a){n.requestInProgress=!1})}u("ExceptionHandlerController",{$scope:a});var v=this;v.customerData={};v.accountModel={};v.tempAccountModel={};v.showLoyaltyOption=!1;v.showOptout=!1;v.hidePromoCampaign=!1;v.rewardsSectionDisplay=!1;v.rewardPreferredTnC=!1;v.prod={};v.rangeSelector={};v.Math=Math;v.displayRewardsSection=!0;v.displayPromoField=!1;v.domain=h.domain.toUpperCase();v.getTnCCountryRewardsList=h.termsandconditionsRewardsMap;
v.loyaltyPnts={detailsAvailable:!1,detailsError:!1,itineraries:{},inProgress:!0,showCampaign:!1};v.resendOtpSuccess=!1;v.resendOtpError=!1;v.tdCheck=!0;v.editSection=I;v.clearFtpDetails=function(a){v.accountModel=q.clearFtpDetails(v.accountModel,a);v.accountModel=q.setFTPSection(v.customerData,v.accountModel)};v.enrollRewards=r;v.saveProfileDetail=function(e,g){v.sectionInEdit=d.getSectionInEdit(g);n.requestInProgress=!0;l.validate(e).success(function(){d.updateProfile(v.customerData,v.accountModel,
v.sectionInEdit).then(function(e){e=a.processErrorMessage(e);angular.isDefined(e.errorList)&&0<e.errorList.length?(v.formError=e.errorList[0].message,v.formValidated=!0,n.requestInProgress=!1):(v.customerData=e,v.formValidated=!1,v.showSuccessMsg=!0,I(!1),location.reload());d.anchorToMsg(v.sectionInEdit)},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&(v.formError=a.errorList[0].message,v.formValidated=!0,d.anchorToMsg(v.sectionInEdit));n.requestInProgress=!1})}).error(function(a){v.formError=
ABG.getFormValidationError(a,!1)[0].message;v.formValidated=!0;n.requestInProgress=!1;d.anchorToMsg(v.sectionInEdit)})};v.initRangeSelector=function(a){v.rangeSelector=t.initRangeSelector(a);angular.equals(n.deviceType,"handheld")&&angular.isDefined(v.rangeSelector.range)&&10==v.pageSize&&(v.pageSize=5)};v.dateRangeFilter=function(a,d){var e=v.convertToDateTime(v.rangeSelector.minSelected),g=v.convertToDateTime(v.rangeSelector.maxSelected);return function(a){if(null===a||angular.isUndefined(a.interactionType)&&
""==a.interactionType&&angular.isUndefined(a.actionType)&&""==a.actionType)return!1;a=v.convertToDateTime(a.interactionDate);return a>=e&&a<=g?!0:!1}};v.convertToDateTime=t.convertToDateTime;v.dateFilterUtil=function(){return function(a){return null===a?!1:v.convertToDateTime(a.interactionDate).getTime()}};v.initLoyaltyPoints=function(){n.requestInProgress=!0;q.getLoyaltyActivity().then(function(a){n.requestInProgress=!1;v.prod=a;v.loyaltyPnts=v._processLoyaltyPoints(v.prod)},function(a){v._processLoyaltyPoints({errorList:[{code:"timeout",
message:"timedout / webapi error"}]});n.requestInProgress=!1})};v.getMemberCardPDF=function(){h.open(apiurl+"/print/fetch-membercard","_blank")};v.onChangeRewardPreference=function(e,d,f,h,m){angular.isDefined(v.formError)&&""!=v.formError&&(v.formValidated=!1,v.formError="",v.accountModel.airlineMembershipNumber="",v.accountModel.airlinePartner="",v.accountModel.otherMembershipNumber="",a.$broadcast("clearPartnerDetails"));"pointsPrgm"==d?(e&&v.accountModel.program.partnerProgram&&(v.accountModel.program.partnerProgram=
!1),v.disableSaveButton=e&&v.customerData.loyaltyDetails.loyaltyOptIn?!0:!1):"partnerPrgm"==d?(e&&v.accountModel.program.pointsProgram&&(v.accountModel.program.pointsProgram=!1),1==e&&v.customerData.ftpPartnerDetails.ftpOptIn?!angular.isDefined(f)||f==v.customerData.ftpPartnerDetails.partnerCode&&(!angular.isDefined(h)||angular.isDefined(h)&&h==v.customerData.ftpPartnerDetails.memebershipNumber)&&(!angular.isDefined(m)||angular.isDefined(m)&&m==v.customerData.ftpPartnerDetails.promotionalCode)?v.disableSaveButton=
!0:v.disableSaveButton=!1:v.disableSaveButton=!1):v.disableSaveButton=0!=v.accountModel.program.pointsProgram||0!=v.accountModel.program.partnerProgram||v.customerData.loyaltyDetails.loyaltyOptIn||v.customerData.ftpPartnerDetails.ftpOptIn?!1:!0};v.cancelEdit=function(){v.formValidated=!1;H()};v.gtmBlur=function(a,d,f){if("text"==f)var e=a?"Filled In":"Skipped";else"checkbox"==f?e=a?"Selected as Y":"Selected as N":"dropdown"==f&&(e=a?"Selected":"Not Selected");dataLayer.push({event:"trackEvent",eventCategory:"Tracking Form: Profile-Form",
eventLabel:d,eventAction:e})};v.verifyProfileOtp=function(e){v.resendOtpSuccess=!1;v.resendOtpError=!1;var d=angular.element(e.target)[0].form.name;e=angular.element("[name\x3d'"+d+"']").controller("form");l.validate(e).success(function(){var e={otpNumber:v.profileOtp};n.requestInProgress=!0;J.validateOtp(e).then(function(e){e.errorList&&(e=a.processErrorMessage(e));e.errorList&&0<e.errorList.length?1==e.errorList.length&&("110033"==e.errorList[0].code?l.displayServiceError("vm.profileOtp","invalidotp",
!1,d):"110034"==e.errorList[0].code?l.displayServiceError("vm.profileOtp","expiredotp",!1,d):"110023"==e.errorList[0].code?A():l.displayServiceError("vm.profileOtp","genericotp",!1,d)):e.promptOtpFlag||(e=k.getSessionModel(),e.tdCheck=!0,v.tdCheck=!0,k.setSessionModel(e));n.requestInProgress=!1},function(a){n.requestInProgress=!1})}).error(function(a){})};v.resendOtp=function(){v.resendOtpSuccess=!1;v.resendOtpError=!1;n.requestInProgress=!0;J.generateOtp().then(function(e){n.requestInProgress=!1;
e.errorList&&0<e.errorList.length?(a.processErrorMessage(e),v.resendOtpError=!0):v.resendOtpSuccess=!0},function(a){n.requestInProgress=!1;v.resendOtpError=!0})};v._setEnrollRewardsSection=m;v._showSectionInExpendedMode=z;v._getPartnerDetails=w;v._processLoyaltyPoints=t.processItenaries;v._enableRewardsSection=H;angular.element(document).ready(function(){setTimeout(function(){a.$broadcast("reCalcViewDimensions")},2E3)});v.enrollRewards=function(a){n.$emit("enrollRewards",{param:a})};n.$on("enrollRewards",
function(a,d){r(d.param||"")});n.$on("Profile.CustomerAdditionalInfo",function(a,g){v.customerData=g;a=k.getSessionModel();angular.isDefined(a)&&angular.isDefined(a.tdCheck)&&(v.tdCheck=a.tdCheck);v.accountModel=d.getAccountData(v.customerData);h.brand==x.brandName.AVIS&&angular.isDefined(v.getTnCCountryRewardsList)&&""!=v.getTnCCountryRewardsList&&(v.showTnCModal=C.gettermsMapURL(v.getTnCCountryRewardsList,v.domain)+".partial.html");m()});n.recompile=function(){var e=angular.element(".checking");
0<e.length&&(angular.element("checking").each(function(a,e){0!=a&&jQuery(e).remove()}),F(e)(a),a.$apply(),angular.element(".checking").removeClass("checking"),jQuery(".hide-on-load").removeClass("hide-on-load"))}}angular.module("account").controller("RewardsProgramController",t);t.$inject="$controller $rootScope $scope $window $cookies myProfileService authenticationService $validation rewardsProgramService carRentalConstant $sce accountUtilityService securityService storageService anchorSmoothScroll $compile getVehicles".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,t,J){function z(){l.addGTMScript();if("errors"==h.current.name)y.errorMessage=t.getStorageData("sessionErrMsg"),y.blockType="Err",a.requestInProgress=!1;else if("success"==h.current.name)y.blockType="Scs",a.requestInProgress=!1;else{var f=l.getUrlParameter("id");f||ABG.redirectPage(d.contextPath+"/"+d.locale+d.contentRoot+"/login"+htmlExtension);k.getProfileSummary(f).then(function(f){angular.isDefined(f.errorList)&&f.errorList.length?(f=n.processErrorMessage(f),
t.setStorageData("sessionErrMsg",f.errorList[0].message),setTimeout(function(){ABG.redirectPage(d.contextPath+"/"+d.locale+d.contentRoot+"/login"+htmlExtension+"#/"+f.errorList[0].code)},200)):f.customerInfo?(y.customerResponce=f.customerInfo,J.trackBiometricVerificationEvents("VERIFICATION_INITIATED","Success",y.customerResponce),y.customerResponce&&y.customerResponce.wizardNumberMasked&&J.dataLayerOfBiometricFlow(y.customerResponce.wizardNumberMasked),y.customerResponce.ftpreferred?(J.trackBiometricVerificationEvents("CLEAR_PROMO",
"Loaded",y.customerResponce),d.location.href=a.contextPath+"/"+a.locale+d.contentRoot+"/biometric-validation"+htmlExtension+"#/clear-me"):!y.customerResponce.ftpreferred&&y.customerResponce.preferred?(J.trackBiometricVerificationEvents("CLEAR_PROMO","AlreadyVerified",y.customerResponce),d.location.href=a.contextPath+"/"+a.locale+d.contentRoot+"/biometric-validation"+htmlExtension+"#/success"):ABG.redirectPage(d.contextPath+"/"+d.locale+d.contentRoot+"/login"+htmlExtension)):ABG.redirectPage(d.contextPath+
"/"+d.locale+d.contentRoot+"/login"+htmlExtension)},function(f){J.trackBiometricVerificationEvents("VERIFICATION_INITIATED","Failure","");a.requestInProgress=!1;ABG.redirectPage(d.contextPath+"/"+d.locale+d.contentRoot+"/login"+htmlExtension+"#/"+f.errorList[0].code)})}}u("ExceptionHandlerController",{$scope:n});var y=this;a.requestInProgress=!0;a.isIntrerimProfile=!0;y.blockType="St";y.domain=d.domain.toUpperCase();y._onPageLoad=z;y.closeErrorPage=function(){ABG.redirectPage(d.contextPath+"/"+d.locale+
d.contentRoot+"/login"+htmlExtension)};y.redirectToLoginPage=function(){ABG.redirectPage(d.contextPath+"/"+d.locale+d.contentRoot+"/login"+htmlExtension)};z()}angular.module("account").controller("BiometricValidationController",t);t.$inject="$controller $scope $rootScope $state $validation $window biometricService reservationModelService MiTek clearMe $location storageService gaService".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,t,J){function z(){f.addGTMScript();d.getCustomerDataData().then(function(d){F.customerResponce=d.customerInfo;F.customerResponce&&F.customerResponce.wizardNumberMasked&&t.dataLayerOfBiometricFlow(F.customerResponce.wizardNumberMasked);F.customerResponce||ABG.redirectPage(k.contextPath+"/"+k.locale+k.contentRoot+"/login"+htmlExtension);F.customerResponce.ftpreferred||(k.location.href=a.contextPath+"/"+a.locale+k.contentRoot+"/biometric-validation"+htmlExtension+
"#/success");"handheld"===a.deviceType&&"clear-me"==x.current.name&&setTimeout(function(){q.initiate("clear-button","self-checkout","verify","profile-enrollment")});a.requestInProgress=!1})}function y(f){p.validate(f).success(function(f){a.requestInProgress=!0;d.sendSms(F.customerResponce.wizardNumberMasked,F.recaptcha).then(function(d){null!=d&&(F.smsRes.result=d,angular.isDefined(d.fieldErrors)&&null!==d.fieldErrors&&0<d.fieldErrors.length?(d=d.fieldErrors[0],d=p.displayServiceError(d.field,d.classifier),
F.isValidated=!0,F.apiErrMsg=d):angular.isDefined(d.errorList)&&null!==d.errorList&&0<d.errorList.length?(t.trackBiometricVerificationEvents("D2M_SMS","Failed",F.customerResponce),d=d.errorList[0],F.isValidated=!0,F.apiErrMsg=d.message):(t.trackBiometricVerificationEvents("D2M_SMS","Sent",F.customerResponce),F.smsRes.showLinkSent=!0,F.smsRes.currAttempt++),a.requestInProgress=!1)},function(d){if(angular.isDefined(d.fieldErrors)&&null!==d&&null!==d.fieldErrors&&0<d.fieldErrors.length){var f=d.fieldErrors[0];
f=p.displayServiceError(f.field,f.classifier);F.isValidated=!0;F.apiErrMsg=f}angular.isDefined(d.errorList)&&null!==d.errorList&&0<d.errorList.length&&(F.isValidated=!0,F.apiErrMsg=d.errorList[0].message);a.requestInProgress=!1})}).error(function(a){F.isValidated=!0;F.apiErrMsg=n.processErrorMessage(a.MSG[0]);angular.element(".ng-invalid").focus()})}u("ExceptionHandlerController",{$scope:n});a.requestInProgress=!0;var F=this;F.customerResponce={};F.loadClearpromo=!1;F.domain=k.domain.toUpperCase();
F.apiErrMsg="";F.smsRes={showLinkSent:!1,currAttempt:0};F.isValidated=!1;F.trigerSms=function(a){F.isValidated=!1;k.brand==J.brandName.PAYLESS||"true"==enableEnterpriseCaptcha&&(k.brand==J.brandName.AVIS||k.brand==J.brandName.BUDGET)?grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"triggerSms",twofactor:!0}).then(function(d){F.recaptcha=d;y(a)}):y(a)};F._onPageLoad=z;F.addVideoClass=function(){jQuery(".rmvdo").addClass("video")};F._setVM=function(a){F=a};F.initiateMitekScan=function(){k.location.href=
a.contextPath+"/"+a.locale+k.contentRoot+"/biometric"+htmlExtension+"#/front-dl-scan"};F.updateProfileStatus=function(){a.requestInProgress=!0;d.convertProfile(F.customerResponce.wizardNumberMasked).then(function(d){angular.isDefined(d.errorList)&&d.errorList.length?(t.trackBiometricVerificationEvents("VERIFICATION","Failed",F.customerResponce),d=n.processErrorMessage(d),l.setStorageData("sessionErrMsg",d.errorList[0].message),k.location.href=a.contextPath+"/"+a.locale+k.contentRoot+"/biometric-validation"+
htmlExtension+"#/errors"):d.customerInfo?(F.customerResponce=d.customerInfo,t.trackBiometricVerificationEvents("VERIFICATION","Completed",F.customerResponce),k.location.href=a.contextPath+"/"+a.locale+k.contentRoot+"/biometric-validation"+htmlExtension+"#/success",a.requestInProgress=!1):ABG.redirectPage(k.contextPath+"/"+k.locale+k.contentRoot+"/login"+htmlExtension);a.requestInProgress=!1},function(d){t.trackBiometricVerificationEvents("VERIFICATION","Failed",F.customerResponce);a.requestInProgress=
!1;l.setStorageData("sessionErrMsg",d.errorList[0].message);k.location.href=a.contextPath+"/"+a.locale+k.contentRoot+"/biometric-validation"+htmlExtension+"#/errors"})};F.enableEnterpriseCaptcha=enableEnterpriseCaptcha;z()}angular.module("account").controller("BiometricController",t);t.$inject="$controller $scope $rootScope $sce $validation biometricService $window storageService clearMe $state reservationModelService gaService carRentalConstant".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,t,J){function z(){l.addGTMScript();r.customerResponce=t.getCustomerModel();r.customerResponce||ABG.redirectPage(d.contextPath+"/"+d.locale+d.contentRoot+"/login"+htmlExtension);r.documents=f.getStorageData("mitekDocuments")||[];if("front-scan"==h.current.name||x.absUrl().includes("front-scan"))r.scanType="front-scan",r.whichCapture=G.driverLicenseFront,r.whichName=r.docName.front,r.isShowLazyLoadCTA=!0,J.trackMitekVerEventsDuringProfileEnroll("DL_FRONT_SCAN",
"Intiate",r.customerResponce),r.autoCapture();else if("back-scan"==h.current.name||x.absUrl().includes("back-scan"))r.scanType="back-scan",r.whichCapture=G.driverLicenseBack,r.whichName=r.docName.back,r.isShowLazyLoadCTA=!0,J.trackMitekVerEventsDuringProfileEnroll("DL_BACK_SCAN","Intiate",r.customerResponce),r.autoCapture();else if("facial-scan"==h.current.name||x.absUrl().includes("facial-scan"))r.scanType="facial-scan",r.whichCapture=G.usersSelfie,r.whichName=r.docName.selfie,J.trackMitekVerEventsDuringProfileEnroll("SELFIE_SCAN",
"Intiate",r.customerResponce),r.autoCapture();else if("facial-instruction"==h.current.name||x.absUrl().includes("facial-instruction"))r.scanType="facial-instruction",J.trackMitekVerEventsDuringProfileEnroll("FACIAL_SCAN_GUIDE","Intiate",r.customerResponce),a.requestInProgress=!1}function y(){$(window).scrollTop(0);r.whichName===r.docName.front?r.captureLoading.dlf=!0:r.whichName==r.docName.back&&(r.captureLoading.dlb=!0);n.$apply()}function F(a){var d=r.documents.findIndex(function(d){return d.typeOfDoc==
a});-1!==d&&r.documents.splice(d,1)}function C(a){r.showCameraOverlay=!1;r.lazyLoad=!1;n.$apply();F(r.whichName);switch(a.response.docType){case G.usersSelfie:r.documents.push({image:a.response.imageData.split(",")[1],encodingType:I.selfie,imageType:a.response.docType,typeOfDoc:r.whichName});break;case G.driverLicenseFront:r.documents.push({image:a.response.imageData.split(",")[1],encodingType:I.baseSixtyFour,imageType:a.response.docType,typeOfDoc:r.whichName});break;case G.driverLicenseBack:r.documents.push({image:angular.isDefined(a.response.code)?
a.response.code:a.response.imageData.split(",")[1],encodingType:angular.isDefined(a.response.code)?I.barcode:I.baseSixtyFour,imageType:a.response.docType,typeOfDoc:r.whichName})}r.whichName==r.docName.front?(f.setStorageData("mitekDocuments",r.documents),setTimeout(function(){r.whichCapture=G.driverLicenseBack;r.whichName=r.docName.back;h.go("back-scan",{})},r.delay.verifyDelay)):r.whichName==r.docName.back&&(f.setStorageData("mitekDocuments",r.documents),setTimeout(function(){h.go("facial-instruction",
{})},r.delay.verifyDelay));3==r.documents.length&&r.whichName==r.docName.selfie&&(f.setStorageData("mitekDocuments",r.documents),r.captureLoading.selfiVerify=!0,r.verifyDocuments())}u("ExceptionHandlerController",{$scope:n});var r=this;a.requestInProgress=!0;a.isIntrerimProfile=!0;r.showCameraOverlay=!1;r.captureLoading={dlf:!1,dlb:!1,selfiVerify:!1,idVerified:!1};var G={driverLicenseFront:"DL_FRONT",driverLicenseBack:"PDF417_BARCODE",usersSelfie:"SELFIE"},I={baseSixtyFour:"base64",barcode:"PDF417",
selfie:"Selfie"};r.docName={front:"DL FRONT",back:"DL BACK",selfie:"SELFIE"};r.delay={timeoutDelay:1E5,verifyDelay:2E3,successDelay:2E3,lazyDelay:3E4};r.manualCapture={dlf:!1,dlb:!1};r.customerResponce={};r.errorOnWhichStep={dlf:!1,selfie:!1};r.domain=d.domain.toUpperCase();r.resSummary={};r.documents=[];r.miteKError="";r.isShowLazyLoadCTA=!1;r._onPageLoad=z;r.autoCapture=function(){q.autoCapture(r.whichCapture,r,n).then(function(a){a&&(y(),C(a))})};r.manualUpload=function(){$(window).scrollTop(0);
r.captureLoading.dlf=!1;r.captureLoading.dlb=!1;r.lazyLoad=!1;r.showCameraOverlay=!1;clearTimeout(r.attemptTimer);mitekScienceSDK.cmd("SDK_STOP");setTimeout(function(){q.manualCapture(r,n).then(function(a){a&&(y(),C(a))})},10)};r._resultStore=C;r.goToFacialScan=function(){J.trackMitekVerEventsDuringProfileEnroll("SELFIE_TERMS_ACCEPT","Click",r.customerResponce);h.go("facial-scan")};r.verifyDocuments=function(){var f=JSON.parse(JSON.stringify(r.documents));angular.forEach(f,function(a){delete a.typeOfDoc});
k.verifyDlDetails(f,r.customerResponce.wizardNumberMasked).then(function(f){r.captureLoading.selfiVerify=!1;r.captureLoading.idVerified=!0;J.trackMitekVerEventsDuringProfileEnroll("DL_VERIFIED","Success",r.customerResponce);setTimeout(function(){angular.isDefined(f.customerInfo)&&angular.isDefined(f.customerInfo.webCustomer)&&angular.isDefined(f.customerInfo.webCustomer.activationStatus)&&"1"==f.customerInfo.webCustomer.activationStatus?ABG.redirectPage(a.contextPath+"/"+a.locale+d.contentRoot+"/dashboard/profile"+
htmlExtension):ABG.redirectPage(a.contextPath+"/"+a.locale+d.contentRoot+"/driving-licence"+htmlExtension)},r.delay.successDelay)},function(a){J.trackMitekVerEventsDuringProfileEnroll("DL_VERIFIED","Failure",r.customerResponce);a&&a.fieldErrors?(a=$scpe.processErrorMessage(a),r.errorDisplayList=a):a&&a.errorList&&(a=n.processErrorMessage(a),r.errorDisplayList=a.errorList,"90050"==a.errorList[0].code?(F(r.docName.back),r.captureLoading.selfiVerify=!1,r.whichCapture=G.driverLicenseFront,r.whichName=
r.docName.front,r.errorOnWhichStep.dlf=!0):"90055"==a.errorList[0].code||"90056"==a.errorList[0].code||"90057"==a.errorList[0].code?(r.captureLoading.selfiVerify=!1,r.errorOnWhichStep.selfie=!0,r.errorOnWhichStep.dlf=!1):(r.captureLoading.selfiVerify=!1,r.errorOnWhichStep.dlf=!0),r.mitekValidation=!0,r.miteKError=a.errorList[0].message)})};r.goToBack=function(){d.history.back()};r.goToDlPage=function(){ABG.redirectPage(a.contextPath+"/"+a.locale+d.contentRoot+"/driving-licence"+htmlExtension)};$(document).on("DOMNodeInserted",
function(a){$("#mitekOuterContainer").length&&r.whichCapture==G.driverLicenseBack?($("#mitekOuterContainer").addClass("DL_BACK_PDF"),$("#mitekOuterContainer").hasClass("DL_SELFIE_SCAN")&&$("#mitekOuterContainer").removeClass("DL_SELFIE_SCAN"),$("#mitekOuterContainer").hasClass("DL_FRONT_SCAN")&&$("#mitekOuterContainer").removeClass("DL_FRONT_SCAN")):$("#mitekOuterContainer").length&&r.whichCapture==G.usersSelfie?($("#mitekOuterContainer").hasClass("DL_BACK_PDF")&&$("#mitekOuterContainer").removeClass("DL_BACK_PDF"),
$("#mitekOuterContainer").hasClass("DL_FRONT_SCAN")&&$("#mitekOuterContainer").removeClass("DL_FRONT_SCAN"),$("#mitekOuterContainer").addClass("DL_SELFIE_SCAN")):$("#mitekOuterContainer").length&&r.whichCapture==G.driverLicenseFront?($("#mitekOuterContainer").hasClass("DL_BACK_PDF")&&$("#mitekOuterContainer").removeClass("DL_BACK_PDF"),$("#mitekOuterContainer").hasClass("DL_SELFIE_SCAN")&&$("#mitekOuterContainer").removeClass("DL_SELFIE_SCAN"),$("#mitekOuterContainer").addClass("DL_FRONT_SCAN")):
$("#mitekOuterContainer").hasClass("DL_BACK_PDF")&&$("#mitekOuterContainer").removeClass("DL_BACK_PDF");r.whichCapture==G.usersSelfie&&0<$(".FACE_IN_GUIDE").length?$("#mitekOuterContainer").addClass("mitek_selfie_green"):0==$(".FACE_IN_GUIDE").length&&$("#mitekOuterContainer").hasClass("mitek_selfie_green")&&$("#mitekOuterContainer").removeClass("mitek_selfie_green")});z()}angular.module("account").controller("VerifyIdentityWithMitekController",t);t.$inject="$controller $scope $rootScope $state $validation $window biometricService reservationModelService MiTek $location storageService authenticationService gaService".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l,q,x,f,t,J,B,y,F,C){function r(){var a=q.getSessionModel();D.credentialModal=t.credentialModal;angular.isDefined(a)&&angular.isDefined(a.status)&&a.status===f.userStateAuthenticated?q.getCustomerAdditionalInfo().then(function(a){x.validatePage(a);u.requestInProgress=!1},function(a){ABG.redirectPage(p.contextPath+"/"+p.locale+p.contentRoot+"/login"+htmlExtension+"#/"+a.errorList[0].code)}):(u.requestInProgress=!1,passwordExpireValue==f.passwordExpirePage&&d.getPasswordExpireLogin().then(function(a){$("#expired-user").show();
D.credentialModal.wizard=a.userLogin},function(a){ABG.redirectPage(p.contextPath+"/"+p.locale+"/home"+htmlExtension)}),D.credentialModal.dobMonth=null,D.credentialModal.dobDate=null,D.credentialModal.dobYear=null)}function z(){D.successMessage=null;D.forgotUsernameCall=!0;"true"==enableCaptcha?grecaptcha.execute():I()}function I(){u.requestInProgress=!0;d.forgotUserName(D.credentialModal,D.recaptcha).then(function(a){u.requestInProgress=!1;angular.isDefined(a)&&(angular.isDefined(a.fieldErrors)&&
0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length?(a=h.processErrorMessage(a),ABG.resetCaptcha(),D.errorDisplayList=a.errorList):(ABG.resetCaptcha(),D.successMessage=Dictionary.I18n.get("msg.profile.wizardMailSent,"+brand)+D.credentialModal.emailAddress),p.scrollTo(0,0))},function(a){D.errorDisplayList=h.processErrorMessage(a).errorList;u.requestInProgress=!1;ABG.resetCaptcha();$("body").animate({scrollTop:0},"slow")})}function m(){u.requestInProgress=!0;q.resetPassword(D.credentialModal.password).then(function(a){u.requestInProgress=
!1;angular.isDefined(a)&&(angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length?(ABG.resetCaptcha(),a=h.processErrorMessage(a),ABG.resetCaptcha(),D.errorDisplayList=a.errorList):p.location.href=u.contextPath+"/"+u.locale+p.contentRoot+"/dashboard/profile"+htmlExtension)},function(a){D.errorDisplayList=h.processErrorMessage(a).errorList;u.requestInProgress=!1;ABG.resetCaptcha();$("body").animate({scrollTop:0},"slow")})}function w(){D.forgotPasswordSuccessMessage=
null;D.forgotPasswordCall=!0;"true"==enableCaptcha?grecaptcha.execute():H()}function H(){u.requestInProgress=!0;d.forgotPassword(D.credentialModal,D.recaptcha).then(function(a){u.requestInProgress=!1;angular.isDefined(a)&&(angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length?(a=h.processErrorMessage(a),ABG.resetCaptcha(),D.errorDisplayList=a.errorList):(ABG.resetCaptcha(),D.forgotPasswordSuccessMessage=Dictionary.I18n.get("msg.profile.passwordMailSent")+
D.credentialModal.emailAddress,D.disableLookUp=!0),p.scrollTo(0,0))},function(a){D.errorDisplayList=h.processErrorMessage(a).errorList;u.requestInProgress=!1;$("body").animate({scrollTop:0},"slow")})}function A(){D.forgotPasswordSuccessMessage=null;D.forgotPasswordCallNew=!0;"true"==enableCaptcha?grecaptcha.execute():v()}function v(){u.requestInProgress=!0;d.forgotPasswordNew(D.credentialModal,D.recaptcha).then(function(a){u.requestInProgress=!1;angular.isDefined(a)&&(angular.isDefined(a.fieldErrors)&&
0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length?(a=h.processErrorMessage(a),ABG.resetCaptcha(),D.errorDisplayList=a.errorList):(ABG.resetCaptcha(),D.forgotPasswordSuccessMessage=Dictionary.I18n.get("msg.profile.passwordMailSent")+Dictionary.I18n.get("msg.profile.registeredEmail"),D.disableLookUp=!0),p.scrollTo(0,0))},function(a){D.errorDisplayList=h.processErrorMessage(a).errorList;u.requestInProgress=!1;$("body").animate({scrollTop:0},"slow")})}function e(a){y.getErrorMessageByCode(a).then(function(a){D.errorDisplayList=
a;p.scrollTo(0,0)},function(){})}function g(){u.requestInProgress=!0;F.updatePassword(D.customerData,D.credentialModal,"password-section").then(function(a){a=h.processErrorMessage(a);angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length?(D.errorDisplayList=a.errorList[0].message,D.formValidated=!0,O()):angular.isDefined(a.errorList)&&0<a.errorList.length?(D.errorDisplayList=a.errorList[0].message,D.formValidated=!0,O()):(D.formValidated=!1,ABG.redirectPage(u.contextPath+"/"+u.locale+p.contentRoot+
"/dashboard/profile"+htmlExtension))},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&(D.errorDisplayList=a.errorList[0].message,D.formValidated=!0,D.showSuccessMsg=!1,p.scrollTo(0,0));O();u.requestInProgress=!1})}function O(){D.credentialModal.currentPassword=U;D.credentialModal.newPassword=U}function Q(){var a=D.hasPartnerInfo?angular.isDefined(D.customerData.partnerCustomerInfo.minAge)?D.customerData.partnerCustomerInfo.minAge:f.ageLimit.lower:f.ageLimit.lower;a=B.loadCalendarDropdown(a);
D.monthsList=a.monthsList;D.yearsList=a.yearsList;D.datesList=a.datesList}a("ExceptionHandlerController",{$scope:h});var D=this,la=!0;D._validationError=function(a){D.errorDisplayList=ABG.getFormValidationError(a,!0)};D._validationErrorExpire=function(a){D.errorDisplayList=2<=a.errorCount?Dictionary.I18n.get("err.global.multi.errorMessage")+"\x3c/br\x3e"+Dictionary.I18n.get("msg.profile.password.reenter"):a.MSG[0]+"\x3c/br\x3e"+Dictionary.I18n.get("msg.profile.password.reenter");D.formValidated=!0;
u.requestInProgress=!1;p.scrollTo(0,0)};D.forgotUserNameSubmit=function(a){D.errorDisplayList=[];k.validate(a).success(z).error(D._validationError)};D.country=p.domain.toUpperCase();D.forgotPasswordSubmit=function(a){D.errorDisplayList=[];k.validate(a).success(w).error(D._validationError)};D.forgotPasswordNewSubmit=function(a){D.errorDisplayList=[];k.validate(a).success(A).error(D._validationError)};D.resetPasswordSubmit=function(a){k.validate(a).success(m).error(D._validationError)};D.resetExpirePasswordSubmit=
function(a){D.errorDisplayList=[];D.credentialModal.updatePassword.currentPassword==D.credentialModal.updatePassword.newPassword&&""!=D.credentialModal.updatePassword.currentPassword&&""!=D.credentialModal.updatePassword.newPassword?(D.errorDisplayList=Dictionary.I18n.get("error.profile.common.samepassword,"+brand)+"\x3c/br\x3e"+Dictionary.I18n.get("msg.profile.password.reenter"),D.formValidated=!0,O()):""==D.credentialModal.updatePassword.currentPassword&&""!=D.credentialModal.updatePassword.newPassword?
(D.errorDisplayList=Dictionary.I18n.get("error.profile.oldPassword.required,"+brand)+"\x3c/br\x3e"+Dictionary.I18n.get("msg.profile.password.reenter"),D.formValidated=!0,O()):k.validate(a).success(g).error(D._validationErrorExpire)};D.dispalyOnloadError=e;D.gtmBlur=function(a,e,d){var g;"text"==d?g=a?"Filled In":"Skipped":"checkbox"==d?g=a?"Selected as Y":"Selected as N":"dropdown"==d&&(g=a?"Selected":"Not Selected");dataLayer.push({event:"trackEvent",eventCategory:"Tracking Form: Forgot-Reset-Password-form",
eventLabel:e,eventAction:g})};D.errorDisplayList=[];D.enableCaptcha=enableCaptcha;D.domain=p.domain.toUpperCase();D._loadCalendarDropdown=Q;D._recaptcha=function(){};u.requestInProgress=!0;n=J.$$absUrl;C.getStorageData("expiredUser");C=n?n.split("#/")[1]:window.location.search.slice(1);D.disableLookUp=!1;D.formName=p.formName;D.brand=p.brand;C&&e(C);D.isLoginModelOpen=!1;D.forgotPasswordCall=!1;D.forgotUsernameCall=!1;var U="";u.$on("initSuccess",function(a,e){la&&r()});brand!=f.brandName.PAYLESS&&
(brand!=f.brandName.AVIS&&brand!=f.brandName.BUDGET||domain!=f.countryCodeAU.toLowerCase()&&domain!=f.countryCodeNZ.toLowerCase())||Q();angular.isDefined(q.getXsrfToken())&&(la=!1,r());D.isLoginModelOpen=!0;a=a("CredentialExnController",{$scope:h});angular.extend(this,a);u.$on("recaptcha",function(a,e){D.recaptcha=e;angular.isDefined(e)&&""!=e&&(D.forgotPasswordCall?(H(),D.forgotPasswordCall=!1):D.forgotPasswordCallNew?(v(),D.forgotPasswordCallNew=!1):D.forgotUsernameCall&&(I(),D.forgotUsernameCall=
!1))})}angular.module("account").controller("CredentialController",t);t.$inject="$rootScope $state $controller $scope $window credentialService $validation $sce authenticationService accessControlService carRentalConstant accountModelService $location accountUtilityService utilityService myProfileService storageService".split(" ")})();
(function(){function t(u,n,a,h,p,d){function k(k){h.passwordResetMailValidate(k).then(function(h){if(angular.isDefined(h))if(h=a.processErrorMessage(h),angular.isDefined(h.errorList)&&0<h.errorList.length||angular.isDefined(h.warningList)&&0<h.warningList.length){var f=p.contextPath+"/"+p.locale+d.contentRoot+"/forgot-password"+htmlExtension;ABG.redirectPage(f+"#/"+h.errorList[0].code)}else f=p.contextPath+"/"+p.locale+d.contentRoot+"/reset-password"+htmlExtension,d.location.href=f;else f=p.contextPath+
"/"+p.locale+d.contentRoot+"/forgot-password"+htmlExtension,d.location.href=f},function(a){d.location.href=p.contextPath+"/"+p.locale+d.contentRoot+"/forgot-password"+htmlExtension+"#/"+a.errorList[0].code})}u("ExceptionHandlerController",{$scope:a});var l=this;l.processActivation=!0;l.prod={};l._validateEmailLinkCall=k;(function(){var a="";a=n.search();var d={};angular.forEach(a,function(a,h){d[h]=a});h.getXsrfToken()&&(l.processActivation=!1,k(d));p.$on("initSuccess",function(a,h){l.processActivation&&
k(d)})})()}angular.module("account").controller("EmailCredentialController",t);t.$inject="$controller $location $scope authenticationService $rootScope $window".split(" ")})();
(function(){function t(u,n,a,h,p,d,k,l){return{getCustomerDataData:function(){var a=n.defer();u({method:"GET",url:apiurl+"/summary/profile?url\x3d/account/my-profile/biometricSummary"}).then(function(d){angular.isUndefined(k.getReservationModel())&&k.load("",!0);a.resolve(d.data)}).catch(function(d){a.reject(d.data)});return a.promise},sendSms:function(a,d){var f=n.defer();u({method:"POST",url:apiurl+"/profile/send-sms",data:{wizardNumber:a},headers:{"g-recaptcha-response":d?d:""}}).then(function(a){f.resolve(a.data)}).catch(function(a){f.reject(ABG.evaluateError(a.data))});
return f.promise},getProfileSummary:function(a){function d(a){var d=n.defer();u({method:"POST",url:apiurl+"/profile/retrieve",data:{encryptedToken:a}}).then(function(a){a=a.data;angular.isDefined(a)&&angular.isUndefined(a.errorList)&&l.setStorageData("profile-data",a.customerInfo);d.resolve(a)}).catch(function(a){d.reject(ABG.evaluateError(a.data))});return d.promise}if(h.getXsrfToken())return d(a);var f=n.defer(),k=h.init();n.all([k]).then(function(h){d(a).then(function(a){f.resolve(a)})});return f.promise},
convertProfile:function(a){var d=n.defer();u({method:"POST",url:apiurl+"/profile/convert",data:{wizardNumber:a}}).then(function(a){d.resolve(a.data)}).catch(function(a){d.reject(ABG.evaluateError(a.data))});return d.promise},verifyDlDetails:function(h,t){h={documents:h,wizardNumber:t};var f=n.defer();u({method:"POST",url:apiurl+"/profile/verifyDriversLicense",data:h}).then(function(h){h=h.data;p.brand!=d.brandName.PAYLESS&&ABG.updateContextStores();h=a.processError(h,k.modelMap);angular.isDefined(h)&&
angular.isUndefined(h.errorList)?(l.setStorageData("dlVerifiedWithMitek",!0),f.resolve(h)):(l.setStorageData("dlVerifiedWithMitek",!1),f.reject(h))}).catch(function(a){l.setStorageData("dlVerifiedWithMitek",!1);f.reject(a.data)});return f.promise}}}angular.module("accountServices").service("biometricService",t);t.$inject="$http $q exceptionHandler authenticationService $window carRentalConstant reservationModelService storageService".split(" ")})();
(function(){function t(u){u.state("clear-me",{url:"/clear-me",templateUrl:rootpath+contentRoot+"/biometric-validation/clear-me.partial"+htmlExtension,controller:"BiometricController",controllerAs:"vm"});u.state("profile-details",{url:"/profile-details",templateUrl:rootpath+contentRoot+"/biometric-validation/profile-details.partial"+htmlExtension,controller:"BiometricController",controllerAs:"vm"});u.state("errors",{url:"/errors",templateUrl:rootpath+contentRoot+"/biometric-validation/errors.partial"+
htmlExtension,controller:"BiometricValidationController",controllerAs:"vm"});u.state("success",{url:"/success",templateUrl:rootpath+contentRoot+"/biometric-validation/success.partial"+htmlExtension,controller:"BiometricValidationController",controllerAs:"vm"});u.state("mitek",{url:"/mitek",templateUrl:rootpath+contentRoot+"/biometric-validation/mitek.partial"+htmlExtension,controller:"BiometricController",controllerAs:"vm"});u.state("front-scan",{url:"/front-scan",templateUrl:rootpath+contentRoot+
"/biometric-validation/mitek-validation/front-scan.partial"+htmlExtension,controller:"VerifyIdentityWithMitekController",controllerAs:"vm"});u.state("back-scan",{url:"/back-scan",templateUrl:rootpath+contentRoot+"/biometric-validation/mitek-validation/back-scan.partial"+htmlExtension,controller:"VerifyIdentityWithMitekController",controllerAs:"vm"});u.state("facial-scan",{url:"/facial-scan",templateUrl:rootpath+contentRoot+"/biometric-validation/mitek-validation/facial-scan.partial"+htmlExtension,
controller:"VerifyIdentityWithMitekController",controllerAs:"vm"});u.state("facial-instruction",{url:"/facial-instruction",templateUrl:rootpath+contentRoot+"/biometric-validation/mitek-validation/facial-instruction.partial"+htmlExtension,controller:"VerifyIdentityWithMitekController",controllerAs:"vm"})}angular.module("account").config(t);t.$inject=["$stateProvider"]})();(function(){angular.module("partner",[])})();
(function(){function t(u,n,a,h,p,d,k,l,q,t,f){function x(a){if(angular.isDefined(a)){B.partnerDetails=a;G.awdNumber=a.awdNumber;var d=angular.isDefined(a.country)&&""!=a.country&&0!=a.country.length?a.country[0].toUpperCase():"US";G.country=-1==d.indexOf("US")&&-1!=d.indexOf("CA")?"CA":"US";angular.isDefined(a)&&(G.requiresMemberID=a.requiresMemberID,G.partnerName=a.partnerName);h(function(){p.$broadcast("setPartnerInfoInWidget",G)},100);ABG.updateContextStores();p.$broadcast("Update.Notificationdisplay")}}
function J(){angular.isDefined(B.member)&&"custom"==B.member?angular.isDefined(n.customText)&&(B.memberToDisplay=n.customText):angular.isDefined(B.member)&&"none"!==B.member&&(B.memberToDisplay=B.member);G.memberToDisplay=B.memberToDisplay}var B=this;t=t("DashboardController",{$scope:u});angular.extend(this,t);t._setVM(B);B.callPartnerReservation=function(a){if(angular.isDefined(a)&&0==C){C++;var d="";"B"==a.toUpperCase()?d=angular.isDefined(n.businessDiscount)&&0<n.businessDiscount.length?n.businessDiscount:
B.parentAwd:"L"==a.toUpperCase()&&(d=angular.isDefined(n.leisureDiscount)&&0<n.leisureDiscount.length?n.leisureDiscount:B.parentAwd.substring(0,B.parentAwd.length-2)+"90");l.callToReservation(a,d).then(function(a){F++;angular.isDefined(r)&&null!==r&&""!==r&&(y=y+"?"+r);n.location.href=y;1>=F&&dataLayer.push({event:"LinkClick",eventCategory:"Link Click",eventCallLabel:n.location.protocol+"//"+n.location.host+y,eventAction:"Element_Clicks"})},function(a){})}};B.setUrl=function(a,d){y=a;r=d};B.memberToDisplay=
"";B.parentAwd=n.parentAwd;B.segmentName=n.segmentName;B.member=n.member;var y="",F=0,C=0,r="",G={segmentName:B.segmentName,memberToDisplay:"",awdNumber:"",country:"",requiresMemberID:!1,partnerName:""};B._onPageLoad=function(){p.$broadcast("cbpInfoForLogo",n.logoImagePath);J();B.cbpInfo=k.getCBPInfoData();angular.isDefined(d.getXsrfToken())&&angular.isDefined(B.cbpInfo)&&!angular.equals({},B.cbpInfo)&&angular.isDefined(B.cbpInfo.awdNumber)&&B.cbpInfo.awdNumber==B.parentAwd?x(B.cbpInfo):d.init(!1,
B.parentAwd).then(function(a){angular.isDefined(a)&&angular.isDefined(a.cbpInfo)&&(q.load(a,!0).then(function(d){x(a.cbpInfo)},function(a){}),k.addCBPInfoData(a.cbpInfo))},function(a){});var f=f||{};(function(d){f[d]=setInterval(function(){if(angular.isDefined(window.angular)){var d=angular.element(".teaser-container");a(d)(u);u.$apply()}},300)})(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15))};B._getMemberDetails=J;B._onPageLoad()}angular.module("partner").controller("PartnerController",
t);t.$inject="$scope $window $compile $timeout $rootScope authenticationService getDataService bridgeService reservationModelService $controller carRentalConstant".split(" ")})();
(function(){function t(t,n,a,h,p,d){function k(){n.requestInProgress=!0;d.getResponse(l.userEmail).then(function(a){a=t.processErrorMessage(a);l.prod=a;l.emailSuccess=l.prod.success;0==l.prod.success&&(l.errorDisplay=!0);angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length&&p.displayServiceError("vm.userEmail",a.fieldErrors[0].classifier)});n.requestInProgress=!1}a("ExceptionHandlerController",{$scope:t});var l=this;l.emailSuccess=!1;l.errorDisplay=!1;l.prod="";l.userEmail="";l.os=ABG.getMobileOperatingSystem();
l.openEmailPopover=function(){l.cancelModal()};l.gotoElement=function(a){a=angular.element(a.target).closest("[id*\x3d'slide']").next("[id*\x3d'slide']").attr("id");h.scrollTo(a)};l.triggerEmail=function(a){p.validate(a).success(k)};l.cancelModal=function(){l.userEmail="";l.emailSuccess=!1;l.errorDisplay=!1;var a=angular.element("form[name\x3demailForm] input[name\x3duserEmail]");p.removeError(a,!0)};l._validationSuccess=k}angular.module("reservation").controller("MobileAppLandingController",t);t.$inject=
"$scope $rootScope $controller anchorSmoothScroll $validation utilityService".split(" ")})();
(function(){function t(t,n,a,h,p,d){var k=this;(function(){if(angular.isDefined(h.search().LocCode)&&angular.isDefined(h.search().prepay)){var a="true"===h.search().prepay.toLowerCase()?p.txnTypePrePay:p.txnTypePostPay,q=h.search().LocCode;n.requestInProgress=!0;d.load(a,q).then(function(a){n.requestInProgress=!1;k.CompleteTexNew=a},function(a){n.requestInProgress=!1})}})()}angular.module("reservation").controller("TncController",t);t.$inject="$scope $rootScope $state $location carRentalConstant locationTermsConditionsService".split(" ")})();
(function(){angular.module("receipt",["receiptService"])})();(function(){angular.module("receiptService",[])})();
(function(){function t(t,n,a,h,p,d,k,l,q,x){function f(a){var d=n.defer();t({method:"POST",url:apiurl+"/rental/validate-receipt",data:a}).then(function(a){a=a.data;a=l.processError(a,p.modelMap);d.resolve(a)}).catch(function(a){console.log("Error")});return d.promise}function u(a){var d=n.defer();t({method:"POST",url:apiurl+"/ncore/rental/fetchEreceipt",data:a}).then(function(a){a=a.data;a=l.processError(a,p.modelMap);d.resolve(a)}).catch(function(a){console.log("Error")});return d.promise}function J(a){var d=
n.defer();t({method:"POST",url:apiurl+"/ncore/rental/view-receipt",data:a}).then(function(a){a=a.data;a=l.processError(a,p.modelMap);d.resolve(a)}).catch(function(a){console.log("Error")});return d.promise}return{getReceipt:function(){var a=n.defer();t({method:"GET",url:apiurl+"/pdf/fetchpdf",responseType:"arraybuffer"}).then(function(d){d=d.data;d=l.processError(d,p.modelMap);a.resolve(d)}).catch(function(a){console.log("Error")});return a.promise},validateReceipt:f,load:function(a,d){if(x.getXsrfToken())return angular.isDefined(d)&&
1==d?J(a):f(a);var h=n.defer();d=x.init(!0);n.all([d]).then(function(d){f(a).then(function(a){h.resolve(a)})});return h.promise},emailRequestHandler:function(a){if(x.getXsrfToken())return u(a);var d=n.defer(),f=x.init(!0);n.all([f]).then(function(f){u(a).then(function(a){d.resolve(a)})});return d.promise}}}angular.module("receiptService").service("ReceiptLookupService",t);t.$inject="$http $q $window $filter reservationModelService storageService carRentalConstant exceptionHandler $rootScope authenticationService".split(" ")})();
(function(){function t(t,n,a,h,p,d,k,l,q,x,f,z,J,B,y,F,C){function r(){a.requestInProgress=!0;k.addRentalFTP(w.reservationModel.ftpDetails.partnerCode,w.reservationModel.ftpDetails.ftpNumber).then(function(e){angular.isDefined(e)&&(angular.isDefined(e.fieldErrors)&&0<e.fieldErrors.length||angular.isDefined(e.errorList)&&0<e.errorList.length?(a.requestInProgress=!1,e=n.processErrorMessage(e),w.errorList=e.errorList):(a.requestInProgress=!1,angular.element(".Rental-Receipt-FTP").modal("hide"),w.ftpSuccess=
e.success))},function(e){a.requestInProgress=!1})}function u(){a.requestInProgress=!0;angular.isDefined(w.emailReceiptRequest)&&B.emailRequestHandler(w.emailReceiptRequest).then(function(e){angular.isDefined(e.success);angular.isDefined(e.errorList);angular.isDefined(e.status);w.validateResponse=e;if(angular.isDefined(e.fieldErrors)&&0<e.fieldErrors.length||angular.isDefined(e.warningList)&&0<e.warningList.length||angular.isDefined(e.errorList)&&0<e.errorList.length)w.prod=n.processErrorMessage(e),
a.requestInProgress=!1;else if(angular.isDefined(e.document))w.receiptRequest.rentalAgreementNum=angular.isDefined(e.rentalAgreementNumber)?e.rentalAgreementNumber:"",l.setStorageData("receiptRequest",w.receiptRequest),l.setStorageData("receiptResponse",w.validateResponse),p.location.href=a.contextPath+"/"+a.locale+"/reservation/receipt-details"+htmlExtension;else{w.prod=n.processErrorMessage(e);e=Dictionary.I18n.get("err.res.genericerrormsg,"+brand);var d=[];d.push({message:e});w.prod.errorList=
d;a.requestInProgress=!1}},function(e){a.requestInProgress=!1})}function I(){angular.isDefined(w.receiptRequest)&&B.load(w.receiptRequest).then(function(e){w.validateResponse=e;if(angular.isDefined(e.fieldErrors)&&0<e.fieldErrors.length||angular.isDefined(e.warningList)&&0<e.warningList.length)w.prod=n.processErrorMessage(e),a.requestInProgress=!1;else if(angular.isDefined(e.errorList)&&0<e.errorList.length)a.requestInProgress=!1,angular.forEach(e.errorList,function(d){if(angular.equals(d.code,"05218")||
angular.equals(d.code,"05222")&&!w.receiptRequest.rentalAgreementNum.match(f.noCouponCreditCardExp))w.lookupModel.lastName=w.receiptRequest.lastName,w.lookupModel.confirmationNumber=w.receiptRequest.rentalAgreementNum,z.setLookUpModel(w.lookupModel),a.requestInProgress=!0,C.load().then(function(e){p.location.href=a.contextPath+"/"+a.locale+"/reservation/reservation-details"+htmlExtension;a.requestInProgress=!1},function(e){a.requestInProgress=!1;w.errorDisplayList=e.errorList});else if(angular.equals(d.code,
"05222")){var g=[];d={message:Dictionary.I18n.get("err.receipt.openRental1")+w.receiptRequest.rentalAgreementNum+Dictionary.I18n.get("err.receipt.openRental2")};g.push(d);w.errorDisplayList=g}else w.prod=n.processErrorMessage(e)});else if(null==e.errorList||void 0==e.errorList)l.setStorageData("receiptRequest",w.receiptRequest),l.setStorageData("receiptResponse",w.validateResponse),a.requestInProgress=!1,p.location.href=a.contextPath+"/"+a.locale+"/reservation/receipt-details"+htmlExtension},function(a){})}
function m(){document.getElementsByName("receipt_form_view")[0].action=apiurl+"/pdf/fetchpdf";document.forms.receipt_form_view.submit()}t("ExceptionHandlerController",{$scope:n});var w=this,H=F.getQueryParamsUsingJs();w.showReceiptForm=!1;w.country={};w.pageContent={};w.initSuccess=!1;var A=l.getStorageData("ClosedRental");w.pageContent.countryList={};w.emailReceiptRequest={};w._setResidency=function(){var a=p.defaultCountryName;if(angular.isDefined(w.pageContent.countryList)){var d=w.pageContent.countryList.indexOf(y("filter")(w.pageContent.countryList,
function(e){return e.name===a})[0]);w.country=w.pageContent.countryList[d].code}};w.session=q.getSessionModel();w.customer=q.getCustomerModel();w.receiptRequest=f.receiptRequest;w.submit=function(e){a.requestInProgress=!0;w.errorDisplayList=[];w.errorMessage="";w.prod&&w.prod.warningList&&(w.prod.warningList=[]);w.prod&&w.prod.errorList&&(w.prod.errorList=[]);x.validate(e).success(w.validationSuccess).error(w.validationError)};w.validationSuccess=function(a){w.receiptRequest.countryCode=w.country;
w.receiptRequest.lastName.trim();w.receiptRequest.lastName=w.receiptRequest.lastName.replace(/^[^a-z|^A-Z]*/,"");w.receiptRequest.lastName=w.receiptRequest.lastName.replace(/\s\s+/g," ");w.receiptRequest.lastName=w.receiptRequest.lastName.replace(/[^a-zA-Z0-9\-\s]/g,"");I()};w.validationError=function(e){a.requestInProgress=!1;e=ABG.getFormValidationError(e,!1);-1!=e[0].message.indexOf("Please enter a valid \x3cstrong\x3econfirmation number")&&(e=[{message:Dictionary.I18n.get("13012")}]);w.errorDisplayList=
e};w.loadPdf=function(){a.requestInProgress=!0;w.clientInfo=ABG.getClientInfo();if(angular.isDefined(w.receiptRequest)||angular.isDefined(A)&&1==A)!angular.isDefined(w.validateResponse)&&angular.isDefined(A)&&0==A&&I(),w.clientInfo.isIE&&w.clientInfo.isIE9&&-1==navigator.userAgent.indexOf("Edge")?(document.getElementsByName("receipt_form_hidden")[0].action=apiurl+"/pdf/fetchpdf",document.forms.receipt_form_hidden.submit()):(w.ie9=!1,B.getReceipt().then(function(e){a.requestInProgress=!0;if(angular.isDefined(e)&&
angular.isDefined(e.byteLength)&&500>e.byteLength){e=Dictionary.I18n.get("err.res.genericerrormsg,"+brand);var d=[];d.push({message:e});w.errorDisplayList=d;l.setStorageData("pdfError",w.errorDisplayList);p.location.href=a.contextPath+"/"+a.locale+"/reservation/get-e-receipt"+htmlExtension}else if(null==e.error||void 0==e.error){w.displayPdf=!0;w.receiptResponse=e;w.file=new Blob([w.receiptResponse],{type:"application/pdf"});w.fileURL=URL.createObjectURL(w.file);var f=document.getElementById("rental-receipt-pdf-wrapper"),
h=document.getElementById("rental-receipt-pdf"),m=h.getContext("2d");PDFJS.workerSrc="/etc/designs/platform/pdfjs-worker-clientlib.js";PDFJS.getDocument(w.fileURL).then(function(a){return a.getPage(1)}).then(function(e){var d=e.getViewport(3);h.width=d.width;h.height=d.height;w.clientInfo.isIE&&!w.clientInfo.isIE9?($(" #rental-receipt-pdf-wrapper").css("height",1723),h.style.width=h.style.height="100%"):h.style.width=h.style.height=f.style.width=f.style.height="100%";d={canvasContext:m,viewport:d};
k.load().then(function(a){(w.ftp=a)&&a.reservationSummary&&a.reservationSummary.ftpDetails&&a.reservationSummary.ftpDetails.messages&&w._getFTPSectionMessage(a.reservationSummary.ftpDetails.messages)},function(a){});a.requestInProgress=!1;e.render(d)})}}));a.requestInProgress=!1};w.initialize=function(){a.requestInProgress=!0;w.validateResponse=l.getStorageData("receiptResponse");w.receiptRequest=l.getStorageData("receiptRequest")};w.viewPdf=m;w.printPdf=function(){if(w.clientInfo.isIE||-1<navigator.userAgent.indexOf("Trident"))m();
else{var a=document.getElementById("rental-receipt-pdf"),d=new Image;d.src=a.toDataURL();d.setAttribute("width","100%");var f=window.open("","","");f.document.write("\x3c!doctype html\x3e\x3chtml\x3e\x3cbody id\x3d'body'\x3e\x3c/body\x3e\x3c/html\x3e");f.document.getElementById("body").appendChild(d);setTimeout(function(){f.focus();f.print()},1E3)}};w._validateReceipt=I;w._initLookup=function(){w.emailReqFlow&&angular.isDefined(q.getXsrfToken())&&!w.initSuccess?(a.requestInProgress=!0,w.initSuccess=
!0,w.emailReceiptRequest={key:H.KEY,country:H.COUNTRY?H.COUNTRY:"",language:H.LANGUAGE?H.LANGUAGE:""},u()):w.emailReqFlow&&(a.requestInProgress=!0);w.sessionErrorMessage=l.getStorageData("sessionErrMsg");z.deleteDataBeforeLogoClick();w.pdfError=l.getStorageData("pdfError");w.pdfError&&(w.errorDisplayList=w.pdfError);l.deleteStorageData("pdfError");if(w.sessionErrorMessage){var e=[];e.push({message:w.sessionErrorMessage});w.errorDisplayList=e;$(".res-PageError .mainErrorText").text(w.sessionErrorMessage);
$(".res-PageError .mainErrorText").show();l.deleteStorageData("sessionErrMsg")}!angular.isDefined(w.session)||w.session.status!=f.userStateRecognized&&w.session.status!=f.userStateAuthenticated&&w.session.status!==f.userStateRememberMe||(w.receiptRequest.lastName=w.customer.lastName)};w.addRntalFtp=r;w.addRental=function(){w._validateFTPData();1>w.errorList.length&&r()};w._validateFTPData=function(){var a=!0,d=!0,f=[],h,k=[];if(void 0==w.reservationModel||void 0==w.reservationModel.ftpDetails||void 0==
w.reservationModel.ftpDetails.partnerCode||""==w.reservationModel.ftpDetails.partnerCode)a=!1;if(void 0==w.reservationModel||void 0==w.reservationModel.ftpDetails||void 0==w.reservationModel.ftpDetails.ftpNumber||""==w.reservationModel.ftpDetails.ftpNumber)d=!1;d&&!a?f.push(x.displayServiceError("vm.reservationModel.ftpDetails.partnerCode","ftpInvalid")):a&&!d?f.push(x.displayServiceError("vm.reservationModel.ftpDetails.ftpNumber","ftpInvalid")):a||d||f.push("Please enter your rewards program name and membership number");
1===f.length&&(h={message:f[0]});0!=f.length&&k.push(h);w.errorList=k};w.lookupInitialize=function(){a.requestInProgress=!0;w.emailReqFlow?w.showReceiptForm=!0:(w.showReceiptForm=!0,a.requestInProgress=!1);var e=angular.fromJson(p.countryList).countryInfoList;w.pageContent.countryList=e;"avis"==p.brand&&"us"==p.domain.toLowerCase()&&("es"==p.locale||"es_US"==p.locale?w.pageContent.countryList.push({code:"U-U S A",name:"EE. UU."}):("pt"==p.locale||"pt_US"==p.locale)&&w.pageContent.countryList.push({code:"U-U S A",
name:"U S A"}));w._setResidency()};w.downloadPdf=function(){if(w.clientInfo.isIE||-1<navigator.userAgent.indexOf("Trident"))m();else{var a=document.createElement("a");w.file=new Blob([w.receiptResponse],{type:"application/pdf"});w.fileURL=window.URL.createObjectURL(w.file);a.href=w.fileURL;a.download="e-receipt.pdf";document.body.appendChild(a);a.click()}};w.lookupModel=f.lookupModel;w.getLoginModalWindow=function(){a.$broadcast("LoginActivity",{requestType:"Login",variance:"Small"})};w.submitGetPage=
function(a){x.validate(a).success(function(){p.location.href=v}).error(function(a){})};var v=p.redirectUrl;w.emailReqFlow=-1<window.location.pathname.toLowerCase().indexOf("get-e-receipt")&&H.KEY?!0:!1;a.$on("initSuccess",function(a,d){!1===l.sessionStorageSupport()&&(w.session=q.getSessionModel(),w.customer=q.getCustomerModel(),w.lookupModel=f.receiptRequest,w._initLookup());w.emailReqFlow&&!w.initSuccess&&(w.initSuccess=!0,w.emailReceiptRequest={key:H.KEY,country:H.COUNTRY?H.COUNTRY:"",language:H.LANGUAGE?
H.LANGUAGE:""},u())});w._initLookup();jQuery(document).ready(function(){z.addGTMScript()})}angular.module("receipt").controller("ReceiptController",t);t.$inject="$controller $scope $rootScope $state $window $sce ftpService storageService authenticationService $validation carRentalConstant reservationModelService $stateParams ReceiptLookupService $filter utilityService lookupService".split(" ")})();
(function(){function t(t,n,a,h,p,d,k,l,q,x){function f(a){var d="";angular.isDefined(a)&&angular.isDefined(a.vehicleFeatures)&&0<a.vehicleFeatures.length&&(d={carClass:angular.isDefined(a.carClass)?a.carClass:"",makeNme:angular.isDefined(a.makeNme)?a.makeNme:"",makeYr:angular.isDefined(a.makeYr)?a.makeYr:"",color:angular.isDefined(a.color)?a.color:"",makeModel:angular.isDefined(a.makeModel)?a.makeModel:"",connectedCar:J(a.vehicleFeatures,"connectedCar"),carGroup:angular.isDefined(a.carGroup)?a.carGroup:
"",startingFuel:B(a.vehicleFeatures,"startingFuel"),mileage:B(a.vehicleFeatures,"mileage"),lotSpaceNumber:B(a.vehicleFeatures,"lotSpaceNumber"),Seats:B(a.vehicleFeatures,"Seats"),Suitcases:B(a.vehicleFeatures,"Suitcases"),Doors:B(a.vehicleFeatures,"Doors"),mpg:B(a.vehicleFeatures,"mpg"),airConditioned:J(a.vehicleFeatures,"Air"),automaticTransmission:J(a.vehicleFeatures,"Auto"),smokeFree:J(a.vehicleFeatures,"NS"),bluetoothEnabled:J(a.vehicleFeatures,"bluetoothEnabled"),upsellStatus:angular.isDefined(a.upsellStatus)?
a.upsellStatus:"",earlyPickUpCharge:angular.isDefined(a.earlyPickUpCharge)?a.earlyPickUpCharge:"",earlyPickUpIndicator:angular.isDefined(a.earlyPickUpCharge)?a.earlyPickUpCharge:"",image:angular.isDefined(a.image)?a.image:"",upgradeAmount:angular.isDefined(a.upgradeAmount)?a.upgradeAmount:"",estimatedTotal:angular.isDefined(a.estimatedTotal)?a.estimatedTotal:"",licensePlateNumber:B(a.vehicleFeatures,"licensePlateNumber"),isPerDayPrice:angular.isDefined(a.perDayPrice)?a.perDayPrice:!1,isTaxFeesIncluded:angular.isDefined(a.taxFeesIncluded)?
a.taxFeesIncluded:!0,additionalCharges:angular.isDefined(a.additionalCharges)?a.additionalCharges:"",fiveStarSafetyRate:angular.isDefined(a.fiveStarSafetyRate)?a.fiveStarSafetyRate:!1,freeUpgrade:angular.isDefined(a.freeUpgrade)?a.freeUpgrade:!1,mvaNumber:angular.isDefined(a.mvaNumber)?a.mvaNumber:angular.isDefined(B(a.vehicleFeatures,"mvaNumber"))?B(a.vehicleFeatures,"mvaNumber"):""});return d}function u(a){var d=[];angular.forEach(a,function(a,h){a=f(a);d.push(a)});return d}function J(a,d){var f=
!1;angular.forEach(a,function(a,h){a.name!=d||"Y"!=a.value&&"TRUE"!=a.value||(f=!0)});return f}function B(a,d){var f=0;angular.forEach(a,function(a,h){a.name==d&&(f=a.value)});return f}return{getVehicleDetails:function(d,f){var h=a.defer();n({method:"POST",url:apiurl+(f?"/self-checkout/vehicle-exchange":"/rental/vehicles"),data:d}).then(function(a){var d=a.data;a={};angular.isDefined(d)?(f?angular.isDefined(d.reservationSummary)&&angular.isDefined(d.reservationSummary.vehicleSummaryList)&&0<d.reservationSummary.vehicleSummaryList.length&&
(angular.isDefined(d.reservationSummary.pickLoc)&&(a.pickLoc=d.reservationSummary.pickLoc),a.fiveStarCarAvailable=d.fiveStarCarAvailable,angular.isDefined(d.reservationSummary.confirmationNumber)&&(a.confirmationNumber=d.reservationSummary.confirmationNumber),a.vehicleSummaryList=u(d.reservationSummary.vehicleSummaryList)):!f&&angular.isDefined(d.vehicleSummaryList)&&0<d.vehicleSummaryList.length&&(angular.isDefined(d.reservationSummary)&&angular.isDefined(d.reservationSummary.pickLoc)&&(a.pickLoc=
d.reservationSummary.pickLoc),a.fiveStarCarAvailable=d.fiveStarCarAvailable,angular.isDefined(d.reservationSummary)&&angular.isDefined(d.reservationSummary.confirmationNumber)&&(a.confirmationNumber=d.reservationSummary.confirmationNumber),a.vehicleSummaryList=u(d.vehicleSummaryList)),angular.isDefined(d.instructionList)&&0<d.instructionList.length?a.instructionList=d.instructionList:angular.isDefined(d.errorList)&&(a=q.processError(d)),h.resolve(a)):h.reject(d)}).catch(function(a){h.reject(a.data)});
return h.promise},vehicleConfirm:function(d,h,k){d={parkingSpace:d,mvaNumber:h};var l=a.defer();n({method:"POST",url:apiurl+(k?"/self-checkout/vehicle-confirm":"/rental/checkout-confirm"),data:d}).then(function(a){a=a.data;if(angular.isDefined(a)){var d="";if(angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.vehicle)){angular.isDefined(a.reservationSummary.pickLoc)&&angular.isDefined(a.reservationSummary.pickLoc.locationCode)&&(d=a.reservationSummary.pickLoc.locationCode);
var h=a.reservationSummary.rentalAgreementNumber;a=f(a.reservationSummary.vehicle);a.rentalAgreementNumber=h;a.pickLocationCode=d}angular.isDefined(a.errorList)&&(a=q.processError(a));l.resolve(a)}else l.reject(a)}).catch(function(a){l.reject(a.data)});return l.promise},getVehicleData:function(d){var f=a.defer(),h={};x.loadRentalSummary("CHOICE_VEHICLES_URL",d).then(function(a){angular.isDefined(a)?(d&&(a.vehicleSummaryList=a.reservationSummary.vehicleSummaryList),angular.isDefined(a.vehicleSummaryList)&&
0<a.vehicleSummaryList.length?(angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.pickLoc)&&(h.pickLoc=a.reservationSummary.pickLoc),h.fiveStarCarAvailable=a.fiveStarCarAvailable,angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.confirmationNumber)&&(h.confirmationNumber=a.reservationSummary.confirmationNumber),h.vehicleSummaryList=u(a.vehicleSummaryList)):angular.isDefined(a.errorList)&&(h=q.processError(a)),f.resolve(h)):f.reject(a)});return f.promise},
getConfirmData:function(){var d=a.defer();x.loadRentalSummary("CHOICE_VEHICLES_CONFIRM").then(function(a){if(angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.vehicle)){if(angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.pickLoc)){var h=a.reservationSummary.rentalAgreementNumber;a=f(a.reservationSummary.vehicle);a.rentalAgreementNumber=h}angular.isDefined(a.errorList)&&(a=q.processError(a));d.resolve(a)}else d.reject(a)});return d.promise}}}
angular.module("rental").service("rentalVehicleService",t);t.$inject="$injector $http $q $window authenticationService reservationModelService carRentalConstant storageService exceptionHandler summaryEndPointService".split(" ")})();