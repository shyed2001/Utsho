/*
 @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js  @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
(function(t){t.URL=t.URL||t.webkitURL;if(t.Blob&&t.URL)try{new Blob;return}catch(q){}var x=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||function(q){var l=function(f){return Object.prototype.toString.call(f).match(/^\[object\s(.*)\]$/)[1]},v=function(){this.data=[]},p=function(f,m,e){this.data=f;this.size=f.length;this.type=m;this.encoding=e},y=v.prototype,g=p.prototype,x=q.FileReaderSync,A=function(f){this.code=this[this.name=f]},B="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),
t=B.length,E=q.URL||q.webkitURL||q,w=E.createObjectURL,z=E.revokeObjectURL,G=E,n=q.btoa,H=q.atob,I=q.ArrayBuffer,u=q.Uint8Array,m=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(p.fake=g.fake=!0;t--;)A.prototype[B[t]]=t+1;E.createObjectURL||(G=q.URL=function(f){var D=document.createElementNS("http://www.w3.org/1999/xhtml","a");D.href=f;"origin"in D||("data:"===D.protocol.toLowerCase()?D.origin=null:(f=f.match(m),D.origin=f&&f[1]));return D});G.createObjectURL=function(f){var m=f.type;null===m&&(m="application/octet-stream");
if(f instanceof p)return m="data:"+m,"base64"===f.encoding?m+";base64,"+f.data:"URI"===f.encoding?m+","+decodeURIComponent(f.data):n?m+";base64,"+n(f.data):m+","+encodeURIComponent(f.data);if(w)return w.call(E,f)};G.revokeObjectURL=function(f){"data:"!==f.substring(0,5)&&z&&z.call(E,f)};y.append=function(f){var m=this.data;if(u&&(f instanceof I||f instanceof u)){var e="";f=new u(f);for(var h=0,r=f.length;h<r;h++)e+=String.fromCharCode(f[h]);m.push(e)}else if("Blob"===l(f)||"File"===l(f))if(x)e=new x,
m.push(e.readAsBinaryString(f));else throw new A("NOT_READABLE_ERR");else f instanceof p?"base64"===f.encoding&&H?m.push(H(f.data)):"URI"===f.encoding?m.push(decodeURIComponent(f.data)):"raw"===f.encoding&&m.push(f.data):("string"!==typeof f&&(f+=""),m.push(unescape(encodeURIComponent(f))))};y.getBlob=function(f){arguments.length||(f=null);return new p(this.data.join(""),f,"raw")};y.toString=function(){return"[object BlobBuilder]"};g.slice=function(f,m,e){var h=arguments.length;3>h&&(e=null);return new p(this.data.slice(f,
1<h?m:this.data.length),e,this.encoding)};g.toString=function(){return"[object Blob]"};g.close=function(){this.size=0;delete this.data};return v}(t);t.Blob=function(q,l){l=l?l.type||"":"";var v=new x;if(q)for(var p=0,y=q.length;p<y;p++)Uint8Array&&q[p]instanceof Uint8Array?v.append(q[p].buffer):v.append(q[p]);q=v.getBlob(l);!q.slice&&q.webkitSlice&&(q.slice=q.webkitSlice);return q};t.Blob.prototype=(Object.getPrototypeOf||function(q){return q.__proto__})(new t.Blob)})("undefined"!==typeof self&&self||
"undefined"!==typeof window&&window||this.content||this);
var saveAs=saveAs||function(t){if("undefined"===typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var x=t.document.createElementNS("http://www.w3.org/1999/xhtml","a"),q="download"in x,l=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),v=t.webkitRequestFileSystem,p=t.requestFileSystem||v||t.mozRequestFileSystem,y=function(g){(t.setImmediate||t.setTimeout)(function(){throw g;},0)},g=0,C=function(g){var l=function(){"string"===typeof g?(t.URL||t.webkitURL||t).revokeObjectURL(g):g.remove()};
t.chrome?l():setTimeout(l,500)},A=function(g,l,p){l=[].concat(l);for(var n=l.length;n--;){var w=g["on"+l[n]];if("function"===typeof w)try{w.call(g,p||g)}catch(I){y(I)}}},B=function(g){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(g.type)?new Blob(["\ufeff",g],{type:g.type}):g},F=function(w,z,E){E||(w=B(w));var n=this;E=w.type;var y=!1,G=function(){A(n,["writestart","progress","write","writeend"])},u=function(){if(h&&l&&"undefined"!==typeof FileReader){var e=
new FileReader;e.onloadend=function(){var f=e.result;h.location.href="data:attachment/file"+f.slice(f.search(/[,;]/));n.readyState=n.DONE;G()};e.readAsDataURL(w);n.readyState=n.INIT}else{if(y||!D)D=(t.URL||t.webkitURL||t).createObjectURL(w);h?h.location.href=D:void 0==t.open(D,"_blank")&&l&&(t.location.href=D);n.readyState=n.DONE;G();C(D)}},m=function(e){return function(){if(n.readyState!==n.DONE)return e.apply(this,arguments)}},f={create:!0,exclusive:!1};n.readyState=n.INIT;z||(z="download");if(q){var D=
(t.URL||t.webkitURL||t).createObjectURL(w);setTimeout(function(){x.href=D;x.download=z;var e=new MouseEvent("click");x.dispatchEvent(e);G();C(D);n.readyState=n.DONE})}else{if(t.chrome&&E&&"application/octet-stream"!==E){var e=w.slice||w.webkitSlice;w=e.call(w,0,w.size,"application/octet-stream");y=!0}v&&"download"!==z&&(z+=".download");if("application/octet-stream"===E||v)var h=t;p?(g+=w.size,p(t.TEMPORARY,g,m(function(e){e.root.getDirectory("saved",f,m(function(e){var r=function(){e.getFile(z,f,
m(function(b){b.createWriter(m(function(e){e.onwriteend=function(e){h.location.href=b.toURL();n.readyState=n.DONE;A(n,"writeend",e);C(b)};e.onerror=function(){var b=e.error;b.code!==b.ABORT_ERR&&u()};["writestart","progress","write","abort"].forEach(function(b){e["on"+b]=n["on"+b]});e.write(w);n.abort=function(){e.abort();n.readyState=n.DONE};n.readyState=n.WRITING}),u)}),u)};e.getFile(z,{create:!1},m(function(b){b.remove();r()}),m(function(b){b.code===b.NOT_FOUND_ERR?r():u()}))}),u)}),u)):u()}},
E=F.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(g,l,p){p||(g=B(g));return navigator.msSaveOrOpenBlob(g,l||"download")};E.abort=function(){this.readyState=this.DONE;A(this,"abort")};E.readyState=E.INIT=0;E.WRITING=1;E.DONE=2;E.error=E.onwritestart=E.onprogress=E.onwrite=E.onabort=E.onerror=E.onwriteend=null;return function(g,l,p){return new F(g,l,p)}}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);
"undefined"!==typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!==typeof define&&null!==define&&null!=define.amd&&define([],function(){return saveAs});
var ics=function(){if(-1<navigator.userAgent.indexOf("MSIE")&&-1==navigator.userAgent.indexOf("MSIE 10"))console.log("Unsupported Browser");else{var t=-1!==navigator.appVersion.indexOf("Win")?"\r\n":"\n",x=[],q=["BEGIN:VCALENDAR","VERSION:2.0"].join(t),l=t+"END:VCALENDAR";return{events:function(){return x},calendar:function(){return q+t+x.join(t)+l},addEvent:function(l,p,q,g,C){if("undefined"===typeof l||"undefined"===typeof p||"undefined"===typeof q||"undefined"===typeof g||"undefined"===typeof C)return!1;
var v=new Date(g),y=new Date(C);C=("0000"+v.getFullYear().toString()).slice(-4);g=("00"+(v.getMonth()+1).toString()).slice(-2);var F=("00"+v.getDate().toString()).slice(-2),E=("00"+v.getHours().toString()).slice(-2),w=("00"+v.getMinutes().toString()).slice(-2);v=("00"+v.getMinutes().toString()).slice(-2);var z=("0000"+y.getFullYear().toString()).slice(-4),G=("00"+(y.getMonth()+1).toString()).slice(-2),n=("00"+y.getDate().toString()).slice(-2),H=("00"+y.getHours().toString()).slice(-2),I=("00"+y.getMinutes().toString()).slice(-2);
y=("00"+y.getMinutes().toString()).slice(-2);var u="",m="";0!=w+v+I+y&&(u="T"+E+w+v,m="T"+H+I+y);l=["BEGIN:VEVENT","CLASS:PUBLIC","DESCRIPTION;ENCODING\x3dQUOTED-PRINTABLE:"+p,"DTSTART;VALUE\x3dDATE:"+(C+g+F+u),"DTEND;VALUE\x3dDATE:"+(z+G+n+m),"LOCATION:"+q,"SUMMARY;LANGUAGE\x3den-us:"+l,"TRANSP:TRANSPARENT","END:VEVENT"].join(t);x.push(l);return l},download:function(v,p){if(1>x.length)return!1;p="undefined"!==typeof p?p:".vcs";v="undefined"!==typeof v?v:"calendar";var y=q+t+x.join(t)+l,g=encodeURI("data:text/calendar;charset\x3dutf8,"+
y);if(-1===navigator.userAgent.indexOf("MSIE 10"))var C=new Blob([y],{type:"text/calendar;charset\x3dutf8"});else C=new (window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder),C.append(y),C=C.getBlob("text/x-vCalendar;charset\x3d"+document.characterSet);0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")?window.open(g,"_self"):saveAs(C,v+p);return y}}}};
(function(){function t(x,q,l,v,p){var y=function(){this.isReady=function(g,l){return"Featured Vehicles"==l.recommType?q.isAvailable(g.availableVehicles,l.weekdayCarData):q.isAvailable(g.availableVehicles,l.carData)};this.process=function(g,l){var p=!1,w=[],n=[],v=l.recommTitle,y=l.carData;"Featured Vehicles"==l.recommType&&(y=l.weekdayCarData,angular.forEach(y,function(m){m.isFeatured=!0}));var u=0;y&&(u=y.length);angular.forEach(y,function(m){m.recommendedOrder=u;m.isFeatured?w.push(m):-1==v.indexOf("Weekend")&&
(n.push(m),p=!0);u--});q.saveRecommendations(w,n);g=q.groupAvailableVehicles(g,w,!1,n);g.isSortRecommended=p;return g}},g=function(){this.isReady=function(g,l){l=x.getMyBuysCarData();(g=q.isAvailable(g.availableVehicles,l))&&x.addToMyBuysCarData(l);return g};this.process=function(g,l){l=[];var p=x.getMyBuysCarData();l.push(p[0]);q.saveRecommendations(l);return q.groupAvailableVehicles(g,l,!1)}},t=function(){this.isReady=function(g,l){l=p.getPastRentalData(g);(g=q.isAvailable(g.availableVehicles,l))&&
x.addToPastRentalData(l);return g};this.process=function(g,l){l=x.getPastRentalData(g);q.saveRecommendations(l);return q.groupAvailableVehicles(g,l,!1)}},A=function(){this.isReady=function(g,l){l=p.getPreferedCarData(g);(g=q.isAvailable(g.availableVehicles,l))&&x.addToPreferedCarData(l);return g};this.process=function(g,l){var p=[],v=[];l=x.getPreferedCarData(g);angular.forEach(l,function(g){1==g.isFeatured?p.push(g):v.push(g)});q.saveRecommendations(p,v);return q.groupAvailableVehicles(g,p,!1,v)}},
B=function(){this.isReady=function(g,p){var v=!1,q=!1;p=g.reservationSummary.productSummaryList;g.webHeader&&(g.webHeader.p13nDetailsMap.rentalCounterProducts&&0<g.webHeader.p13nDetailsMap.rentalCounterProducts.length?(g=g.webHeader.p13nDetailsMap.rentalCounterProducts,v=l.isAvailable(p,g)):g.webHeader.p13nDetailsMap.crmTopRentedAncillaries&&0<g.webHeader.p13nDetailsMap.crmTopRentedAncillaries.length&&(g=g.webHeader.p13nDetailsMap.crmTopRentedAncillaries,q=l.isAvailable(p,g)));return v||q?!0:!1};
this.process=function(g,p){g=x.getExtraMerchandisingData();var v=p="";var q=x.getSupportedOptions();g.webHeader&&g.webHeader.p13nDetailsMap.rentalCounterProducts&&(p=g.webHeader.p13nDetailsMap.rentalCounterProducts);g.webHeader&&g.webHeader.p13nDetailsMap.crmTopRentedAncillaries&&(v=g.webHeader.p13nDetailsMap.crmTopRentedAncillaries);g.reservationSummary.productSummaryList=x.getAvailableProducts();return l.process(g,q,p,v)}},F=function(){this.process=function(g){l.setAncillaryBundlesData(g)}};return{getRecommendationObject:function(l){var p;
l===v.recomOthers||"Featured Vehicles"===l?p=new y:l===v.recomMyBuys?p=new g:l===v.recomPastRental?p=new t:l===v.recomExtrasPastRental?p=new B:l===v.recomPreferenceCar?p=new A:l===v.recomTierDiscount&&(p=new F);return p}}}angular.module("reservationServices").factory("Recommendations",t);t.$inject=["getDataService","vehicleService","optionalService","carRentalConstant","recommendedDataService"]})();
(function(){function t(x){x.state("/vehicleAvailability",{url:"/vehicles",templateUrl:rootpath+"/reservation/vehicle-availability.partial"+htmlExtension,controller:"VehicleListController",controllerAs:"vm"});x.state("/pre-checkin",{url:"/pre-checkin",templateUrl:rootpath+"/reservation/pre-checkin.partial"+htmlExtension});x.state("/pre-checkin-complete",{url:"/pre-checkin-complete",templateUrl:rootpath+"/reservation/confirmation.partial"+htmlExtension,controller:"ConfirmationController",controllerAs:"vm"});
x.state("/pre-checkin-confirmation",{url:"/pre-checkin-confirmation",templateUrl:rootpath+"/reservation/pre-checkin-confirmation.partial"+htmlExtension,controller:"PreCheckinController",controllerAs:"vm"});x.state("/protectionCoverage",{url:"/extras",templateUrl:rootpath+"/reservation/protectioncoverage.partial"+htmlExtension,controller:"ExtrasController",controllerAs:"vm"});x.state("/review-and-book",{url:"/review-and-book",templateUrl:rootpath+"/reservation/review-and-book.partial"+htmlExtension,
controller:"ReviewController",controllerAs:"vm"});x.state("/review-and-book-paylater",{url:"/review-and-book-paylater",templateUrl:rootpath+"/reservation/review-and-book-paylater.partial"+htmlExtension,controller:"ReviewController",controllerAs:"vm"});x.state("/confirmationPage",{url:"/confirmation/:infoKey",templateUrl:rootpath+"/reservation/confirmation.partial"+htmlExtension,controller:"ConfirmationController",controllerAs:"vm"});x.state("/printableConfirmationPage",{url:"/printableConfirmationPage",
templateUrl:rootpath+"/reservation/printable-confirmation-page.print"+htmlExtension,controller:"PrintConfirmationController",controllerAs:"vm"});x.state("/reservationSummary",{url:"/summary",templateUrl:rootpath+"/reservation/reservation-details.partial"+htmlExtension});x.state("/reservationSummaryCancel",{url:"/summary-cancel",templateUrl:rootpath+"/reservation/reservation-details.partial"+htmlExtension});x.state("/modifyReviewConfirm",{url:"/review-modifications",templateUrl:rootpath+"/reservation/modify-review-confirm.partial"+
htmlExtension,controller:"ReviewModifyController",controllerAs:"vm"});x.state("/display-reservation",{url:"/display-reservation",templateUrl:rootpath+"/reservation/find-reservation.partial"+htmlExtension,controller:"DisplayReservationController",controllerAs:"vm"});x.state("/modify-reservation",{url:"/manage",templateUrl:rootpath+"/reservation/manage-reservation.partial"+htmlExtension});x.state("/make-a-reservation",{url:"/time-and-place",templateUrl:rootpath+"/reservation/make-reservation.partial"+
htmlExtension});x.state("/cancelBooking",{url:"/cancel-confirmation",templateUrl:rootpath+"/reservation/cancelConfirmation.partial"+htmlExtension,controller:"ConfirmationController",controllerAs:"vm"});x.state("/viewModifyCancel",{url:"/view-modify-cancel",templateUrl:rootpath+"/reservation/view-modify-cancel.partial"+htmlExtension,controller:"LookupController",controllerAs:"vm"});x.state("/quickPass",{url:"/quick-pass",templateUrl:rootpath+"/reservation/selfcheckout-quickpass.partial"+htmlExtension,
controller:"SelfCheckoutQuickpassController",controllerAs:"vm"});x.state("/lookUp",{url:"/lookup/:infoKey",templateUrl:rootpath+"/reservation/view-modify-cancel.partial"+htmlExtension,controller:"LookupController",controllerAs:"vm"});x.state("/reservationSummaryEmail",{url:"/summary/:lastName/:confirmationNumber",templateUrl:rootpath+"/reservation/reservation-details.partial"+htmlExtension});x.state("/reservationDigitalWallet",{url:"/summary/:lastName/:confirmationNumber/:errorKey",templateUrl:rootpath+
"/reservation/reservation-details.partial"+htmlExtension});x.state("/reservationSummaryError",{url:"/summary/:errorKey",templateUrl:rootpath+"/reservation/reservation-details.partial"+htmlExtension});x.state("/reservationSummaryInfoError",{url:"/ressummary/:infoKey",templateUrl:rootpath+"/reservation/reservation-details.partial"+htmlExtension});x.state("/corporate",{url:"/corporate",template:"",controller:"BridgeController",controllerAs:"vm"});x.state("/oneclick",{url:"/oneclick",template:"",controller:"BridgeController",
controllerAs:"vm"});x.state("/oneclick-partner",{url:"/oneclick-partner",template:"",controller:"BridgeController",controllerAs:"vm"});x.state("/display-confirmationPage",{url:"/display-confirmation",templateUrl:rootpath+"/reservation/confirmation.partial"+htmlExtension,controller:"ConfirmationController",controllerAs:"vm"});x.state("/book-again",{url:"/book-again",templateUrl:rootpath+"/reservation/book-again/book-again-landing.partial"+htmlExtension,controller:"BookAgainController",controllerAs:"vm"});
x.state("/book-again-vehicle",{url:"/book-again-vehicle",templateUrl:rootpath+"/reservation/book-again/book-again-vehicle.partial"+htmlExtension,controller:"ResWidgetController",controllerAs:"resVm"});x.state("/book-again-pay",{url:"/book-again-pay",templateUrl:rootpath+"/reservation/book-again/book-again-pay-now.partial"+htmlExtension,controller:"ReviewController",controllerAs:"vm"});x.state("/book-again-pay-at-counter",{url:"/book-again-pay-at-counter",templateUrl:rootpath+"/reservation/book-again/book-again-pay-at-counter.partial"+
htmlExtension,controller:"ReviewController",controllerAs:"vm"});x.state("/express-enrollment",{url:"/sign-up",templateUrl:rootpath+contentRoot+"/enrollment.partial"+htmlExtension});x.state("/profile-activation",{url:"/activation",templateUrl:rootpath+contentRoot+"/activation.partial"+htmlExtension,controller:"ActivationController",controllerAs:"vm"});x.state("/credential-management",{url:"/credential-management",controller:"EmailCredentialController",controllerAs:"vm"});x.state("/password-reset",
{url:"/password-reset",controller:"EmailCredentialController",controllerAs:"vm"});x.state("/email-activate",{url:"/email-activate",controller:"EmailActivationController",controllerAs:"vm"});x.state("/cancelledResSummary",{url:"/cancelledResSummary",templateUrl:rootpath+"/reservation/reservation-details.partial"+htmlExtension})}angular.module("reservation").config(t);t.$inject=["$stateProvider"]})();
(function(){function t(x,q,l,v){return{load:function(){var p=q.defer();x({method:"GET",url:apiurl+"/partners/airline/"+internalLocale}).then(function(q){q=q.data;q=l.processError(q,v.modelMap);p.resolve(q)}).catch(function(l){console.log("Error")});return p.promise}}}angular.module("reservationServices").service("airlineService",t);t.$inject=["$http","$q","exceptionHandler","reservationModelService"]})();
(function(){function t(x,q,l,v,p){function y(){var g=q.defer();x({method:"GET",url:apiurl+"/partners/partner-names/"+internalLocale,data:""}).then(function(l){l=l.data;p.addToPartnerNamesData(l);g.resolve(l)}).catch(function(g){});return g.promise}return{load:y,getData:function(){var g=q.defer(),l=p.getPartnerNamesData();if(""==l||void 0==l||$.isEmptyObject(l))return y();g.resolve(l);return g.promise},addFTP:function(g,y){var A=q.defer();x({method:"POST",url:apiurl+"/reservation/addFTP/",data:{ftpNumber:y,
partnerCode:g}}).then(function(g){g=g.data;g=l.processError(g,v.modelMap);var q=p.getReviewData();q&&q.reservationSummary&&g&&g.reservationSummary&&(q.reservationSummary.ftpDetails&&g.reservationSummary.ftpDetails&&(q.reservationSummary.ftpDetails=g.reservationSummary.ftpDetails),q.reservationSummary.rateSummary&&q.reservationSummary.rateSummary.rateTerms&&g.reservationSummary.rateSummary&&g.reservationSummary.rateSummary.rateTerms&&(q.reservationSummary.rateSummary.rateTerms=g.reservationSummary.rateSummary.rateTerms),
q.reservationSummary.rateSummary&&q.reservationSummary.rateSummary.surcharges&&g.reservationSummary.rateSummary&&g.reservationSummary.rateSummary.surcharges&&(q.reservationSummary.rateSummary.surcharges=g.reservationSummary.rateSummary.surcharges),p.addToReviewData(q));A.resolve(g)}).catch(function(g){});return A.promise},addRentalFTP:function(g,p){var y=q.defer();x({method:"POST",url:apiurl+"/rental/addRentalFTP",data:{ftpNumber:p,partnerCode:g}}).then(function(g){g=g.data;g=l.processError(g,v.modelMap);
y.resolve(g)}).catch(function(g){});return y.promise}}}angular.module("reservationServices").service("ftpService",t);t.$inject=["$http","$q","exceptionHandler","reservationModelService","getDataService"]})();
(function(){function t(x,q,l,v,p,y,g,t,A){function B(){var l=q.defer(),p=g.load("VIEW_URL");q.all([p]).then(function(g){C(g[0]).then(function(g){l.resolve(g)})});return l.promise}function C(g){var l=q.defer();angular.copy(y.bookingModel);y.setClientContextData(g);g=p.processError(g,y.modelMap);angular.isDefined(g)&&angular.isDefined(g.reservationSummary)&&y.load(g,!1);l.resolve(g);return l.promise}return{getData:function(){var g=q.defer(),l={};if(angular.equals({},l))return B();l.instructionList=
[];g.resolve(l);return g.promise},loadData:C,phoneNumberValidation:function(g){g={phoneNumber:g};var l=q.defer();x({method:"POST",url:apiurl+"/reservation/validatePhoneNumber",data:g}).then(function(g){g=g.data;g=p.processError(g,y.modelMap);angular.isDefined(g)&&angular.isUndefined(g.errorList)?l.resolve(g):l.reject(g)}).catch(function(g){l.reject(g.data)});return l.promise},submitCheckinForm:function(g,l){g={confirmationNumber:l,driversLicense:{dlNumber:g.dlSummary.dlNumber,state:angular.isDefined(g.dlSummary.state)&&
"Not Applicable"!=g.dlSummary.state?g.dlSummary.state:t.nonUSStateCode,country:g.dlSummary.country,dateOfBirth:g.dobMonth+"/"+g.dobDate+"/"+g.dobYear},contactPhoneRQ:{phoneNumber:g.personalInfoRQ.phone,smsOptIn:angular.isDefined(g.personalInfoRQ.smsOptIn)&&1==g.personalInfoRQ.smsOptIn?"T":"N"},billingAddress:{address1:g.paymentRq.address.address1,address2:g.paymentRq.address.address2,address3:angular.isDefined(g.paymentRq.address.address3)?g.paymentRq.address.address3:"",city:g.paymentRq.address.city,
state:g.paymentRq.address.state,country:g.paymentRq.address.country,zipCode:g.paymentRq.address.zipCode}};var w=q.defer();x({method:"POST",url:apiurl+"/reservation/precheckout/confirm",data:g}).then(function(g){g=g.data;y.setClientContextData(g);v.brand!=t.brandName.PAYLESS&&ABG.updateContextStores();g=p.processError(g,y.modelMap);angular.isDefined(g)&&angular.isUndefined(g.errorList)?w.resolve(g):w.reject(g)}).catch(function(g){w.reject(g.data)});return w.promise}}}angular.module("reservationServices").service("preCheckinService",
t);t.$inject="$http $q $rootScope $window exceptionHandler reservationModelService summaryEndPointService carRentalConstant $sce".split(" ")})();
(function(){function t(){function x(l,p){var q={leftLimit:0,rightLimit:0,lastLimit:0};l.length<=p?q.rightLimit=l.length-1:l.length>p&&(q.rightLimit=p-1,q.lastLimit=l.length-1);return q}function q(l){var p={equipmentsList:[],servicesList:[],services_tab1List:[],services_tab2List:[]},q=[],g=[],v=[],x=[];angular.forEach(l,function(l,p){"tab2"==l.tabType?q.push(l):"tab3"==l.tabType?g.push(l):"tab4"==l.tabType?v.push(l):"tab5"==l.tabType&&x.push(l)});p.equipmentsList=q;p.servicesList=g;p.services_tab1List=
v;p.services_tab2List=x;return p}function l(l,p){angular.forEach(p,function(q,g){"tab1"==p[g].tabId?p[g].showTab=!0:angular.isDefined(l.equipmentsList)&&0<l.equipmentsList.length&&"tab2"==p[g].tabId?p[g].showTab=!0:angular.isDefined(l.servicesList)&&0<l.servicesList.length&&"tab3"==p[g].tabId?p[g].showTab=!0:angular.isDefined(l.services_tab1List)&&0<l.services_tab1List.length&&"tab4"==p[g].tabId?p[g].showTab=!0:angular.isDefined(l.services_tab2List)&&0<l.services_tab2List.length&&"tab5"==p[g].tabId?
p[g].showTab=!0:p[g].showTab=!1});return p}return{process:function(v){var p=q(v.productSummaryList),y={displayTabsList:l(p,v.getAvailableTabs),ancillaryProductsList:p,insuranceDisplayCount:0,equipDisplayLen:0,servicesDisplaylen:0,servicestab1len:0,servicestab2len:0};angular.isDefined(v.insuranceSummaryList)&&(y.insuranceDisplayCount=x(v.insuranceSummaryList,4));0<p.equipmentsList.length&&(y.equipDisplayLen=x(p.equipmentsList,8));0<p.servicesList.length&&(y.servicesDisplaylen=x(p.servicesList,8));
0<p.services_tab1List.length&&(y.servicestab1len=x(p.services_tab1List,8));0<p.services_tab2List.length&&(y.servicestab2len=x(p.services_tab2List,4));return y},getLimitObject:x,getAncillaryList:q,updateTabDetails:l,getCurrentActiveTab:function(l){var p={tab1:!1,tab2:!1,tab3:!1,tab4:!1,tab5:!1,tab6:!1};angular.forEach(l,function(l,g){"tab1"==l.tabId?p.tab1=l.active:"tab2"==l.tabId?p.tab2=l.active:"tab3"==l.tabId?p.tab3=l.active:"tab4"==l.tabId?p.tab4=l.active:"tab5"==l.tabId&&(p.tab5=l.active)});return p}}}
angular.module("reservationServices").service("ancillaryService",t);t.$inject=[]})();(function(){angular.module("reservation").directive("focusOnError",function(){return{restrict:"A",link:function(t,x,q,l){x.on("submit",function(){var l=$("form[name\x3d"+q.name+"]").offset().top;l-=100;var p=x[0].querySelector(".platform-element-error");p&&($("html, body").animate({scrollTop:l},1E3),p.focus())})}}})})();
(function(){angular.module("reservationServices").service("jsonCompare",function(){return{jsonComparator:function(t,x,q,l,v,p){angular.isUndefined(q)&&(q=!1);angular.isUndefined(l)&&(l=!1);angular.isUndefined(p)&&(p=!1);angular.isUndefined(v)&&(v={});x.constructor!==Array&&(x=[x]);p=0;for(var y=x.length;p<y;++p){var g=x[p];if(angular.isObject(g)||angular.isFunction(g))for(var C=Object.keys(g),A=0,B=C.length;A<B;A++){var F=C[A],E=g[F];angular.isObject(E)?(angular.isObject(t[F])||(t[F]=angular.isArray(E)?
[]:{}),this.jsonComparator(t[F],[E],q,l,v)):angular.equals(t[F],g[F])?q?t[F+"_MODIFIED"]=!1:t[F]=!1:q?t[F+"_MODIFIED"]=!0:t[F]=!0;if(A==C.length-1){F=Object.keys(t);E=0;for(var w=F.length;E<w;E++){var z=F[E],G=t[z];"object"!==typeof G&&angular.isUndefined(g[z])?-1===z.indexOf("_MODIFIED")&&(q?(t[z+"_MODIFIED"]=!0,t[z]=G):t[z]=!0):"object"==typeof G&&angular.isUndefined(g[z])&&(t[z]=angular.isArray(G)?[]:{},angular.forEach(G,function(g,l){q?(t[z][l+"_MODIFIED"]=!0,t[z][l]=g):t[z][l]=!0}))}}}}return t}}})})();
(function(){function t(x,q,l,v,p,y,g,t,A){return{load:function(B){var C=q.defer();x({method:"GET",url:apiurl+"/reservation/modify/"+B}).then(function(x){var w=x.data;p.setClientContextData(w);l.brand!=A.brandName.PAYLESS&&ABG.updateContextStores();w=v.processError(w,p.modelMap);w.errorList?C.resolve(w):q.all([y.getSelectedProductDetails(w.reservationSummary),y.getSelectedInsuranceDetails(w.reservationSummary)]).then(function(l){w.reservationSummary=l[0];w.reservationSummary=g.getPeriodFreeMilesMessage(w.reservationSummary);
angular.isDefined(w.reservationSummary)&&(w.reservationSummary.displayControl=w.reservationSummary.displayControl||{},angular.isDefined(w.reservationSummary.coupon)&&angular.isDefined(w.reservationSummary.coupon.description)&&0==w.reservationSummary.coupon.discountAmt?(w.reservationSummary.displayControl.couponFlag=!0,w.reservationSummary.displayControl.coupondescription=Dictionary.I18n.get("lbl.reservation.step3.reservationSummary.discountCodes.counterDescription"),w.reservationSummary.displayControl.coupondaydescription=
w.reservationSummary.coupon.description):angular.isDefined(w.reservationSummary.coupon)&&angular.isDefined(w.reservationSummary.coupon.description)&&0<w.reservationSummary.coupon.discountAmt&&(w.reservationSummary.displayControl.couponFlag=!0,w.reservationSummary.displayControl.coupondescription="",w.reservationSummary.displayControl.coupondaydescription=w.reservationSummary.coupon.description));p.setClientContextData(w);t.addToConfirmationData(w);C.resolve(w)})}).catch(function(g){C.reject(g.data)});
return C.promise}}}angular.module("reservationServices").service("confirmModifications",t);t.$inject="$http $q $window exceptionHandler reservationModelService optionalService utilityService getDataService carRentalConstant".split(" ")})();
(function(){function t(x,q,l,v,p,y,g,t,A){return{load:function(B,C,E,w){var z=q.defer();B={rqHeader:{locale:internalLocale},confirmationNumber:B,lastName:C,email:E,cancelReason:w};p.setLookUpModel(B);x({method:"POST",url:apiurl+"/reservation/cancel",data:B}).then(function(w){var n=w.data;n=v.processError(n,p.modelMap);q.all([y.getSelectedProductDetails(n.reservationSummary),y.getSelectedInsuranceDetails(n.reservationSummary)]).then(function(q){n=g.manageDiscount(n);n.reservationSummary=q[0];angular.isDefined(n.reservationSummary)&&
(n.reservationSummary=g.getPeriodFreeMilesMessage(n.reservationSummary));l.brand==t.brandName.BUDGET&&angular.isDefined(n.reservationSummary)&&angular.isDefined(n.reservationSummary.userState)&&"ANONYMOUS"==n.reservationSummary.userState&&A.deleteCustomerModel();p.setStorageData("cancelConfirmationData",n);z.resolve(n)})}).catch(function(g){z.reject(g.data)});return z.promise}}}angular.module("reservationServices").service("confirmCancelService",t);t.$inject="$http $q $window exceptionHandler reservationModelService optionalService utilityService carRentalConstant authenticationService".split(" ")})();
(function(){function t(x,q,l,v){return{forwardEmail:function(p){var y=q.defer();x({method:"POST",url:apiurl+"/reservation/sendEmail",data:p}).then(function(g){g=g.data;g=l.processError(g,v.modelMap);y.resolve(g)}).catch(function(g){y.reject(g.data)});return y.promise}}}angular.module("reservationServices").service("emailService",t);t.$inject=["$http","$q","exceptionHandler","reservationModelService"]})();
(function(){function t(x,q,l,v,p,y,g,t,A,B,F,E,w,z,G,n,H,I,u,m,f,D,e,h,r,J,M,b,O,S,T){function C(d){var e=document.querySelector("#confirmation-page-dci-btn");e&&(e=e.getAttribute("target"),a.trackingID=e);p.requestInProgress=!0;d&&b.deleteStorageData("isDciFlow");H.redirectToDLPage().then(function(d){angular.isDefined(d)&&(!angular.isDefined(d.instructionList)||"14978"!=d.instructionList[0].code&&"090004"!=d.instructionList[0].code&&"20008"!=d.instructionList[0].code&&"20007"!=d.instructionList[0].code&&
"20006"!=d.instructionList[0].code?(b.setStorageData("reservationModelSelfCheckOut",d),angular.isDefined(d.webHeader)&&"CHOICE_LICENSE_PLATE_SCAN"==d.webHeader.viewIndicator?n.location.href=p.contextPath+"/"+p.locale+"/on-lot-exchange"+htmlExtension+"#/start-up":angular.isDefined(d.webHeader)&&"CHOICE_NO_LICENSE_PLATE_SCAN"==d.webHeader.viewIndicator?n.location.href=p.contextPath+"/"+p.locale+"/on-lot-exchange"+htmlExtension+"#/start-up":angular.isDefined(d.webHeader)&&"PRECHECKIN_ELIGIBLE"==d.webHeader.viewIndicator&&
(n.location.href=p.contextPath+"/"+p.locale+"/self-checkout"+htmlExtension+"#/driver-info?"+a.trackingID)):(angular.isDefined(b.getStorageData("isDciFlow"))&&(b.setStorageData("reservationModelSelfCheckOut",d),b.setStorageData("equipmentCSSList",d)),n.location.href=p.contextPath+"/"+p.locale+"/reservation"+htmlExtension+"#/manage"))})}function da(){n.brand==D.brandName.PAYLESS&&(a.termsToPrintRequired=!0);var d=rootpath+"/reservation/print-confirmation"+htmlExtension+"#/?tncrequired\x3d"+a.termsToPrintRequired+
"\x26pageType\x3d"+(a.pageName===D.confirmationPage||a.pageName===D.displayConfirmationPage?"confirm":"cancel");a.tncRequired=a.termsToPrintRequired;n.open(d,"AEM","width\x3d950,height\x3d500,scrollbars\x3dyes")}function ba(){a.contentType=!0===a.confirmation.reservationSummary.prepayTxn?D.txnTypePrePay:D.txnTypePostPay;G.load(a.contentType,a.confirmation.reservationSummary.pickLoc.locationCode).then(function(d){a.CompleteTexNew=d;a._expandDebitTerms();if(angular.isDefined(a.confirmation.reservationSummary.dropLoc)&&
angular.isDefined(1==a.confirmation.reservationSummary.dropLoc.keyDrop)&&1==a.keyDroptermsNc)for(var b=0;b<d.length;b++)if("After Hours Return"==d[b].Id){a.afterHourTnC=d[b].Description.toString().replace(/<[^>]+>/gm,"");break}},function(a){})}function ca(d){d=d.split("|,");var b=[];angular.forEach(d,function(a,d){-1!=a.indexOf("|")&&(d={},d.code=a.split("|")[0],d.included="included"==a.split("|")[1]?!0:!1,b.push(d))});0<b.length&&(angular.forEach(b,function(d,b){angular.forEach(a.insuranceDisplay,
function(a,b){a.code==d.code&&d.included&&(a.included=!0,a.selected="TRUE")})}),angular.forEach(b,function(d,b){b=u.getStorageData("productList");angular.forEach(b,function(b,e){b.code==d.code&&d.included&&(b.included=!0,b.selected=!0,a.products.push(b))})}))}function U(d,b){b==D.resFlowModify?angular.isDefined(d)&&angular.isDefined(d.reservationSummary)&&d.reservationSummary.concurUser&&(0==d.reservationSummary.corporateBookingType&&1==d.reservationSummary.optOpenBooking||d.reservationSummary.corporateBookingType&&
(1==d.reservationSummary.optOpenBooking||0==d.reservationSummary.optOpenBooking))&&e.addToConcur(b).then(function(d){a.confirmation=d;a.reservation=d},function(a){console.log("not added to Concur")}):angular.isDefined(d)&&angular.isDefined(d.reservationSummary)&&d.reservationSummary.concurUser&&d.reservationSummary.corporateBookingType&&e.addToConcur(b).then(function(d){a.confirmation=d;a.reservation=d},function(a){console.log("not added to Concur")});angular.isDefined(d)&&angular.isDefined(d.webHeader)&&
d.webHeader.tripItCookieExists&&e.tripItConfirm().then(function(d){a.confirmation=d;a.reservation=d;angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.tripAggregator)&&angular.isDefined(a.confirmation.reservationSummary.tripAggregator.tripitAddedFlag)&&(a.tripItAddedFlag=a.confirmation.reservationSummary.tripAggregator.tripitAddedFlag)},function(a){console.log("not added to tripit")})}function Z(d){if(1==d.reservationSummary.prepayTxn&&
("AU"==d.reservationSummary.pickLoc.address.country.toUpperCase()||"NZ"==d.reservationSummary.pickLoc.address.country.toUpperCase())){var b=d.reservationSummary.displayAddress;a.bookingAddress.fullName=d.reservationSummary.personalInfo.firstName.value+" "+d.reservationSummary.personalInfo.displayLastName.value;a.bookingAddress.address1=b.address1;a.bookingAddress.address2=b.address2;switch(b.country){case "AU":a.bookingAddress.address3=b.address3+", "+b.state+", "+b.zipCode;break;case "NZ":a.bookingAddress.address3=
"";void 0!=b.address3&&(a.bookingAddress.address3=b.address3+", ");a.bookingAddress.address3+=b.city+", "+b.zipCode;break;case "US":case "CA":a.bookingAddress.address3=b.city+", "+b.state+", "+b.zipCode;break;default:a.bookingAddress.address3=b.address3}a.bookingAddress.address3=a.bookingAddress.address3+", "+b.country}}p.emailRedirectingPath=!0;"true"===n.jsProfileConfigFlag&&(n.startTime.confirmationPage=performance.now());B("ExceptionHandlerController",{$scope:l});p.chkRedeemedRes=!1;window.dataLayer=
window.dataLayer||[];var a=this;a.pageName=g.current.name;a.domain=n.domain;a.emailFlag=p.$progressbar.$previousState.name;a.cancelModify=!0;a.trackingID="";a.prepaycancelReservation=!1;a.refundcancelReservation=!1;a.prepaycancelReservationAUNZ=!1;a.modifyConfirmation=D.resFlowModify;a.getcouponquantity="";a.chkRedeemedRes=!1;a.reservationModel=u.getReservationModel();a.lookupModel=u.lookupModel;a.forwardEmailModel=u.forwardEmailModel;a.openNewWindow=function(a){n.open(a,"AEM","width\x3d950,height\x3d500",
"resizable\x3dno","toolbar\x3dno","location\x3dno","status\x3dno","menubar\x3dno","scrollbars\x3dyes")};a.replaceWindow=function(d){a.reservationModel=u.getReservationModel();angular.isDefined(a.reservationModel)&&(a.reservationModel.displayControls.reservation=D.resFlowCreate,u.setReservationModel(a.reservationModel));n.location.href=d};a.isConcurTrip=function(){return angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.tripAggregator)&&
angular.isDefined(a.confirmation.reservationSummary.tripAggregator.concurMessage)&&angular.isDefined("05125"===a.confirmation.reservationSummary.tripAggregator.concurMessage.code)?!0:!1};a.multiCurrencyFlag=!1;a.tripItModel=u.tripItModel;a.tripItAddedFlag=!1;a.tripItMessage="";a.tripItError=!1;a.expiredccMessage="";a.autoAddTripit=function(){var d={};d.lastname=a.confirmation.reservationSummary.personalInfo.lastName.value;d.email=a.confirmation.reservationSummary.personalInfo.email;d.autoAdd="1";
a._callTripItService(d)};a.enrollTripit=function(){n.location.href=p.contextPath+"/"+p.locale+"/reservation/tripit"+htmlExtension};a.pickUpLocationLink="";a.dropOffLocationLink="";a.userAge="";a.bookedDate="";a.currencySymbol="";a.disableModifyCancel=!1;p.keyDropPath="";p.mapModalPath="";a.confmessage=!1;a.keyDroptermsNc=!1;a.dciNewUi=!1;a.showUpsellMessageError=!1;a.keyDropTnC=function(){a.keyDroptermsNc=!0;ba()};a.reservation={};a.insuranceDisplay=[];a.products=[];a.confirmation={reservationSummary:{rateSummary:{selectedInsurances:void 0}}};
a.productUpsellCode;a.protectionUpsellCode;a.oneClickURLMessage=!1;a.showUpsellMessage=!1;a.productUpsellError=!1;a.accordionStatus={mileage:!1};a.gstOnNoShowFee="";a.gstOnCancelFee="";a.cancelFee="";a.currency="";a.noShowFee="";a.rentalLocationCountry="";a.cancelReasonList=[];a.pastPickUpReservation=!1;a.resAmt_greaterthan_cancelAmt=!1;a.resAmt_lessthan_cancelAmt=!1;a.resAmt_greaterthan_noShowAmt=!1;a.resAmt_lessthan_noShowAmt=!1;a.cancelFeeGreaterThanPrepaidAmount=!1;a.cancelFeeLessOrEqualThanPrepaidAmount=
!1;a.proactiveChat=!1;a.showProactiveChatBtn=!1;a.bookingAddress={fullName:"",address1:"",address2:"",address3:""};a.hideSmallBiz=function(){n.brand==D.brandName.BUDGET&&"us"==a.domain&&($("#small-biz-modal").hide(),$(".smBiz-enroll-button").hide())};a.callProactiveChat=function(){a.proactiveChat=!0;$(".oo_feedback_float").hide();$("#divChatContainer").click()};a.resetEmailForm=function(){a.emailuserForm.$setUntouched();a.emailuserForm.$setPristine();angular.element('form[name\x3d"vm.emailuserForm"] input').removeClass("ng-invalid");
angular.element('form[name\x3d"vm.emailuserForm"] input').removeClass("platform-element-error");a.forwardEmail.globaErrorFlag=!1;f.resetError("vm.forwardEmailModel.emailId",!0);f.resetError("vm.forwardEmailModel.confirmEmailId",!0)};a.clearForwardDetails=function(){angular.element(".platform-error-message").css("display","none");f.resetError("vm.forwardEmailModel.emailId",!0);f.resetError("vm.forwardEmailModel.confirmEmailId",!0)};a.modifyTimePlace=function(){p.requestInProgress=!p.requestInProgress;
jQuery("#avisLoader").removeClass("hidden");jQuery("#step2Placeholder").addClass("hidden");jQuery("#defaultLoader").removeClass("hidden");jQuery("#budgetStep2Placeholder").addClass("hidden");u.load(a.confirmation,!1).then(function(d){a.reservationModel=d;angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.amazonReservation)&&(a.reservationModel.amazonReservation=a.confirmation.reservationSummary.amazonReservation);
p.reservation=d.displayControls.reservation;E.addToAvailableVehicles("");u.setLookUpModel({lastName:a.reservationModel.personalInfoRQ.lastName,confirmationNumber:a.reservationModel.confirmationNumber,email:a.reservationModel.personalInfoRQ.email});angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.awdNumber)&&(a.reservationModel.confdiscountnum=a.confirmation.reservationSummary.awdNumber,u.setReservationModel(a.reservationModel));
g.go(D.step1aPageName)},function(a){p.requestInProgress=!1})};a.modifyVehicle=function(){p.requestInProgress=!0;u.load(a.confirmation,!1).then(function(d){a.reservationModel=d;angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.amazonReservation)&&(a.reservationModel.amazonReservation=a.confirmation.reservationSummary.amazonReservation);a.reservationModel.rateRequestDropIndicator?g.go(D.step1aPageName):(p.reservation=
d.displayControls.reservation,a.reservationModel&&(a.reservationModel.selectedNonSupCPlist=[],a.confirmation.reservationSummary&&a.confirmation.reservationSummary.rateSummary&&a.confirmation.reservationSummary.rateSummary.selectedNonSupCPlist&&(a.reservationModel.selectedNonSupCPlist=a.confirmation.reservationSummary.rateSummary.selectedNonSupCPlist)),angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.awdNumber)&&
(a.reservationModel.confdiscountnum=a.confirmation.reservationSummary.awdNumber,u.setReservationModel(a.reservationModel)),E.resetAvailableVehicles(),"true"!=n.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||n.brand!=D.brandName.AVIS&&n.brand!=D.brandName.BUDGET?w.load().then(function(a){angular.isDefined(a.errorList)&&0<a.errorList.length||angular.isDefined(a.warningList)&&0<a.warningList.length||angular.isDefined(a.fieldErrors)&&
0<a.fieldErrors.length?g.go(D.step1aPageName):(ABG.stepTwoLoader(),g.go(D.step2PageName))},function(a){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(d){a.recaptcha=d;w.load(!1,a.recaptcha).then(function(a){angular.isDefined(a.errorList)&&0<a.errorList.length||angular.isDefined(a.warningList)&&0<a.warningList.length||angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length?g.go(D.step1aPageName):(ABG.stepTwoLoader(),
g.go(D.step2PageName))},function(a){})})}))},function(a){})};a.modifyExtras=function(){p.requestInProgress=!0;$(window).scrollTop(0);u.load(a.confirmation,!1).then(function(d){a.reservationModel=d;angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.amazonReservation)&&(a.reservationModel.amazonReservation=a.confirmation.reservationSummary.amazonReservation);a.reservationModel.rateRequestDropIndicator?g.go(D.step1aPageName):
(p.reservation=d.displayControls.reservation,a.reservationModel&&(a.reservationModel.selectedNonSupCPlist=[],a.confirmation.reservationSummary&&a.confirmation.reservationSummary.rateSummary&&a.confirmation.reservationSummary.rateSummary.selectedNonSupCPlist&&(a.reservationModel.selectedNonSupCPlist=a.confirmation.reservationSummary.rateSummary.selectedNonSupCPlist),a.reservationModel.displayControls.reservation=D.resFlowModify),E.resetAvailableVehicles(),E.resetAvailableExtras(),angular.isDefined(a.confirmation)&&
angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.awdNumber)&&(a.reservationModel.confdiscountnum=a.confirmation.reservationSummary.awdNumber,u.setReservationModel(a.reservationModel)),g.go(D.step3PageName))},function(a){})};a.modifyPersonalInfo=function(){event.stopPropagation();p.requestInProgress=!1;jQuery("#avisLoader").removeClass("hidden");jQuery("#step2Placeholder").addClass("hidden");jQuery("#defaultLoader").removeClass("hidden");jQuery("#budgetStep2Placeholder").addClass("hidden");
var d=u.load(a.confirmation,!1);a.reservationModel=u.getReservationModel();d.then(function(d){a.reservationModel=d;angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.amazonReservation)&&(a.reservationModel.amazonReservation=a.confirmation.reservationSummary.amazonReservation);if(a.reservationModel.rateRequestDropIndicator)g.go(D.step1aPageName);else{p.reservation=d.displayControls.reservation;d.displayControls.rdmApplied=
!0;if(a.reservationModel&&(a.reservationModel.selectedNonSupCPlist=[],a.confirmation.reservationSummary&&a.confirmation.reservationSummary.rateSummary&&a.confirmation.reservationSummary.rateSummary.selectedNonSupCPlist&&(a.reservationModel.selectedNonSupCPlist=a.confirmation.reservationSummary.rateSummary.selectedNonSupCPlist),a.reservationModel.displayControls.reservation===D.resFlowModify))for(d=0;d<a.reservationModel.selectedProducts.length;d++)0<a.reservationModel.selectedProducts[d].totalRedeemedPts&&
0==a.chkRedeemedRes&&(a.chkRedeemedRes=!0,p.chkRedeemedRes=!0);E.resetAvailableVehicles();u.setReservationModel(a.reservationModel);I.load().then(function(d){if(angular.isDefined(d.errorList)&&0<d.errorList.length||angular.isDefined(d.warningList)&&0<d.warningList.length||angular.isDefined(d.fieldErrors)&&0<d.fieldErrors.length)g.go(D.step1aPageName);else{if(angular.isDefined(d.reservationSummary))if(void 0==d.reservationSummary.iataNumber)p.iataNum=!1;else{p.iataNum=!0;var b=d.reservationSummary.iataNumber;
a.reservationModel.iataNumber=b==D.systemInjectedIata?"":b}d=d.reservationSummary;(d.prepayTxn||"TRUE"==d.ccsection.visible&&"FALSE"==d.payNowCheckBoxInd.visible&&!1===d.prepayTxn?0:"TRUE"!=d.payNowCheckBoxInd.visible)?g.go(D.step4PayLaterPageName):g.go(D.step4PageName)}},function(a){})}},function(a){})};a.addToCalendar=function(){var d={name:Dictionary.I18n.get("lbl.res.resconf.addtocalendar.name,"+brand)+": "+a.confirmation.reservationSummary.confirmationNumber,contact:Dictionary.I18n.get("lbl.res.resconf.addtocalendar.contact,"+
brand)};e.addToCalendar(d,a.confirmation.reservationSummary)};a.redirectToSelfCheckout=C;a.printReservationDetails=da;a.checkCoupon=function(){return angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&(angular.isDefined(a.confirmation.reservationSummary.coupon)&&angular.isDefined(a.confirmation.reservationSummary.coupon.number)&&""!=a.confirmation.reservationSummary.coupon.number&&!0===a.confirmation.reservationSummary.prepayTxn&&!1===a.confirmation.reservationSummary.cancelledReservation||
!0===a.confirmation.reservationSummary.prepayTxn&&!1===a.confirmation.reservationSummary.cancelledReservation)?!0:!1};a.checkInstructionList=function(){return a.pageName==D.cancelBookingPage&&angular.isDefined(a.confirmation)&&(void 0==a.confirmation.instructionList||0>a.confirmation.instructionList.length)?!0:!1};a.checkMaxiRentalError=function(){a.checkMaxiRentalErrorFlag=!0;return a.checkMaxiRentalErrorFlag};a.checkMaxiRentalErrorFlag=!1;a.checkEmailFlag=function(){var d=!1;angular.isDefined(a.confirmation)&&
angular.isDefined(a.confirmation.instructionList)&&0<a.confirmation.instructionList.length&&angular.forEach(a.confirmation.instructionList,function(a,b){if("090001"===a.code||"090004"===a.code)d=!0});return a.pageName!=D.confirmationPage||!a.emailFlag||a.cancelModify||a.forwardMessage||a.reservationModel.displayControls.viewReservation||!1!==d?!1:!0};a.checkCancelReservation=function(){return a.pageName==D.cancelBookingPage||angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&
(void 0==a.confirmation.reservationSummary.permission||a.confirmation.reservationSummary.permission.cancel&&(void 0==a.confirmation.reservationSummary.permission.cancel.visible||"FALSE"===a.confirmation.reservationSummary.permission.cancel.visible))?!0:!1};a.checkModify=function(){return a.pageName==D.cancelBookingPage||angular.isDefined(a.confirmation.reservationSummary)&&a.confirmation.reservationSummary.cancelledReservation||angular.isDefined(a.confirmation.reservationSummary)&&(void 0==a.confirmation.reservationSummary.permission||
a.confirmation.reservationSummary.permission.modify&&(void 0==a.confirmation.reservationSummary.permission.modify.visible||"FALSE"===a.confirmation.reservationSummary.permission.modify.visible))?!0:!1};a.checkCostControl=function(){return angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&(a.confirmation.reservationSummary.userState==D.userStateAuthenticated||a.confirmation.reservationSummary.userState==D.userStateRecognized)?!0:!1};a.checkIATA=function(){return angular.isDefined(a.confirmation)&&
angular.isDefined(a.confirmation.reservationSummary)&&(""!=a.confirmation.reservationSummary.iataNumber&&void 0!=a.confirmation.reservationSummary.iataNumber&&1==a.confirmation.reservationSummary.prepayTxn||""!=a.confirmation.reservationSummary.iataNumber&&void 0!=a.confirmation.reservationSummary.iataNumber&&a.confirmation.reservationSummary.iataNumber!=D.systemInjectedIata&&0==a.confirmation.reservationSummary.prepayTxn)?!0:!1};a.checkRefund=function(){return angular.isDefined(a.confirmation)&&
angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.permission)&&angular.isDefined(a.confirmation.reservationSummary.permission.refund)&&angular.isDefined(a.confirmation.reservationSummary.permission.refund.visible)&&"TRUE"==a.confirmation.reservationSummary.permission.refund.visible?!0:!1};a.redirecturl=function(a){"enrollment"==a?ABG.redirectPage(p.contextPath+"/"+p.locale+"/loyalty-profile/avis-preferred/enrollment"+htmlExtension):"profile"==
a?ABG.redirectPage(p.contextPath+"/"+p.locale+"/loyalty-profile/avis-preferred/dashboard/profile"+htmlExtension):"login"==a&&ABG.redirectPage(p.contextPath+"/"+p.locale+"/loyalty-profile/avis-preferred/login"+htmlExtension)};a.printConfirmation=function(){n.brand!=D.brandName.PAYLESS||a.pageName!=D.confirmationPage&&a.pageName!=D.cancelBookingPage?angular.element(".print-modal").modal("show"):da()};a.cancelOrNoShowFeeMessage=function(){!(a.confirmation&&a.confirmation.reservationSummary&&n.brand!=
D.brandName.PAYLESS&&a.confirmation.reservationSummary.prepayTxn&&a.confirmation.reservationSummary.prepayInfo&&"FALSE"==a.confirmation.reservationSummary.permission.refund.visible)||"C"!==a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&"N"!==a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator||a.confirmation.reservationSummary.prepayInfo.refundIndicator!=D.RESAMT_LESSTHAN_NOSHOWAMT&&a.confirmation.reservationSummary.prepayInfo.refundIndicator!=D.RESAMT_LESSTHAN_CANCELAMT||
a.confirmation.reservationSummary.pickLoc.address.country.toUpperCase()!=D.countryCodeAU&&a.confirmation.reservationSummary.pickLoc.address.country.toUpperCase()!=D.countryCodeNZ?!(a.confirmation&&a.confirmation.reservationSummary&&n.brand!=D.brandName.PAYLESS&&a.confirmation.reservationSummary.prepayTxn&&a.confirmation.reservationSummary.prepayInfo&&"FALSE"==a.confirmation.reservationSummary.permission.refund.visible)||"C"!==a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&"N"!==
a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator||a.confirmation.reservationSummary.prepayInfo.refundIndicator!=D.RESAMT_GREATERTHAN_CANCELAMT&&a.confirmation.reservationSummary.prepayInfo.refundIndicator!=D.RESAMT_GREATERTHAN_NOSHOWAMT||a.confirmation.reservationSummary.pickLoc.address.country.toUpperCase()!=D.countryCodeAU&&a.confirmation.reservationSummary.pickLoc.address.country.toUpperCase()!=D.countryCodeNZ||(a.cancelFeeGreaterThanPrepaidAmount=!0,a.rentalLocationCountry=
a.confirmation.reservationSummary.pickLoc.address.country.toUpperCase()):(a.cancelFeeLessOrEqualThanPrepaidAmount=!0,a.rentalLocationCountry=a.confirmation.reservationSummary.pickLoc.address.country.toUpperCase())};a.amazonBenefitsKey=Dictionary.I18n.get("lbl.global.amazonBenefits");a.cancellingReason="";a.disablePrecheckin=n.disablePrecheckinExtensionFlow;a.forwardEmail={validated:!1,globaErrorFlag:!1,globalError:"",submit:function(d){f.validate(d).success(a.forwardEmail.validationSuccess).error(a.forwardEmail.validationError)},
validationSuccess:function(){p.requestInProgress=!0;var d={rqHeader:{locale:internalLocale},confirmationNum:a.confirmation.reservationSummary.confirmationNumber,lastName:a.confirmation.reservationSummary.personalInfo.lastName.value,emailId:a.forwardEmailModel.emailId.toLowerCase()};a.forwardEmailModel.emailId.toLowerCase()==a.forwardEmailModel.confirmEmailId.toLowerCase()?m.forwardEmail(d).then(function(d){p.requestInProgress=!1;a.forwardMessage=d;f.resetError("vm.forwardEmailModel.emailId",!0);f.resetError("vm.forwardEmailModel.confirmEmailId",
!0);a.forwardMessage&&jQuery(".confirmation-email").modal("toggle");a.fwdEmailId=a.forwardEmailModel.emailId.toLowerCase();a.forwardEmail.globalError="";a.forwardEmail.globaErrorFlag=!1;a.forwardEmailModel.emailId="";a.forwardEmailModel.confirmEmailId=""},function(a){p.requestInProgress=!1}):(f.displayServiceError("vm.forwardEmailModel.confirmEmailId","emailmatch"),p.requestInProgress=!1)},validationError:function(d){a.forwardEmail.globaErrorFlag=!0;1===d.errorCount?a.forwardEmail.globalError=d.MSG[0]:
1<d.errorCount&&(a.forwardEmail.globalError=Dictionary.I18n.get("err.global.multi.errorMessage"))}};a.addToTripIt={submit:function(d){f.validate(d).success(a.addToTripIt.validationSuccess).error(a.addToTripIt.validationError)},validationSuccess:function(){a.addToTripIt.add()},validationError:function(a){},add:function(){a.tripItModel.autoAdd="0";a._callTripItService(a.tripItModel)}};a._productUpsellMessage=function(){a.reservationModel=u.getReservationModel();a.showUpsellMessage=!1;var d=b.getStorageData("oneClickURLCode");
angular.isDefined(a.reservationModel)&&angular.isDefined(a.reservationModel.bookAgain)&&angular.isDefined(a.reservationModel.bookAgain.bookAgainFlow)&&a.reservationModel.bookAgain.bookAgainFlow&&b.deleteStorageData("oneClickURLCode");if(a.reservationModel&&a.reservationModel.selectedProducts&&a.pageName!=D.cancelBookingPage){for(var e=0;e<a.reservationModel.selectedProducts.length;e++)if(angular.isDefined(a.reservationModel.selectedProducts[e].isCampaignBased)&&a.reservationModel.selectedProducts[e].isCampaignBased||
a.reservationModel.selectedProducts[e].code==d){a.productUpsellCode=a.reservationModel.selectedProducts[e].description;a.reservationModel.selectedProducts[e].isCampaignBased=!1;u.setReservationModel(a.reservationModel);a.showUpsellMessage=!0;break}if(angular.isDefined(d))for(e=0;e<a.reservationModel.selectedInsurances.length;e++)if(n.brand==D.brandName.BUDGET&&"LDW"==a.reservationModel.selectedInsurances[e].code&&(a.reservationModel.selectedInsurances[e].code="CDW"),a.reservationModel.selectedInsurances[e].code==
d){a.protectionUpsellCode=a.reservationModel.selectedInsurances[e].description;u.setReservationModel(a.reservationModel);a.oneClickURLMessage=!0;break}}};a._displayTermsConditions=ba;a._expandDebitTerms=function(){!angular.isDefined(a.focusTerms)||null==a.focusTerms||-1==a.focusTerms.indexOf("terms")&&"fullterms"!=a.linkref||F.scrollTo("scrollPage");if(angular.isDefined(a.focusTerms)&&null!=a.focusTerms&&(-1!=a.focusTerms.indexOf("Debit")||"terms"==a.linkref)){F.scrollTo("scrollPage");a.debit=Dictionary.I18n.get("lbl.res.resConf.debitCardPolicies");
a.indexCount;for(var d=0;d<a.CompleteTexNew.length;d++)if(a.CompleteTexNew[d].Id==a.debit){a.indexCount=d;break}}};a._emailUrlParams=function(){null!=z.readQueryString("resForm.confirmationNumber")?(a.conNum=z.readQueryString("resForm.confirmationNumber"),a.lastName=z.readQueryString("resForm.lastName.value")):(a.conNum=z.readQueryString("CONFIRM_NUM"),a.lastName=z.readQueryString("LAST_NAME"));a.focusTerms=z.readQueryString("utm_campaign");a.linkref=z.readQueryString("linkref");angular.isDefined(a.conNum)&&
u.setLookUpModel({lastName:a.lastName,confirmationNumber:a.conNum,email:""})};a._pageInit=function(){p.requestInProgress=!0;u.setExpressReservationFlag(!1);b.deleteStorageData("bridgeResponse");a.session=r.getSessionModel();!a.session||a.session.status!==D.userStateAuthenticated&&a.session.status!==D.userStateRememberMe||p.$emit("Profile.refreshReservation");var d=z.readQueryString("utm_campaign");a.focusTerms=d;a.emailFlag=a.emailFlag==D.resSummaryPage?!1:!0;if(g.current.name==D.confirmationPage||
g.current.name==D.displayConfirmationPage||g.current.name==D.preCheckoutCompletePage)d=angular.isDefined(t.infoKey)?t.infoKey:"lookup","lookup"===t.infoKey&&n.brand===D.brandName.PAYLESS&&(a.confmessage=!0),g.current.name==D.confirmationPage||g.current.name==D.preCheckoutCompletePage?e.getData(d).then(function(d){"02001"==t.infoKey||"02003"==t.infoKey||"02013"==t.infoKey||"02002"==t.infoKey||"02004"==t.infoKey?(a.confirmation=d,M.getErrorMessageByCode(t.infoKey).then(function(d){a.confirmation.errorList=
d;a.errorDisplayList=a.confirmation.errorList;delete a.confirmation.reservationSummary.showSmallBiz;a.emailFlag=!1},function(){})):(a.confirmation=d,angular.isDefined(d.infoList)&&0<d.infoList.length&&(d=l.processErrorMessage(d),angular.isDefined(d.infoList)&&0<d.infoList.length&&(a.confirmation.infoList=d.infoList)),angular.isDefined(a.reservationModel.displayControls)&&a.reservationModel.displayControls.reservation==D.resFlowModify?U(d,"modify"):U(d,"confirm"));a.reservation=d;var b=u.getReservationModel();
b.confirmationNumber=a.reservation.reservationSummary.confirmationNumber;u.setReservationModel(b);a.emailaddr=angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.personalInfo)&&angular.isDefined(a.confirmation.reservationSummary.personalInfo.email)?a.confirmation.reservationSummary.personalInfo.email:"";a.confirmation.reservationSummary.cancelledReservation&&(a.disableModifyCancel=!0);a._printData(d);a.rentalLocationCountry=d.reservationSummary.pickLoc.address.country.toUpperCase();
Z(d)}):H.load().then(function(d){a.confirmation=d;a.reservation=d;a._printData(d);Z(d);if(d.customerInfo&&"PARTNER_AUTHENTICATED"!=d.customerInfo.userState){var b=r.setCustomerData(d);r.setCustomerModel(b)}d.reservationSummary&&d.reservationSummary.userState&&(d=r.setSessionData(d),r.setSessionModel(d))}),a.confirmation=E.getConfirmationData(),a.cancelOrNoShowFeeMessage();else{a.confirmation=E.getConfirmationData();if(a.pageName==D.cancelBookingPage){var f=u.getStorageData("cancelConfirmationData");
angular.isDefined(f)&&angular.isDefined(f.errorList)&&angular.isDefined(f.errorList[0])?u.deleteSpecificStorageData("cancelConfirmationData"):(a.confirmation=f,angular.isDefined(f)&&U(f,"cancel"),angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&(a.userAge=e.getAge(a.confirmation.reservationSummary),a.rentalLocationCountry=a.confirmation.reservationSummary.pickLoc.address.country.toUpperCase(),Z(f),a.currencySymbol=J("currencySymbol")(a.confirmation.reservationSummary.rateSummary.currencySymbol),
angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.prepayInfo)&&(a.gstOnNoShowFee=a.confirmation.reservationSummary.prepayInfo.gstOnNoShowFee,a.gstOnCancelFee=a.confirmation.reservationSummary.prepayInfo.gstOnCancelFee,a.cancelFee=a.confirmation.reservationSummary.prepayInfo.cancelFee,a.currency=a.confirmation.reservationSummary.prepayInfo.currency,a.noShowFee=a.confirmation.reservationSummary.prepayInfo.noShowFee)))}if($.isEmptyObject(a.confirmation))a.pageName==
D.cancelBookingPage?(d=u.getLookUpModel(),angular.isDefined(d)&&angular.isDefined(d.confirmationNumber)?H.load().then(function(d){angular.isDefined(f)&&angular.isDefined(f.errorList)&&angular.isDefined(f.errorList[0])&&(d.errorList=f.errorList);angular.isDefined(d.instructionList)&&0<d.instructionList.length||angular.isDefined(d.errorList)&&0<d.errorList.length?(a._processError(d),angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&(a.userAge=e.getAge(a.confirmation.reservationSummary),
Z(a.confirmation)),a.errorDisplayList=a.confirmation.instructionList):(d=l.processErrorMessage(d),a.confirmation=d);try{h.analyticsDimension(a.confirmation.reservationSummary,a.pageName,a.confirmation)}catch(P){}a._process()},function(a){}):(b.setStorageData("sessionErrMsg",Dictionary.I18n.get("err.global.travelSecurity.errorMessage")),setTimeout(function(){n.location.href=contextPath+"/"+locale+"/reservation/view-modify-cancel"+htmlExtension},10))):H.getData().then(function(d){angular.isDefined(d.instructionList)&&
0<d.instructionList.length||angular.isDefined(d.errorList)&&0<d.errorList.length?(a._processError(d),a.errorDisplayList=a.confirmation.errorList):(a.confirmation=d,angular.isDefined(a.confirmation&&a.confirmation.reservationSummary)&&(a.currencySymbol=J("currencySymbol")(a.confirmation.reservationSummary.rateSummary.currencySymbol)));angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&(a.userAge=e.getAge(a.confirmation.reservationSummary));E.addToConfirmationData(d);
if(a.pageName==D.cancelBookingPage)try{h.analyticsDimension(a.confirmation.reservationSummary,a.pageName,a.confirmation)}catch(P){}a._process()},function(a){});else{angular.isUndefined(a.confirmation.length)&&u.getStorageData("cancelConfirmationData")&&(a.confirmation=u.getStorageData("cancelConfirmationData"),u.deleteSpecificStorageData("cancelConfirmationData"));if(a.pageName==D.cancelBookingPage)try{h.analyticsDimension(a.confirmation.reservationSummary,a.pageName,a.confirmation)}catch(K){}a._process()}}a._productUpsellMessage();
a.accordionStatus.mileage=!1;a.creditCardDetails=E.getCreditCardData();a.cancelReasonFunction();angular.isDefined(b.deleteStorageData("selectedMember"))&&b.deleteStorageData("selectedMember");angular.isDefined(b.deleteStorageData("corporateEmailID"))&&b.deleteStorageData("corporateEmailID");p.requestInProgress=!1;a.dciNewUi=b.getStorageData("isDciFlow")};a._printData=function(d){angular.isDefined(d.errorList)&&0<d.errorList.length&&(d=l.processErrorMessage(a.confirmation),a.errorDisplayList=d.errorList);
if(void 0!=a.confirmation.reservationSummary&&angular.isDefined(a.confirmation.reservationSummary.rateSummary.currencySymbol)){a.currencySymbol=J("currencySymbol")(a.confirmation.reservationSummary.rateSummary.currencySymbol);var b=n.locale,f="fr"==b||"fr_US"==b?!0:!1;b=a.confirmation.reservationSummary.rateSummary.surcharges;var g=a.confirmation.reservationSummary.rateSummary.periodFreeMiles.values;if(("us"==n.domain.toLowerCase()||"ca"==n.domain.toLowerCase())&&f&&"C$"==a.currencySymbol){a.currencySymbol=
"$ CA";a.confirmation.reservationSummary.rateSummary.estimatedTotal=a.confirmation.reservationSummary.rateSummary.estimatedTotal.replace(".",",");a.confirmation.reservationSummary.rateSummary.baseRate=a.confirmation.reservationSummary.rateSummary.baseRate.replace(".",",");a.confirmation.reservationSummary.rateSummary.optionsTotal=a.confirmation.reservationSummary.rateSummary.optionsTotal.replace(".",",");a.confirmation.reservationSummary.rateSummary.extrasTotal=a.confirmation.reservationSummary.rateSummary.extrasTotal.replace(".",
",");a.confirmation.reservationSummary.rateSummary.protectionsTotal=a.confirmation.reservationSummary.rateSummary.protectionsTotal.replace(".",",");a.confirmation.reservationSummary.rateSummary.surchargeTotal=a.confirmation.reservationSummary.rateSummary.surchargeTotal.replace(".",",");a.confirmation.reservationSummary.rateSummary.totalTax=a.confirmation.reservationSummary.rateSummary.totalTax.replace(".",",");angular.isDefined(a.confirmation.reservationSummary&&a.confirmation.reservationSummary.prepayInfo&&
("null"!=a.confirmation.reservationSummary.prepayInfo.amount||"null"!=a.confirmation.reservationSummary.prepayInfo.cancelFee||"null"!=a.confirmation.reservationSummary.prepayInfo.noShowFee))&&(a.confirmation.reservationSummary.prepayInfo.amount=a.confirmation.reservationSummary.prepayInfo.amount.replace(".",","),a.confirmation.reservationSummary.prepayInfo.cancelFee=a.confirmation.reservationSummary.prepayInfo.cancelFee.replace(".",","),a.confirmation.reservationSummary.prepayInfo.noShowFee=a.confirmation.reservationSummary.prepayInfo.noShowFee.replace(".",
","),a.confirmation.reservationSummary.prepayInfo.currency="$ CA");for(f=0;f<b.length;f++)null!==b[f].unitPrice&&void 0!==b[f].unitPrice&&(a.confirmation.reservationSummary.rateSummary.surcharges[f].unitPrice=b[f].unitPrice=b[f].unitPrice.replace(".",",")),null!==b[f].totalSurchargePrice&&void 0!==b[f].totalSurchargePrice&&(a.confirmation.reservationSummary.rateSummary.surcharges[f].totalSurchargePrice=b[f].totalSurchargePrice=b[f].totalSurchargePrice.replace(".",","));if(null!==g&&void 0!==g)for(f=
0;f<g.length;f++)1==f&&(g[f]=g[f].replace(".",","))}}angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&(a.userAge=e.getAge(a.confirmation.reservationSummary));angular.isDefined(d)&&angular.isDefined(d.reservationSummary)&&angular.isDefined(d.reservationSummary.walletType)&&"AMAZON"==d.reservationSummary.walletType&&angular.isDefined(n.amazon)&&"true"==partnerConfig.amazon.enablePartnerBenefit&&amazon.Login.logout();if(!a.confirmation||$.isEmptyObject(a.confirmation)||
!a.confirmation.reservationSummary||1==a.confirmation.reservationSummary.cancelledReservation)H.getData().then(function(d){if(angular.isDefined(a.focusTerms)&&null!=a.focusTerms&&-1!=a.focusTerms.toLowerCase().indexOf("nonprepay")&&1==d.reservationSummary.cancelledReservation)n.location.href=p.contextPath+"/"+p.locale+"/reservation/view-modify-cancel"+htmlExtension+"?utm_campaign\x3d"+a.focusTerms+"\x26resForm.confirmationNumber\x3d"+a.conNum+"\x26resForm.lastName.value\x3d"+a.lastName;else{if(angular.isDefined(d.instructionList)&&
0<d.instructionList.length||angular.isDefined(d.errorList)&&0<d.errorList.length)if(a.confirmation=l.processErrorMessage(d),angular.isDefined(d.instructionList)&&0<d.instructionList.length&&1==a.confirmation.reservationSummary.cancelledReservation&&null!=a.focusTerms){n.location.href=p.contextPath+"/"+p.locale+"/reservation"+htmlExtension+"#/cancel-confirmation?utm_campaign\x3d"+a.focusTerms;return}a.confirmation=d;a._process();E.addToConfirmationData(d);try{h.analyticsDimension(d,"view",d)}catch(Y){}}},
function(a){});else if(a.confirmation&&a.confirmation.reservationSummary){a._process();try{h.analyticsDimension(a.confirmation.reservationSummary,a.pageName,a.confirmation)}catch(aa){}}};a._processError=function(d){d=l.processErrorMessage(d);a.confirmation=d};a._process=function(){p.requestInProgress=!0;a.insurances=u.getStorageData("insuranceList");angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.rateSummary)&&
angular.isDefined(a.confirmation.reservationSummary.rateSummary.selectedProducts)&&(a.products=a.confirmation.reservationSummary.rateSummary.selectedProducts);var d={};angular.isDefined(E.getSupportedOptions())&&(d=E.getSupportedOptions().supportedInsurances);a.insuranceDisplay=e.mergeInsurance(d,a.confirmation.reservationSummary.insuranceSummaryList);n.brand==D.brandName.BUDGET&&angular.isDefined(a.confirmation.reservationSummary.ccSummary)?a.creditCardType=ABG.getCreditCardMap(a.confirmation.reservationSummary.ccSummary.type):
angular.isDefined(a.confirmation.reservationSummary.ccSummary)&&angular.isDefined(a.confirmation.reservationSummary.ccSummary.type)&&(a.creditCardType=a.confirmation.reservationSummary.ccSummary.type);angular.isDefined(a.confirmation.reservationSummary.tripAggregator)&&(a.tripItAddedFlag=a.confirmation.reservationSummary.tripAggregator.tripitAddedFlag);!angular.isDefined(a.confirmation.reservationSummary&&a.confirmation.reservationSummary.prepayInfo&&a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&
a.confirmation.reservationSummary.prepayTxn&&a.confirmation.reservationSummary.permission&&a.confirmation.reservationSummary.permission.cancel&&a.confirmation.reservationSummary.permission.cancel.visible&&a.confirmation.reservationSummary.permission.refund&&a.confirmation.reservationSummary.permission.refund.visible)||"TRUE"!==a.confirmation.reservationSummary.permission.cancel.visible&&"TRUE"!==a.confirmation.reservationSummary.permission.refund.visible||"C"!==a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator||
(a.prepaycancelReservation=!0);if(void 0!=a.confirmation.reservationSummary&&angular.isDefined(a.confirmation.reservationSummary.rateSummary.currencySymbol)){a.currencySymbol=J("currencySymbol")(a.confirmation.reservationSummary.rateSummary.currencySymbol);d=n.locale;var f="fr"==d||"fr_US"==d?!0:!1;d=a.confirmation.reservationSummary.rateSummary.surcharges;var h=a.confirmation.reservationSummary.rateSummary.periodFreeMiles.values;if(("us"==n.domain.toLowerCase()||"ca"==n.domain.toLowerCase())&&f&&
"C$"==a.currencySymbol){a.currencySymbol="$ CA";a.confirmation.reservationSummary.rateSummary.estimatedTotal=a.confirmation.reservationSummary.rateSummary.estimatedTotal.replace(".",",");a.confirmation.reservationSummary.rateSummary.baseRate=a.confirmation.reservationSummary.rateSummary.baseRate.replace(".",",");a.confirmation.reservationSummary.rateSummary.optionsTotal=a.confirmation.reservationSummary.rateSummary.optionsTotal.replace(".",",");a.confirmation.reservationSummary.rateSummary.extrasTotal=
a.confirmation.reservationSummary.rateSummary.extrasTotal.replace(".",",");a.confirmation.reservationSummary.rateSummary.protectionsTotal=a.confirmation.reservationSummary.rateSummary.protectionsTotal.replace(".",",");a.confirmation.reservationSummary.rateSummary.surchargeTotal=a.confirmation.reservationSummary.rateSummary.surchargeTotal.replace(".",",");a.confirmation.reservationSummary.rateSummary.totalTax=a.confirmation.reservationSummary.rateSummary.totalTax.replace(".",",");angular.isDefined(a.confirmation.reservationSummary&&
a.confirmation.reservationSummary.prepayInfo&&("null"!=a.confirmation.reservationSummary.prepayInfo.amount||"null"!=a.confirmation.reservationSummary.prepayInfo.cancelFee||"null"!=a.confirmation.reservationSummary.prepayInfo.noShowFee))&&(a.confirmation.reservationSummary.prepayInfo.amount=a.confirmation.reservationSummary.prepayInfo.amount.replace(".",","),a.confirmation.reservationSummary.prepayInfo.cancelFee=a.confirmation.reservationSummary.prepayInfo.cancelFee.replace(".",","),a.confirmation.reservationSummary.prepayInfo.noShowFee=
a.confirmation.reservationSummary.prepayInfo.noShowFee.replace(".",","),a.confirmation.reservationSummary.prepayInfo.currency="$ CA");for(f=0;f<d.length;f++)null!==d[f].unitPrice&&void 0!==d[f].unitPrice&&(a.confirmation.reservationSummary.rateSummary.surcharges[f].unitPrice=d[f].unitPrice=d[f].unitPrice.replace(".",",")),null!==d[f].totalSurchargePrice&&void 0!==d[f].totalSurchargePrice&&(a.confirmation.reservationSummary.rateSummary.surcharges[f].totalSurchargePrice=d[f].totalSurchargePrice=d[f].totalSurchargePrice.replace(".",
","));if(null!==h&&void 0!==h)for(f=0;f<h.length;f++)1==f&&(h[f]=h[f].replace(".",","))}}!angular.isDefined(a.confirmation.reservationSummary&&a.confirmation.reservationSummary.prepayInfo&&a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&a.confirmation.reservationSummary.prepayTxn&&a.confirmation.reservationSummary.permission&&a.confirmation.reservationSummary.permission.cancel&&a.confirmation.reservationSummary.permission.cancel.visible&&a.confirmation.reservationSummary.permission.refund&&
a.confirmation.reservationSummary.permission.refund.visible)||"TRUE"!==a.confirmation.reservationSummary.permission.cancel.visible&&"TRUE"!==a.confirmation.reservationSummary.permission.refund.visible||a.confirmation.reservationSummary.pickLoc.address.country.toUpperCase()!=D.countryCodeAU&&a.confirmation.reservationSummary.pickLoc.address.country.toUpperCase()!=D.countryCodeNZ||("C"===a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&a.confirmation.reservationSummary.prepayInfo.refundIndicator==
D.RESAMT_GREATERTHAN_CANCELAMT&&(a.resAmt_greaterthan_cancelAmt=!0),"C"===a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&a.confirmation.reservationSummary.prepayInfo.refundIndicator==D.RESAMT_LESSTHAN_CANCELAMT&&(a.resAmt_lessthan_cancelAmt=!0),"N"===a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&a.confirmation.reservationSummary.prepayInfo.refundIndicator==D.RESAMT_GREATERTHAN_NOSHOWAMT&&(a.resAmt_greaterthan_noShowAmt=!0),"N"===a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&
a.confirmation.reservationSummary.prepayInfo.refundIndicator==D.RESAMT_LESSTHAN_NOSHOWAMT&&(a.resAmt_lessthan_noShowAmt=!0));!angular.isDefined(a.confirmation.reservationSummary&&a.confirmation.reservationSummary.prepayInfo&&a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&a.confirmation.reservationSummary.prepayTxn&&a.confirmation.reservationSummary.permission&&a.confirmation.reservationSummary.permission.cancel&&a.confirmation.reservationSummary.permission.cancel.visible&&a.confirmation.reservationSummary.permission.refund&&
a.confirmation.reservationSummary.permission.refund.visible)||"TRUE"!==a.confirmation.reservationSummary.permission.cancel.visible&&"TRUE"!==a.confirmation.reservationSummary.permission.refund.visible||"N"!==a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator||(a.refundcancelReservation=!0);angular.isDefined(a.confirmation.reservationSummary&&a.confirmation.reservationSummary.prepayInfo)&&(a.pageName!=D.cancelBookingPage||"C"!=a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator||
a.confirmation.reservationSummary.digitalWalletFlow?a.pageName==D.cancelBookingPage&&"C"==a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&a.confirmation.reservationSummary.digitalWalletFlow&&(a.creditcardNumber=D.maskNumber+a.confirmation.reservationSummary.customerWalletGenericRS.paymentCard.ccNumberMasked,a.cancelFee=a.confirmation.reservationSummary.prepayInfo.cancelFee):(a.creditcardNumber=angular.isDefined(a.confirmation.reservationSummary.ccSummary)?a.confirmation.reservationSummary.ccSummary.number:
"",a.cancelFee=a.confirmation.reservationSummary.prepayInfo.cancelFee));angular.isDefined(a.confirmation.reservationSummary)&&a.pageName==D.cancelBookingPage&&a.confirmation.reservationSummary.prepayTxn&&!0===a.confirmation.reservationSummary.prepayTxn&&(a.rentalLocationCountry=a.confirmation.reservationSummary.pickLoc.address.country.toUpperCase());angular.isDefined(a.confirmation.reservationSummary)&&a.confirmation.reservationSummary.dateOfBooking&&a.confirmation.reservationSummary.prepayTxn&&!0===
a.confirmation.reservationSummary.prepayTxn&&(a.bookedDate=a.confirmation.reservationSummary.dateOfBooking);angular.isDefined(a.confirmation.reservationSummary&&a.confirmation.reservationSummary.prepayInfo)&&(a.pageName!=D.cancelBookingPage||"N"!=a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator||a.confirmation.reservationSummary.digitalWalletFlow?a.pageName==D.cancelBookingPage&&"N"==a.confirmation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&a.confirmation.reservationSummary.digitalWalletFlow&&
(a.creditcardNumber=D.maskNumber+a.confirmation.reservationSummary.customerWalletGenericRS.paymentCard.ccNumberMasked,a.cancelFee=a.confirmation.reservationSummary.prepayInfo.noShowFee):(a.creditcardNumber=angular.isDefined(a.confirmation.reservationSummary.ccSummary)?a.confirmation.reservationSummary.ccSummary.number:"",a.cancelFee=a.confirmation.reservationSummary.prepayInfo.noShowFee));angular.isDefined(a.confirmation.reservationSummary&&a.confirmation.reservationSummary.prepayTxn&&a.confirmation.reservationSummary.permission)&&
(a.pageName==D.cancelBookingPage&&a.confirmation.reservationSummary.prepayTxn&&angular.isDefined(a.confirmation.reservationSummary.permission)&&angular.isDefined(a.confirmation.reservationSummary.permission.cancel)&&"TRUE"===a.confirmation.reservationSummary.permission.cancel.visible&&a.confirmation.reservationSummary.prepayCancelInfo&&a.confirmation.reservationSummary.prepayCancelInfo.refundAmount?a.refund=a.confirmation.reservationSummary.prepayCancelInfo.refundAmount:a.pageName==D.cancelBookingPage&&
a.confirmation.reservationSummary.prepayTxn&&angular.isDefined(a.confirmation.reservationSummary.permission)&&angular.isDefined(a.confirmation.reservationSummary.permission.refund)&&"TRUE"===a.confirmation.reservationSummary.permission.refund.visible&&a.confirmation.reservationSummary.prepayCancelInfo&&a.confirmation.reservationSummary.prepayCancelInfo.refundAmount&&(a.refund=a.confirmation.reservationSummary.prepayCancelInfo.refundAmount));a.reservationModel=u.getReservationModel();angular.isDefined(a.reservationModel)&&
angular.isDefined(a.reservationModel.displayControls)&&(a.cancelModify=a.reservationModel.displayControls.cancelModify,a.modifyConfirmation=a.reservationModel.displayControls.reservation);d=u.getDataBeforeLogoClick();angular.isDefined(d)&&(D.confirmationPage===d.prevPage&&(a.reservationModel.displayControls.reservation=d.prevFlow,a.modifyConfirmation=a.reservationModel.displayControls.reservation),u.deleteDataBeforeLogoClick());void 0!=a.confirmation.reservationSummary.earnPoints&&(a.earnPoints=a.confirmation.reservationSummary.earnPoints);
a.confirmation.reservationSummary.ccSummary&&(a.confirmation.reservationSummary.ccSummary.expiryMsg?a.expiredccMessage=A.trustAsHtml(a.confirmation.reservationSummary.ccSummary.expiryMsg.message):a.confirmation.reservationSummary.ccSummary.credCardUpdate&&(a.expiredccMessage=A.trustAsHtml(a.confirmation.reservationSummary.ccSummary.credCardUpdate.message)));a.confirmation.reservationSummary.ftpDetails&&a.confirmation.reservationSummary.ftpDetails.partnerCode&&""!=a.confirmation.reservationSummary.ftpDetails.partnerCode&&
q.getData().then(function(d){a.ftp=d;a.confirmation.reservationSummary.ftpDetails.ftpBonusMiles==D.ftpNotApplicableLower&&(a.confirmation.reservationSummary.ftpDetails.ftpBonusMiles=D.ftpNotApplicable);a.partnerName=M.getPartnerName(a.confirmation.reservationSummary.ftpDetails.partnerCode,a.ftp.partnersList,!1)},function(a){});a.confirmation&&a.confirmation.reservationSummary&&a.confirmation.reservationSummary.ftpDetails&&a.confirmation.reservationSummary.ftpDetails.partnerCode&&(d=Math.floor(parseFloat(a.confirmation.reservationSummary.rateSummary.baseRate.replace(/,/g,
""))),a.multipliedValue=4*d);a.confirmation&&a.confirmation.reservationSummary&&a.confirmation.reservationSummary.ftpDetails&&(d=document.querySelector(".promocustombanner"),"QF"===a.confirmation.reservationSummary.ftpDetails.partnerCode&&d&&a.reservationModel&&a.reservationModel.personalInfoRQ&&"AU"===a.reservationModel.personalInfoRQ.residency&&"AU"===a.reservationModel.pickCountry?d.style.display="block":d&&(d.style.display="none"));a.userName=a.confirmation.reservationSummary.personalInfo.firstName.value;
a.reservationModel&&u.setReservationModel(a.reservationModel);a._displayTermsConditions();a.cancelModify||a._constructLocationLinks();p.emailRedirectingPath=!1;a.personalizedPartnerName=b.getStorageData("partnerName");!angular.isDefined(a.personalizedPartnerName)||""==a.personalizedPartnerName||"USAA"!=a.personalizedPartnerName&&"AARP"!=a.personalizedPartnerName||angular.element(document).injector().get("getVehicles").hideorShowPartnerBenefits(a.confirmation);d="";h=u.getReservationModel();angular.isDefined(h)&&
angular.isDefined(h.pickUpLocation)&&angular.isDefined(h.pickUpLocation.corpLicInd)&&""!=h.pickUpLocation.corpLicInd?d=h.pickUpLocation.corpLicInd:angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&angular.isDefined(a.confirmation.reservationSummary.pickLoc)&&angular.isDefined(a.confirmation.reservationSummary.pickLoc.corpLicInd)&&""!=a.confirmation.reservationSummary.pickLoc.corpLicInd?d=a.confirmation.reservationSummary.pickLoc.corpLicInd:angular.isDefined(b.getStorageData("locationType"))&&
""!=b.getStorageData("locationType")&&(d=b.getStorageData("locationType"));"C"==d&&angular.isDefined(a.personalizedPartnerName)&&""!=a.personalizedPartnerName&&("USAA"==a.personalizedPartnerName?ca(n.usaaBenefitsList):"AARP"==a.personalizedPartnerName&&ca(n.aarpBenefitsList));p.requestInProgress=!1;angular.isDefined(a.confirmation.reservationSummary.ccSummary)&&angular.isDefined(a.confirmation.reservationSummary.ccSummary.type)&&(a.primaryCardType=ABG.getCreditCardMap(a.confirmation.reservationSummary.ccSummary.type));
angular.isDefined(a.confirmation.reservationSummary.secondaryCCSummary)&&angular.isDefined(a.confirmation.reservationSummary.secondaryCCSummary.type)&&(a.secondaryCardType=ABG.getCreditCardMap(a.confirmation.reservationSummary.secondaryCCSummary.type))};a._constructLocationLinks=function(){if("us"==a.domain||"ca"==a.domain){if(angular.isDefined(a.confirmation.reservationSummary.pickLoc)&&angular.isDefined(a.confirmation.reservationSummary.pickLoc.address)&&angular.isDefined(a.confirmation.reservationSummary.pickLoc.address.country)&&
angular.isDefined(a.confirmation.reservationSummary.pickLoc.address.state)&&angular.isDefined(a.confirmation.reservationSummary.pickLoc.address.city)&&angular.isDefined(a.confirmation.reservationSummary.pickLoc.locationCode)){var d=a.confirmation.reservationSummary.pickLoc.address.city.toLowerCase().replace(/[^a-zA-Z]+/g,"-");a.confirmation.reservationSummary.pickLoc.address.state.toLowerCase()==D.locationState?a.pickUpLocationLink=rootpath+"/locations/"+a.confirmation.reservationSummary.pickLoc.address.country.toLowerCase()+
"/"+d+"/"+a.confirmation.reservationSummary.pickLoc.locationCode.toLowerCase()+htmlExtension+"?shuttle\x3dtrue":a.pickUpLocationLink=rootpath+"/locations/"+a.confirmation.reservationSummary.pickLoc.address.country.toLowerCase()+"/"+a.confirmation.reservationSummary.pickLoc.address.state.toLowerCase()+"/"+d+"/"+a.confirmation.reservationSummary.pickLoc.locationCode.toLowerCase()+htmlExtension+"?shuttle\x3dtrue"}if(angular.isDefined(a.confirmation.reservationSummary.dropLoc)&&angular.isDefined(a.confirmation.reservationSummary.dropLoc.address)&&
angular.isDefined(a.confirmation.reservationSummary.dropLoc.address.country)&&angular.isDefined(a.confirmation.reservationSummary.dropLoc.address.state)&&angular.isDefined(a.confirmation.reservationSummary.dropLoc.address.city)&&angular.isDefined(a.confirmation.reservationSummary.dropLoc.locationCode)){var b=a.confirmation.reservationSummary.dropLoc.address.city.toLowerCase().replace(/[^a-zA-Z]+/g,"-");a.confirmation.reservationSummary.dropLoc.address.state.toLowerCase()==D.locationState?a.dropOffLocationLink=
rootpath+"/locations/"+a.confirmation.reservationSummary.dropLoc.address.country.toLowerCase()+"/"+b+"/"+a.confirmation.reservationSummary.dropLoc.locationCode.toLowerCase()+htmlExtension+"?shuttle\x3dtrue":a.dropOffLocationLink=rootpath+"/locations/"+a.confirmation.reservationSummary.dropLoc.address.country.toLowerCase()+"/"+a.confirmation.reservationSummary.dropLoc.address.state.toLowerCase()+"/"+b+"/"+a.confirmation.reservationSummary.dropLoc.locationCode.toLowerCase()+htmlExtension+"?shuttle\x3dtrue"}else a.dropOffLocationLink=
a.pickUpLocationLink}if("au"==a.domain){if(angular.isDefined(a.confirmation.reservationSummary.pickLoc)&&angular.isDefined(a.confirmation.reservationSummary.pickLoc.address)&&angular.isDefined(a.confirmation.reservationSummary.pickLoc.address.country)||angular.isDefined(a.confirmation.reservationSummary.pickLoc.address.state)||angular.isDefined(a.confirmation.reservationSummary.pickLoc.address.city)&&angular.isDefined(a.confirmation.reservationSummary.pickLoc.locationCode))angular.isDefined(a.confirmation.reservationSummary.pickLoc.address.city)&&
(d=a.confirmation.reservationSummary.pickLoc.address.city.toLowerCase().replace(/[^a-zA-Z]+/g,"-")),"AU"==a.confirmation.reservationSummary.pickLoc.address.country&&angular.isDefined(a.confirmation.reservationSummary.pickLoc.address.stateCode)?a.pickUpLocationLink=rootpath+"/locations/"+a.confirmation.reservationSummary.pickLoc.address.country.toLowerCase()+"/"+a.confirmation.reservationSummary.pickLoc.address.stateCode.toLowerCase()+"/"+d+"/"+a.confirmation.reservationSummary.pickLoc.locationCode.toLowerCase()+
htmlExtension:a.pickUpLocationLink=rootpath+"/locations/"+a.confirmation.reservationSummary.pickLoc.address.country.toLowerCase()+"/"+d+"/"+a.confirmation.reservationSummary.pickLoc.locationCode.toLowerCase()+htmlExtension;angular.isDefined(a.confirmation.reservationSummary.dropLoc)&&angular.isDefined(a.confirmation.reservationSummary.dropLoc.address)&&angular.isDefined(a.confirmation.reservationSummary.dropLoc.address.country)||angular.isDefined(a.confirmation.reservationSummary.dropLoc.address.state)||
angular.isDefined(a.confirmation.reservationSummary.dropLoc.address.city)&&angular.isDefined(a.confirmation.reservationSummary.dropLoc.locationCode)?(angular.isDefined(a.confirmation.reservationSummary.dropLoc.address.city)&&(b=a.confirmation.reservationSummary.dropLoc.address.city.toLowerCase().replace(/[^a-zA-Z]+/g,"-")),"AU"==a.confirmation.reservationSummary.dropLoc.address.country&&angular.isDefined(a.confirmation.reservationSummary.dropLoc.address.stateCode)?a.dropOffLocationLink=rootpath+"/locations/"+
a.confirmation.reservationSummary.dropLoc.address.country.toLowerCase()+"/"+a.confirmation.reservationSummary.dropLoc.address.stateCode.toLowerCase()+"/"+b+"/"+a.confirmation.reservationSummary.dropLoc.locationCode.toLowerCase()+htmlExtension:a.dropOffLocationLink=rootpath+"/locations/"+a.confirmation.reservationSummary.dropLoc.address.country.toLowerCase()+"/"+b+"/"+a.confirmation.reservationSummary.dropLoc.locationCode.toLowerCase()+htmlExtension):a.dropOffLocationLink=a.pickUpLocationLink}if("nz"==
a.domain){if(angular.isDefined(a.confirmation.reservationSummary.pickLoc)&&angular.isDefined(a.confirmation.reservationSummary.pickLoc.address)&&angular.isDefined(a.confirmation.reservationSummary.pickLoc.address.country)||angular.isDefined(a.confirmation.reservationSummary.pickLoc.address.state)||angular.isDefined(a.confirmation.reservationSummary.pickLoc.address.city)&&angular.isDefined(a.confirmation.reservationSummary.pickLoc.locationCode))angular.isDefined(a.confirmation.reservationSummary.pickLoc.address.city)&&
(d=a.confirmation.reservationSummary.pickLoc.address.city.toLowerCase().replace(/[^a-zA-Z]+/g,"-")),"AU"==a.confirmation.reservationSummary.pickLoc.address.country&&angular.isDefined(a.confirmation.reservationSummary.pickLoc.address.state)?a.pickUpLocationLink=rootpath+"/locations/"+a.confirmation.reservationSummary.pickLoc.address.country.toLowerCase()+"/"+a.confirmation.reservationSummary.pickLoc.address.state.toLowerCase()+"/"+d+"/"+a.confirmation.reservationSummary.pickLoc.locationCode.toLowerCase()+
htmlExtension:a.pickUpLocationLink=rootpath+"/locations/"+a.confirmation.reservationSummary.pickLoc.address.country.toLowerCase()+"/"+d+"/"+a.confirmation.reservationSummary.pickLoc.locationCode.toLowerCase()+htmlExtension;angular.isDefined(a.confirmation.reservationSummary.dropLoc)&&angular.isDefined(a.confirmation.reservationSummary.dropLoc.address)&&angular.isDefined(a.confirmation.reservationSummary.dropLoc.address.country)||angular.isDefined(a.confirmation.reservationSummary.dropLoc.address.state)||
angular.isDefined(a.confirmation.reservationSummary.dropLoc.address.city)&&angular.isDefined(a.confirmation.reservationSummary.dropLoc.locationCode)?(angular.isDefined(a.confirmation.reservationSummary.dropLoc.address.city)&&(b=a.confirmation.reservationSummary.dropLoc.address.city.toLowerCase().replace(/[^a-zA-Z]+/g,"-")),"AU"==a.confirmation.reservationSummary.dropLoc.address.country&&angular.isDefined(a.confirmation.reservationSummary.dropLoc.address.state)?a.dropOffLocationLink=rootpath+"/locations/"+
a.confirmation.reservationSummary.dropLoc.address.country.toLowerCase()+"/"+a.confirmation.reservationSummary.dropLoc.address.state.toLowerCase()+"/"+b+"/"+a.confirmation.reservationSummary.dropLoc.locationCode.toLowerCase()+htmlExtension:a.dropOffLocationLink=rootpath+"/locations/"+a.confirmation.reservationSummary.dropLoc.address.country.toLowerCase()+"/"+b+"/"+a.confirmation.reservationSummary.dropLoc.locationCode.toLowerCase()+htmlExtension):a.dropOffLocationLink=a.pickUpLocationLink}};a._callTripItService=
function(d){e.addToTripIt(d).then(function(d){d.errorList&&0<d.errorList.length?(a.tripItError=!0,a.tripItMessage=d.errorList[0].message):d.message==D.tripItServiceMsgSuccess&&(a.tripItAddedFlag=!0,jQuery(".tripit-signin-modal").modal("hide"),d={},n.dataLayer=n.dataLayer||[],d.event="errorCode",d.tripIt="Reservation added successfully to tripIt",dataLayer.push(d))},function(a){})};a.cancelReasonFunction=function(){if("au"===window.domain||"nz"===window.domain){var d=Dictionary.I18n.get("lbl.reservation.cancelReasons");
d=JSON.parse(d);a.cancelReasonList=d.cancelReasons;a.cancellingReason=null}};x=B("ConfirmationExnController",{$scope:l});angular.extend(this,x);a.cancelReservation={submit:function(d){f.validate(d).success(a.cancelReservation.validationSuccess).error(a.cancelReservation.validationError)},validationSuccess:function(){p.requestInProgress=!0;a.cancelReservation.process()},validationError:function(a){},process:function(){O.load(a.reservation.reservationSummary.confirmationNumber,a.reservation.reservationSummary.personalInfo.lastName.value,
a.emailaddr,a.cancellingReason).then(function(d){a.model=d;angular.isDefined(d.errorList)&&0<d.errorList.length?(S.process(d.errorList[0].code),p.requestInProgress=!1):(void 0!=a.model.reservationSummary.loyaltyDetails&&(r.setLoyaltyDetails(r.setLoyaltyDetailsData(a.model)),p.$broadcast("loyaltyUpdated",a.model)),b.deleteStorageData("upcomingReservations"),b.deleteStorageData("cancelledReservations"),E.deleteConcurTripList(),jQuery(".getres-modal-cancel").modal("hide"),n.location.href=p.contextPath+
"/"+p.locale+"/reservation"+htmlExtension+"#/cancel-confirmation")},function(a){})}};if(g.current.name==D.displayConfirmationPage){if(a._emailUrlParams(),a.displayConfirmationPage=!0,r.getXsrfToken()||r.getSessionModel())a.displayConfirmationPage=!1,a._pageInit()}else a._pageInit();p.$on("initSuccess",function(d,b){a.displayConfirmationPage&&a._pageInit()});jQuery(document).ready(function(){"UPLIFT"==a.reservationModel.walletType&&setTimeout(function(){Uplift.Analytics.orderResponse({mode_of_payment:"pay monthly",
order_id:a.reservationModel.confirmationNumber});window.Uplift.Payments.confirm(a.reservationModel.confirmationNumber)},500);a.pageName!=D.confirmationPage&&a.pageName!=D.cancelBookingPage&&a.pageName!=D.preCheckoutCompletePage||u.addGTMScript();setTimeout(function(){a.isSegmentResolved=!1;if(ContextHub){var d=ContextHub.SegmentEngine.SegmentManager.getResolvedSegments();angular.forEach(d,function(d,b){"dci-segmentation"==d.name&&(a.isSegmentResolved=!0)})}angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&
angular.isDefined(a.confirmation.reservationSummary.permission)&&angular.isDefined(a.confirmation.reservationSummary.permission.preCheckin)&&angular.isDefined(a.confirmation.reservationSummary.permission.preCheckin.visible)&&"TRUE"===a.confirmation.reservationSummary.permission.preCheckin.visible&&angular.isUndefined(b.getStorageData("gotoConfPageClicked"))&&"true"!=a.disablePrecheckin&&a.isSegmentResolved&&(d=u.getReservationModel(),d.isPrevConfirmationPage=!0,b.setStorageData("isDciFlow",!0),u.setReservationModel(d),
ABG.loadSkeletonLoader({name:"/driver-info"},g.current),C());angular.isDefined(b.getStorageData("isDciFlow")&&angular.isDefined(b.getStorageData("gotoConfPageClicked")))&&(angular.isDefined(a.confirmation.oldReservationSummary)&&angular.isUndefined(a.confirmation.oldReservationSummary.prepayInfo)&&angular.isDefined(a.confirmation.reservationSummary.prepayInfo)&&(a.confirmation.reservationSummary.prepayInfo=void 0),angular.isDefined(a.confirmation)&&angular.isDefined(a.confirmation.reservationSummary)&&
angular.isDefined(a.confirmation.reservationSummary.prepayTxn)&&!a.confirmation.reservationSummary.prepayTxn&&(a.prepaycancelReservation=!1,a.resAmt_lessthan_noShowAmt=!1));a.pageName!=D.preCheckoutCompletePage&&a.pageName!=D.confirmationPage||h.setRoktAttributes(a.confirmation.reservationSummary)},1500)})}angular.module("reservation").controller("ConfirmationController",t);t.$inject="$q ftpService $scope $timeout $rootScope $location $state $stateParams $sce $controller anchorSmoothScroll getDataService vehicleService locationService locationTermsConditionsService $window lookupService reviewService reservationModelService emailService $validation carRentalConstant confirmationService gaService authenticationService $filter utilityService storageService confirmCancelService BackButtonFactory splitPaymentService".split(" ")})();
(function(){function t(x,q,l,v,p,y,g,t,A,B,F,E,w,z,G,n,H,I,u,m,f,D,e,h,r,J){function C(d){return $.grep(a.ftp.partnersList,function(a){return a.partnerId==d})}function b(d){({OFFER_AVAILABLE:function(){a.reservationModel.upliftOffer=!0;angular.element(".estimate.mobile-hide").click()},TOKEN_AVAILABLE:function(){},TOKEN_RETRIEVED:function(){},OFFER_UNAVAILABLE:function(){a.reservationModel.upliftOffer=!1;angular.element(".estimate.mobile-hide").click()},SERVICE_UNAVAILABLE:function(){}})[d.status]()}
function O(){a.upliftOrderInfo={travelers:[{id:0,first_name:a.reservationModel.personalInfoRQ.firstName,last_name:a.reservationModel.personalInfoRQ.lastName,date_of_birth:""}],rentals:[{type:a.prod.reservationSummary.vehicle.classDescription,unit_price:Math.round(100*parseFloat(a.prod.reservationSummary.rateSummary.baseRate).toFixed(2)),quantity:1,start_date:a.reservationModel.pickUpDate.replaceAll("-",""),end_date:a.reservationModel.dropDate.replaceAll("-",""),agency:"Budget",insurance:[]}],add_ons:[],
order_amount:a.estimatedTotalIncents};var d=0;a.reservationModel.selectedInsurances&&a.reservationModel.selectedInsurances.forEach(function(b,c){d++;a.upliftOrderInfo.add_ons.push({id:d.toString(),name:b.code,price:100*b.price})});a.reservationModel.selectedProducts&&a.reservationModel.selectedProducts.forEach(function(b,c){d++;a.upliftOrderInfo.add_ons.push({id:d.toString(),name:b.code,price:100*b.price})});return a.upliftOrderInfo}function S(d){var b=[],c=[],e={CDW:{includedMessage:"",notIncludedMessage:""},
ALI:{includedMessage:Dictionary.I18n.get("msg.res.googleALIIncludedMessage,"+brand),notIncludedMessage:Dictionary.I18n.get("msg.res.googleALINotIncludedMessage,"+brand)},ADR:{includedMessage:Dictionary.I18n.get("msg.res.googleADRIncludedMessage,"+brand),notIncludedMessage:Dictionary.I18n.get("msg.res.googleADRNotIncludedMessage,"+brand)}};angular.isDefined(d)&&angular.isDefined(d.reservationSummary)&&angular.isDefined(d.reservationSummary.googleRentalOption)&&angular.isDefined(d.reservationSummary.googleRentalOption.rentalOptionsList)&&
0<d.reservationSummary.googleRentalOption.rentalOptionsList.length&&(a.benefitsMap=d.reservationSummary.googleRentalOption,b=d.reservationSummary.googleRentalOption.rentalOptionsList);angular.forEach(b,function(d,b){if(d.included||"INCLUDED"==d.price){b=f.getSupportedOptions();var k=b.supportedProducts,N="";angular.forEach(b.supportedInsurances,function(a,b){a.code==d.code&&(N=a.code,a.rentalOptionType="protection",a.included=!0,a.includedMessage=e[a.code].includedMessage,c.push(a))});angular.forEach(k,
function(a,b){a.code==d.code&&a.code!=N&&(a.rentalOptionType="services",a.included=!0,a.includedMessage=e[a.code].includedMessage,c.push(a))})}else angular.forEach(a.insurances,function(a,b){a.code==d.code&&(a.rentalOptionType="protection",a.included=!1,a.notIncludedMessage=e[a.code].notIncludedMessage,c.push(a))}),angular.forEach(a.products,function(a,b){a.code==d.code&&(a.rentalOptionType="services",a.included=!1,a.notIncludedMessage=e[a.code].notIncludedMessage,c.push(a))})});return c}function T(a){var d=
n.getReservationModel();if(angular.isDefined(a)&&angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.ancillaryBundleSummary))for(L=0;L<a.reservationSummary.ancillaryBundleSummary.length;L++)a.reservationSummary.ancillaryBundleSummary,a.reservationSummary.ancillaryBundleSummary[L].enableTag=d.ancillaryBundlesData[0].resolvedOffers[L].enableTag,a.reservationSummary.ancillaryBundleSummary[L].tagTitle=d.ancillaryBundlesData[0].resolvedOffers[L].tagTitle,a.reservationSummary.ancillaryBundleSummary[L].tagIcon=
d.ancillaryBundlesData[0].resolvedOffers[L].tagIcon,a.reservationSummary.ancillaryBundleSummary[L].tagColor=d.ancillaryBundlesData[0].resolvedOffers[L].tagColor,a.reservationSummary.ancillaryBundleSummary[L].isAnimation=d.ancillaryBundlesData[0].resolvedOffers[L].isAnimation}function ia(d){angular.isDefined(d.errorList)&&0<d.errorList.length?(g.requestInProgress=!1,y.processErrorMessage(d),d.errorList=x.handleRateCodeMainFrameError(d.errorList),0<d.errorList.length&&(a.errorList=d.errorList,A.scroll(0,
0))):q.load().then(function(d){a.insurances=d.reservationSummary.insuranceSummaryList;a.prod=d;angular.isDefined(d.reservationSummary.rateSummary)&&angular.isDefined(d.reservationSummary.rateSummary.estimatedTotal)&&(a.reservationModel.estimatedTotal=d.reservationSummary.rateSummary.estimatedTotal);t.go(a.pageName,{},{reload:!0})});e.closeModal({type:"protectionModify"})}function da(d){angular.isDefined(d.errorList)&&0<d.errorList.length?(g.requestInProgress=!1,y.processErrorMessage(d),d.errorList=
x.handleRateCodeMainFrameError(d.errorList),0<d.errorList.length&&(a.errorList=d.errorList,A.scroll(0,0))):q.load().then(function(d){a.products=d.reservationSummary.productSummaryList;a.prodPoints=d.reservationSummary.pointProducts;a.prod=d;angular.isDefined(d.reservationSummary.rateSummary)&&angular.isDefined(d.reservationSummary.rateSummary.estimatedTotal)&&(a.reservationModel.estimatedTotal=d.reservationSummary.rateSummary.estimatedTotal);t.go(a.pageName,{},{reload:!0})});e.closeModal({type:"equipmentModify"})}
function ba(a,d){a.protections&&0<a.protections.length&&a.protections.forEach(function(a){d=F.arrayPop(a,!0,d)});a.equipment&&0<a.equipment.length&&a.equipment.forEach(function(a){d=F.arrayPop(a,!1,d)});return d}function ca(d){d.equipment&&0<d.equipment.length&&d.equipment.forEach(function(b){a.pointCheckbox[b]=d.selected;a.productCheckbox[b]=d.selected})}function U(d){d.protections&&0<d.protections.length&&d.protections.forEach(function(b){a.insuranceCheckbox[b]=d.selected})}function Z(d){for(L=
0;L<d.length;L++){if("TRUE"==d[L].bundleDisplay.selected){a.bundleCheckbox[d[L].bundleName]=!0;var b=d[L].bundleName}else a.bundleCheckbox[d[L].bundleName]=!1;if("au"==a.domain||"nz"==a.domain){var c=L,e=d,N=n.getReservationModel();e[c].enableTag=N.ancillaryBundlesData[0].resolvedOffers[c].enableTag;e[c].tagTitle=N.ancillaryBundlesData[0].resolvedOffers[c].tagTitle;e[c].tagIcon=N.ancillaryBundlesData[0].resolvedOffers[c].tagIcon;e[c].tagColor=N.ancillaryBundlesData[0].resolvedOffers[c].tagColor;e[c].isAnimation=
N.ancillaryBundlesData[0].resolvedOffers[c].isAnimation}}return b}"true"===A.jsProfileConfigFlag&&(A.startTime.protectionCoverage=performance.now());p("ExceptionHandlerController",{$scope:y});var a=this;l=p("CouponController",{$scope:y});angular.extend(this,l);a.ancillaryIsInsurance={};a.session=E.getSessionModel();a.insuranceCheckbox={};a.productCheckbox={};a.pointCheckbox={};a.productCarUpsell={};a.pointCarUpsell={};a.insurancePackageSelected=!1;a.childSafetyExpanded=!1;a.couponcheckCarupsell=!1;
a.selectedProductsCodeForExpansion={};a.rateAmountShow=A.rateAmountShow;a.reservationModel=n.getReservationModel();angular.isDefined(a.reservationModel)&&(a.reservationModel.initOptionalServiceFlag=!0,a.couponNumber=a.reservationModel.coupon.couponNumber,a.pageName==z.step3PageName&&0==a.reservationModel.selectedProducts.length&&(a.reservationModel.initOptionalServiceFlag=!1));a.pageName=t.current.name;a.domain=A.domain;a.couponFlag=!1;a.showUpsellCampaign=!1;a.totalreedem=0;a.displayFreedayFlag=
!1;a.childSafetyExpanded=!1;a.childSafetyExpandedCheck=!1;a.rewardSelectDds=1;a.couponCodeDisabled=!1;a.memberName="";a.currencySymbol="";a.freedaySectionDisplay=!1;a.bundleCheckbox=[];a.showExtrasSavingsHeading=!1;a.googleRentalOptionsList=[];a.googleModalTrack=function(d){setTimeout(function(){angular.forEach(a.googleRentalOptionsList,function(a,c){a.code==d.code&&H.partnerPersonalizationTracking(a.selected?"Selected":"Deselected",d.code+" Rental Option","Partner Modal Step3")})},1500)};a.enableEnterpriseCaptcha=
A.enableEnterpriseCaptcha;a.cssDropDown={};a.cssDropDownValues={CBS:[],CFS:[],CIS:[],CSB:[],CSS:[],BXM:[],BXS:[],BXL:[],BBS:[],BLK:[],ROP:[]};var d={prefferedPointsFlag:"",loyaltyDetails:"",pointProducts:"",displayFreedayFlag:"",freedaySectionDisplay:"",freeDayPoints:"",totalreedem:"",redeemableDays:"",pointCheckbox:"",frdProdFlag:!1,redeemQty:0},ea="",K="",P="",aa="",Y="";a.subcontent="";a.test=0;a.rentalLocationCountry="";a.insuranceDisplayCount={};a.equipDisplayLen={};a.servicesDisplaylen={};a.hideTierBundles=
A.hideTierBundles;a.showEquipmentSec=!1;a.servicestab1len={};a.showCarousalArrow=!1;a.displayBundles=!1;a.servicestab2len={};a.showUpliftOptionStep3=A.showUpliftOptionStep3;a.enableUplift=A.enableUplift;a.cbpCustomer=E.getCBPCustomerDetails();a.getLoginModalWindow=function(){g.$broadcast("LoginActivity",{requestType:"Login",variance:"Small"})};a.notYou=function(){var a={};a=E.logout();a.then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length||
angular.isDefined(a.warningList)&&0<a.warningList.length?y.processErrorMessage(a):A.location.href=rootpath+"/home"+htmlExtension},function(a){})};a.initExtrasPage=function(){a.loadingSpinner=!0;a._productUpsellMessage();a.isTruckLocation=!1;a.loyaltyDetails=E.getLoyaltyDetails();F.getData().then(function(b){var e=u.getStorageData("oneClickURLCode");null!=e&&""!=e&&u.deleteStorageData("oneClickURLCode");e=u.getStorageData("bridgeResponse");null!=e&&""!=e&&angular.isDefined(e.errorList)&&"4"===e.webHeader.viewIndicator&&
(e=y.processErrorMessage(e),b.errorList=e.errorList);if(angular.isDefined(b.fieldErrors)&&0<b.fieldErrors.length||angular.isDefined(b.errorList)&&0<b.errorList.length||angular.isDefined(b.warningList)&&0<b.warningList.length||angular.isDefined(b.instructionList)&&0<b.instructionList.length||angular.isDefined(b.infoList)&&0<b.infoList.length){b=y.processErrorMessage(b);if(angular.isDefined(b.fieldErrors)&&0<b.fieldErrors.length||angular.isDefined(b.errorList)&&0<b.errorList.length)a.errorList=b.errorList;
angular.isDefined(b.warningList)&&0<b.warningList.length&&(a.warningList=b.warningList);angular.isDefined(b.instructionList)&&0<b.instructionList.length&&(a.instructionList=b.instructionList);angular.isDefined(b.infoList)&&0<b.infoList.length&&(a.infoList=b.infoList)}if(angular.isDefined(b)&&angular.isDefined(b.reservationSummary)&&angular.isDefined(b.reservationSummary.awdNonParticipating)&&b.reservationSummary.awdNonParticipating&&(e=Dictionary.I18n.get("msg.res.nonParticipatingMessage,"+brand),
angular.isDefined(e)&&e!="msg.res.nonParticipatingMessage,"+brand)){var c=[];c.push({message:e});a.infoList=c}a.reservationModel.digitalWalletFlowModify=!1;a.prod=b;e=f.getReviewData();!angular.isDefined(e)||angular.equals({},e)||a.pageName!=z.step4PageName&&g.$progressbar.$previousState.name!=z.step4PageName||(a.prod=e);angular.isDefined(e)&&angular.isDefined(b)&&angular.isDefined(b.reservationSummary)&&angular.isDefined(b.reservationSummary.ancillaryBundleSummary)&&(a.prod.reservationSummary.ancillaryBundleSummary=
b.reservationSummary.ancillaryBundleSummary);c=["us","ca","au","nz"];var h=["au","nz"];e=A.locale;e="fr"==e||"fr_US"==e?!0:!1;var N=a.prod.reservationSummary.ancillaryBundleSummary,m=a.prod.reservationSummary.rateSummary.periodFreeMiles.values,k=a.prod.reservationSummary.rateSummary.surcharges;if(("us"==A.domain.toLowerCase()||"ca"==A.domain.toLowerCase())&&e&&"\x26#x43;\x26#x24;"==a.prod.reservationSummary.rateSummary.currencySymbol){angular.isDefined(a.prod.reservationSummary.prepayInfo)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.cancelFee)&&
angular.isDefined(a.prod.reservationSummary.prepayInfo.noShowFee)&&(a.prod.reservationSummary.prepayInfo.cancelFee=a.prod.reservationSummary.prepayInfo.cancelFee.replace(".",","),a.prod.reservationSummary.prepayInfo.currency="$ CA",a.prod.reservationSummary.prepayInfo.noShowFee=a.prod.reservationSummary.prepayInfo.noShowFee.replace(".",","));a.prod.reservationSummary.rateSummary.currencySymbol="\x26#x24; \x26#x43;\x26#x41;";a.prod.reservationSummary.rateSummary.baseRate=a.prod.reservationSummary.rateSummary.baseRate.replace(".",
",");a.prod.reservationSummary.rateSummary.surchargeTotal=a.prod.reservationSummary.rateSummary.surchargeTotal.replace(".",",");a.prod.reservationSummary.rateSummary.estimatedTotal=a.prod.reservationSummary.rateSummary.estimatedTotal.replace(".",",");angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings)&&angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings.totalSavings)&&null!==a.prod.reservationSummary.rateSummary.resSavings.totalSavings&&(a.prod.reservationSummary.rateSummary.resSavings.totalSavings=
a.prod.reservationSummary.rateSummary.resSavings.totalSavings.replace(".",","));a.prod.reservationSummary.rateSummary.totalTax=a.prod.reservationSummary.rateSummary.totalTax.replace(".",",");angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.amount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.amount&&(a.prod.reservationSummary.vehicle.payLaterRate.amount=a.prod.reservationSummary.vehicle.payLaterRate.amount.replace(".",
","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.originalAmount&&(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount=a.prod.reservationSummary.vehicle.payLaterRate.originalAmount.replace(".",","));if(null!==N&&void 0!==N)for(var l=0;l<N.length;l++)null!==N[l].price&&void 0!==N[l].price&&(N[l].price=N[l].price.replace(".",",")),null!==
N[l].originalPrice&&void 0!==N[l].originalPrice&&(N[l].originalPrice=N[l].originalPrice.replace(".",",")),null!==N[l].discountAmount&&void 0!==N[l].discountAmount&&(N[l].discountAmount=N[l].discountAmount.replace(".",","));if(void 0!=a.prod.reservationSummary&&angular.isDefined(a.prod.reservationSummary.rateSummary.surcharges))for(l=0;l<k.length;l++)null!==k[l].unitPrice&&void 0!==k[l].unitPrice&&(a.prod.reservationSummary.rateSummary.surcharges[l].unitPrice=k[l].unitPrice=k[l].unitPrice.replace(".",
",")),null!==k[l].totalSurchargePrice&&void 0!==k[l].totalSurchargePrice&&(a.prod.reservationSummary.rateSummary.surcharges[l].totalSurchargePrice=k[l].totalSurchargePrice=k[l].totalSurchargePrice.replace(".",","));if(null!==m&&void 0!==m)for(l=0;l<m.length;l++)1==l&&(m[l]=m[l].replace(".",","))}angular.isDefined(a.prod.domainConfig)&&angular.isDefined(a.prod.domainConfig.rentLoc)&&angular.isDefined(a.prod.domainConfig.cor)&&g.isAnonymous&&null!=a.reservationModel.displayControls&&null!=a.reservationModel.displayControls.reservation&&
"create"===a.reservationModel.displayControls.reservation&&ABG.arrayHasObject(A.domain.toLowerCase(),h)&&ABG.arrayHasObject(a.prod.domainConfig.rentLoc.toLowerCase(),h)&&ABG.arrayHasObject(a.prod.domainConfig.cor.toLowerCase(),c)&&(a.showUpsellCampaign=!0);angular.isDefined(b.reservationSummary.vehicle)&&angular.isDefined(b.reservationSummary.vehicle.classDescription)&&(a.carDescription=b.reservationSummary.vehicle.classDescription);G(function(){g.$broadcast("couponRedeemRemoval",b)},100);angular.isDefined(b.reservationSummary.insuranceSummaryList)&&
angular.forEach(b.reservationSummary.insuranceSummaryList,function(a,c){a.priceInCents=Math.round(100*parseFloat(a.price).toFixed(2))});angular.isDefined(b.reservationSummary.productSummaryList)&&angular.forEach(b.reservationSummary.productSummaryList,function(a,c){a.priceInCents=Math.round(100*parseFloat(a.price).toFixed(2))});a.insurances=b.reservationSummary.insuranceSummaryList;a.products=b.reservationSummary.productSummaryList;h=J.process(b.reservationSummary);a.ancillaryProductsList=h.ancillaryProductsList;
a.insuranceDisplayCount=h.insuranceDisplayCount;a.displayTabsList=h.displayTabsList;a.equipDisplayLen=h.equipDisplayLen;a.servicesDisplaylen=h.servicesDisplaylen;a.servicestab1len=h.servicestab1len;a.servicestab2len=h.servicestab2len;a.pointProducts=b.reservationSummary.pointProducts;a.reservationModel.ccsection=b.reservationSummary.ccsection;a.reservationModel.payNowCheckBoxInd=b.reservationSummary.payNowCheckBoxInd;a.reservationModel.coupon.discountNumber=b.reservationSummary.awdNumber;c=b.reservationSummary.insuranceSummaryList;
h=h.ancillaryProductsList;if(("us"==A.domain.toLowerCase()||"ca"==A.domain.toLowerCase())&&e&&angular.isDefined(a.prod.reservationSummary.prepayInfo)&&"$ CA"==a.prod.reservationSummary.prepayInfo.currency){if(null!==c&&void 0!==c)for(e=0;e<c.length;e++)null!==c[e].price&&void 0!==c[e].price&&(c[e].price=c[e].price.replace(".",",")),null!==c[e].originalPrice&&void 0!==c[e].originalPrice&&(c[e].originalPrice=c[e].originalPrice.replace(".",","));if(null!==h&&void 0!==h){for(e=0;e<h.equipmentsList.length;e++)null!==
h.equipmentsList[e].price&&void 0!==h.equipmentsList[e].price&&(h.equipmentsList[e].price=h.equipmentsList[e].price.replace(".",",")),null!==h.equipmentsList[e].originalPrice&&void 0!==h.equipmentsList[e].originalPrice&&(h.equipmentsList[e].originalPrice=h.equipmentsList[e].originalPrice.replace(".",","));for(e=0;e<h.servicesList.length;e++)null!==h.servicesList[e].price&&void 0!==h.servicesList[e].price&&(h.servicesList[e].price=h.servicesList[e].price.replace(".",",")),null!==h.servicesList[e].originalPrice&&
void 0!==h.servicesList[e].originalPrice&&(h.servicesList[e].originalPrice=h.servicesList[e].originalPrice.replace(".",","))}}if(angular.isDefined(b.reservationSummary.discountSummaryList)){a.reservationModel.discountSummaryList=b.reservationSummary.discountSummaryList;var D="";angular.forEach(a.reservationModel.discountSummaryList,function(a,c){D=a.selected?a.discountNumber:b.reservationSummary.awdNumber});a.reservationModel.coupon.discountNumber=D}else a.reservationModel.coupon.discountNumber=b.reservationSummary.awdNumber;
angular.isDefined(b.reservationSummary.amazonLinked)&&(a.reservationModel.amazonLinked=b.reservationSummary.amazonLinked);angular.isDefined(b.reservationSummary.amazonLinkingSupported)&&(a.reservationModel.amazonLinkingSupported=b.reservationSummary.amazonLinkingSupported);void 0!=a.reservationModel.coupon&&(ea=a.reservationModel.coupon.couponNumber,aa=a.reservationModel.coupon.couponQuantity,K=a.reservationModel.coupon.discountNumber,Y=a.reservationModel.rentalType);if(a.prod.unavailProductMsg||
a.prod.unavailInsuranceMsg||a.prod.reservationSummary.productDropMsg)a.droppedProdAndInsuranceList=r.droppedData(a.prod);P=a.prod.reservationSummary.couponRateCode?a.prod.reservationSummary.couponRateCode:"";void 0!=a.prod.reservationSummary.loyaltyDetails&&0<a.prod.reservationSummary.loyaltyDetails.points&&("US"==a.prod.reservationSummary.pickLoc.address.country||"CA"==a.prod.reservationSummary.pickLoc.address.country||"PR"==a.prod.reservationSummary.pickLoc.address.country||"VI"==a.prod.reservationSummary.pickLoc.address.country)&&
(a.displayFreedayFlag=!0);null==a.reservationModel.displayControls||null==a.reservationModel.displayControls.reservation||z.resFlowCreate!==a.reservationModel.displayControls.reservation||b.reservationSummary.userState!==z.userStateAuthenticated&&b.reservationSummary.userState!==z.userStateRecognized||a._merchandisingServiceListener(a,b);a.prefferedPointsFlag=!1;e=angular.copy(a.products);c=angular.copy(a.pointProducts);h=angular.copy(a.insurances);a._setDataIntoSession(e,c,h);a._handlePKGInsurance();
a._handleCSSDisplay();a._tierBundlesDisplay();a.rentalLocationCountry=b.reservationSummary.pickLoc.address.country.toUpperCase();angular.isDefined(b.reservationSummary.rateSummary)&&angular.isDefined(b.reservationSummary.rateSummary.couponRedeemRemoval)&&angular.isDefined(b.reservationSummary.rateSummary.couponRedeemRemoval.code)&&(a.couponRedeemed=!0);angular.isDefined(b.reservationSummary.pointProducts)&&angular.isDefined(b.reservationSummary.pointProducts.freeDay)&&angular.isDefined(b.reservationSummary.pointProducts.freeDay.freeDayLessPoints)&&
(a.frdLessPoints=b.reservationSummary.pointProducts.freeDay.freeDayLessPoints);a.couponcheck=angular.isDefined(a.prod.reservationSummary.coupon);a.couponcheckCarupsell=angular.isDefined(a.prod.reservationSummary.coupon)&&angular.isDefined(a.prod.reservationSummary.coupon.number);(a.reservationModel.prepayOpted=a.prod.reservationSummary.prepayTxn)||a.prod.reservationSummary.ccsection&&"TRUE"==a.prod.reservationSummary.ccsection.visible&&angular.isDefined(a.prod.reservationSummary.payNowCheckBoxInd)&&
"FALSE"==a.prod.reservationSummary.payNowCheckBoxInd.visible&&!1===a.prod.reservationSummary.prepayTxn?a.isPayLaterOnlyReservation=!1:!angular.isDefined(a.prod.reservationSummary.payNowCheckBoxInd)||"TRUE"!=a.prod.reservationSummary.payNowCheckBoxInd.visible||a.reservationModel.prepayOpted||a.reservationModel.prepayProcessIndicator||a.rentalLocationCountry==z.countryCodeAU.toUpperCase()||a.rentalLocationCountry==z.countryCodeNZ.toUpperCase()?a.isPayLaterOnlyReservation=!0:a.isPayLaterOnlyReservation=
!1;a.getncfmessage();a.currencySymbol=B("currencySymbol")(b.reservationSummary.rateSummary.currencySymbol);d.reservationModel=angular.copy(a.reservationModel);e=F.handleLoyalty(a.prod.reservationSummary,d,a.pointCheckbox,a.productCheckbox,"EXTRAS",a.products);a.prefferedPointsFlag=e.prefferedPointsFlag;a.loyaltyDetails=e.loyaltyDetails;a.pointProducts=e.pointProducts;a.displayFreedayFlag=e.displayFreedayFlag;a.freedaySectionDisplay=e.freedaySectionDisplay;a.redeemableDays=e.redeemableDays;a.freeDayPoints=
e.freeDayPoints;a.totalreedem=e.totalReedemPoints;a.pointCheckbox=e.pointCheckbox;a.productCheckbox=e.productCheckbox;a.estimatedTotalIncents=Math.round(100*parseFloat(a.prod.reservationSummary.rateSummary.estimatedTotal).toFixed(2));e.selectedProducts&&(a.reservationModel.selectedProducts=e.selectedProducts);e=F.displayCarUpsell(a.pointProducts);a.priceUPS=e.priceUPS;a.redeemableUPS=e.redeemableUPS;a.pointsUPS=e.pointsUPS;a.prod.reservationSummary.ancillaryBundleSummary&&0<a.prod.reservationSummary.ancillaryBundleSummary.length&&
"INBOUND_BASIC"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"INBOUND_ALL"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"GUIDED_RES"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"LAST_MINUTE"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName||angular.isDefined(a.insurances)||(a.showEquipmentSec=!0);if(a.prod.reservationSummary.ancillaryBundleSummary&&0<a.prod.reservationSummary.ancillaryBundleSummary.length&&"INBOUND_BASIC"!==
a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"INBOUND_ALL"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"GUIDED_RES"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"LAST_MINUTE"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&angular.isDefined(a.insurances)&&angular.isDefined(a.products)||!(a.prod.reservationSummary.ancillaryBundleSummary&&0<a.prod.reservationSummary.ancillaryBundleSummary.length&&"INBOUND_BASIC"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&
"INBOUND_ALL"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"GUIDED_RES"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"LAST_MINUTE"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName)&&angular.isDefined(a.insurances)&&angular.isDefined(a.products)||a.prod.reservationSummary.ancillaryBundleSummary&&0<a.prod.reservationSummary.ancillaryBundleSummary.length&&"INBOUND_BASIC"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"INBOUND_ALL"!==
a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"GUIDED_RES"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"LAST_MINUTE"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&!angular.isDefined(a.insurances)&&angular.isDefined(a.products)||a.prod.reservationSummary.ancillaryBundleSummary&&0<a.prod.reservationSummary.ancillaryBundleSummary.length&&"INBOUND_BASIC"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"INBOUND_ALL"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&
"GUIDED_RES"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"LAST_MINUTE"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&angular.isDefined(a.insurances)&&!angular.isDefined(a.products))a.showCarousalArrow=!0;a.prod.reservationSummary.ancillaryBundleSummary&&0<a.prod.reservationSummary.ancillaryBundleSummary.length&&"INBOUND_BASIC"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"INBOUND_ALL"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&
"GUIDED_RES"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&"LAST_MINUTE"!==a.prod.reservationSummary.ancillaryBundleSummary[0].bundleName&&(a.displayBundles=!0);a.Tabactive=J.getCurrentActiveTab(a.displayTabsList);b.reservationSummary.ftpDetails&&"TRUE"==b.reservationSummary.ftpDetails.visible&&v.getData().then(function(c){a.ftp=c;a.reservationModel.ftpDetails.partnerCode=b.reservationSummary.ftpDetails.partnerCode!=z.ftpNotApplicableLower?b.reservationSummary.ftpDetails.partnerCode:
"";angular.isDefined(b.reservationSummary.ftpDetails.ftpNumber)&&b.reservationSummary.ftpDetails.ftpNumber.toLowerCase()!=z.ftpNotApplicableLower?a.reservationModel.ftpDetails.ftpNumber=b.reservationSummary.ftpDetails.ftpNumber:a.reservationModel.ftpDetails.ftpNumber="";a.reservationModel.ftpDetails.ftpBonusMiles=b.reservationSummary.ftpDetails.ftpBonusMiles;b.reservationSummary.ftpDetails.messages&&a._getFTPSectionMessage(b.reservationSummary.ftpDetails.messages)},function(a){});angular.isDefined(b.reservationSummary.rateSummary)&&
angular.isDefined(b.reservationSummary.rateSummary.estimatedTotal)&&(a.reservationModel.estimatedTotal=b.reservationSummary.rateSummary.estimatedTotal);"avis"==A.brand&&I.ancillaryBundlePromisesExecution().then(function(c){var d=[];d&&c&&0<d.length&&0<c.length&&(a.reservationModel.ancillaryBundlesRequestObj=F.createAncillaryBundlesRequest(c,d))});n.setReservationModel(a.reservationModel);a._retainPointStatus();setTimeout(function(){var a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Tablet PC|Opera Mini/i.test(navigator.userAgent)?
"focus":"hover";jQuery('a.popOver[data-toggle\x3d"popover"], a.steptwoinfo[data-toggle\x3d"popover"], a.info-icon[data-toggle\x3d"popover"]').attr("data-trigger",a);jQuery('[data-toggle\x3d"popover"]').popover();jQuery(".hide-on-load").removeClass("hide-on-load")},100);if(a.pageName==z.step3PageName)try{H.analyticsDimension(a.prod.reservationSummary,a.pageName,a.prod)}catch(pa){}a.loadingSpinner=!1;if(a.pageName==z.step3PageName&&g.deviceType==z.deviceTypeMobile&&"US"==a.reservationModel.pickUpLocation.countryCode&&
"US"==a.reservationModel.personalInfoRQ.residency&&a.prod.reservationSummary.userState===z.userStateAnonymous&&angular.isDefined(A.ancillaryCode)&&angular.isDefined(A.ancillaryType)){var R=!1;"protection"==A.ancillaryType?angular.forEach(a.insurances,function(c){c.code!=A.ancillaryCode||c.selected||(a.ancillary=angular.copy(c),R=a.ancillaryIsInsurance=!0)}):"equipment"==A.ancillaryType?angular.forEach(a.products,function(c){c.code!=A.ancillaryCode||c.selected||(a.ancillary=angular.copy(c),a.ancillaryIsInsurance=
!1,R=!0)}):"bundle"==A.ancillaryType&&angular.forEach(a.prod.reservationSummary.ancillaryBundleSummary,function(c){c.bundleName==A.ancillaryCode&&"FALSE"===c.bundleDisplay.selected&&(a.bundle=angular.copy(c),a.ancillaryIsInsurance=!1,R=!0)});setTimeout(function(){1==R&&angular.isUndefined(u.getStorageData("ancillaryPopupShown"))&&angular.element(".ancillary-upsell-modal").modal()},2500);jQuery(document).on("click",".modal-backdrop",function(){"handheld"==g.deviceType&&angular.element(".modal.in").modal("hide")})}a.googleRentalOptionsList=
S(b);e=u.getStorageData("hideGoogleModal")?u.getStorageData("hideGoogleModal"):"";"us"==a.domain&&0<a.googleRentalOptionsList.length&&""==e&&z.resFlowCreate===a.reservationModel.displayControls.reservation&&angular.element("#google-step3-modal").modal();e=u.getStorageData("partnerName");angular.isUndefined(e)&&angular.isDefined(b)&&angular.isDefined(b.reservationSummary)&&angular.isDefined(b.reservationSummary.partnerName)&&(e=b.reservationSummary.partnerName);if(angular.isDefined(e)&&""!=e&&"create"==
a.reservationModel.displayControls.reservation){if("USAA"==e){var p=A.usaaUpsellCode;angular.forEach(a.insurances,function(c,d){c.code==p&&(c.currencySymbol=a.prod.reservationSummary.rateSummary.currencySymbol,g.$broadcast("PartnerUpsellPrice",c))})}else if("AARP"==e){var q=A.aarpUpsellCode;angular.forEach(a.insurances,function(c,d){c.code==q&&(c.currencySymbol=a.prod.reservationSummary.rateSummary.currencySymbol,g.$broadcast("PartnerUpsellPrice",c))});x.getAARPBenefits(a.prod)}x.hideorShowPartnerBenefits(a.prod)}angular.isDefined(a.prod)&&
angular.isDefined(a.prod.reservationSummary)&&angular.isDefined(a.prod.reservationSummary.pickLoc)&&angular.isDefined(a.prod.reservationSummary.pickLoc.locationFleetType)&&"TRUCK"==a.prod.reservationSummary.pickLoc.locationFleetType&&(a.isTruckLocation=!0)},function(a){})};a.insuranceSelected=function(d,b){0<$("#PKGchk").length&&(a.insuranceCheckbox.PEP&&a.insuranceCheckbox.ALI&&a.insuranceCheckbox.PAI||a.insuranceCheckbox.PKG?(a.insuranceCheckbox.PKG=!0,a.insurancePackageSelected=!0,a.insuranceCheckbox.PEP=
!1,a.insuranceCheckbox.ALI=!1,a.insuranceCheckbox.PAI=!1,a.reservationModel.selectedInsurances=[],angular.forEach(a.insurances,function(a){a.code==z.insuranceCodePKG&&(d=a,d.selected=!0)}),a.reservationModel.selectedInsurances.push(d)):a.insurancePackageSelected=!1);a.insurancePackageSelected||(d.selected=a.insuranceCheckbox[b],a.insuranceCheckbox[b]?a.reservationModel.selectedInsurances.push(d):a.reservationModel=F.arrayPop(b,!0,a.reservationModel));n.setReservationModel(a.reservationModel);if(!("true"!=
a.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||A.brand!=z.brandName.AVIS&&A.brand!=z.brandName.BUDGET))grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(c){a.recaptcha=c;if(a.pageName==z.step3PageName||a.pageName==z.modifyReservationPage)g.requestInProgress=!0,F.recalculate("false",a.recaptcha).then(function(c){if(angular.isDefined(c.errorList)&&
0<c.errorList.length)g.requestInProgress=!1,y.processErrorMessage(c),c.errorList=x.handleRateCodeMainFrameError(c.errorList),0<c.errorList.length&&(a.errorList=c.errorList,A.scroll(0,0));else{g.requestInProgress=!1;1==a.displayBundles&&T(c);a.insurances=c.reservationSummary.insuranceSummaryList;a.products=c.reservationSummary.productSummaryList;a.googleRentalOptionsList=S(c);a.prod=c;angular.isDefined(c.reservationSummary.rateSummary)&&angular.isDefined(c.reservationSummary.rateSummary.estimatedTotal)&&
(a.reservationModel.estimatedTotal=c.reservationSummary.rateSummary.estimatedTotal);var d=A.locale,b="fr"==d||"fr_US"==d?!0:!1,k=a.prod.reservationSummary.ancillaryBundleSummary;d=c.reservationSummary.insuranceSummaryList;if(("us"==A.domain.toLowerCase()||"ca"==A.domain.toLowerCase())&&b&&"$ CA"==a.currencySymbol){angular.isDefined(a.prod.reservationSummary.prepayInfo)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.cancelFee)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.noShowFee)&&
(a.prod.reservationSummary.prepayInfo.cancelFee=a.prod.reservationSummary.prepayInfo.cancelFee.replace(".",","),a.prod.reservationSummary.prepayInfo.noShowFee=a.prod.reservationSummary.prepayInfo.noShowFee.replace(".",","));a.prod.reservationSummary.rateSummary.baseRate=a.prod.reservationSummary.rateSummary.baseRate.replace(".",",");a.prod.reservationSummary.rateSummary.surchargeTotal=a.prod.reservationSummary.rateSummary.surchargeTotal.replace(".",",");a.prod.reservationSummary.rateSummary.estimatedTotal=
a.prod.reservationSummary.rateSummary.estimatedTotal.replace(".",",");angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings)&&angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings.totalSavings)&&null!==a.prod.reservationSummary.rateSummary.resSavings.totalSavings&&(a.prod.reservationSummary.rateSummary.resSavings.totalSavings=a.prod.reservationSummary.rateSummary.resSavings.totalSavings.replace(".",","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&
angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.amount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.amount&&(a.prod.reservationSummary.vehicle.payLaterRate.amount=a.prod.reservationSummary.vehicle.payLaterRate.amount.replace(".",","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.originalAmount&&(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount=
a.prod.reservationSummary.vehicle.payLaterRate.originalAmount.replace(".",","));if(null!==k&&void 0!==k)for(b=0;b<k.length;b++)null!==k[b].price&&void 0!==k[b].price&&(k[b].price=k[b].price.replace(".",",")),null!==k[b].originalPrice&&void 0!==k[b].originalPrice&&(k[b].originalPrice=k[b].originalPrice.replace(".",",")),null!==k[b].discountAmount&&void 0!==k[b].discountAmount&&(k[b].discountAmount=k[b].discountAmount.replace(".",","));if(null!==d&&void 0!==d)for(k=0;k<d.length;k++)null!==d[k].price&&
void 0!==d[k].price&&(d[k].price=d[k].price.replace(".",",")),null!==d[k].originalPrice&&void 0!==d[k].originalPrice&&(d[k].originalPrice=d[k].originalPrice.replace(".",","))}a.estimatedTotalIncents=Math.round(100*parseFloat(a.prod.reservationSummary.rateSummary.estimatedTotal).toFixed(2));a.orderInfo=O();angular.isDefined(a.insurances)&&angular.forEach(a.insurances,function(a,c){a.priceInCents=Math.round(100*parseFloat(a.price).toFixed(2))});angular.isDefined(a.products)&&angular.forEach(a.products,
function(a,c){a.priceInCents=Math.round(100*parseFloat(a.price).toFixed(2))});d=u.getStorageData("partnerName");angular.isUndefined(d)&&angular.isDefined(c)&&angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.partnerName)&&(d=c.reservationSummary.partnerName);if(angular.isDefined(d)&&""!=d)if("USAA"==d){var e=A.usaaUpsellCode;angular.forEach(a.insurances,function(c,d){c.code==e&&(c.currencySymbol=a.prod.reservationSummary.rateSummary.currencySymbol,g.$broadcast("PartnerUpsellPrice",
c))})}else"AARP"==d&&(e=A.aarpUpsellCode,angular.forEach(a.insurances,function(c,d){c.code==e&&(c.currencySymbol=a.prod.reservationSummary.rateSummary.currencySymbol,g.$broadcast("PartnerUpsellPrice",c))}));setTimeout(function(){jQuery('[data-toggle\x3d"popover"]').popover({trigger:"hover"});ABG.updateContextStores();a.displayUpLiftRelatedInfo&&window.Uplift.Payments.load(a.orderInfo)},100)}},function(a){})})});else if(a.pageName==z.step3PageName||a.pageName==z.modifyReservationPage)g.requestInProgress=
!0,F.recalculate("false").then(function(c){if(angular.isDefined(c.errorList)&&0<c.errorList.length)g.requestInProgress=!1,y.processErrorMessage(c),c.errorList=x.handleRateCodeMainFrameError(c.errorList),0<c.errorList.length&&(a.errorList=c.errorList,A.scroll(0,0));else{g.requestInProgress=!1;1==a.displayBundles&&T(c);a.insurances=c.reservationSummary.insuranceSummaryList;a.products=c.reservationSummary.productSummaryList;a.googleRentalOptionsList=S(c);a.prod=c;angular.isDefined(c.reservationSummary.rateSummary)&&
angular.isDefined(c.reservationSummary.rateSummary.estimatedTotal)&&(a.reservationModel.estimatedTotal=c.reservationSummary.rateSummary.estimatedTotal);var d=A.locale,b="fr"==d||"fr_US"==d?!0:!1,e=a.prod.reservationSummary.ancillaryBundleSummary;d=c.reservationSummary.insuranceSummaryList;if(("us"==A.domain.toLowerCase()||"ca"==A.domain.toLowerCase())&&b&&"$ CA"==a.currencySymbol){angular.isDefined(a.prod.reservationSummary.prepayInfo)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.cancelFee)&&
angular.isDefined(a.prod.reservationSummary.prepayInfo.noShowFee)&&(a.prod.reservationSummary.prepayInfo.cancelFee=a.prod.reservationSummary.prepayInfo.cancelFee.replace(".",","),a.prod.reservationSummary.prepayInfo.noShowFee=a.prod.reservationSummary.prepayInfo.noShowFee.replace(".",","));a.prod.reservationSummary.rateSummary.baseRate=a.prod.reservationSummary.rateSummary.baseRate.replace(".",",");a.prod.reservationSummary.rateSummary.surchargeTotal=a.prod.reservationSummary.rateSummary.surchargeTotal.replace(".",
",");a.prod.reservationSummary.rateSummary.estimatedTotal=a.prod.reservationSummary.rateSummary.estimatedTotal.replace(".",",");angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings)&&angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings.totalSavings)&&null!==a.prod.reservationSummary.rateSummary.resSavings.totalSavings&&(a.prod.reservationSummary.rateSummary.resSavings.totalSavings=a.prod.reservationSummary.rateSummary.resSavings.totalSavings.replace(".",","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&
angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.amount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.amount&&(a.prod.reservationSummary.vehicle.payLaterRate.amount=a.prod.reservationSummary.vehicle.payLaterRate.amount.replace(".",","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.originalAmount&&(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount=
a.prod.reservationSummary.vehicle.payLaterRate.originalAmount.replace(".",","));if(null!==e&&void 0!==e)for(b=0;b<e.length;b++)null!==e[b].price&&void 0!==e[b].price&&(e[b].price=e[b].price.replace(".",",")),null!==e[b].originalPrice&&void 0!==e[b].originalPrice&&(e[b].originalPrice=e[b].originalPrice.replace(".",",")),null!==e[b].discountAmount&&void 0!==e[b].discountAmount&&(e[b].discountAmount=e[b].discountAmount.replace(".",","));if(null!==d&&void 0!==d)for(e=0;e<d.length;e++)null!==d[e].price&&
void 0!==d[e].price&&(d[e].price=d[e].price.replace(".",",")),null!==d[e].originalPrice&&void 0!==d[e].originalPrice&&(d[e].originalPrice=d[e].originalPrice.replace(".",","))}a.estimatedTotalIncents=Math.round(100*parseFloat(a.prod.reservationSummary.rateSummary.estimatedTotal).toFixed(2));a.orderInfo=O();angular.isDefined(a.insurances)&&angular.forEach(a.insurances,function(a,c){a.priceInCents=Math.round(100*parseFloat(a.price).toFixed(2))});angular.isDefined(a.products)&&angular.forEach(a.products,
function(a,c){a.priceInCents=Math.round(100*parseFloat(a.price).toFixed(2))});d=u.getStorageData("partnerName");angular.isUndefined(d)&&angular.isDefined(c)&&angular.isDefined(c.reservationSummary)&&angular.isDefined(c.reservationSummary.partnerName)&&(d=c.reservationSummary.partnerName);if(angular.isDefined(d)&&""!=d)if("USAA"==d){var k=A.usaaUpsellCode;angular.forEach(a.insurances,function(c,d){c.code==k&&(c.currencySymbol=a.prod.reservationSummary.rateSummary.currencySymbol,g.$broadcast("PartnerUpsellPrice",
c))})}else"AARP"==d&&(k=A.aarpUpsellCode,angular.forEach(a.insurances,function(c,d){c.code==k&&(c.currencySymbol=a.prod.reservationSummary.rateSummary.currencySymbol,g.$broadcast("PartnerUpsellPrice",c))}));setTimeout(function(){jQuery('[data-toggle\x3d"popover"]').popover({trigger:"hover"});ABG.updateContextStores();a.displayUpLiftRelatedInfo&&window.Uplift.Payments.load(a.orderInfo)},100)}},function(a){})};a.pointSelected=function(d,b,c){if(a.pageName==z.step3PageName||a.pageName==z.modifyReservationPage)g.requestInProgress=
!0;fa=ha=1;a.productSelected(d,b,"",c);a.couponCodeDisabled=F.disablecoupon(a.reservationModel)};a.productSelected=function(d,b,c,e){a.hideLoader||(g.requestInProgress=!0);a.frdSelectedFlag=!1;a.reservationModel.isItalylocation=a.prod.reservationSummary.snowChainCountryIndicator;a.reservationModel.issnowchainincluded=a.prod.reservationSummary.snowChainIncludedIndicator;a._productUpsellMessage();a.reservationModel.initOptionalServiceFlag=!0;angular.isDefined(d.subProducts)&&0<d.subProducts.length&&
(a.selectedProductsCodeForExpansion[b]=a.productCheckbox[b]);if(!a.productCheckbox[b]&&angular.isDefined(d.subProducts)&&0<d.subProducts.length)for(a.productCheckbox[b]=!1,g.requestInProgress=!1,F.unCheckCSSOption(d),b=0;b<d.subProducts.length;b++)c=d.subProducts[b].code,a.productCheckbox[c]=!1,a.cssDropDown[c]=0;else if(n.setReservationModel(a.reservationModel),d=F.handleProducts(d,b,c,e,fa,{pointCheckbox:a.pointCheckbox,productCheckbox:a.productCheckbox,cssDropDown:a.cssDropDown,products:a.products,
redeemedQty:ha,childSafetyExpanded:a.childSafetyExpanded,frdSelectedFlag:a.frdSelectedFlag,freeDayPoints:a.freeDayPoints,loyaltyDetails:a.loyaltyDetails,totalPoints:a.totalPoints}),a.reservationModel=n.getReservationModel(),a.pointCheckbox=d.pointCheckbox,a.productCheckbox=d.productCheckbox,a.cssDropDown=d.cssDropDown,a.products=d.products,a.childSafetyExpanded=d.childSafetyExpanded,a.freeDayPoints=d.freeDayPoints,a.loyaltyDetails=d.loyaltyDetails,a.totalPoints=d.totalPoints,fa=d.quantity,ha=d.redeemedQty,
d.flag){g.requestInProgress=!1;return}n.setReservationModel(a.reservationModel);"true"!=a.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||A.brand!=z.brandName.AVIS&&A.brand!=z.brandName.BUDGET?a.pageName!=z.step3PageName&&a.pageName!=z.modifyReservationPage||F.recalculate("false").then(function(c){if(angular.isDefined(c.errorList)&&0<c.errorList.length)g.requestInProgress=!1,y.processErrorMessage(c),c.errorList=x.handleRateCodeMainFrameError(c.errorList),
0<c.errorList.length&&(a.errorList=c.errorList,A.scroll(0,0));else{g.requestInProgress=!1;1==a.displayBundles&&T(c);a.products=c.reservationSummary.productSummaryList;var d=J.process(c.reservationSummary);a.ancillaryProductsList=d.ancillaryProductsList;a.insurances=c.reservationSummary.insuranceSummaryList;a.pointProducts=c.reservationSummary.pointProducts;a.googleRentalOptionsList=S(c);x.getAARPBenefits(c);a.prod=y.processErrorMessage(c);var b=A.locale,e="fr"==b||"fr_US"==b?!0:!1,h=a.prod.reservationSummary.ancillaryBundleSummary;
b=c.reservationSummary.insuranceSummaryList;d=d.ancillaryProductsList;if(("us"==A.domain.toLowerCase()||"ca"==A.domain.toLowerCase())&&e&&"$ CA"==a.currencySymbol){angular.isDefined(a.prod.reservationSummary.prepayInfo)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.cancelFee)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.noShowFee)&&(a.prod.reservationSummary.prepayInfo.cancelFee=a.prod.reservationSummary.prepayInfo.cancelFee.replace(".",","),a.prod.reservationSummary.prepayInfo.noShowFee=
a.prod.reservationSummary.prepayInfo.noShowFee.replace(".",","));a.prod.reservationSummary.rateSummary.baseRate=a.prod.reservationSummary.rateSummary.baseRate.replace(".",",");a.prod.reservationSummary.rateSummary.surchargeTotal=a.prod.reservationSummary.rateSummary.surchargeTotal.replace(".",",");a.prod.reservationSummary.rateSummary.estimatedTotal=a.prod.reservationSummary.rateSummary.estimatedTotal.replace(".",",");angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings)&&angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings.totalSavings)&&
null!==a.prod.reservationSummary.rateSummary.resSavings.totalSavings&&(a.prod.reservationSummary.rateSummary.resSavings.totalSavings=a.prod.reservationSummary.rateSummary.resSavings.totalSavings.replace(".",","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.amount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.amount&&(a.prod.reservationSummary.vehicle.payLaterRate.amount=a.prod.reservationSummary.vehicle.payLaterRate.amount.replace(".",
","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.originalAmount&&(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount=a.prod.reservationSummary.vehicle.payLaterRate.originalAmount.replace(".",","));if(null!==h&&void 0!==h)for(e=0;e<h.length;e++)null!==h[e].price&&void 0!==h[e].price&&(h[e].price=h[e].price.replace(".",",")),null!==
h[e].originalPrice&&void 0!==h[e].originalPrice&&(h[e].originalPrice=h[e].originalPrice.replace(".",",")),null!==h[e].discountAmount&&void 0!==h[e].discountAmount&&(h[e].discountAmount=h[e].discountAmount.replace(".",","));if(null!==b&&void 0!==b)for(h=0;h<b.length;h++)null!==b[h].price&&void 0!==b[h].price&&(b[h].price=b[h].price.replace(".",",")),null!==b[h].originalPrice&&void 0!==b[h].originalPrice&&(b[h].originalPrice=b[h].originalPrice.replace(".",","));if(null!==d&&void 0!==d){for(h=0;h<d.equipmentsList.length;h++)null!==
d.equipmentsList[h].price&&void 0!==d.equipmentsList[h].price&&(d.equipmentsList[h].price=d.equipmentsList[h].price.replace(".",",")),null!==d.equipmentsList[h].originalPrice&&void 0!==d.equipmentsList[h].originalPrice&&(d.equipmentsList[h].originalPrice=d.equipmentsList[h].originalPrice.replace(".",","));for(h=0;h<d.servicesList.length;h++)null!==d.servicesList[h].price&&void 0!==d.servicesList[h].price&&(d.servicesList[h].price=d.servicesList[h].price.replace(".",",")),null!==d.servicesList[h].originalPrice&&
void 0!==d.servicesList[h].originalPrice&&(d.servicesList[h].originalPrice=d.servicesList[h].originalPrice.replace(".",","))}}a.prod.instructionList&&0<a.prod.instructionList.length&&(a.instructionList=a.prod.instructionList);angular.forEach(a.instructionList,function(c){a.instructionList&&0<a.instructionList.length&&m.containsObject(c.code,z.nonParticpatingBcd)&&(a.reservationModel.coupon.discountNumber="")});n.setReservationModel(a.reservationModel);angular.isDefined(a.prod.reservationSummary.coupon)&&
!0===a.prod.reservationSummary.coupon.disableCoupon?a.couponCodeDisabled=!0:a.couponCodeDisabled=!1;0==!a.frdSelectedFlag&&a._calculateFreedayPoints();null==a.reservationModel.displayControls||null==a.reservationModel.displayControls.reservation||z.resFlowCreate!==a.reservationModel.displayControls.reservation||c.reservationSummary.userState!==z.userStateAuthenticated&&c.reservationSummary.userState!==z.userStateRecognized||a._merchandisingServiceListener(a,c);angular.isDefined(c.reservationSummary.rateSummary)&&
angular.isDefined(c.reservationSummary.rateSummary.estimatedTotal)&&(a.reservationModel.estimatedTotal=c.reservationSummary.rateSummary.estimatedTotal);"true"!=a.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||A.brand!=z.brandName.AVIS&&A.brand!=z.brandName.BUDGET?a.pageName==z.step3PageName||a.pageName==z.modifyReservationPage?F.recalculate("false").then(function(c){if(angular.isDefined(c.errorList)&&0<c.errorList.length)g.requestInProgress=
!1,y.processErrorMessage(c),c.errorList=x.handleRateCodeMainFrameError(c.errorList),0<c.errorList.length&&(a.errorList=c.errorList,A.scroll(0,0));else{g.requestInProgress=!1;1==a.displayBundles&&T(c);a.products=c.reservationSummary.productSummaryList;var d=J.process(c.reservationSummary);a.ancillaryProductsList=d.ancillaryProductsList;a.insurances=c.reservationSummary.insuranceSummaryList;a.pointProducts=c.reservationSummary.pointProducts;a.googleRentalOptionsList=S(c);x.getAARPBenefits(c);a.prod=
y.processErrorMessage(c);var b=A.locale,k="fr"==b||"fr_US"==b?!0:!1;b=a.prod.reservationSummary.ancillaryBundleSummary;c=c.reservationSummary.insuranceSummaryList;d=d.ancillaryProductsList;if(("us"==A.domain.toLowerCase()||"ca"==A.domain.toLowerCase())&&k&&"$ CA"==a.currencySymbol){angular.isDefined(a.prod.reservationSummary.prepayInfo)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.cancelFee)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.noShowFee)&&(a.prod.reservationSummary.prepayInfo.cancelFee=
a.prod.reservationSummary.prepayInfo.cancelFee.replace(".",","),a.prod.reservationSummary.prepayInfo.noShowFee=a.prod.reservationSummary.prepayInfo.noShowFee.replace(".",","));a.prod.reservationSummary.rateSummary.baseRate=a.prod.reservationSummary.rateSummary.baseRate.replace(".",",");a.prod.reservationSummary.rateSummary.surchargeTotal=a.prod.reservationSummary.rateSummary.surchargeTotal.replace(".",",");a.prod.reservationSummary.rateSummary.estimatedTotal=a.prod.reservationSummary.rateSummary.estimatedTotal.replace(".",
",");angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings)&&angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings.totalSavings)&&null!==a.prod.reservationSummary.rateSummary.resSavings.totalSavings&&(a.prod.reservationSummary.rateSummary.resSavings.totalSavings=a.prod.reservationSummary.rateSummary.resSavings.totalSavings.replace(".",","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.amount)&&
null!==a.prod.reservationSummary.vehicle.payLaterRate.amount&&(a.prod.reservationSummary.vehicle.payLaterRate.amount=a.prod.reservationSummary.vehicle.payLaterRate.amount.replace(".",","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.originalAmount&&(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount=a.prod.reservationSummary.vehicle.payLaterRate.originalAmount.replace(".",
","));if(null!==b&&void 0!==b)for(k=0;k<b.length;k++)null!==b[k].price&&void 0!==b[k].price&&(b[k].price=b[k].price.replace(".",",")),null!==b[k].originalPrice&&void 0!==b[k].originalPrice&&(b[k].originalPrice=b[k].originalPrice.replace(".",",")),null!==b[k].discountAmount&&void 0!==b[k].discountAmount&&(b[k].discountAmount=b[k].discountAmount.replace(".",","));if(null!==c&&void 0!==c)for(b=0;b<c.length;b++)null!==c[b].price&&void 0!==c[b].price&&(c[b].price=c[b].price.replace(".",",")),null!==c[b].originalPrice&&
void 0!==c[b].originalPrice&&(c[b].originalPrice=c[b].originalPrice.replace(".",","));if(null!==d&&void 0!==d){for(b=0;b<d.equipmentsList.length;b++)null!==d.equipmentsList[b].price&&void 0!==d.equipmentsList[b].price&&(d.equipmentsList[b].price=d.equipmentsList[b].price.replace(".",",")),null!==d.equipmentsList[b].originalPrice&&void 0!==d.equipmentsList[b].originalPrice&&(d.equipmentsList[b].originalPrice=d.equipmentsList[b].originalPrice.replace(".",","));for(b=0;b<d.servicesList.length;b++)null!==
d.servicesList[b].price&&void 0!==d.servicesList[b].price&&(d.servicesList[b].price=d.servicesList[b].price.replace(".",",")),null!==d.servicesList[b].originalPrice&&void 0!==d.servicesList[b].originalPrice&&(d.servicesList[b].originalPrice=d.servicesList[b].originalPrice.replace(".",","))}}a.prod.instructionList&&0<a.prod.instructionList.length&&(a.instructionList=a.prod.instructionList);angular.forEach(a.instructionList,function(c){a.instructionList&&0<a.instructionList.length&&m.containsObject(c.code,
z.nonParticpatingBcd)&&(a.reservationModel.coupon.discountNumber="")});G(function(){angular.element('.f_head [data-toggle\x3d"popover"]').popover({trigger:"hover"});angular.element(".popupDisabler").popover("disable");angular.element(".popupEnabler").popover({trigger:"focus"});ABG.updateContextStores();a.displayUpLiftRelatedInfo&&window.Uplift.Payments.load(a.orderInfo)},100)}},function(a){}):g.requestInProgress=!1:grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,
{action:"submit"}).then(function(c){a.recaptcha=c;a.pageName==z.step3PageName||a.pageName==z.modifyReservationPage?F.recalculate("false",a.recaptcha).then(function(c){if(angular.isDefined(c.errorList)&&0<c.errorList.length)g.requestInProgress=!1,y.processErrorMessage(c),c.errorList=x.handleRateCodeMainFrameError(c.errorList),0<c.errorList.length&&(a.errorList=c.errorList,A.scroll(0,0));else{g.requestInProgress=!1;1==a.displayBundles&&T(c);a.products=c.reservationSummary.productSummaryList;var d=J.process(c.reservationSummary);
a.ancillaryProductsList=d.ancillaryProductsList;a.insurances=c.reservationSummary.insuranceSummaryList;a.pointProducts=c.reservationSummary.pointProducts;a.googleRentalOptionsList=S(c);x.getAARPBenefits(c);a.prod=y.processErrorMessage(c);var b=A.locale,k="fr"==b||"fr_US"==b?!0:!1,e=a.prod.reservationSummary.ancillaryBundleSummary;b=c.reservationSummary.insuranceSummaryList;d=d.ancillaryProductsList;if(("us"==A.domain.toLowerCase()||"ca"==A.domain.toLowerCase())&&k&&"$ CA"==a.currencySymbol){angular.isDefined(a.prod.reservationSummary.prepayInfo)&&
angular.isDefined(a.prod.reservationSummary.prepayInfo.cancelFee)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.noShowFee)&&(a.prod.reservationSummary.prepayInfo.cancelFee=a.prod.reservationSummary.prepayInfo.cancelFee.replace(".",","),a.prod.reservationSummary.prepayInfo.noShowFee=a.prod.reservationSummary.prepayInfo.noShowFee.replace(".",","));a.prod.reservationSummary.rateSummary.baseRate=a.prod.reservationSummary.rateSummary.baseRate.replace(".",",");a.prod.reservationSummary.rateSummary.surchargeTotal=
a.prod.reservationSummary.rateSummary.surchargeTotal.replace(".",",");a.prod.reservationSummary.rateSummary.estimatedTotal=a.prod.reservationSummary.rateSummary.estimatedTotal.replace(".",",");angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings)&&angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings.totalSavings)&&null!==a.prod.reservationSummary.rateSummary.resSavings.totalSavings&&(a.prod.reservationSummary.rateSummary.resSavings.totalSavings=a.prod.reservationSummary.rateSummary.resSavings.totalSavings.replace(".",
","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.amount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.amount&&(a.prod.reservationSummary.vehicle.payLaterRate.amount=a.prod.reservationSummary.vehicle.payLaterRate.amount.replace(".",","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.originalAmount&&
(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount=a.prod.reservationSummary.vehicle.payLaterRate.originalAmount.replace(".",","));if(null!==e&&void 0!==e)for(k=0;k<e.length;k++)null!==e[k].price&&void 0!==e[k].price&&(e[k].price=e[k].price.replace(".",",")),null!==e[k].originalPrice&&void 0!==e[k].originalPrice&&(e[k].originalPrice=e[k].originalPrice.replace(".",",")),null!==e[k].discountAmount&&void 0!==e[k].discountAmount&&(e[k].discountAmount=e[k].discountAmount.replace(".",","));
if(null!==b&&void 0!==b)for(e=0;e<b.length;e++)null!==b[e].price&&void 0!==b[e].price&&(b[e].price=b[e].price.replace(".",",")),null!==b[e].originalPrice&&void 0!==b[e].originalPrice&&(b[e].originalPrice=b[e].originalPrice.replace(".",","));if(null!==d&&void 0!==d){for(e=0;e<d.equipmentsList.length;e++)null!==d.equipmentsList[e].price&&void 0!==d.equipmentsList[e].price&&(d.equipmentsList[e].price=d.equipmentsList[e].price.replace(".",",")),null!==d.equipmentsList[e].originalPrice&&void 0!==d.equipmentsList[e].originalPrice&&
(d.equipmentsList[e].originalPrice=d.equipmentsList[e].originalPrice.replace(".",","));for(e=0;e<d.servicesList.length;e++)null!==d.servicesList[e].price&&void 0!==d.servicesList[e].price&&(d.servicesList[e].price=d.servicesList[e].price.replace(".",",")),null!==d.servicesList[e].originalPrice&&void 0!==d.servicesList[e].originalPrice&&(d.servicesList[e].originalPrice=d.servicesList[e].originalPrice.replace(".",","))}}a.prod.instructionList&&0<a.prod.instructionList.length&&(a.instructionList=a.prod.instructionList);
angular.forEach(a.instructionList,function(c){a.instructionList&&0<a.instructionList.length&&m.containsObject(c.code,z.nonParticpatingBcd)&&(a.reservationModel.coupon.discountNumber="")});n.setReservationModel(a.reservationModel);angular.isDefined(a.prod.reservationSummary.coupon)&&!0===a.prod.reservationSummary.coupon.disableCoupon?a.couponCodeDisabled=!0:a.couponCodeDisabled=!1;0==!a.frdSelectedFlag&&a._calculateFreedayPoints();null==a.reservationModel.displayControls||null==a.reservationModel.displayControls.reservation||
z.resFlowCreate!==a.reservationModel.displayControls.reservation||c.reservationSummary.userState!==z.userStateAuthenticated&&c.reservationSummary.userState!==z.userStateRecognized||a._merchandisingServiceListener(a,c);angular.isDefined(c.reservationSummary.rateSummary)&&angular.isDefined(c.reservationSummary.rateSummary.estimatedTotal)&&(a.reservationModel.estimatedTotal=c.reservationSummary.rateSummary.estimatedTotal);a.estimatedTotalIncents=Math.round(100*parseFloat(a.prod.reservationSummary.rateSummary.estimatedTotal).toFixed(2));
a.orderInfo=O();angular.isDefined(a.insurances)&&angular.forEach(a.insurances,function(a,c){a.priceInCents=Math.round(100*parseFloat(a.price).toFixed(2))});angular.isDefined(a.products)&&angular.forEach(a.products,function(a,c){a.priceInCents=Math.round(100*parseFloat(a.price).toFixed(2))});G(function(){angular.element('.f_head [data-toggle\x3d"popover"]').popover({trigger:"hover"});angular.element(".popupDisabler").popover("disable");angular.element(".popupEnabler").popover({trigger:"focus"});ABG.updateContextStores();
a.displayUpLiftRelatedInfo&&window.Uplift.Payments.load(a.orderInfo)},100)}},function(a){}):g.requestInProgress=!1})})}}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(c){a.recaptcha=c;a.pageName==z.step3PageName||a.pageName==z.modifyReservationPage?F.recalculate("false",a.recaptcha).then(function(c){if(angular.isDefined(c.errorList)&&0<c.errorList.length)g.requestInProgress=!1,y.processErrorMessage(c),c.errorList=x.handleRateCodeMainFrameError(c.errorList),
0<c.errorList.length&&(a.errorList=c.errorList,A.scroll(0,0));else{g.requestInProgress=!1;1==a.displayBundles&&T(c);a.products=c.reservationSummary.productSummaryList;var d=J.process(c.reservationSummary);a.ancillaryProductsList=d.ancillaryProductsList;a.insurances=c.reservationSummary.insuranceSummaryList;a.pointProducts=c.reservationSummary.pointProducts;a.googleRentalOptionsList=S(c);x.getAARPBenefits(c);a.prod=y.processErrorMessage(c);var b=A.locale,e="fr"==b||"fr_US"==b?!0:!1,h=a.prod.reservationSummary.ancillaryBundleSummary;
b=c.reservationSummary.insuranceSummaryList;d=d.ancillaryProductsList;if(("us"==A.domain.toLowerCase()||"ca"==A.domain.toLowerCase())&&e&&"$ CA"==a.currencySymbol){angular.isDefined(a.prod.reservationSummary.prepayInfo)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.cancelFee)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.noShowFee)&&(a.prod.reservationSummary.prepayInfo.cancelFee=a.prod.reservationSummary.prepayInfo.cancelFee.replace(".",","),a.prod.reservationSummary.prepayInfo.noShowFee=
a.prod.reservationSummary.prepayInfo.noShowFee.replace(".",","));a.prod.reservationSummary.rateSummary.baseRate=a.prod.reservationSummary.rateSummary.baseRate.replace(".",",");a.prod.reservationSummary.rateSummary.surchargeTotal=a.prod.reservationSummary.rateSummary.surchargeTotal.replace(".",",");a.prod.reservationSummary.rateSummary.estimatedTotal=a.prod.reservationSummary.rateSummary.estimatedTotal.replace(".",",");angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings)&&angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings.totalSavings)&&
null!==a.prod.reservationSummary.rateSummary.resSavings.totalSavings&&(a.prod.reservationSummary.rateSummary.resSavings.totalSavings=a.prod.reservationSummary.rateSummary.resSavings.totalSavings.replace(".",","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.amount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.amount&&(a.prod.reservationSummary.vehicle.payLaterRate.amount=a.prod.reservationSummary.vehicle.payLaterRate.amount.replace(".",
","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.originalAmount&&(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount=a.prod.reservationSummary.vehicle.payLaterRate.originalAmount.replace(".",","));if(null!==h&&void 0!==h)for(e=0;e<h.length;e++)null!==h[e].price&&void 0!==h[e].price&&(h[e].price=h[e].price.replace(".",",")),null!==
h[e].originalPrice&&void 0!==h[e].originalPrice&&(h[e].originalPrice=h[e].originalPrice.replace(".",",")),null!==h[e].discountAmount&&void 0!==h[e].discountAmount&&(h[e].discountAmount=h[e].discountAmount.replace(".",","));if(null!==b&&void 0!==b)for(h=0;h<b.length;h++)null!==b[h].price&&void 0!==b[h].price&&(b[h].price=b[h].price.replace(".",",")),null!==b[h].originalPrice&&void 0!==b[h].originalPrice&&(b[h].originalPrice=b[h].originalPrice.replace(".",","));if(null!==d&&void 0!==d){for(h=0;h<d.equipmentsList.length;h++)null!==
d.equipmentsList[h].price&&void 0!==d.equipmentsList[h].price&&(d.equipmentsList[h].price=d.equipmentsList[h].price.replace(".",",")),null!==d.equipmentsList[h].originalPrice&&void 0!==d.equipmentsList[h].originalPrice&&(d.equipmentsList[h].originalPrice=d.equipmentsList[h].originalPrice.replace(".",","));for(h=0;h<d.servicesList.length;h++)null!==d.servicesList[h].price&&void 0!==d.servicesList[h].price&&(d.servicesList[h].price=d.servicesList[h].price.replace(".",",")),null!==d.servicesList[h].originalPrice&&
void 0!==d.servicesList[h].originalPrice&&(d.servicesList[h].originalPrice=d.servicesList[h].originalPrice.replace(".",","))}}a.prod.instructionList&&0<a.prod.instructionList.length&&(a.instructionList=a.prod.instructionList);angular.forEach(a.instructionList,function(c){a.instructionList&&0<a.instructionList.length&&m.containsObject(c.code,z.nonParticpatingBcd)&&(a.reservationModel.coupon.discountNumber="")});n.setReservationModel(a.reservationModel);angular.isDefined(a.prod.reservationSummary.coupon)&&
!0===a.prod.reservationSummary.coupon.disableCoupon?a.couponCodeDisabled=!0:a.couponCodeDisabled=!1;0==!a.frdSelectedFlag&&a._calculateFreedayPoints();null==a.reservationModel.displayControls||null==a.reservationModel.displayControls.reservation||z.resFlowCreate!==a.reservationModel.displayControls.reservation||c.reservationSummary.userState!==z.userStateAuthenticated&&c.reservationSummary.userState!==z.userStateRecognized||a._merchandisingServiceListener(a,c);angular.isDefined(c.reservationSummary.rateSummary)&&
angular.isDefined(c.reservationSummary.rateSummary.estimatedTotal)&&(a.reservationModel.estimatedTotal=c.reservationSummary.rateSummary.estimatedTotal);a.estimatedTotalIncents=Math.round(100*parseFloat(a.prod.reservationSummary.rateSummary.estimatedTotal).toFixed(2));a.orderInfo=O();angular.isDefined(a.insurances)&&angular.forEach(a.insurances,function(a,c){a.priceInCents=Math.round(100*parseFloat(a.price).toFixed(2))});angular.isDefined(a.products)&&angular.forEach(a.products,function(a,c){a.priceInCents=
Math.round(100*parseFloat(a.price).toFixed(2))});G(function(){angular.element('.f_head [data-toggle\x3d"popover"]').popover({trigger:"hover"});angular.element(".popupDisabler").popover("disable");angular.element(".popupEnabler").popover({trigger:"focus"});ABG.updateContextStores();a.displayUpLiftRelatedInfo&&window.Uplift.Payments.load(a.orderInfo)},100)}},function(a){}):g.requestInProgress=!1})})};a.pointSelectedvsFTP=function(d,b,c,e){c==z.productSectionFREEDAYS&&("TRUE"==a.prod.reservationSummary.ftpDetails.visible?
(angular.element(".ftp-loyality-modal").modal("show"),a._productUpsellMessage()):a._frwdSelected(d));a.couponCodeDisabled=F.disablecoupon(a.reservationModel);a.productObjSelected=d;a.codeSelected=b;a.productSectionSelected=c};a.keepFTPEarning=function(){g.requestInProgress=!0;F.disableLoyalty("true").then(function(d){angular.isDefined(d.fieldErrors)&&0<d.fieldErrors.length||angular.isDefined(d.errorList)&&0<d.errorList.length?y.processErrorMessage(d):(g.requestInProgress=!1,a.products=d.reservationSummary.productSummaryList,
a.pointProducts=d.reservationSummary.pointProducts,a.prod=d,a.displayFreedayFlag=!1,a.freedaySectionDisplay=F.getFreedaySectionDisplay(a.prod.reservationSummary))},function(a){})};a.keepPointsSelection=function(){a.productSectionSelected==z.productSectionCARUPSELL?a.handleUpsellSelection(a.productObjSelected,a.codeSelected):a.productSectionSelected==z.productSectionFREEDAYS?a._frwdSelected(void 0):(a.pointSelected(a.productObjSelected,a.codeSelected),a.couponCodeDisabled=F.disablecoupon(a.reservationModel))};
a.subProductSelected=function(){!1===a.childSafetyExpanded&&(a.childSafetyExpanded=!0)};a.updateProtectionModal=function(){g.requestInProgress=!0;n.setReservationModel(a.reservationModel);"true"!=a.enableEnterpriseCaptcha||A.brand!=z.brandName.AVIS&&A.brand!=z.brandName.BUDGET?F.recalculate().then(function(a){ia(a)},function(a){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(d){a.recaptcha=d;F.recalculate("false",a.recaptcha).then(function(a){ia(a)},
function(a){})})})};a.updateEquipmentModal=function(){g.requestInProgress=!0;a._productUpsellMessage();n.setReservationModel(a.reservationModel);"true"!=a.enableEnterpriseCaptcha||A.brand!=z.brandName.AVIS&&A.brand!=z.brandName.BUDGET?F.recalculate().then(function(a){da(a)},function(a){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(d){a.recaptcha=d;F.recalculate("false",a.recaptcha).then(function(a){da(a)},function(a){})})})};
a.cancelProtectionModal=function(){var d=n.getStorageData("insuranceList");a.insurances=angular.copy(d);a.reservationModel.selectedInsurances=[];a.prod.reservationSummary.insuranceSummaryList=a.insurances;angular.forEach(a.insurances,function(d,c){d.selected?(a.insuranceCheckbox[d.code]=!0,a.reservationModel.selectedInsurances.push(d)):a.insuranceCheckbox[d.code]=!1});e.closeModal({type:"protectionModify"})};a.cancelEquipmentModal=function(){var d=n.getStorageData("productList");a.products=angular.copy(d);
a.reservationModel.selectedProducts=[];a.prod.reservationSummary.productSummaryList=a.products;angular.forEach(a.products,function(d,c){if(d.code===z.equipmentCodeCSSG){var b=!1;angular.forEach(d.subProducts,function(c,d){c.selected&&c.redeemedQty&&1>c.redeemedQty||c.selected&&!c.redeemedQty?(a.productCheckbox[c.code]=!0,a.pointCheckbox[c.code]=!1,a.cssDropDown[c.code]=c.quantity,b=!0,a.reservationModel.selectedProducts.push(c)):c.selected&&c.redeemedQty&&0<c.redeemedQty?(a.pointCheckbox[c.code]=
!0,a.productCheckbox[c.code]=!1,a.cssDropDown[c.code]=c.quantity,b=!0,a.reservationModel.selectedProducts.push(c)):(a.productCheckbox[c.code]=!1,a.pointCheckbox[c.code]=!1,a.cssDropDown[c.code]=0)});a.productCheckbox[d.code]=b?!0:!1}else d.selected&&d.redeemedQty&&1>d.redeemedQty||d.selected&&!d.redeemedQty?(a.productCheckbox[d.code]=!0,a.pointCheckbox[d.code]=!1,a.reservationModel.selectedProducts.push(d)):d.selected&&d.redeemedQty&&0<d.redeemedQty?(a.pointCheckbox[d.code]=!0,a.productCheckbox[d.code]=
!1,a.reservationModel.selectedProducts.push(d)):(a.productCheckbox[d.code]=!1,a.pointCheckbox[d.code]=!1)});a.productCheckbox.CSSG||(a.productCheckbox.CSSG=!1,a.pointCheckbox.CSSG=!1,a.childSafetyExpanded=!1);e.closeModal({type:"equipmentModify"})};a.cancelDiscountModal=function(){a.cancelDicountUtility(a,ea,K,P,aa,Y)};a.getncfmessage=function(){angular.isDefined(a.prod.reservationSummary.rateSummary.disclosureFeeMsg)&&(a.ncfmessage=a.prod.reservationSummary.rateSummary.disclosureFeeMsg.values[0])};
a.review=function(){"avis"!=brand||"us"!=domain&&"ca"!=domain?"avis"!=brand||"au"!=domain&&"nz"!=domain?"budget"!=brand||"us"!=domain&&"ca"!=domain?"budget"!=brand&&"budgettruck"!=brand||"au"!=domain&&"nz"!=domain||(jQuery("#defaultLoader").addClass("hidden"),jQuery("#budgetStep2Placeholder").addClass("hidden"),jQuery("#budgetStep3Placeholder").removeClass("hidden")):(jQuery("#defaultLoader").removeClass("hidden"),jQuery("#budgetStep2Placeholder").addClass("hidden"),jQuery("#budgetStep3Placeholder").addClass("hidden")):
(jQuery("#avisLoader").addClass("hidden"),jQuery("#step2Placeholder").addClass("hidden"),jQuery("#step3Placeholder").removeClass("hidden")):(jQuery("#avisLoader").removeClass("hidden"),jQuery("#step2Placeholder").addClass("hidden"),jQuery("#step3Placeholder").addClass("hidden"));a.reservationModel.ftpDetails.partnerName="";a._validateFTPData();1>a.errorList.length&&a._reviewFtp()};a.childSafetyExpand=function(d){a.valChecked=!1;var b;angular.element(".childSafSubCont-wrap select").each(function(){b=
angular.element(this).val();1<b&&(a.valChecked=!0)});0==a.childSafetyExpanded?a.childSafetyExpanded=!0:1==a.valChecked?(a.childSafetyExpandedCheck=!0,a.childSafetyExpanded=!0,angular.element("#warning-message").popover("show"),G(function(){angular.element("#warning-message").popover("destroy")},2E3)):(a.childSafetyExpandedCheck=!1,a.childSafetyExpanded=!1)};a.handleUpsellSelection=function(d,b){g.requestInProgress=!0;angular.forEach(a.reservationModel.selectedProducts,function(c,d){c.code===b&&a.reservationModel.selectedProducts.splice(d,
1)});a.productCarUpsell[b]?(d.selected=!0,d.redeemedQty=0,d.quantity=1,a.reservationModel.selectedProducts.push(d)):a.pointCarUpsell[b]?(a.totalPoints=parseInt(a.loyaltyDetails.points),d.selected=!0,d.redeemedQty=1,d.quantity=1,a.reservationModel.selectedProducts.push(d)):a.reservationModel=F.arrayPop(b,!1,a.reservationModel);a.reservationModel.pointProducts.carUpsell=d;n.setReservationModel(a.reservationModel);if(a.pageName==z.step3PageName||a.pageName==z.modifyReservationPage)"true"!=a.enableEnterpriseCaptcha||
angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||A.brand!=z.brandName.AVIS&&A.brand!=z.brandName.BUDGET?F.recalculate("false").then(function(c){angular.isDefined(c.errorList)&&0<c.errorList.length?(g.requestInProgress=!1,y.processErrorMessage(c),c.errorList=x.handleRateCodeMainFrameError(c.errorList),0<c.errorList.length&&(a.errorList=c.errorList,A.scroll(0,0))):(g.requestInProgress=!1,a.pointProducts=c.reservationSummary.pointProducts,a.prod=c,
a.reservationModel.selectedCar=[],a.reservationModel.selectedCar.push(a.prod.reservationSummary.vehicle),angular.isDefined(a.prod.reservationSummary.coupon)&&!0===a.prod.reservationSummary.coupon.disableCoupon&&(a.couponCodeDisabled=!0),angular.isDefined(a.pointProducts)&&null!=a.pointProducts.carUpsell&&(c=a.pointProducts.carUpsell,a.priceUPS=0,a.redeemableUPS=!1,a.pointsUPS=0,a.priceUPS=void 0!=c.price?c.price:0,1==c.redeemable&&(a.redeemableUPS=!0,a.pointsUPS=c.points)),g.isAuthenticated&&brand===
carRentalConstants.brandName.AVIS&&a._calculateFreedayPoints())},function(a){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(c){a.recaptcha=c;F.recalculate("false",a.recaptcha).then(function(c){angular.isDefined(c.errorList)&&0<c.errorList.length?(g.requestInProgress=!1,y.processErrorMessage(c),c.errorList=x.handleRateCodeMainFrameError(c.errorList),0<c.errorList.length&&(a.errorList=c.errorList,A.scroll(0,0))):(g.requestInProgress=
!1,a.pointProducts=c.reservationSummary.pointProducts,a.prod=c,a.reservationModel.selectedCar=[],a.reservationModel.selectedCar.push(a.prod.reservationSummary.vehicle),angular.isDefined(a.prod.reservationSummary.coupon)&&!0===a.prod.reservationSummary.coupon.disableCoupon&&(a.couponCodeDisabled=!0),angular.isDefined(a.pointProducts)&&null!=a.pointProducts.carUpsell&&(c=a.pointProducts.carUpsell,a.priceUPS=0,a.redeemableUPS=!1,a.pointsUPS=0,a.priceUPS=void 0!=c.price?c.price:0,1==c.redeemable&&(a.redeemableUPS=
!0,a.pointsUPS=c.points)),g.isAuthenticated&&brand===carRentalConstants.brandName.AVIS&&a._calculateFreedayPoints())},function(a){})})})};a.analytics=function(d){var b={event:"analyticsVPV"};b.vpvName="/vpv/linkClickPage-"+d+a.pageName;dataLayer.push(b)};a.childSafetyModel=function(){a.content=!R;a.subcontent="mdlsubsafety"};a.scrollSetTop=function(){document.body.scrollTop=0};a.updateFTP=function(){a.reservationModel.ftpDetails.partnerName="";a._validateFTPData("update");1>a.errorList.length&&(g.requestInProgress=
!0,v.addFTP(a.reservationModel.ftpDetails.partnerCode,a.reservationModel.ftpDetails.ftpNumber).then(function(d){angular.isDefined(d.fieldErrors)&&0<d.fieldErrors.length||angular.isDefined(d.errorList)&&0<d.errorList.length||angular.isDefined(d.warningList)&&0<d.warningList.length?(g.requestInProgress=!1,d=y.processErrorMessage(d),a.errorList=d.errorList):(g.requestInProgress=!1,d.reservationSummary.ftpDetails&&d.reservationSummary.ftpDetails.partnerCode&&a.ftp&&a.ftp.partnersList&&(d=C(d.reservationSummary.ftpDetails.partnerCode),
a.reservationModel.ftpDetails.partnerName=0<d.length?d[0].partnerName:""),n.setReservationModel(a.reservationModel),A.location.reload())},function(a){g.requestInProgress=!1}))};a.loadHelpModal=function(d){a.helpURL=x.getUrl(d.target.parentElement,a.prod.reservationSummary.pickLoc.address.country)};a.loadHelpPath=function(d){a.helpPath=d.target.parentElement.dataset.helpMap+".html"};a.checkForPrfered=function(){return a.pageName==z.step3PageName&&a.prod&&a.prod.reservationSummary.loyaltyDetails&&a.prod.reservationSummary.loyaltyDetails.loyaltyLogin&&
"TRUE"==a.prod.reservationSummary.loyaltyDetails.loyaltyLogin.visible&&angular.isDefined(a.session)&&a.session.status==z.userStateRecognized&&!a.prod.reservationSummary.lockStatus?!0:!1};a.checkForStep4=function(){return a.pageName==z.step4PageName||a.pageName==z.step4PayLaterPageName||a.pageName==z.bookAgainPayNowPage||a.pageName==z.bookAgainPayLaterPage?!0:!1};a.disablePtsPerDay=function(d){return(d.points+a.prod.reservationSummary.rateSummary.totalRdmPts>a.totalPoints||0==d.redeemable)&&(void 0==
a.pointCheckbox[d.code]||0==a.pointCheckbox[d.code])||a.redeemedRes?!0:!1};a.disableExtraFromRecent=function(a){return a.productId===a.code+"chk_ext"||a.productId===a.code+"points_ext"||a.productId===a.code+"FTPpoints_ext"?!0:!1};a.disableExtraFromNonRecent=function(a){return a.productId===a.code+"chk"||a.productId===a.code+"points"||a.productId===a.code+"FTPpoints"?!0:!1};a.showHideRecentExtras=function(d,b,c){if(a.prod&&a.prod.webHeader&&a.prod.webHeader.p13nDetailsMap)var e=a.prod.webHeader.p13nDetailsMap;
else return!1;if(null!=a.reservationModel.displayControls&&null!=a.reservationModel.displayControls.reservation&&a.reservationModel.displayControls.reservation!=z.resFlowCreate||a.prod&&a.prod.reservationSummary.userState===z.userStateAnonymous)return!1;c=a._recentExtrasReady(c);if(d&&b&&e&&c){if(e.crmTopRentedAncillaries&&0<e.crmTopRentedAncillaries.length)return a.recentExtrasFlag="ancillaries",!0;if(e.rentalCounterProducts&&0<e.rentalCounterProducts.length&&c)return a.recentExtrasFlag="rentalExtra",
!0}else if(d&&e&&c){if(e.crmTopRentedAncillaries&&0<e.crmTopRentedAncillaries.length)return a.recentExtrasFlag="ancillaries",!0}else if(b&&e&&c&&e.rentalCounterProducts&&0<e.rentalCounterProducts.length)return a.recentExtrasFlag="rentalExtra",!0;return!1};a.recentExtrasIndicator=function(d){return"ancillaries"===a.recentExtrasFlag?d.ancillaries:d.rentalExtra};a.couponRedeemed=!1;a.frdLessPoints=!1;a.closeCarModel=function(){e.closeModal({type:"CarDetailsModify"})};a.productUpsellCode;a.showUpsellMessage=
!1;a.closeModal=function(d){"ftpDetails"===d&&(a.reservationModel.bookAgain.bookAgainFlow?(d=f.getAvailableExtras(),angular.isDefined(d.reservationSummary)&&angular.isDefined(d.reservationSummary.ftpDetails)?(angular.isDefined(d.reservationSummary.ftpDetails.partnerCode)&&(a.reservationModel.ftpDetails.partnerCode=d.reservationSummary.ftpDetails.partnerCode),angular.isDefined(d.reservationSummary.ftpDetails.ftpNumber)&&(a.reservationModel.ftpDetails.ftpNumber=d.reservationSummary.ftpDetails.ftpNumber)):
(a.reservationModel.ftpDetails.partnerCode="",a.reservationModel.ftpDetails.ftpNumber="")):(a.reservationModel.ftpDetails.partnerCode=f.getAvailableExtras().reservationSummary.ftpDetails.partnerCode,a.reservationModel.ftpDetails.ftpNumber=f.getAvailableExtras().reservationSummary.ftpDetails.ftpNumber),e.closeModal({type:"ftpDetails"}));n.setReservationModel(a.reservationModel)};a.bookAgainFTPCheck=function(d){return d&&a.prod.reservationSummary.rebookFlow?angular.isDefined(a.prod.reservationSummary.ftpDetails.ftpNumber)?
!0:!1:!d&&a.prod.reservationSummary.rebookFlow?angular.isUndefined(a.prod.reservationSummary.ftpDetails.ftpNumber)?!0:!1:d?!0:!1};a.getPrepayTnCs=function(){a.contentType=!0===a.prod.reservationSummary.prepayTxn?z.txnTypePrePay:z.txnTypePostPay;a.promise=h.load(a.contentType,a.prod.reservationSummary.pickLoc.locationCode);a.promise.then(function(d){a.tempDescription=d},function(a){})};a.createBundleExtrasList=function(d){if(angular.isDefined(d)){var b,c=[];a.bundleDescription={bundleName:"",bundleExtras:""};
if(angular.isDefined(d.bundledInsurances))for(b=0;b<d.bundledInsurances.length;b++)c.push({description:d.bundledInsurances[b].description,shortDescription:d.bundledInsurances[b].shortDescription,additionalNote:d.bundledInsurances[b].additionalnote});if(angular.isDefined(d.bundledProducts))for(b=0;b<d.bundledProducts.length;b++)c.push({description:d.bundledProducts[b].description,shortDescription:d.bundledProducts[b].shortDescription,additionalNote:d.bundledProducts[b].additionalnote})}a.bundleDescription.bundleName=
d.bundleName;a.bundleDescription.bundleExtras=c};a.showExcludedProducts=function(d){a.excludedProductsList=[];var b,c;if(d){if(d.productSummaryList&&0<d.productSummaryList.length)for(b=0;b<d.productSummaryList.length;b++)if(d.productSummaryList[b].code!=z.equipmentCodeCSSG)0!=d.productSummaryList[b].discountEligible&&""!=d.productSummaryList[b].discountEligible||a.excludedProductsList.push(d.productSummaryList[b].description);else for(c=0;c<d.productSummaryList[b].subProducts.length;c++)0!=d.productSummaryList[b].subProducts[c].discountEligible&&
""!=d.productSummaryList[b].subProducts[c].discountEligible||a.excludedProductsList.push(d.productSummaryList[b].subProducts[c].description);if(d.insuranceSummaryList&&0<d.insuranceSummaryList.length)for(b=0;b<d.insuranceSummaryList.length;b++)0!=d.insuranceSummaryList[b].discountEligible&&""!=d.insuranceSummaryList[b].discountEligible||a.excludedProductsList.push(d.insuranceSummaryList[b].description)}};a.selectBundle=function(b){var e=n.getReservationModel();if(e&&e.ancillaryBundlesData){var c=
e.ancillaryBundlesData;null!=c&&c&&0<c.length&&c[0]&&c[0].resolvedOffers.forEach(function(c){c.selected=c.bundleName==b.bundleName?a.bundleCheckbox[b.bundleName]?a.bundleCheckbox[b.bundleName]:!1:!1;e.selectedBundleName==c.bundleName&&(e=ba(c,e));ca(c);U(c)})}e.selectedBundleName=a.bundleCheckbox[b.bundleName]?b.bundleName:"";n.setReservationModel(e);g.requestInProgress=!0;"true"!=a.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||
A.brand!=z.brandName.AVIS&&A.brand!=z.brandName.BUDGET?F.recalculate().then(function(c){if(angular.isDefined(c.errorList)&&0<c.errorList.length)g.requestInProgress=!1,y.processErrorMessage(c),c.errorList=x.handleRateCodeMainFrameError(c.errorList),0<c.errorList.length&&(a.errorList=c.errorList,A.scroll(0,0));else{g.requestInProgress=!1;a.prod=c;angular.isDefined(a.prod.reservationSummary.ancillaryBundleSummary)&&(a.selectedBundleName=Z(a.prod.reservationSummary.ancillaryBundleSummary),H.bundleSelectedtoAnalytics(a.selectedBundleName,
a.prod),e.selectedBundleName=a.selectedBundleName,n.setReservationModel(e));a.products=a.prod.reservationSummary.productSummaryList;a.insurances=a.prod.reservationSummary.insuranceSummaryList;var b=J.process(c.reservationSummary);a.ancillaryProductsList=b.ancillaryProductsList;var h=A.locale,k="fr"==h||"fr_US"==h?!0:!1,f=a.prod.reservationSummary.ancillaryBundleSummary;h=c.reservationSummary.insuranceSummaryList;b=b.ancillaryProductsList;if(("us"==A.domain.toLowerCase()||"ca"==A.domain.toLowerCase())&&
k&&"$ CA"==a.currencySymbol){angular.isDefined(a.prod.reservationSummary.prepayInfo)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.cancelFee)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.noShowFee)&&(a.prod.reservationSummary.prepayInfo.cancelFee=a.prod.reservationSummary.prepayInfo.cancelFee.replace(".",","),a.prod.reservationSummary.prepayInfo.noShowFee=a.prod.reservationSummary.prepayInfo.noShowFee.replace(".",","));a.prod.reservationSummary.rateSummary.baseRate=a.prod.reservationSummary.rateSummary.baseRate.replace(".",
",");a.prod.reservationSummary.rateSummary.surchargeTotal=a.prod.reservationSummary.rateSummary.surchargeTotal.replace(".",",");a.prod.reservationSummary.rateSummary.estimatedTotal=a.prod.reservationSummary.rateSummary.estimatedTotal.replace(".",",");angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings)&&angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings.totalSavings)&&null!==a.prod.reservationSummary.rateSummary.resSavings.totalSavings&&(a.prod.reservationSummary.rateSummary.resSavings.totalSavings=
a.prod.reservationSummary.rateSummary.resSavings.totalSavings.replace(".",","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.amount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.amount&&(a.prod.reservationSummary.vehicle.payLaterRate.amount=a.prod.reservationSummary.vehicle.payLaterRate.amount.replace(".",","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount)&&
null!==a.prod.reservationSummary.vehicle.payLaterRate.originalAmount&&(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount=a.prod.reservationSummary.vehicle.payLaterRate.originalAmount.replace(".",","));if(null!==f&&void 0!==f)for(k=0;k<f.length;k++)null!==f[k].price&&void 0!==f[k].price&&(f[k].price=f[k].price.replace(".",",")),null!==f[k].originalPrice&&void 0!==f[k].originalPrice&&(f[k].originalPrice=f[k].originalPrice.replace(".",",")),null!==f[k].discountAmount&&void 0!==f[k].discountAmount&&
(f[k].discountAmount=f[k].discountAmount.replace(".",","));if(null!==h&&void 0!==h)for(f=0;f<h.length;f++)null!==h[f].price&&void 0!==h[f].price&&(h[f].price=h[f].price.replace(".",",")),null!==h[f].originalPrice&&void 0!==h[f].originalPrice&&(h[f].originalPrice=h[f].originalPrice.replace(".",","));if(null!==b&&void 0!==b){for(f=0;f<b.equipmentsList.length;f++)null!==b.equipmentsList[f].price&&void 0!==b.equipmentsList[f].price&&(b.equipmentsList[f].price=b.equipmentsList[f].price.replace(".",",")),
null!==b.equipmentsList[f].originalPrice&&void 0!==b.equipmentsList[f].originalPrice&&(b.equipmentsList[f].originalPrice=b.equipmentsList[f].originalPrice.replace(".",","));for(f=0;f<b.servicesList.length;f++)null!==b.servicesList[f].price&&void 0!==b.servicesList[f].price&&(b.servicesList[f].price=b.servicesList[f].price.replace(".",",")),null!==b.servicesList[f].originalPrice&&void 0!==b.servicesList[f].originalPrice&&(b.servicesList[f].originalPrice=b.servicesList[f].originalPrice.replace(".",
","))}}h=F.handleLoyalty(a.prod.reservationSummary,d,a.pointCheckbox,a.productCheckbox,"EXTRAS",a.products);a.prefferedPointsFlag=h.prefferedPointsFlag;a.loyaltyDetails=h.loyaltyDetails;a.pointProducts=h.pointProducts;a.displayFreedayFlag=h.displayFreedayFlag;a.freedaySectionDisplay=h.freedaySectionDisplay;a.redeemableDays=h.redeemableDays;a.freeDayPoints=h.freeDayPoints;a.totalreedem=h.totalReedemPoints;a.pointCheckbox=h.pointCheckbox;a.productCheckbox=h.productCheckbox;angular.isDefined(c.reservationSummary.rateSummary)&&
angular.isDefined(c.reservationSummary.rateSummary.estimatedTotal)&&(a.reservationModel.estimatedTotal=c.reservationSummary.rateSummary.estimatedTotal)}},function(a){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(c){a.recaptcha=c;F.recalculate("false",a.recaptcha).then(function(c){if(angular.isDefined(c.errorList)&&0<c.errorList.length)g.requestInProgress=!1,y.processErrorMessage(c),c.errorList=x.handleRateCodeMainFrameError(c.errorList),
0<c.errorList.length&&(a.errorList=c.errorList,A.scroll(0,0));else{g.requestInProgress=!1;a.prod=c;angular.isDefined(a.prod.reservationSummary.ancillaryBundleSummary)&&(a.selectedBundleName=Z(a.prod.reservationSummary.ancillaryBundleSummary),H.bundleSelectedtoAnalytics(a.selectedBundleName,a.prod),e.selectedBundleName=a.selectedBundleName,n.setReservationModel(e));a.products=a.prod.reservationSummary.productSummaryList;a.insurances=a.prod.reservationSummary.insuranceSummaryList;var b=J.process(c.reservationSummary);
a.ancillaryProductsList=b.ancillaryProductsList;var k=A.locale,h="fr"==k||"fr_US"==k?!0:!1,f=a.prod.reservationSummary.ancillaryBundleSummary;k=c.reservationSummary.insuranceSummaryList;b=b.ancillaryProductsList;if(("us"==A.domain.toLowerCase()||"ca"==A.domain.toLowerCase())&&h&&"$ CA"==a.currencySymbol){angular.isDefined(a.prod.reservationSummary.prepayInfo)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.cancelFee)&&angular.isDefined(a.prod.reservationSummary.prepayInfo.noShowFee)&&(a.prod.reservationSummary.prepayInfo.cancelFee=
a.prod.reservationSummary.prepayInfo.cancelFee.replace(".",","),a.prod.reservationSummary.prepayInfo.noShowFee=a.prod.reservationSummary.prepayInfo.noShowFee.replace(".",","));a.prod.reservationSummary.rateSummary.baseRate=a.prod.reservationSummary.rateSummary.baseRate.replace(".",",");a.prod.reservationSummary.rateSummary.surchargeTotal=a.prod.reservationSummary.rateSummary.surchargeTotal.replace(".",",");a.prod.reservationSummary.rateSummary.estimatedTotal=a.prod.reservationSummary.rateSummary.estimatedTotal.replace(".",
",");angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings)&&angular.isDefined(a.prod.reservationSummary.rateSummary.resSavings.totalSavings)&&null!==a.prod.reservationSummary.rateSummary.resSavings.totalSavings&&(a.prod.reservationSummary.rateSummary.resSavings.totalSavings=a.prod.reservationSummary.rateSummary.resSavings.totalSavings.replace(".",","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.amount)&&
null!==a.prod.reservationSummary.vehicle.payLaterRate.amount&&(a.prod.reservationSummary.vehicle.payLaterRate.amount=a.prod.reservationSummary.vehicle.payLaterRate.amount.replace(".",","));angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount)&&null!==a.prod.reservationSummary.vehicle.payLaterRate.originalAmount&&(a.prod.reservationSummary.vehicle.payLaterRate.originalAmount=a.prod.reservationSummary.vehicle.payLaterRate.originalAmount.replace(".",
","));if(null!==f&&void 0!==f)for(h=0;h<f.length;h++)null!==f[h].price&&void 0!==f[h].price&&(f[h].price=f[h].price.replace(".",",")),null!==f[h].originalPrice&&void 0!==f[h].originalPrice&&(f[h].originalPrice=f[h].originalPrice.replace(".",",")),null!==f[h].discountAmount&&void 0!==f[h].discountAmount&&(f[h].discountAmount=f[h].discountAmount.replace(".",","));if(null!==k&&void 0!==k)for(f=0;f<k.length;f++)null!==k[f].price&&void 0!==k[f].price&&(k[f].price=k[f].price.replace(".",",")),null!==k[f].originalPrice&&
void 0!==k[f].originalPrice&&(k[f].originalPrice=k[f].originalPrice.replace(".",","));if(null!==b&&void 0!==b){for(f=0;f<b.equipmentsList.length;f++)null!==b.equipmentsList[f].price&&void 0!==b.equipmentsList[f].price&&(b.equipmentsList[f].price=b.equipmentsList[f].price.replace(".",",")),null!==b.equipmentsList[f].originalPrice&&void 0!==b.equipmentsList[f].originalPrice&&(b.equipmentsList[f].originalPrice=b.equipmentsList[f].originalPrice.replace(".",","));for(f=0;f<b.servicesList.length;f++)null!==
b.servicesList[f].price&&void 0!==b.servicesList[f].price&&(b.servicesList[f].price=b.servicesList[f].price.replace(".",",")),null!==b.servicesList[f].originalPrice&&void 0!==b.servicesList[f].originalPrice&&(b.servicesList[f].originalPrice=b.servicesList[f].originalPrice.replace(".",","))}}k=F.handleLoyalty(a.prod.reservationSummary,d,a.pointCheckbox,a.productCheckbox,"EXTRAS",a.products);a.prefferedPointsFlag=k.prefferedPointsFlag;a.loyaltyDetails=k.loyaltyDetails;a.pointProducts=k.pointProducts;
a.displayFreedayFlag=k.displayFreedayFlag;a.freedaySectionDisplay=k.freedaySectionDisplay;a.redeemableDays=k.redeemableDays;a.freeDayPoints=k.freeDayPoints;a.totalreedem=k.totalReedemPoints;a.pointCheckbox=k.pointCheckbox;a.productCheckbox=k.productCheckbox;angular.isDefined(c.reservationSummary.rateSummary)&&angular.isDefined(c.reservationSummary.rateSummary.estimatedTotal)&&(a.reservationModel.estimatedTotal=c.reservationSummary.rateSummary.estimatedTotal)}},function(a){})})})};a.closeAncillaryModal=
function(){u.setStorageData("ancillaryPopupShown","yes");angular.element(".ancillary-upsell-modal").modal("hide")};a.closeGoogleModal=function(){u.setStorageData("hideGoogleModal","true");angular.element("#google-step3-modal").modal("hide")};a.inCents=100;a._productUpsellMessage=function(){if(angular.isDefined(a.reservationModel)&&angular.isDefined(a.reservationModel.selectedProducts)){var d=F.productUpsellMessage(a.reservationModel.selectedProducts);a.showUpsellMessage=d.showUpsellMessage;a.productUpsellCode=
d.productUpsellCode;a.reservationModel.selectedProducts=d.selectedProducts;n.setReservationModel(a.reservationModel)}};a._recentExtrasReady=function(a){if(a)for(L=0;L<a.length;L++)if(a[L].ancillaries||a[L].rentalExtra)return!0;return!1};a._authenticationHandler=function(d){a.model=d;t.current.name==z.step3PageName&&(d.reservationSummary.userState==z.userStateAuthenticated?"true"!=a.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||
A.brand!=z.brandName.AVIS&&A.brand!=z.brandName.BUDGET?F.load().then(function(d){angular.isDefined(d.fieldErrors)&&0<d.fieldErrors.length||angular.isDefined(d.errorList)&&0<d.errorList.length?y.processErrorMessage(d):(a.session=E.getSessionModel(),a.initExtrasPage())},function(a){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(d){a.recaptcha=d;F.load(!1,a.recaptcha).then(function(c){angular.isDefined(c.fieldErrors)&&
0<c.fieldErrors.length||angular.isDefined(c.errorList)&&0<c.errorList.length?y.processErrorMessage(c):(a.session=E.getSessionModel(),a.initExtrasPage())},function(a){})})}):(a.loginValidated=!0,a.loginFormPageError=Dictionary.I18n.get("err.prof.login.authenticationFailedAction")))};a._merchandisingServiceListener=function(a,d){I.promisesExecution(d,"extras").then(function(c){a.products=c.reservationSummary.productSummaryList;if(c.webHeader.p13nDetailsMap.rentalCounterProducts){var d=n.getReservationModel();
d.recentExtras=c.webHeader.p13nDetailsMap.rentalCounterProducts;n.setReservationModel(d)}})};a._setDataIntoSession=function(a,d,c){n.setStorageData("insuranceList",c);n.setStorageData("productList",a);n.setStorageData("pointProductList",d)};a._handlePKGInsurance=function(){angular.forEach(a.insurances,function(d){if(d.selected){a.insuranceCheckbox[d.code]=!0;var b=!1;angular.forEach(a.reservationModel.selectedInsurances,function(a){d.code==a.code&&(b=!0)});b||a.reservationModel.selectedInsurances.push(d)}d.selected&&
d.code===z.insuranceCodePKG&&(a.insurancePackageSelected=!0)})};a._handleCSSDisplay=function(){angular.forEach(a.products,function(d){!0===d.selected&&(a.productCheckbox[d.code]=!0);void 0!=d.subProducts&&angular.forEach(d.subProducts,function(c){for(var b=c.code,e=c.displayQuantity,h=0;h<=e;h++)a.cssDropDownValues[b].push({selectId:h,selectName:h});!0===c.selected?(a.pointCheckbox[d.code]=!1,a.productCheckbox[d.code]=!0,a.childSafetyExpanded=!0,a.selectedProductsCodeForExpansion[d.code]=!0,a.cssDropDown[c.code]=
c.quantity,a.productCheckbox[c.code]=!0,a.subProductInclusionMessage=c.productMessage.message):a.cssDropDown[c.code]=0})});for(var d=0;d<a.reservationModel.selectedProducts.length;d++)if("CSSG"==a.reservationModel.selectedProducts[d].code){a.subProductSelected();break}};a._getFTPSectionMessage=function(d){var b=[],c=[],e=[];angular.forEach(d,function(a){angular.equals(a.type,"ERROR")?c.push(a):angular.equals(a.type,"WARNING")?e.push(a):b.push(a)});a.ftpSectInstrList=b;a.ftpSectErrList=c;a.ftpSectWarList=
e};a._retainPointStatus=function(){0<a.reservationModel.selectedProducts.length&&angular.forEach(a.reservationModel.selectedProducts,function(d,b){if(void 0==a.reservationModel.selectedProducts[b].redeemedQty||1>a.reservationModel.selectedProducts[b].redeemedQty)a.productCheckbox[a.reservationModel.selectedProducts[b].code]=!0,a.pointCheckbox[a.reservationModel.selectedProducts[b].code]=!1;void 0!=a.reservationModel.selectedProducts[b].redeemedQty&&0<a.reservationModel.selectedProducts[b].redeemedQty&&
(a.pointCheckbox[a.reservationModel.selectedProducts[b].code]=!0,a.productCheckbox[a.reservationModel.selectedProducts[b].code]=!1)})};a._validateFTPData=function(d){var b=!0,c=!0,e=[],h,f=[];if(void 0==a.reservationModel.ftpDetails.partnerCode||""==a.reservationModel.ftpDetails.partnerCode||"n/a"==a.reservationModel.ftpDetails.partnerCode)b=!1,a.reservationModel.ftpDetails.partnerCode="";if(void 0==a.reservationModel.ftpDetails.ftpNumber||""==a.reservationModel.ftpDetails.ftpNumber||"n/a"==a.reservationModel.ftpDetails.ftpNumber)c=
!1,a.reservationModel.ftpDetails.ftpNumber="";"update"==d?c&&!b?e.push(Dictionary.I18n.get("err.res.step3.ftp.PartnerError")):b&&!c&&e.push(Dictionary.I18n.get("err.res.step3.ftp.MemberError")):c&&!b?e.push(w.displayServiceError("vm.reservationModel.ftpDetails.partnerCode","ftpInvalid")):b&&!c&&e.push(w.displayServiceError("vm.reservationModel.ftpDetails.ftpNumber","ftpInvalid"));1===e.length&&(h={message:e[0]});0!=e.length&&f.push(h);a.errorList=f};a._reviewFtp=function(){g.requestInProgress=!0;
q.load().then(function(d){if(angular.isDefined(d)){var b=n.getExpressReservationFlag();if(!angular.isDefined(d.webHeader)||"5"!=d.webHeader.viewIndicator&&"6"!=d.webHeader.viewIndicator||!b||d.reservationSummary.prepayTxn)if(angular.isDefined(d.fieldErrors)&&0<d.fieldErrors.length||angular.isDefined(d.errorList)&&0<d.errorList.length||angular.isDefined(d.warningList)&&0<d.warningList.length){g.requestInProgress=!1;d=y.processErrorMessage(d);if(angular.isDefined(d.fieldErrors)&&0<d.fieldErrors.length||
angular.isDefined(d.errorList)&&0<d.errorList.length)a.errorList=d.errorList,A.scroll(0,0),a.errorList=x.handleRateCodeMainFrameError(a.errorList);angular.isDefined(d.warningList)&&0<d.warningList.length&&(a.warningList=d.warningList)}else g.requestInProgress=!1,d.reservationSummary.ftpDetails&&d.reservationSummary.ftpDetails.partnerCode&&""!=d.reservationSummary.ftpDetails.partnerCode&&a.ftp&&a.ftp.partnersList&&(d=C(d.reservationSummary.ftpDetails.partnerCode),a.reservationModel.ftpDetails.partnerName=
0<d.length?d[0].partnerName:""),a.isPayLaterOnlyReservation?t.go(z.step4PayLaterPageName):t.go(z.step4PageName);else D.processResults(d,{})}},function(a){g.requestInProgress=!1})};a._calculateFreedayPoints=function(){var d=F.calculateFreedayPoints(a.pointProducts,a.freeDayPoints);a.noOfFreeDays=d.noOfFreeDays;a.prefferedPointsFlag=d.prefferedPointsFlag;a.redeemableDays=d.redeemableDays};a._frwdSelected=function(d){g.requestInProgress=!0;angular.isDefined(a.pointProducts)&&null!=a.pointProducts.freeDay&&
(d=a.pointProducts.freeDay);var b=F.frdSelected(a.pointProducts,a.freeDayPoints,a.pointCheckbox,"EXTRAS",d);d=b.productObj;ha=d.redeemedQty;fa=d.quantity;a.pointCheckbox=b.pointCheckbox;a.productSelected(d,"FRD");a.frdSelectedFlag=b.frdSelectedFlag;void 0!=E.getLoyaltyDetails()&&(a.freedayPresent=!1,a.loyaltyDetails=E.getLoyaltyDetails(),a.totalPointsFrd=parseInt(a.loyaltyDetails.points),a.frdNoChnage=!1)};a.amazonBenefitsKey=Dictionary.I18n.get("lbl.global.amazonBenefits");a._tierBundlesDisplay=
function(){var d=[],b=n.getReservationModel();if(angular.isDefined(a.prod.reservationSummary.ancillaryBundleSummary)){a.selectedBundleName=Z(a.prod.reservationSummary.ancillaryBundleSummary);b.selectedBundleName=a.selectedBundleName;a:{var c=a.prod.reservationSummary.ancillaryBundleSummary;var e;for(e=0;e<c.length;e++)if(c[e].discountEligiblity){c=!0;break a}c=!1}a.showExtrasSavingsHeading=c;for(c=0;c<a.prod.reservationSummary.ancillaryBundleSummary.length;c++)if(d[c]=a.prod.reservationSummary.ancillaryBundleSummary[c].bundleName,
"au"==a.domain||"nz"==a.domain){e=c;var h=b;a.prod.reservationSummary.ancillaryBundleSummary[e].enableTag=h.ancillaryBundlesData[0].resolvedOffers[e].enableTag;a.prod.reservationSummary.ancillaryBundleSummary[e].tagTitle=h.ancillaryBundlesData[0].resolvedOffers[e].tagTitle;a.prod.reservationSummary.ancillaryBundleSummary[e].tagIcon=h.ancillaryBundlesData[0].resolvedOffers[e].tagIcon;a.prod.reservationSummary.ancillaryBundleSummary[e].tagColor=h.ancillaryBundlesData[0].resolvedOffers[e].tagColor;a.prod.reservationSummary.ancillaryBundleSummary[e].isAnimation=
h.ancillaryBundlesData[0].resolvedOffers[e].isAnimation}b.bundleNameList=d;n.setReservationModel(b)}};p=p("ExtrasExnController",{$scope:y});angular.extend(this,p);var R=!1,ha=0,fa=0,L=0;a.hideLoader=!1;g.$on("Profile.successAuthentication",function(d,b){a._authenticationHandler(b)});g.$on("InsuranceListUpdated",function(d,b){a.insurances=b});g.$on("ProductListUpdated",function(d,b){a.products=b});a.initExtrasPage();a.helpURL="";a.helpPath="";jQuery(document).ready(function(){a.corporateBcd="C"==a.reservationModel.coupon.discountNumberType||
"K"==a.reservationModel.coupon.discountNumberType||"G"==a.reservationModel.coupon.discountNumberType||"S"==a.reservationModel.coupon.discountNumberType||"T"==a.reservationModel.coupon.discountNumberType||"H"==a.reservationModel.coupon.discountNumberType||"J"==a.reservationModel.coupon.discountNumberType||"R"==a.reservationModel.coupon.discountNumberType||"U"==a.reservationModel.coupon.discountNumberType||"V"==a.reservationModel.coupon.discountNumberType||"I"==a.reservationModel.coupon.discountNumberType||
"Z"==a.reservationModel.coupon.discountNumberType;a.displayUpLiftRelatedInfo=!a.corporateBcd&&"US"==a.reservationModel.personalInfoRQ.residency&&"US"==a.reservationModel.pickCountry&&"true"==a.showUpliftOptionStep3&&"true"==a.enableUplift&&angular.equals(g.reservation,z.resFlowCreate)?!0:!1;a.displayUpLiftRelatedInfo&&a.pageName==z.step3PageName&&setTimeout(function(){var d=setInterval(function(){window.Uplift.Payments&&(window.Uplift.Payments.init({apiKey:A.upliftApiKey,locale:"en-US",currency:"USD",
checkout:!1,channel:"desktop",onChange:b}),clearInterval(d))},100),e=setInterval(function(){$(".extra-packages-section").is(":visible")&&a.prod.reservationSummary.vehicle.classDescription&&(a.orderInfo=O(),window.Uplift.Payments.load(a.orderInfo),clearInterval(e))},100)},200);a.pageName==z.step3PageName&&n.addGTMScript();g.requestInProgress=!1;$("body").on("shown.bs.modal",".modal.policies_Modal",function(d){a.getPrepayTnCs()})})}angular.module("reservation").controller("ExtrasController",t);t.$inject=
"getVehicles reviewService $sce ftpService $controller $scope $rootScope $state $window $filter optionalService authenticationService $validation carRentalConstant $timeout reservationModelService gaService merchandisingService storageService utilityService getDataService bridgeService ModalService locationTermsConditionsService reviewModifyService ancillaryService".split(" ")})();
(function(){function t(x,q,l,v,p,y,g,t,A,B,F,E,w,z,G,n,H){function C(){h.prod=t.getAvailableExtras();var b=t.getReviewData();!angular.isDefined(b)||angular.equals({},b)||h.pageName!=w.step4PageName&&h.pageName!=w.step4PayLaterPageName&&v.$progressbar.$previousState.name!=w.step4PageName&&v.$progressbar.$previousState.name!=w.step4PayLaterPageName||(h.prod=b);angular.isDefined(h.prod)&&angular.isDefined(h.prod.reservationSummary)&&angular.isDefined(h.prod.reservationSummary.rateSummary)&&(angular.isDefined(h.prod.reservationSummary.rateSummary.baseRate)&&
angular.isDefined(h.prod.reservationSummary.rateSummary.resSavings)&&angular.isDefined(h.prod.reservationSummary.rateSummary.resSavings.totalSavings)&&(h.strikePrice=parseFloat(h.prod.reservationSummary.rateSummary.baseRate)+parseFloat(h.prod.reservationSummary.rateSummary.resSavings.totalSavings)),angular.isDefined(h.prod.reservationSummary.rateSummary.periodFreeMiles.values)&&0<h.prod.reservationSummary.rateSummary.periodFreeMiles.values.length&&(h.periodFreeMilesContent+=E("number")(h.prod.reservationSummary.rateSummary.periodFreeMiles.values[0]),
h.periodFreeMilesContent+=angular.isDefined(h.prod.reservationSummary.rateSummary.distanceMeasuredIn)&&"KMS"==h.prod.reservationSummary.rateSummary.distanceMeasuredIn?Dictionary.I18n.get("lbl.res.mileage.kilometersIncluded"):Dictionary.I18n.get("lbl.res.mileage.milesIncluded"),h.periodFreeMilesContent+=" | "+E("currencySymbol")(h.prod.reservationSummary.rateSummary.currencySymbol),h.periodFreeMilesContent+=E("number")(h.prod.reservationSummary.rateSummary.periodFreeMiles.values[1],2),h.periodFreeMilesContent+=
Dictionary.I18n.get("lbl.res.additional"),h.periodFreeMilesContent+=angular.isDefined(h.prod.reservationSummary.rateSummary.distanceMeasuredIn)&&"KMS"==h.prod.reservationSummary.rateSummary.distanceMeasuredIn?Dictionary.I18n.get("lbl.res.mileage.km"):Dictionary.I18n.get("lbl.res.mileage.mile"),"au"==h.domain.toLowerCase()||"nz"==h.domain.toLowerCase()))&&(h.periodFreeMilesContent+=Dictionary.I18n.get("lbl.res.feesntaxes"));b=Math.floor(parseFloat(h.prod.reservationSummary.rateSummary.baseRate.replace(/,/g,
"")));h.multipliedValue=4*b;h.reservationModel=z.getReservationModel();angular.isDefined(h.reservationModel)&&angular.isDefined(h.reservationModel.selectedCar)&&0<h.reservationModel.selectedCar.length&&(b=h.reservationModel.selectedCar[0],b.upgradeApplicable&&angular.isDefined(b.upgradeCar)&&(h.selectedVehicle=b));h.reservationModel.displayControls.reservation==w.resFlowCreate&&(y.brand==w.brandName.AVIS||y.brand==w.brandName.BUDGET)&&angular.isDefined(h.prod)&&angular.isDefined(h.prod.reservationSummary)&&
angular.isDefined(h.prod.reservationSummary.strikethroughVehicle)&&h.prod.reservationSummary.strikethroughVehicle&&angular.isDefined(h.prod.reservationSummary.vehicle)&&h.prod.reservationSummary.vehicle.displayRate.displayPayLater&&h.prod.reservationSummary.vehicle.displayRate.displayPayNow&&angular.isDefined(h.prod.reservationSummary.rateSummary.resSavings)&&angular.isDefined(h.prod.reservationSummary.rateSummary.resSavings.payNowSavings)&&"0.00"!=h.prod.reservationSummary.rateSummary.resSavings.payNowSavings&&
(h.showSavingsBanner=!0,h.showToggleButton=!0);h.reservationModel.prepayOpted&&"NOT_SELECTED"==h.reservationModel.payNowToggleOptionSelected&&(h.showToggleButton=!1);h.personalizedPartnerName=H.getStorageData("partnerName");angular.isDefined(h.personalizedPartnerName)&&""!=h.personalizedPartnerName&&(b="",angular.isDefined(h.prod)&&angular.isDefined(h.prod.reservationSummary)&&angular.isDefined(h.prod.reservationSummary.pickLoc)&&angular.isDefined(h.prod.reservationSummary.pickLoc.corpLicInd)&&""!=
h.prod.reservationSummary.pickLoc.corpLicInd?b=h.prod.reservationSummary.pickLoc.corpLicInd:angular.isDefined(H.getStorageData("locationType"))&&""!=H.getStorageData("locationType")&&(b=H.getStorageData("locationType")),""==b||"C"!=b||h.reservationModel.displayControls.reservation!=w.resFlowCreate||h.pageName!=w.step4PageName&&h.pageName!=w.step4PayLaterPageName||(h.showBenefitTracker=!0),"USAA"==h.personalizedPartnerName?angular.isDefined(h.reservationModel)&&(angular.isUndefined(h.reservationModel.coupon.partnerMembershipId)||
""==h.reservationModel.coupon.partnerMembershipId)?h.showUnderAgeFeeBenefit=!1:h.showUnderAgeFeeBenefit=!0:"AARP"==h.personalizedPartnerName&&u(h.prod))}function u(b){h.aarpBenefitsList=[];var e=H.getStorageData("AARPBenefits"),f={},g=!0,l=!1,m=[],r=[];f.name=Dictionary.I18n.get("lbl.benefitTracker.aarpBenefits1,"+brand);f.code="Base Rate";f.availed=!0;h.aarpBenefitsList.push(f);if(angular.isDefined(e)&&0<e.length)for(f=0;f<e.length;f++){var D={};D.name=Dictionary.I18n.get("lbl.benefitTracker.aarpBenefits"+
(f+2)+","+brand);D.availed=!0;D.code=e[f].code;h.aarpBenefitsList.push(D);if(1==e[f].discounted)var n=e[f].code}angular.isDefined(b)&&angular.isDefined(b.reservationSummary)&&angular.isDefined(b.reservationSummary.vehicle)&&angular.isUndefined(b.reservationSummary.vehicle.upgradeCarName)&&(g=!1);angular.forEach(b.reservationSummary.productSummaryList,function(a,d){""!=n&&a.code==n&&(a.selected||a.productDisplay&&a.productDisplay.selected&&"TRUE"==a.productDisplay.selected)&&(l=!0)});angular.forEach(h.aarpBenefitsList,
function(a,d){a.code!=n||l?"Upgrade"!=a.code||g||(a.availed=!1):a.availed=!1});angular.forEach(h.aarpBenefitsList,function(a,d){a.availed?m.push(a):r.push(a)});h.aarpBenefitsList=m.concat(r)}function m(){h.showSavingsBanner=!1;var b=h.prod.reservationSummary.vehicle,e=!1;angular.isDefined(h.reservationModel.payNowToggle)&&h.reservationModel.payNowToggle?(e=!0,h.reservationModel.prepayOpted=!0,h.reservationModel.payNowToggleOptionSelected="SELECTED"):h.reservationModel.payNowToggle||(h.reservationModel.prepayOpted=
!1,h.reservationModel.payNowToggleOptionSelected="DESELECTED");h.reservationModel.rateCode=h.reservationModel.prepayOpted?b.prepayRateCode:b.rateCode;v.requestInProgress=!0;h.reservationModel.selectedCar=[];h.reservationModel.carClass=b.carClass;h.reservationModel.couponAppliedCar=b.couponApplicable;h.reservationModel.prepayProcessIndicator=e;h.reservationModel.selectedCar.push(b);z.setReservationModel(h.reservationModel);"true"!=y.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==
isHumanSecEnabled&&angular.isDefined(window._pxAppId)||y.brand!=w.brandName.AVIS&&y.brand!=w.brandName.BUDGET?h.pageName==w.step3PageName?(z.updateClientContext("carClass",b.carClass),angular.element(document).injector().get("merchandisingService").ancillaryBundlePromisesExecution().then(function(b){f()},function(b){f()})):h.pageName==w.step4PageName&&D():grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(e){h.recaptcha=e;
h.pageName==w.step3PageName?(z.updateClientContext("carClass",b.carClass),angular.element(document).injector().get("merchandisingService").ancillaryBundlePromisesExecution().then(function(b){f(h.recaptcha)},function(b){f(h.recaptcha)})):h.pageName==w.step4PageName&&D()})})}function f(b){angular.element(document).injector().get("optionalService").load(!1,b).then(function(b){if(angular.isDefined(b.errorList)&&0<b.errorList.length){h.errorDisplayList=q.processErrorMessage(b).errorList;var e="05126 05127 05128 14437 14438 14439 14440 14441 14442 14443 14444 14075 30014 10019 10020 19074 14528".split(" ");
angular.forEach(b.errorList,function(b,f){angular.element(document).injector().get("utilityService").containsObject(b.code,e)&&(h.reservationModel.forceRateCodeDisplay=!1)});h.errorDisplayList=angular.element(document).injector().get("getVehicles").handleRateCodeMainFrameError(h.errorDisplayList);v.requestInProgress=!1}else t.addToAvailableProducts(b),p.go(w.step3PageName,{},{reload:!0})},function(b){v.requestInProgress=!1})}function D(){angular.element(document).injector().get("optionalService").loadAvailableExtras(!0).then(function(b){if(angular.isDefined(b)&&
angular.isDefined(b.fieldErrors)&&0<b.fieldErrors.length||angular.isDefined(b.errorList)&&0<b.errorList.length||angular.isDefined(b.warningList)&&0<b.warningList.length){if(v.requestInProgress=!1,b=q.processErrorMessage(b),angular.isDefined(b.fieldErrors)&&0<b.fieldErrors.length||angular.isDefined(b.errorList)&&0<b.errorList.length)h.errorList=b.errorList,y.scroll(0,0),h.errorDisplayList=angular.element(document).injector().get("getVehicles").handleRateCodeMainFrameError(h.errorDisplayList)}else{if(angular.isDefined(b)&&
angular.isDefined(b.reservationSummary)&&angular.isDefined(b.reservationSummary.rateSummary)&&angular.isDefined(b.reservationSummary.rateSummary.estimatedTotal)){var e=z.getReservationModel();e.estimatedTotal=b.reservationSummary.rateSummary.estimatedTotal;z.setReservationModel(e)}v.requestInProgress=!1;p.go(w.step4PageName,{},{reload:!0})}},function(b){v.requestInProgress=!1})}x("ExceptionHandlerController",{$scope:q});var e=x("CouponController",{$scope:q});angular.extend(this,e);var h=this,r=!1;
h.brand=y.brand;h.domain=y.domain;h.couponAwdSameflag=!1;h.multiCurrencyFlag=!1;h.ages=w.ageList;h.couponCodeDisabled=!1;h.epIndicator=!1;h.enableBenefit=partnerConfig.amazon.enablePartnerBenefit;h.enablePrimeBenefit=partnerConfig.amazon.enablePrimeBenefit;h.reservationModel={personalInfoRQ:{residency:""}};h.couponList={};h.isBookAgainFlow=!1;h.requiresMemberID=!1;h.partnerPlaceholder="";h.partnerLabel="";h.displayInfoMessage=!1;h.awdDisabled=!1;h.showToggleButton=!1;h.showSavingsBanner=!1;h.showUnderAgeFeeBenefit=
!1;h.showUpliftOption=y.showUpliftOption;h.enableUplift=y.enableUplift;h.cbpCustomer=A.getCBPCustomerDetails();h.showBenefitTracker=!1;h.collapsedRentalSummary=!1;h.periodFreeMilesContent="";h.multipliedValue="";h.usaaLogoImg=y.usaaLogoImage;h.aarpLogoImg=y.aarpLogoImage;h.setDiscountNumberList=function(){h.awdDisabled=!1;var b=angular.isDefined(h.customer)&&angular.isDefined(h.customer.discountSummaryList)?h.customer.discountSummaryList:"";angular.isDefined(h.reservationModel.corporateBookingType)&&
(b=angular.element(document).injector().get("utilityService").getConcurDiscountSummary(b,h.reservationModel.corporateBookingType),angular.isDefined(b.concurList)&&(h.reservationModel.discountSummaryList=b.concurList),angular.isDefined(b.discountNumber)&&(h.reservationModel.coupon.discountNumber=angular.isDefined(h.response.reservationSummary.awdNumber)?h.response.reservationSummary.awdNumber:b.discountNumber),h.awdDisabled=ABG.disableDiscountField(h.reservationModel.discountSummaryList,h.reservationModel.corporateBookingType));
angular.isDefined(h.reservationModel)&&angular.isDefined(h.reservationModel.amazonReservation)&&!h.reservationModel.amazonReservation&&(h.reservationModel.discountSummaryList=ABG.removeAmazonBenefits(h.reservationModel.discountSummaryList));angular.isDefined(h.reservationModel)&&angular.isDefined(h.reservationModel.coupon)&&angular.isDefined(h.reservationModel.coupon.discountNumber)&&""!=h.reservationModel.coupon.discountNumber&&-1!=h.reservationModel.coupon.discountNumber.toUpperCase().indexOf("RATE")&&
(h.reservationModel.coupon.isMaskedDiscountCode=!0)};h.updateAwd=function(){J=!0;M&&(h.modifyDiscountCodes(),M=!1)};h.modifyPersonalInfo=function(){v.requestInProgress=!0;h.reservationModel.selectedCar=[];z.setReservationModel(h.reservationModel);h.controlGuidedResFlow(!1);"true"!=y.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||y.brand!=w.brandName.AVIS&&y.brand!=w.brandName.BUDGET?B.load().then(function(b){angular.isDefined(b.fieldErrors)&&
0<b.fieldErrors.length||angular.isDefined(b.errorList)&&0<b.errorList.length||angular.isDefined(b.warningList)&&0<b.warningList.length?p.go(w.step1aPageName):(ABG.stepTwoLoader(),p.go(w.step2PageName))},function(b){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(b){h.recaptcha=b;B.load(!1,h.recaptcha).then(function(b){angular.isDefined(b.fieldErrors)&&0<b.fieldErrors.length||angular.isDefined(b.errorList)&&0<b.errorList.length||
angular.isDefined(b.warningList)&&0<b.warningList.length?p.go(w.step1aPageName):(ABG.stepTwoLoader(),p.go(w.step2PageName))},function(b){})})})};h.modifyDiscountCodes=function(){v.requestInProgress=!0;h.resFormPageError="";0<h.couponSwap(h.reservationModel).length?(G(angular.element(".platform-error-message"))(q),G(angular.element("#discounterrors"))(q),h.validated=!0,v.requestInProgress=!1):(h.reservationModel.selectedRateType=h.reservationModel.coupon.discountNumber,z.setReservationModel(h.reservationModel),
h.controlGuidedResFlow(!1),1!=h.reservationModel.coupon.partnerEmailRequired||""!=h.corporateEmailID&&void 0!=h.corporateEmailID?(angular.element(document).injector().get("storageService").setStorageData("corporateEmailID",h.corporateEmailID),"true"!=y.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||y.brand!=w.brandName.AVIS&&y.brand!=w.brandName.BUDGET?B.load().then(function(b){if(angular.isDefined(b.fieldErrors)&&0<b.fieldErrors.length){b=
q.processErrorMessage(b);var e=[],f;angular.forEach(b.fieldErrors,function(b){if("vm.reservationModel.coupon.discountNumber"==b.field||"vm.reservationModel.coupon.couponNumber"==b.field||"vm.reservationModel.coupon.couponRateCode"==b.field)f={message:g.displayServiceError(b.field.replace("vm.","vmx."),b.classifier)},h.reservationModel.displayControls.additionalInfo="displayDiscount"});1<b.fieldErrors.length&&(f={message:Dictionary.I18n.get("err.res.mutliplemsg")});e.push(f);h.errorDisplayList=e}else angular.isDefined(b.errorList)&&
0<b.errorList.length?p.go(w.step1aPageName):($("#modify-discounts").modal("hide"),$(".modal-backdrop").remove(),ABG.stepTwoLoader(),p.go(w.step2PageName,{},{reload:!0}))},function(b){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(b){h.recaptcha=b;B.load(!1,h.recaptcha).then(function(b){if(angular.isDefined(b.fieldErrors)&&0<b.fieldErrors.length){b=q.processErrorMessage(b);var e=[],f;angular.forEach(b.fieldErrors,function(b){if("vm.reservationModel.coupon.discountNumber"==
b.field||"vm.reservationModel.coupon.couponNumber"==b.field||"vm.reservationModel.coupon.couponRateCode"==b.field)f={message:g.displayServiceError(b.field.replace("vm.","vmx."),b.classifier)},h.reservationModel.displayControls.additionalInfo="displayDiscount"});1<b.fieldErrors.length&&(f={message:Dictionary.I18n.get("err.res.mutliplemsg")});e.push(f);h.errorDisplayList=e}else angular.isDefined(b.errorList)&&0<b.errorList.length?p.go(w.step1aPageName):($("#modify-discounts").modal("hide"),$(".modal-backdrop").remove(),
ABG.stepTwoLoader(),p.go(w.step2PageName,{},{reload:!0}))},function(b){})})})):(angular.element("#emailReq").addClass("platform-error-message"),v.requestInProgress=!1))};h.couponSwap=function(b){var e=[],f,g=b.coupon.discountNumber,l=b.coupon.couponNumber?b.coupon.couponNumber:"";(f=z.validateDiscountNumber(g,l,b,"Other"))&&e.push(f);r=h._discountValidation();(f=z.validateCouponCode(l,g,b,"Other",r))&&e.push(f);(f=z.validateMembeshipID(g,b,"Other",h.requiresMemberID))&&e.push(f);1==e.length&&(b=e[0].message,
angular.element("#pageError").html(""),G(angular.element("#pageError").append(b))(q));2==e.length&&(h.resFormPageError=Dictionary.I18n.get("err.res.mutliplemsg"));return e};h.getDefaultAwd=function(b){var e=z.getReservationModel();e.rentalType="";h.reservationModel=e;z.setReservationModel(h.reservationModel);angular.isDefined(b)&&0<b.length?(h.DiscAWD=b,document.getElementById("awd").disabled=!0):angular.isDefined(document.getElementById("awd"))&&null!=document.getElementById("awd").placeholder&&
(document.getElementById("awd").placeholder="AWD#")};h.getDefaultCouponCode=function(b){angular.isDefined(b)&&0<b.length?(h.DiscCoupon=b,document.getElementById("coupon").disabled=!0):angular.isDefined(document.getElementById("coupon"))&&null!=document.getElementById("coupon").placeholder&&(document.getElementById("coupon").placeholder="Coupon Code")};h.removeError=function(){h.validated=!1;h.hideCoupons=!1};h.getMultiCoupon=function(){h.getMultiCouponUtility(h,!0)};h.reloadModelValue=function(b){h.reservationModel.editRentalSummary=
!1;z.setReservationModel(h.reservationModel);h.reservationModel=z.getReservationModel();angular.isDefined(h.reservationModel.dropInfo)&&h.reservationModel.dropInfo!=h.reservationModel.pickInfo?(h.reservationModel.diffLoc=!0,z.setReservationModel(h.reservationModel)):h.reservationModel.diffLoc=!1;v.resModel=angular.copy(h.reservationModel);q.$broadcast("angucomplete-alt:changeInput","PicLoc",h.reservationModel.pickUpLocation);$(window).width()>w.deviceTypeMobileWidth?($(".start-date-input").val(h.reservationModel.pickUpDateDisplay),
$(".end-date-input").val(h.reservationModel.dropDateDisplay),$("#PicLoc_value").val(h.reservationModel.pickUpLocation.suggDescription),h.reservationModel.pickUpLocation.suggCode!=h.reservationModel.dropLocation.suggCode?(h.reservationModel.dropLocation.suggDescription?$("#DropLoc_value").val(h.reservationModel.dropLocation.suggDescription):$("#DropLoc_value").val(h.reservationModel.dropLocation.suggCode),q.$broadcast("angucomplete-alt:changeInput","DropLoc",h.reservationModel.dropLocation)):l(function(){h.reservationModel.dropLocation=
"";$("#DropLoc_value").val("");q.$broadcast("angucomplete-alt:changeInput","DropLoc",h.reservationModel.dropLocation)},1E3),l(function(){$("#PicLoc_value").focus();$("#PicLoc_value").blur();$("#DropLoc_value").focus();$("#DropLoc_value").blur()},150)):($(".start-date-input").datepicker("setDate",h.reservationModel.pickUpDateDisplay),$(".end-date-input").datepicker("setDate",h.reservationModel.dropDateDisplay),h.reservationModel.pickUpLocation.suggCode!=h.reservationModel.dropLocation.suggCode?($($("input[id\x3dDropLoc_value]")[1]).val(h.reservationModel.dropLocation.suggDescription),
q.$broadcast("angucomplete-alt:changeInput","DropLoc",h.reservationModel.dropLocation)):l(function(){h.reservationModel.dropLocation="";$($("input[id\x3dDropLoc_value]")[1]).val("");q.$broadcast("angucomplete-alt:changeInput","DropLoc",h.reservationModel.dropLocation)},1E3),l(function(){$($("input[id\x3dPicLoc_value]")[1]).focus();$($("input[id\x3dPicLoc_value]")[1]).blur();$($("input[id\x3dDropLoc_value]")[1]).focus();$($("input[id\x3dDropLoc_value]")[1]).blur()},150))};h.setUserSelectedCurrencyNull=
function(){var b=z.getReservationModel();b.userSelectedCurrency="";h.reservationModel=b;z.setReservationModel(h.reservationModel)};h.scrollSetTop=function(){document.body.scrollTop=0};h.resFormpopupCancelClick=function(){h.displayInfoMessage=!1};h.analytics=function(b){var e={event:"analyticsVPV"};e.vpvName="/vpv/linkClickPage-"+b+"LocationsModify";dataLayer.push(e)};h.cancelModifyAge=function(){var b=Number(t.getAvailableExtras().reservationSummary.personalInfo.age.value);h.reservationModel.personalInfoRQ.age=
b;h.reservationModel.personalInfoRQ.residency=t.getAvailableExtras().reservationSummary.personalInfo.residency.value;z.setReservationModel(h.reservationModel)};h.removeCoupon=function(){v.requestInProgress=!0;angular.isDefined(h.response.reservationSummary.coupon)&&(h.reservationModel.coupon.couponNumber="","true"!=y.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||y.brand!=w.brandName.AVIS&&y.brand!=w.brandName.BUDGET?B.load().then(function(b){h.response=
b;b=h._processErrorByType(h.response);angular.isDefined(b.errorList)&&0<b.errorList.length||angular.isDefined(b.warningList)&&0<b.warningList.length?p.go(w.step1aPageName):p.go(w.step2PageName,{},{reload:!0})},function(b){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(b){h.recaptcha=b;B.load(!1,h.recaptcha).then(function(b){h.response=b;b=h._processErrorByType(h.response);angular.isDefined(b.errorList)&&0<b.errorList.length||
angular.isDefined(b.warningList)&&0<b.warningList.length?p.go(w.step1aPageName):p.go(w.step2PageName,{},{reload:!0})},function(b){})})}))};h.modifyModal=function(b){var e="",h="";switch(b){case "ftpDetails":e="reservation.frequent-travel-program-modal";h="ExtrasController";break;case "protectionModify":e="reservation.protection-modal";h="ExtrasController";break;case "equipmentModify":e="reservation.equipment-modal";h="ExtrasController";break;default:h=e=""}""!=e&&""!=h&&n.showModal({type:b,templateUrl:v.contextPath+
"/"+v.locale+"/"+e+htmlExtension,controller:h,controllerAs:"vm"}).then(function(b){l(function(){b.element.modal("show")},1);B.infoToolTip()})};h.modifyCarModal=function(){v.requestInProgress=!0;var b=t.getAvailableVehicles();h.reservationModel.bookAgain.bookAgainFlow&&angular.equals({},b)?B.getData("",!0).then(function(b){v.requestInProgress=!1;n.showModal({type:"CarDetailsModify",templateUrl:v.contextPath+"/"+v.locale+"/reservation.modify-car-model"+htmlExtension,controller:"VehicleListController",
controllerAs:"vm"}).then(function(b){b.element.modal()})},function(b){}):h.reservationModel.isGuidedRes?p.go(w.step2PageName):angular.equals({},b)?"true"!=y.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||y.brand!=w.brandName.AVIS&&y.brand!=w.brandName.BUDGET?B.load().then(function(b){v.requestInProgress=!1;n.showModal({type:"CarDetailsModify",templateUrl:v.contextPath+"/"+v.locale+"/reservation.modify-car-model"+htmlExtension,
controller:"VehicleListController",controllerAs:"vm"}).then(function(b){b.element.modal()})},function(b){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(b){h.recaptcha=b;B.load(!1,h.recaptcha).then(function(b){v.requestInProgress=!1;n.showModal({type:"CarDetailsModify",templateUrl:v.contextPath+"/"+v.locale+"/reservation.modify-car-model"+htmlExtension,controller:"VehicleListController",controllerAs:"vm"}).then(function(b){b.element.modal()})},
function(b){})})}):B.getData().then(function(b){v.requestInProgress=!1;n.showModal({type:"CarDetailsModify",templateUrl:v.contextPath+"/"+v.locale+"/reservation.modify-car-model"+htmlExtension,controller:"VehicleListController",controllerAs:"vm"}).then(function(b){b.element.modal()})},function(b){})};h.controlGuidedResFlow=function(b){var e=z.getReservationModel();e.isGuidedRes&&!b?(e.isGuidedRes=!1,v.isGuidedRes=!1):b&&(e.isGuidedRes=!0,v.isGuidedRes=!0);z.setReservationModel(e)};h.rentalSummaryApplyCoupon=
function(){h.reservationModel&&h.reservationModel.coupon&&""==h.reservationModel.coupon.couponNumber&&(h.couponList=t.getCouponList(),F.couponApply(h.couponList,h.reservationModel).then(function(b){h.couponList=b.couponList;h.reservationModel=b.reservationModel}))};h.partnerDiscount=function(){h.partnerPlaceholder="";h.partnerLabel="";h.reservationModel.coupon.discountNumber=ABG.awdNumberValidator(h.reservationModel.coupon.discountNumber);var b=h.reservationModel.coupon.discountNumber;angular.isDefined(b)&&
7<=b.length&&-1===b.indexOf("AMAZON")&&!$("#awdStep3").hasClass("ng-invalid")&&angular.isUndefined(h.reservationModel.coupon.isMaskedDiscountCode)&&(v.requestInProgress=!0,B.partnerDiscountValidation(b).then(function(b){b.fieldErrors?v.requestInProgress=!1:(h.requiresMemberID=b.awdSummary.requiresMemberID,h.partnerName=b.awdSummary.partnerName,h.reservationModel.coupon.requiresMemberID=h.requiresMemberID,h.reservationModel.partnerName=h.partnerName,z.setReservationModel(h.reservationModel),v.requestInProgress=
!1,angular.isDefined(h.partnerName)&&h.requiresMemberID?(h.partnerPlaceholder=h.partnerName+Dictionary.I18n.get("lbl.global.partnerMember,"+brand),h.partnerLabel=Dictionary.I18n.get("lbl.global.partnerlabel,"+brand)+h.partnerName+Dictionary.I18n.get("lbl.global.partnerlabel1,"+brand),h.reservationModel.partnerLabel=h.partnerLabel):h.requiresMemberID=!1,J?setTimeout(function(){h.modifyDiscountCodes();J=!1}):M=!0,v.isAuthenticated||v.isRecognized||y.brand!=w.brandName.AVIS&&y.brand!=w.brandName.BUDGET||
(h.reservationModel.coupon.partnerEmailRequired=b.awdSummary.partnerEmailRequired,angular.isDefined(h.reservationModel.coupon.partnerEmailRequired)&&z.setReservationModel(h.reservationModel)))}))};h.partnerValidation=function(){var b=h.reservationModel.coupon.discountNumber,e=h.reservationModel.discountSummaryList,f=!1;h.reservationModel.coupon.partnerEmailRequired=!1;angular.isDefined(h.reservationModel.coupon.isMaskedDiscountCode)&&h.reservationModel.coupon.isMaskedDiscountCode&&(h.reservationModel.coupon.isMaskedDiscountCode=
!1);angular.isDefined(e)&&angular.isDefined(b)&&angular.forEach(e,function(e,h){b==e.discountNumber&&(f=!0)});if(f||angular.isDefined(b)&&7>b.length)h.requiresMemberID=!1,h.reservationModel.coupon.partnerMembershipId="",h.response.reservationSummary.membershipId=null;0==b.length&&(h.reservationModel.coupon.isMaskedDiscountCode=void 0)};h.checkPartnerValidation=function(){h.reservationModel.NoPartnerMembershipID&&(h.reservationModel.coupon.partnerMembershipId="",z.setReservationModel(h.reservationModel));
g.resetError("vmx.reservationModel.coupon.partnerMembershipId",!0)};h.checkPartnerMemberValidation=function(){""!=h.reservationModel.coupon.partnerMembershipId&&h.reservationModel.NoPartnerMembershipID&&(h.reservationModel.NoPartnerMembershipID=!1,z.setReservationModel(h.reservationModel))};h.updateDiscountNumber=function(b){h.reservationModel.coupon.discountNumber=b.discountNumber;h.showLearnWhyError=!1;h.customer.awdSummary.partnerName=null;h.partnerName=null;h.partnerDiscount()};h.setVehicleFeatues=
function(){B.getStaticFleets().then(function(b){return b}).catch(function(b){console.error(b);return[]}).then(function(e){for(var f,g,l,m,r=h.reservationModel.selectedCar[0],D=angular.isDefined(r)&&angular.isDefined(r.vehicleFeatures)?r.vehicleFeatures:[],n=0;n<D.length;n++){r[D[n].name.toLowerCase()]=!0;var p=D[n].name.replaceAll(" ","");g=f=!1;for(var a=m=l=0;a<e.length;a++)if(p.toLowerCase()==e[a].name.toLowerCase()){f=e[a].hasOwnProperty("webEnabled")?e[a].webEnabled:D[n].hasOwnProperty("webEnabled")?
D[n].webEnabled:!1;l=1;g=e[a].hasOwnProperty("iconEnabled")?e[a].iconEnabled:D[n].hasOwnProperty("iconEnabled")?D[n].iconEnabled:!1;m=1;break}1==l&&(D[n].webEnabled=f);1==m&&(D[n].iconEnabled=g);!0===D[n].webEnabled&&(!0===D[n].iconEnabled&&(D[n].cssClass=b(D[n].name.toLowerCase()),f=D[n].name.toLowerCase().split("_"),"suitcases"===f[0]&&f[1]&&""!==f[1]&&(D[n].cssClass=b(f[1]))),"seats"===D[n].name.toLowerCase()&&(r.seatCount=parseInt(D[n].value,10)));n!==D.length-1||r.hasOwnProperty("seatCount")||
(r.seatCount=0);if("Auto"==D[n].name||"Man"==D[n].name)D[n].value=D[n].name}h.features=D;if(h.pageName==w.step3PageName)setTimeout(function(){C();angular.element(".navbar-fixed-top.bg-header").click()},1E3);else{setTimeout(function(){angular.element(".navbar-fixed-top.bg-header").click()},1E3);var d=setInterval(function(){var a=t.getReviewData();angular.isDefined(a)&&!angular.equals({},a)&&(C(),clearInterval(d))},100)}}).catch(function(b){console.error(b)})};h.switchToggle=m;h.payNowClick=function(){h.reservationModel.payNowToggle=
!0;m()};h._summaryPageInit=function(){h.isBookAgainFlow=z.isBookAgainFlow(h.pageName);h.customer=A.getCustomerModel();h.reservationModel=z.getReservationModel();h.corporateBcd="C"==h.reservationModel.coupon.discountNumberType||"K"==h.reservationModel.coupon.discountNumberType||"G"==h.reservationModel.coupon.discountNumberType||"S"==h.reservationModel.coupon.discountNumberType||"T"==h.reservationModel.coupon.discountNumberType||"H"==h.reservationModel.coupon.discountNumberType||"J"==h.reservationModel.coupon.discountNumberType||
"R"==h.reservationModel.coupon.discountNumberType||"U"==h.reservationModel.coupon.discountNumberType||"V"==h.reservationModel.coupon.discountNumberType||"I"==h.reservationModel.coupon.discountNumberType||"Z"==h.reservationModel.coupon.discountNumberType;h.displayUpLiftRelatedInfo=!h.corporateBcd&&"US"==h.reservationModel.personalInfoRQ.residency&&"US"==h.reservationModel.pickCountry&&"true"==h.showUpliftOption&&"true"==h.enableUplift&&angular.equals(v.reservation,w.resFlowCreate)?!0:!1;angular.isDefined(H.getStorageData("qantasData"))&&
p.current.name!=w.step4PayLaterPageName&&(H.deleteStorageData("qantasData"),H.deleteStorageData("balanceAmount"),H.setStorageData("qantasMessage",!0));H.getStorageData("qantasData")&&""!==H.getStorageData("qantasData")&&(console.log("qantasDatasaasd"),h.qantasSessionData=H.getStorageData("qantasData"),h.balanceAmountValue=H.getStorageData("balanceAmount"),h.pointsBurned=h.qantasSessionData.pointsBurned,h.balanceAmount=h.balanceAmountValue);h.reservationModel?h._summaryPageProcess():B.getData().then(function(b){z.load(b,
!0).then(function(b){h.reservationModel=b;h._summaryPageProcess()})});"true"==partnerConfig.amazon.enablePartnerBenefit&&ABG.loadAmazon()};h._summaryPageProcess=function(){var b=angular.fromJson(y.countryList);h.countryList=b;var e="US";b=h.reservationModel.promotionalCoupon;null!=b&&b&&""!=b&&(h.couponCodeDisabled=!0,h.reservationModel&&h.reservationModel.coupon&&h.reservationModel.coupon.couponNumber&&(h.reservationModel.coupon.couponNumber=""));0<h.reservationModel.selectedProducts.length&&angular.forEach(h.reservationModel.selectedProducts,
function(b,e){void 0!=h.reservationModel.selectedProducts[e].redeemedQty&&"0"!=h.reservationModel.selectedProducts[e].redeemedQty&&(h.couponCodeDisabled=!0)});angular.isDefined(h.customer)&&(e=h.customer.cor,h.reservationModel.displayControls.fieldDisable=!0);angular.isDefined(h.customer)&&angular.isDefined(h.customer.cor)&&("US"==h.customer.cor||"CA"==h.customer.cor)&&y.brand==w.brandName.AVIS&&angular.isDefined(h.customer.userState)&&"AUTHENTICATED"==h.customer.userState&&(h.epIndicator=!0);h.reservationModel&&
null!=h.reservationModel&&""!==h.reservationModel.personalInfoRQ.residency&&(e=h.reservationModel.personalInfoRQ.residency=h.reservationModel.personalInfoRQ.residency);b=h.countryList.indexOf(E("filter")(h.countryList,function(b){return b.code===e})[0]);h.reservationModel.personalInfoRQ.residency=h.countryList[b].code;h.rentalSummaryApplyCoupon()};h._processErrorByType=function(b){b=q.processErrorMessage(b);angular.isDefined(b.fieldErrors)&&0<b.fieldErrors.length&&(h.errorDisplayList=b.fieldErrors,
h.infoError=!1,h.resFormPageInfo="");return angular.isDefined(b.errorList)&&0<b.errorList.length?(h.validated=!0,h.errorDisplayList=b.errorList,!0):!1};h._couponRedeemHandler=function(b){angular.isDefined(b.reservationSummary.rateSummary)&&angular.isDefined(b.reservationSummary.rateSummary.couponRedeemRemoval)&&angular.isDefined(b.reservationSummary.rateSummary.couponRedeemRemoval.code)&&G(angular.element("#couponRedeemRemoval").html(b.reservationSummary.rateSummary.couponRedeemRemoval.message))(q);
h.response=b};h.pageName=p.current.name;h.scroll_Up=function(){y.scroll(0,0)};h._discountValidation=function(){};h.response=t.getReviewData();h.checkModifyWithPrime=function(){if(!angular.equals(h.response,{}))return"modify"==h.response.webHeader.p13nDetailsMap.reservationFlow&&"Y"==h.response.reservationSummary.partnerRewardInfoDetails.rewardFulfillType?!0:!1};var J=!1,M=!1;h.partnerEmailRequired=!1;x=x("GlobalSummaryExnController",{$scope:q});angular.extend(this,x);jQuery(".step2-renter-summary-detail").on("hide.bs.modal",
function(b){v.$broadcast("widgetModifyReload",v.resModel)});h._summaryPageInit();v.$on("learnwhypop",function(b,e){r=h._discountValidation();b=B.learnWhyErrorMsg(h,e,r);h.title=b.title;h.errorMsg=b.errorMsg;h.reason=b.reason;jQuery(".generic-pop-modal").modal("show")});v.$on("errorHandling",function(b,e){h.displayInfoMessage=!0;h.reservationModel.editRentalSummary=!1;z.setReservationModel(h.reservationModel)});v.$on("couponRedeemRemoval",function(b,e){h._couponRedeemHandler(e)});var b=function(b){return{ns:"icon-smoke-free",
abs:"icon-abs",seats:"four-seats-feat",doors:"four-door-feat",auto:"four-automatic-feat",man:"four-automatic-feat",large:"four-bags-feat",medium:"four-bags-feat-medium",small:"four-bags-feat-small",air:"ac-seats-feat",mpg:"mpg-seats-feat",ev:"ev-miles-feat"}[b]||""};"bigbrowser"==v.deviceType&&(h.collapsedRentalSummary=!0);jQuery(document).ready(function(){var b=jQuery(".wrap-severe-weather").outerHeight();b&&jQuery(".collapsed-rentalSummary").css("top",b+"px")})}angular.module("reservation").controller("GlobalSummaryController",
t);t.$inject="$controller $scope $timeout $rootScope $state $window $validation getDataService authenticationService vehicleService couponService $filter carRentalConstant reservationModelService $compile ModalService storageService".split(" ")})();
(function(){function t(x,q,l,v,p,y,g,t,A,B,F,E,w,z,G,n,H,I){function u(){var f=I.$$absUrl;f=f?f.split("#/lookup/")[1]:window.location.search.slice(1);ABG.arrayHasObject(f,["4002","150005","05214"])&&g.getErrorMessageByCode(f).then(function(f){m.pageMessage=f[0].message;m.showMessage=!0},function(){})}x("ExceptionHandlerController",{$scope:q});var m=this;m.session=B.getSessionModel();m.customer=B.getCustomerModel();m.lookupModel=E.lookupModel;m.brand=p.brand;m._reserve=function(){p.location.href=l.contextPath+
"/"+l.locale+"/home"+htmlExtension};m.countryList={};m.getchatnow=function(){g.openChatWindow();return!0};m.getLoginModalWindow=function(){l.$broadcast("LoginActivity",{requestType:"Login",variance:"Small"})};m._initLookup=function(){u();if("avis"==m.brand||"budget"==m.brand){var f=angular.fromJson(p.countryList).countryInfoList;m.countryList=f;"avis"!=m.brand||"us"!=p.domain.toLowerCase()||"es"!=p.locale&&"es_US"!=p.locale&&"fr"!=p.locale&&"fr_US"!=p.locale&&"pt"!=p.locale&&"pt_US"!=p.locale||m.countryList.push({code:"U-U S A",
name:"U S A"});m._setResidency()}m.sessionErrorMessage=A.getStorageData("sessionErrMsg");w.deleteDataBeforeLogoClick();m.sessionErrorMessage&&(f=[],f.push({message:m.sessionErrorMessage}),m.errorDisplayList=f,$(".res-PageError .mainErrorText").text(m.sessionErrorMessage),$(".res-PageError .mainErrorText").show(),A.deleteStorageData("sessionErrMsg"));m.bridgeResponse=A.getStorageData("bridgeResponse");angular.isDefined(m.bridgeResponse)&&angular.isDefined(m.bridgeResponse.errorList)&&m._validateBridgeflow(m.bridgeResponse);
!angular.isDefined(m.session)||m.session.status!=E.userStateRecognized&&m.session.status!=E.userStateAuthenticated&&m.session.status!==E.userStateRememberMe||brand==E.brandName.PAYLESS||(m.lookupModel.lastName=m.customer.lastName);m.conNum=w.getUrlParameter("resForm.confirmationNumber");m.lastName=w.getUrlParameter("resForm.lastName.value");angular.isDefined(m.conNum)&&(m.lookupModel.lastName=m.lastName,m.lookupModel.confirmationNumber=m.conNum,w.setLookUpModel(m.lookupModel),t.load(m.country).then(function(f){if(angular.isDefined(f.fieldErrors)&&
0<f.fieldErrors.length||angular.isDefined(f.warningList)&&0<f.warningList.length)m.prod=q.processErrorMessage(f)},function(f){f&&f.fieldErrors?(f=q.processErrorMessage(f),m.errorDisplayList=f):m.errorDisplayList=f.errorList;l.requestInProgress=!1}));m._cancelledReservation();"avis"!=m.brand&&"budget"!=m.brand||"us"!=p.domain.toLowerCase()||(B.getXsrfToken()?g.getChatStatus().then(function(f){angular.isDefined(f)&&angular.isDefined(f.chatStatus)&&"1"==f.chatStatus?m.chatStatus=!0:m.chatStatus=!1},
function(f){}):setTimeout(function(){var f=A.getStorageData("chatStatus");m.chatStatus=angular.isDefined(f)&&"1"==f?!0:!1},1E3))};m._validateBridgeflow=function(f){var g=[];f=q.processErrorMessage(f);f.errorList&&0<f.errorList.length&&g.push(f.errorList[0]);f.warningList&&0<f.warningList.length&&g.push(f.warningList[0]);m.errorDisplayList=g};m._cancelledReservation=function(){if(z.infoKey){g.getErrorMessageByCode(z.infoKey).then(function(f){m.errorDisplayList=f},function(){console.log("error in service")});
var f=w.getLookUpModel();m.lookupModel.lastName=f.lastName;m.lookupModel.confirmationNumber=f.confirmationNumber;m.lookupModel.email=f.email;l.requestInProgress=!1}};m._setResidency=function(){var f=p.countrySelect?p.countrySelect:"U S A";"budget"==m.brand&&(f=f.toUpperCase());"US"===p.countrySelect&&(f="U S A");if(angular.isDefined(m.countryList)){var g=m.countryList.indexOf(n("filter")(m.countryList,function(e){return e.name===f})[0]);m.country=m.countryList[g].code}};l.$on("initSuccess",function(f,
g){!1===A.sessionStorageSupport()&&(m.session=B.getSessionModel(),m.customer=B.getCustomerModel(),m.lookupModel=E.lookupModel,m._initLookup())});m.CNValidation={lookupValidated:!1,submit:function(f){var g=new URL(window.location);window.history.pushState(g.href,"",g);m.errorDisplayList=[];m.prod&&m.prod.warningList&&(m.prod.warningList=[]);m.prod&&m.prod.errorList&&(m.prod.errorList=[]);F.validate(f).success(m.CNValidation.validationSuccess).error(m.CNValidation.validationError)},validationSuccess:function(){l.requestInProgress=
!0;m.CNValidation.lookupValidated=!1;m.lookupPageError="";m.errorDisplayList="";G.addToConfirmationData({});!angular.isDefined(m.session)||m.session.status!=E.userStateRecognized&&m.session.status!=E.userStateAuthenticated&&m.session.status!==E.userStateRememberMe?"14036"!=z.infoKey?m.CNValidation.getReservationDetails():m._cancelledReservation():m.CNValidation.getReservationDetailsNew()},validationError:function(f){l.requestInProgress=!1;m.errorDisplayList=ABG.getFormValidationError(f,!1)},getReservationDetails:function(){var f=
m.lookupModel.lastName;f.trim();f=f.replace(/^[^a-z|^A-Z]*/,"");f=f.replace(/\s\s+/g," ");f=f.replace(/[^a-zA-Z0-9\-\s]/g,"");m.lookupModel.lastName=f;w.setLookUpModel(m.lookupModel);t.load(m.country).then(function(f){angular.isDefined(f.reservationSummary.reservationFlow)&&"view-reservation"==f.reservationSummary.reservationFlow&&sessionStorage.removeItem("quickPass");if(angular.isDefined(f.fieldErrors)&&0<f.fieldErrors.length||angular.isDefined(f.warningList)&&0<f.warningList.length)m.prod=q.processErrorMessage(f),
l.requestInProgress=!1;else if(angular.isDefined(f.instructionList)&&0<f.instructionList.length)p.location.href="05162"==f.instructionList[0].code?l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/confirmation/lookup":"14978"==f.instructionList[0].code||"090004"==f.instructionList[0].code?l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage":l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/cancel-confirmation";else if(angular.isDefined(f.errorList)&&0<f.errorList.length){var e=
!1;angular.forEach(f.errorList,function(f){angular.equals(f.code,"05032")&&(e=!0)});1==e?(m.getEmail=f.reservationSummary.personalInfo.email,p.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/confirmation/lookup"):(m.prod=q.processErrorMessage(f),l.requestInProgress=!1)}else{angular.isDefined(f.reservationSummary.reservationFlow)&&"view-reservation"==f.reservationSummary.reservationFlow&&sessionStorage.removeItem("quickPass");f.customerInfo&&f.reservationSummary&&angular.isUndefined(f.reservationSummary.userState)&&
(f.reservationSummary.userState=f.customerInfo.userState);var h=B.setCustomerData(f);B.setCustomerModel(h);h=B.setSessionData(f);B.setSessionModel(h);angular.isDefined(f.reservationSummary.personalInfo)&&angular.isDefined(f.reservationSummary.personalInfo.email)&&(m.getEmail=f.reservationSummary.personalInfo.email);f.reservationSummary.permission&&f.reservationSummary.permission.modify&&"TRUE"==f.reservationSummary.permission.modify.visible?p.location.href=l.contextPath+"/"+l.locale+"/reservation"+
htmlExtension+"#/manage":angular.isDefined(f.reservationSummary)&&angular.isDefined(f.reservationSummary.rentalType)&&"Open"==f.reservationSummary.rentalType&&angular.isDefined(f.reservationSummary.gateExitDone)&&f.reservationSummary.gateExitDone?H.fetchRentalDetails(f.reservationSummary.rentalAgreementNumber).then(function(e){angular.isDefined(e)&&angular.isUndefined(e.errorList)&&(p.location.href=l.contextPath+"/"+l.locale+"/rental/rental-dashboard"+htmlExtension)},function(e){e&&e.fieldErrors?
(e=q.processErrorMessage(e),m.errorDisplayList=e):m.errorDisplayList=e.errorList;l.requestInProgress=!1}):angular.isDefined(f.reservationSummary)&&angular.isDefined(f.reservationSummary.rentalType)&&"Open"==f.reservationSummary.rentalType&&angular.isDefined(f.reservationSummary.gateExitDone)&&!f.reservationSummary.gateExitDone?H.fetchRentalDetails(f.reservationSummary.rentalAgreementNumber).then(function(e){angular.isDefined(e)&&angular.isUndefined(e.errorList)&&(p.location.href=l.contextPath+"/"+
l.locale+"/rental/rental-dashboard"+htmlExtension)},function(e){e&&e.fieldErrors?(e=q.processErrorMessage(e),m.errorDisplayList=e):m.errorDisplayList=e.errorList;l.requestInProgress=!1}):angular.isDefined(f.reservationSummary)&&angular.isDefined(f.reservationSummary.rentalType)&&"Closed"==f.reservationSummary.rentalType?(A.setStorageData("ClosedRental",!0),p.location.href=l.contextPath+"/"+l.locale+"/reservation/receipt-details"+htmlExtension):p.location.href=l.contextPath+"/"+l.locale+"/reservation"+
htmlExtension+"#/confirmation/lookup"}},function(f){f&&f.fieldErrors?(f=q.processErrorMessage(f),m.errorDisplayList=f):m.errorDisplayList=f.errorList;l.requestInProgress=!1})},getReservationDetailsNew:function(){brand!=E.brandName.PAYLESS&&(m.lookupModel.lastName=m.customer.lastName);m.lookupModel.confirmationNumber=m.lookupModel.confirmationNumber;w.setLookUpModel(m.lookupModel);t.load(m.country).then(function(f){if(angular.isDefined(f.fieldErrors)&&0<f.fieldErrors.length||angular.isDefined(f.warningList)&&
0<f.warningList.length)m.prod=q.processErrorMessage(f),l.requestInProgress=!1;else if(angular.isDefined(f.instructionList)&&0<f.instructionList.length)p.location.href="05162"==f.instructionList[0].code?l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/confirmation/lookup":"14978"==f.instructionList[0].code||"090004"==f.instructionList[0].code?l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage":l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/cancel-confirmation";
else if(angular.isDefined(f.errorList)&&0<f.errorList.length)if(angular.equals(f.errorList.code,"5306"))m.errorDisplayList=q.processErrorMessage(f).errorList,l.requestInProgress=!1;else{var g=!1;angular.forEach(f.errorList,function(e){angular.equals(e.code,"05032")&&(g=!0)});1==g?(m.getEmail=f.reservationSummary.personalInfo.email,p.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage"):(m.prod=q.processErrorMessage(f),l.requestInProgress=!1)}else angular.isDefined(f.reservationSummary.reservationFlow)&&
"view-reservation"==f.reservationSummary.reservationFlow&&sessionStorage.removeItem("quickPass"),m.getEmail=f.reservationSummary.personalInfo.email,f.reservationSummary.permission&&f.reservationSummary.permission.modify&&"TRUE"==f.reservationSummary.permission.modify.visible&&null!=f.reservationSummary.status?p.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage":angular.isDefined(f.reservationSummary)&&angular.isDefined(f.reservationSummary.rentalType)&&"Open"==f.reservationSummary.rentalType&&
angular.isDefined(f.reservationSummary.gateExitDone)&&f.reservationSummary.gateExitDone?H.fetchRentalDetails(f.reservationSummary.rentalAgreementNumber).then(function(e){angular.isDefined(e)&&angular.isUndefined(e.errorList)&&(p.location.href=l.contextPath+"/"+l.locale+"/rental/rental-dashboard"+htmlExtension)},function(e){m.errorDisplayList=e.errorList;l.requestInProgress=!1}):angular.isDefined(f.reservationSummary)&&angular.isDefined(f.reservationSummary.rentalType)&&"Open"==f.reservationSummary.rentalType&&
angular.isDefined(f.reservationSummary.gateExitDone)&&!f.reservationSummary.gateExitDone?H.fetchRentalDetails(f.reservationSummary.rentalAgreementNumber).then(function(e){angular.isDefined(e)&&angular.isUndefined(e.errorList)&&(p.location.href=l.contextPath+"/"+l.locale+"/rental/rental-dashboard"+htmlExtension)},function(e){e&&e.fieldErrors?(e=q.processErrorMessage(e),m.errorDisplayList=e):m.errorDisplayList=e.errorList;l.requestInProgress=!1}):p.location.href=l.contextPath+"/"+l.locale+"/reservation"+
htmlExtension+"#/confirmation/lookup"},function(f){f&&f.fieldErrors?(f=q.processErrorMessage(f),m.errorDisplayList=f):m.errorDisplayList=f.errorList;l.requestInProgress=!1})}};m._initLookup();x=x("LookupExnController",{$scope:q});angular.extend(this,x);l.$on("Profile.successAuthentication",function(f,g){m.session=B.getSessionModel();m.customer=B.getCustomerModel()})}angular.module("reservation").controller("LookupController",t);t.$inject="$controller $scope $rootScope $state $window $sce utilityService lookupService storageService authenticationService $validation carRentalConstant reservationModelService $stateParams getDataService $filter rentalService $location".split(" ")})();
(function(){function t(x,q,l,v,p,y,g,t,A,B,F,E,w,z,G,n,H,I){function u(){var l=I.$$absUrl;l=l?l.split("#/lookup/")[1]:window.location.search.slice(1);ABG.arrayHasObject(l,["4002","150005","05214"])&&g.getErrorMessageByCode(l).then(function(e){f.pageMessage=e[0].message;f.showMessage=!0},function(){})}function m(f){if(angular.isDefined(f.errorList)&&0<f.errorList.length){var e=!0;angular.forEach(f.errorList,function(f){if(angular.equals(f.code,"20018")||angular.equals(f.code,"05032"))e=!1});return e}}
x("ExceptionHandlerController",{$scope:q});var f=this;f.session=B.getSessionModel();f.customer=B.getCustomerModel();f.lookupModel=E.lookupModel;f.brand=p.brand;f.trackingID="";f.selfCheckoutFormValidation=!1;f.preCheckPageError="";f.errors=[];f._reserve=function(){p.location.href=l.contextPath+"/"+l.locale+"/home"+htmlExtension};f.countryList={};f.getchatnow=function(){g.openChatWindow();return!0};f.getLoginModalWindow=function(){l.$broadcast("LoginActivity",{requestType:"Login",variance:"Small"})};
f._initLookup=function(){w.addGTMScript();u();if("avis"==f.brand||"budget"==f.brand){var m=angular.fromJson(p.countryList).countryInfoList;f.countryList=m;"avis"!=f.brand||"us"!=p.domain.toLowerCase()||"es"!=p.locale&&"es_US"!=p.locale&&"fr"!=p.locale&&"fr_US"!=p.locale&&"pt"!=p.locale&&"pt_US"!=p.locale||f.countryList.push({code:"U-U S A",name:"U S A"});f._setResidency()}f.sessionErrorMessage=A.getStorageData("sessionErrMsg");w.deleteDataBeforeLogoClick();f.sessionErrorMessage&&(m=[],m.push({message:f.sessionErrorMessage}),
f.errorDisplayList=m,$(".res-PageError .mainErrorText").text(f.sessionErrorMessage),$(".res-PageError .mainErrorText").show(),A.deleteStorageData("sessionErrMsg"));f.bridgeResponse=A.getStorageData("bridgeResponse");angular.isDefined(f.bridgeResponse)&&angular.isDefined(f.bridgeResponse.errorList)&&f._validateBridgeflow(f.bridgeResponse);!angular.isDefined(f.session)||f.session.status!=E.userStateRecognized&&f.session.status!=E.userStateAuthenticated&&f.session.status!==E.userStateRememberMe||brand==
E.brandName.PAYLESS||(f.lookupModel.lastName=f.customer.lastName);f.conNum=w.getUrlParameter("resForm.confirmationNumber");f.lastName=w.getUrlParameter("resForm.lastName.value");f.utmCampaign=w.getUrlParameter(E.urlParamUtm_campaign);f.MID=w.getUrlParameter("MID")?w.getUrlParameter("MID"):w.getUrlParameter("utm_content");angular.isDefined(f.conNum)&&(f.lookupModel.lastName=f.lastName,f.lookupModel.confirmationNumber=f.conNum,w.setLookUpModel(f.lookupModel),t.load(f.country).then(function(e){if(angular.isDefined(e.fieldErrors)&&
0<e.fieldErrors.length||angular.isDefined(e.warningList)&&0<e.warningList.length)f.prod=q.processErrorMessage(e)},function(e){e&&e.fieldErrors?(e=q.processErrorMessage(e),f.errorDisplayList=e):f.errorDisplayList=e.errorList;l.requestInProgress=!1}));f._cancelledReservation();"avis"!=f.brand&&"budget"!=f.brand||"us"!=p.domain.toLowerCase()||(B.getXsrfToken()?g.getChatStatus().then(function(e){angular.isDefined(e)&&angular.isDefined(e.chatStatus)&&"1"==e.chatStatus?f.chatStatus=!0:f.chatStatus=!1},
function(e){}):setTimeout(function(){var e=A.getStorageData("chatStatus");f.chatStatus=angular.isDefined(e)&&"1"==e?!0:!1},1E3))};f._validateBridgeflow=function(g){var e=[];g=q.processErrorMessage(g);g.errorList&&0<g.errorList.length&&e.push(g.errorList[0]);g.warningList&&0<g.warningList.length&&e.push(g.warningList[0]);f.errorDisplayList=e};f._cancelledReservation=function(){if(z.infoKey){g.getErrorMessageByCode(z.infoKey).then(function(e){f.errorDisplayList=e},function(){console.log("error in service")});
var m=w.getLookUpModel();f.lookupModel.lastName=m.lastName;f.lookupModel.confirmationNumber=m.confirmationNumber;f.lookupModel.email=m.email;l.requestInProgress=!1}};f._setResidency=function(){var g=p.countrySelect?p.countrySelect:"U S A";"budget"==f.brand&&(g=g.toUpperCase());"US"===p.countrySelect&&(g="U S A");if(angular.isDefined(f.countryList)){var e=f.countryList.indexOf(n("filter")(f.countryList,function(e){return e.name===g})[0]);f.country=f.countryList[e].code}};f._redirectToRentalFlow=function(g){H.fetchRentalDetails(g.reservationSummary.rentalAgreementNumber).then(function(e){angular.isDefined(e)&&
angular.isUndefined(e.errorList)&&(p.location.href=l.contextPath+"/"+l.locale+"/rental/rental-dashboard"+htmlExtension)},function(e){e&&e.fieldErrors?(e=q.processErrorMessage(e),f.errorDisplayList=e):e&&e.errorList&&(f.errorDisplayList=e.errorList);l.requestInProgress=!1})};l.$on("initSuccess",function(g,e){!1===A.sessionStorageSupport()&&(f.session=B.getSessionModel(),f.customer=B.getCustomerModel(),f.lookupModel=E.lookupModel,f._initLookup())});f.CNValidation={lookupValidated:!1,submit:function(g){var e=
document.querySelector("#headermenu-dci-btn");f.MID?f.trackingID="ICID\x3d"+f.MID:e&&(e=e.getAttribute("target"),f.trackingID=e);f.errorDisplayList=[];f.prod&&f.prod.warningList&&(f.prod.warningList=[]);f.prod&&f.prod.errorList&&(f.prod.errorList=[]);F.validate(g).success(f.CNValidation.validationSuccess).error(f.CNValidation.validationError)},validationSuccess:function(){l.requestInProgress=!0;f.CNValidation.lookupValidated=!1;f.lookupPageError="";angular.isUndefined(w.getReservationModel())&&w.load("",
!0);f.errorDisplayList="";G.addToConfirmationData({});if(!angular.isDefined(f.session)||f.session.status!=E.userStateRecognized&&f.session.status!=E.userStateAuthenticated&&f.session.status!==E.userStateRememberMe)if("14036"!=z.infoKey){var g=f.lookupModel.lastName;g.trim();g=g.replace(/^[^a-z|^A-Z]*/,"");g=g.replace(/\s\s+/g," ");g=g.replace(/[^a-zA-Z0-9\-\s]/g,"");f.lookupModel.lastName=g;f.CNValidation.getReservationDetails()}else f._cancelledReservation();else brand!=E.brandName.PAYLESS&&(f.lookupModel.lastName=
f.customer.lastName),f.CNValidation.getReservationDetails()},validationError:function(g){l.requestInProgress=!1;f.errorDisplayList=ABG.getFormValidationError(g,!1);1===g.errorCount?f.modifyPageError=g.MSG[0]:1<g.errorCount&&(f.modifyPageError=Dictionary.I18n.get("err.global.multi.errorMessage"))},getReservationDetails:function(){w.setLookUpModel(f.lookupModel);t.quickPassLoad(f.country).then(function(g){if(angular.isDefined(g.fieldErrors)&&0<g.fieldErrors.length||angular.isDefined(g.warningList)&&
0<g.warningList.length)f.prod=q.processErrorMessage(g),l.requestInProgress=!1;else if(angular.isDefined(g.errorList)&&0<g.errorList.length&&m(g)){var e=!1;angular.forEach(g.errorList,function(f){angular.equals(f.code,"20018")&&(e=!0)});1==e?(f.getEmail=g.reservationSummary.personalInfo.email,p.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/confirmation/lookup"):(f.prod=q.processErrorMessage(g),l.requestInProgress=!1)}else{if(g.customerInfo&&"PARTNER_AUTHENTICATED"!=g.customerInfo.userState){g.customerInfo&&
g.reservationSummary&&angular.isUndefined(g.reservationSummary.userState)&&(g.reservationSummary.userState=g.customerInfo.userState);var h=B.setCustomerData(g);B.setCustomerModel(h);h=B.setSessionData(g);B.setSessionModel(h)}angular.isDefined(g.reservationSummary.personalInfo)&&angular.isDefined(g.reservationSummary.personalInfo.email)&&(f.getEmail=g.reservationSummary.personalInfo.email);angular.isDefined(g.webHeader)&&"CHOICE_LICENSE_PLATE_SCAN"==g.webHeader.viewIndicator?(A.setStorageData("reservationModelSelfCheckOut",
g),p.location.href=l.contextPath+"/"+l.locale+"/on-lot-exchange"+htmlExtension+"#/start-up"):angular.isDefined(g.webHeader)&&"CHOICE_NO_LICENSE_PLATE_SCAN"==g.webHeader.viewIndicator?(A.setStorageData("reservationModelSelfCheckOut",g),p.location.href=l.contextPath+"/"+l.locale+"/on-lot-exchange"+htmlExtension+"#/start-up"):!angular.isDefined(g.webHeader)||"PRE_RENTAL_DASHBOARD"!=g.webHeader.viewIndicator&&"MID_RENTAL_DASHBOARD"!=g.webHeader.viewIndicator?!angular.isDefined(g.webHeader)||"PRECHECKIN_ELIGIBLE"!=
g.webHeader.viewIndicator&&"PRECHECKIN_SUBMITTED"!=g.webHeader.viewIndicator?angular.isDefined(g.webHeader)&&"VMC_PAGE"==g.webHeader.viewIndicator?p.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage":angular.isDefined(g.webHeader)&&"INITIATE_BIOMETRIC"==g.webHeader.viewIndicator||g.reservationSummary.permission&&g.reservationSummary.permission.modify&&"TRUE"==g.reservationSummary.permission.modify.visible&&null!=g.reservationSummary.status&&angular.isDefined(f.session)&&
(f.session.status==E.userStateRecognized||f.session.status==E.userStateAuthenticated||f.session.status===E.userStateRememberMe)?p.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage":angular.isDefined(g.webHeader)&&"CANCEL_CONFIRM_PAGE"==g.webHeader.viewIndicator?p.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/cancel-confirmation":angular.isDefined(g.instructionList)&&0<g.instructionList.length&&("05162"==g.instructionList[0].code?p.location.href=
l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/confirmation/lookup":angular.isDefined(g.webHeader)&&"PRECHECKIN_SUBMITTED"==g.webHeader.viewIndicator||"090004"==g.instructionList[0].code?(A.setStorageData("reservationModelSelfCheckOut",g),angular.isDefined(g.reservationSummary.reservationFlow)&&"selfCheckoutIntiate"==g.reservationSummary.reservationFlow&&sessionStorage.setItem("quickPass",g.reservationSummary.reservationFlow),p.location.href=contextPath+"/"+locale+"/self-checkout"+htmlExtension+
"#/confirmation-page"):angular.isDefined(g.webHeader)&&"INITIATE_BIOMETRIC"==g.webHeader.viewIndicator||"14978"==g.instructionList[0].code||"20008"==g.instructionList[0].code||"20007"==g.instructionList[0].code||"20006"==g.instructionList[0].code?(angular.isDefined(g.reservationSummary)&&sessionStorage.setItem("quickPass","selfCheckoutIntiate"),p.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage"):p.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+
"#/cancel-confirmation"):angular.isDefined(g.reservationSummary)&&angular.isDefined(g.reservationSummary.permission.preCheckin)&&"FALSE"==g.reservationSummary.permission.preCheckin.visible?(angular.isDefined(g.reservationSummary.reservationFlow)&&sessionStorage.setItem("quickPass",g.reservationSummary.reservationFlow),p.location.href=contextPath+"/"+locale+"/self-checkout"+htmlExtension+"#/confirmation-page"):(A.setStorageData("reservationModelSelfCheckOut",g),p.location.href=l.contextPath+"/"+l.locale+
"/self-checkout"+htmlExtension+"#/driver-info?"+f.trackingID):angular.isDefined(g.reservationSummary)&&angular.isDefined(g.reservationSummary.rentalType)&&"Open"==g.reservationSummary.rentalType&&angular.isDefined(g.reservationSummary.gateExitDone)?f._redirectToRentalFlow(g):angular.isDefined(g.reservationSummary)&&angular.isDefined(g.reservationSummary.rentalType)&&"Closed"==g.reservationSummary.rentalType&&(A.setStorageData("ClosedRental",!0),p.location.href=l.contextPath+"/"+l.locale+"/reservation/receipt-details"+
htmlExtension)}},function(g){g&&g.fieldErrors?(g=q.processErrorMessage(g),f.errorDisplayList=g):f.errorDisplayList=g.errorList;l.requestInProgress=!1})}};f._initLookup();x=x("LookupExnController",{$scope:q});angular.extend(this,x);l.$on("Profile.successAuthentication",function(g,e){f.session=B.getSessionModel();f.customer=B.getCustomerModel()})}angular.module("reservation").controller("SelfCheckoutQuickpassController",t);t.$inject="$controller $scope $rootScope $state $window $sce utilityService lookupService storageService authenticationService $validation carRentalConstant reservationModelService $stateParams getDataService $filter rentalService $location".split(" ")})();
(function(){function t(x,q,l,v,p,y,g,t,A,B,F,E,w,z,G){function n(f){p.validate(f).success(function(e){g.requestInProgress=!0;t.desktopToMobileIntegration(m,u.mobNum,u.recaptcha).then(function(e){null!=e&&(u.dciSms.result=e,angular.isDefined(e.fieldErrors)&&null!==e.fieldErrors&&0<e.fieldErrors.length?(e=e.fieldErrors[0],e=p.displayServiceError(e.field,e.classifier),u.isValidated=!0,u.err=e):angular.isDefined(e.errorList)&&null!==e.errorList&&0<e.errorList.length?(e=e.errorList[0],u.isValidated=!0,
u.err=e.message):(u.dciSms.showLinkSent=!0,u.dciSms.currAttempt++,C(u.dciSms)),g.requestInProgress=!1)},function(e){if(angular.isDefined(e.fieldErrors)&&null!==e&&null!==e.fieldErrors&&0<e.fieldErrors.length){var f=e.fieldErrors[0];f=p.displayServiceError(f.field,f.classifier);u.isValidated=!0;u.err=f}angular.isDefined(e.errorList)&&null!==e.errorList&&0<e.errorList.length&&(u.isValidated=!0,u.err=e.errorList[0].message);g.requestInProgress=!1})}).error(function(e){u.isValidated=!0;u.err=x.processErrorMessage(e.MSG[0]);
angular.element(".ng-invalid").focus()})}function H(){return v.getStorageData("desktopToMobilePromo")}function C(f){v.setStorageData("desktopToMobilePromo",f)}var u=this;u.data={};var m=u.mobNum="",f="";u.isValidated=!1;u.trackingID="";u.dciSms={showLinkSent:!1,maxLimit:1,currAttempt:0,flowType:"firstTimePreferred"};u.clearMeLocations=supportedLocsClearMe?supportedLocsClearMe.split(","):[];u.mitekLocations=supportedLocsMiTek?supportedLocsMiTek.split(","):[];u.hideResendLinkOption=!1;u.countryList=
{};u.brand=l.brand;u.onInit=function(){t.fetchSummary().then(function(f){f&&null!=f&&(u.data=f,angular.isDefined(H())?u.dciSms=H():C(u.dciSms),!0===u.dciSms.showLinkSent&&(u.dciSms.showLinkSent=!u.dciSms.showLinkSent,C(u.dciSms)),!f.customerInfo||"US"!==f.customerInfo.cor&&"CA"!==f.customerInfo.cor||(angular.isDefined(H())&&(u.hideResendLinkOption=H().currAttempt>H().maxLimit?!0:!1),f=u.data.reservationSummary&&u.data.reservationSummary.pickLoc.locationCode,u.supportClearMe=E.checkLocation(u.clearMeLocations,
f),u.supportMiTek=w.checkLocation(u.mitekLocations,f),angular.isDefined(u.data.reservationSummary.personalInfo)&&angular.isDefined(u.data.reservationSummary.personalInfo.phone)&&0<u.data.reservationSummary.personalInfo.phone.length&&(u.mobNum=u.data.reservationSummary.personalInfo.phone=u.data.customerInfo.cellPhone),m=u.data&&u.data.reservationSummary&&u.data.reservationSummary.confirmationNumber?u.data.reservationSummary.confirmationNumber:"",u.supportMiTek||u.supportClearMe&&"handheld"!==g.deviceType?
(B.trackScanOfFTPEvent("SCAN_WITH_PHONE_WINDOW_FTP","Open"),angular.element(".desktop-to-mobile-modal-ftp").modal("show"),!$(".desktop-to-mobile-modal-ftp").hasClass("mitek-madal-added")&&$("body").hasClass("mitek-body-added")&&$("body").toggleClass("mitek-body-added")):u.supportClearMe&&"handheld"===g.deviceType&&(angular.element("#clear-me-promo-modal").modal("show"),E.initiate("clear-button","self-checkout","verify","profile-conversion"))),g.requestInProgress=!1)},function(f){if(angular.isDefined(f.fieldErrors)&&
null!==f&&null!==f.fieldErrors&&0<f.fieldErrors.length){var e=f.fieldErrors[0];e=p.displayServiceError(e.field,e.classifier);u.isValidated=!0;u.err=e}angular.isDefined(f.errorList)&&null!==f.errorList&&0<f.errorList.length&&(u.isValidated=!0,u.err=f.errorList[0].message);g.requestInProgress=!1})};u.submit=function(f){u.isValidated=!1;B.trackScanOfFTPEvent("SMS_BUTTON_FTP_SUCCESS","Requested");l.brand==G.brandName.PAYLESS||"true"==enableEnterpriseCaptcha&&(l.brand==G.brandName.AVIS||l.brand==G.brandName.BUDGET)?
grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"triggerSms",twofactor:!0}).then(function(e){u.recaptcha=e;n(f)}):n(f)};u.ftppMobileSubmit=function(n){if("ftpp-mb-promo"===n){f=u.data.reservationSummary.personalInfo.lastName.value;if(n=document.querySelector("#ftpp-mb-promo"))u.trackingID=n.getAttribute("target");B.trackMitekVerEventsDuringDci("PROMO_VERIFY_CTA","Click",u.data);g.requestInProgress=!0;t.verifyFTP({confirmationNumber:m,lastName:f,countryCode:"U-U S A"}).then(function(e){angular.isDefined(e)&&
(angular.isDefined(e.fieldErrors)&&null!==e.fieldErrors&&0<e.fieldErrors.length?(e=e.fieldErrors[0],e=p.displayServiceError(e.field,e.classifier),u.isValidated=!0,u.err=e):angular.isDefined(e.errorList)&&null!==e.errorList&&0<e.errorList.length?(e=e.errorList[0],u.isValidated=!0,u.err=e.message):angular.isDefined(e.webHeader)&&"INITIATE_BIOMETRIC"==e.webHeader.viewIndicator?(v.setStorageData("reservationModelSelfCheckOut",e),l.location.href=g.contextPath+"/"+g.locale+"/self-checkout"+htmlExtension+
"#/ftp-driver-scan-guide-info?"+u.trackingID):angular.isDefined(e.webHeader)&&"CHOICE_LICENSE_PLATE_SCAN"==e.webHeader.viewIndicator?(v.setStorageData("reservationModelSelfCheckOut",e),l.location.href=g.contextPath+"/"+g.locale+"/on-lot-exchange"+htmlExtension+"#/start-up"):angular.isDefined(e.webHeader)&&"CHOICE_NO_LICENSE_PLATE_SCAN"==e.webHeader.viewIndicator&&(v.setStorageData("reservationModelSelfCheckOut",e),l.location.href=g.contextPath+"/"+g.locale+"/on-lot-exchange"+htmlExtension+"#/start-up"),
g.requestInProgress=!1)},function(e){g.requestInProgress=!1;var f=function(f){if(angular.isDefined(f.fieldErrors)&&null!==f.fieldErrors&&0<f.fieldErrors.length)return f=f.fieldErrors[0],p.displayServiceError(f.field,f.classifier);if(angular.isDefined(f.errorList)&&null!==f.errorList&&0<f.errorList.length)return e.errorList[0].message}(e);v.setStorageData("sessionErrMsg",f);setTimeout(function(){l.location.href=g.contextPath+"/"+g.locale+"/reservation/view-modify-cancel"+htmlExtension},10)})}};u.resetModalForm=
function(){$(".desktop-to-mobile-modal-ftp").toggleClass("mitek-madal-added");$("body").toggleClass("mitek-body-added");$(".modal-backdrop").toggleClass("mitek-overlay")};u.enableEnterpriseCaptcha=enableEnterpriseCaptcha;(q=document.getElementById("clear-button"))&&q.addEventListener("click",function(f){B.trackClearMeEvents("PROMO_VERIFY_CTA","Click",u.data)});u.onInit()}"use-strict";angular.module("reservation").controller("desktopToMobileRes",t);t.$inject="$scope $location $window storageService $validation $sce $rootScope lookupService reservationModelService gaService $controller clearMe MiTek authenticationService carRentalConstant".split(" ")})();
(function(){function t(x,q,l,v,p,y,g,t,A,B,F,E,w,z,G,n,H,I,u,m,f,D,e,h,r,J,M,b,O,S,T,ia,da,ba,ca){function C(){angular.isDefined(k.prod)&&angular.isDefined(k.prod.reservationSummary)&&(k.userAge=O.getAge(k.prod.reservationSummary))}function Z(){g.brand==m.brandName.PAYLESS&&(k.termsToPrintRequired=!0);var a=rootpath+"/reservation/print-confirmation"+htmlExtension+"#/?tncrequired\x3d"+k.termsToPrintRequired+"\x26pageType\x3dconfirm";k.tncRequired=k.termsToPrintRequired;g.open(a,"AEM","width\x3d950,height\x3d500,scrollbars\x3dyes")}
function a(){l.requestInProgress=!0;f.load(k.reservation,!1).then(function(a){a.rateRequestDropIndicator?g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/time-and-place":(l.reservation=a.displayControls.reservation,E.getData().then(function(a){k.reservation=a;k.availableTabs=a.reservationSummary.getAvailableTabs;k.reservationModel=f.getReservationModel();angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length&&R(a)||
angular.isDefined(a.warningList)&&0<a.warningList.length?angular.isDefined(a.errorList)&&0<a.errorList.length&&"02009"==a.errorList[0].code?k.getDataInitiate():(a=q.processErrorMessage(a),(angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length)&&k.redirectError(a.errorList),angular.isDefined(a.warningList)&&0<a.warningList.length&&(k.warningList=a.warningList),g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/time-and-place"):
angular.isDefined(a.errorList)&&0<a.errorList.length&&!R(a)&&angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.permission)&&angular.isDefined(a.reservationSummary.permission.preCheckin)&&angular.isDefined(a.reservationSummary.permission.preCheckin.visible)&&"FALSE"===a.reservationSummary.permission.preCheckin.visible?g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/confirmation/lookup":k.getDataInitiate()},function(a){}))},function(a){})}function d(a){if(angular.isDefined(a.reservationSummary)&&
angular.isDefined(a.reservationSummary.permission)&&angular.isDefined(a.reservationSummary.permission.preCheckin)&&angular.isDefined(a.reservationSummary.permission.preCheckin.visible)){var c=f.getUrlParameter("MID"),b=f.getUrlParameter("partner");J.setStorageData("reservationModelSelfCheckOut",a);angular.isDefined(c)&&"GDS_N_DC_Reminder"==c||angular.isDefined(b)&&"y"==b.toLowerCase()?"TRUE"===a.reservationSummary.permission.preCheckin.visible?(a=angular.isDefined(c)?c:"PARTNERDCI",g.location.href=
contextPath+"/"+locale+"/quick-pass-partner"+htmlExtension+"#/partner-driver-info?ICID\x3d"+a):g.location.href=contextPath+"/"+locale+"/quick-pass-partner"+htmlExtension+"#/partner-confirmation":g.location.href="TRUE"===a.reservationSummary.permission.preCheckin.visible?l.contextPath+"/"+l.locale+"/self-checkout"+htmlExtension+"#/driver-info?ICID\x3d"+c:contextPath+"/"+locale+"/self-checkout"+htmlExtension+"#/confirmation-page"}}function ea(){angular.isDefined(k.partnerParams)&&(l.requestInProgress=
!0,E.redirectToSelfCheckoutViaSms(k.partnerParams[0],m.selfCheckoutEndPoints.filter(function(a){return a.partnerDecrypt})[0].partnerDecrypt,k.partnerParams[3]).then(function(a){l.requestInProgress=!1;if(angular.isDefined(a.warningList)&&0<a.warningList.length)J.setStorageData("sessionErrMsg",a.warningList[0].message),g.location.href=l.contextPath+"/"+l.locale+"/quick-pass-partner/partner-landing"+htmlExtension;else if(angular.isDefined(a.instructionList)&&0<a.instructionList.length)"05162"==a.instructionList[0].code?
g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/confirmation/lookup":"090004"==a.instructionList[0].code?(J.setStorageData("reservationModelSelfCheckOut",a),g.location.href=contextPath+"/"+locale+"/quick-pass-partner"+htmlExtension+"#/partner-confirmation"):"14978"==a.instructionList[0].code||"20008"==a.instructionList[0].code||"20007"==a.instructionList[0].code||"20006"==a.instructionList[0].code?(J.setStorageData("sessionErrMsg",a.instructionList[0].message),g.location.href=
l.contextPath+"/"+l.locale+"/quick-pass-partner/partner-landing"+htmlExtension):g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/cancel-confirmation";else if(angular.isDefined(a.errorList)&&0<a.errorList.length)if(angular.equals(a.errorList.code,"5306"))k.errorDisplayList=q.processErrorMessage(a).errorList,l.requestInProgress=!1;else{var c=!1;angular.forEach(a.errorList,function(a){angular.equals(a.code,"05032")&&(c=!0)});1==c?(k.getEmail=a.reservationSummary.personalInfo.email,
J.setStorageData("sessionErrMsg",a.errorList[0].message),g.location.href=l.contextPath+"/"+l.locale+"/quick-pass-partner/partner-landing"+htmlExtension):(k.prod=q.processErrorMessage(a),l.requestInProgress=!1,J.setStorageData("sessionErrMsg",a.errorList[0].message),setTimeout(function(){g.location.href=l.contextPath+"/"+l.locale+"/quick-pass-partner/partner-landing"+htmlExtension},10))}else angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.permission)&&angular.isDefined(a.reservationSummary.permission.preCheckin)&&
angular.isDefined(a.reservationSummary.permission.preCheckin.visible)&&"checkout"===k.partnerParams[1]&&"y"===k.partnerParams[2]&&function(a){for(var c=0;c<a.length;c++)if(k.partnerParams[3]!==a[c])return!1;return!0}(["partner-dci"])&&("TRUE"===a.reservationSummary.permission.preCheckin.visible?(a=J.getStorageData("reservationModelSelfCheckOut"),a.MID=k.MID,J.setStorageData("reservationModelSelfCheckOut",a),g.location.href=contextPath+"/"+locale+"/quick-pass-partner"+htmlExtension+"#/partner-driver-info?ICID\x3d"+
k.MID):g.location.href=contextPath+"/"+locale+"/quick-pass-partner"+htmlExtension+"#/partner-confirmation")},function(a){l.requestInProgress=!1;angular.isDefined(a.errorList)&&0<a.errorList.length&&(l.requestInProgress=!0,J.setStorageData("sessionErrMsg",a.errorList[0].message),g.location.href=l.contextPath+"/"+l.locale+"/quick-pass-partner/partner-landing"+htmlExtension)}))}function K(){angular.isDefined(k.expressParams)&&E.redirectToSelfCheckoutViaSms(k.expressParams[0],m.selfCheckoutEndPoints.filter(function(a){return a.retrieveRes})[0].retrieveRes,
k.expressParams[2]).then(function(a){if(angular.isDefined(a.errorList)&&0<a.errorList.length)if(angular.equals(a.errorList.code,"5306"))k.errorDisplayList=q.processErrorMessage(a).errorList,l.requestInProgress=!1;else{var c=!1;angular.forEach(a.errorList,function(a){angular.equals(a.code,"05032")&&(c=!0)});1==c?(k.getEmail=a.reservationSummary.personalInfo.email,g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage"):(k.prod=q.processErrorMessage(a),l.requestInProgress=
!1,J.setStorageData("sessionErrMsg",a.errorList[0].message),setTimeout(function(){g.location.href=l.contextPath+"/"+l.locale+"/reservation/quick-pass"+htmlExtension},10))}else"ADDFLTINFO"==f.getUrlParameter("utm_content")?g.location.href=l.contextPath+"/"+l.locale+"/self-checkout"+htmlExtension+"#/flight-info":Y(a)},function(a){angular.isDefined(a.errorList)&&0<a.errorList.length&&k._redirectToQuickPass(a)})}function P(){angular.isDefined(k.expressParams)?E.redirectToSelfCheckoutViaSms(k.expressParams[0],
m.selfCheckoutEndPoints.filter(function(a){return a.onlotUser})[0].onlotUser,k.expressParams[2]).then(function(a){if(angular.isDefined(a.errorList)&&0<a.errorList.length)if(angular.equals(a.errorList.code,"5306"))k.errorDisplayList=q.processErrorMessage(a).errorList,l.requestInProgress=!1;else{var c=!1;angular.forEach(a.errorList,function(a){angular.equals(a.code,"05032")&&(c=!0)});1==c?(k.getEmail=a.reservationSummary.personalInfo.email,g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+
"#/manage"):(k.prod=q.processErrorMessage(a),l.requestInProgress=!1,J.setStorageData("sessionErrMsg",a.errorList[0].message),setTimeout(function(){aa()},10))}else Y(a)},function(a){a&&angular.isDefined(a.errorList)&&0<a.errorList.length&&(J.setStorageData("sessionErrMsg",a.errorList[0].message),aa())}):(J.setStorageData("sessionErrMsg",Dictionary.I18n.get("err.res.genericerrormsg,"+brand)),aa())}function aa(){ABG.redirectPage(l.contextPath+"/"+l.locale+"/on-lot-exchange"+htmlExtension+"#/rental-error")}
function Y(a){if(angular.isDefined(a.webHeader)&&"CHOICE_LICENSE_PLATE_SCAN"==a.webHeader.viewIndicator)g.location.href=l.contextPath+"/"+l.locale+"/on-lot-exchange"+htmlExtension+"#/start-up";else if(angular.isDefined(a.webHeader)&&"CHOICE_NO_LICENSE_PLATE_SCAN"==a.webHeader.viewIndicator)g.location.href=l.contextPath+"/"+l.locale+"/on-lot-exchange"+htmlExtension+"#/start-up";else if(!angular.isDefined(a.webHeader)||"PRE_RENTAL_DASHBOARD"!=a.webHeader.viewIndicator&&"MID_RENTAL_DASHBOARD"!=a.webHeader.viewIndicator&&
"PRE_RENTAL_DASHBOARD_EXPRSS_PASS"!=a.webHeader.viewIndicator)angular.isDefined(a.webHeader)&&"PRECHECKIN_ELIGIBLE"==a.webHeader.viewIndicator?g.location.href=l.contextPath+"/"+l.locale+"/self-checkout"+htmlExtension+"#/driver-info?ICID\x3d"+k.MID:angular.isDefined(a.webHeader)&&"PRECHECKIN_SUBMITTED"==a.webHeader.viewIndicator?g.location.href=contextPath+"/"+locale+"/self-checkout"+htmlExtension+"#/confirmation-page":angular.isDefined(a.webHeader)&&"INITIATE_BIOMETRIC"==a.webHeader.viewIndicator?
g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage":angular.isDefined(a.webHeader)&&"VMC_PAGE"==a.webHeader.viewIndicator?g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage":angular.isDefined(a.webHeader)&&"CANCEL_CONFIRM_PAGE"==a.webHeader.viewIndicator?g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/cancel-confirmation":angular.isDefined(data.instructionList)&&0<data.instructionList.length&&("05162"==data.instructionList[0].code?
g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/confirmation/lookup":angular.isDefined(data.webHeader)&&"PRECHECKIN_SUBMITTED"==data.webHeader.viewIndicator||"090004"==data.instructionList[0].code?g.location.href=l.contextPath+"/"+l.locale+"/self-checkout"+htmlExtension+"#/confirmation-page":angular.isDefined(data.webHeader)&&"INITIATE_BIOMETRIC"==data.webHeader.viewIndicator||"14978"==data.instructionList[0].code||"20008"==data.instructionList[0].code||"20007"==data.instructionList[0].code||
"20006"==data.instructionList[0].code?g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage":g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/cancel-confirmation");else if(angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.rentalType)&&"Open"==a.reservationSummary.rentalType&&angular.isDefined(a.reservationSummary.gateExitDone)){var c=z.setSessionData(a);z.setSessionModel(c);k._redirectToRentalFlow(a)}else angular.isDefined(a.reservationSummary)&&
angular.isDefined(a.reservationSummary.rentalType)&&"Closed"==a.reservationSummary.rentalType&&(J.setStorageData("ClosedRental",!0),g.location.href=l.contextPath+"/"+l.locale+"/reservation/receipt-details"+htmlExtension)}function R(a){if(angular.isDefined(a.errorList)&&0<a.errorList.length){var c=!0;angular.forEach(a.errorList,function(a){if(angular.equals(a.code,"20018")||angular.equals(a.code,"05032"))c=!1});return c}}function ha(){if(!angular.isDefined(k.selfCheckoutToken)||la()||c()||na()||"ADDFLTINFO"==
f.getUrlParameter("utm_content"))if(!angular.isDefined(k.smsVoltageToken)||la()||c()||na()||"ADDFLTINFO"==f.getUrlParameter("utm_content"))if(la())ea();else if(c()||"ADDFLTINFO"==f.getUrlParameter("utm_content"))K();else if(na())P();else if(angular.isDefined(f.getUrlParameter("MID")&&"GDS_N_DC_Reminder"==f.getUrlParameter("MID"))||angular.isDefined(f.getUrlParameter("partner"))&&"y"==f.getUrlParameter("partner").toLowerCase()){if(!X){var b={lastName:p.lastName,confirmationNumber:p.confirmationNumber,
email:""};f.setLookUpModel(b)}l.requestInProgress=!0;E.quickPassLoad("U-U S A").then(function(c){var b=f.getUrlParameter(m.lookupActionParam);angular.isDefined(b)&&b===m.lookupCheckout&&null!=c.reservationSummary.status&&d(c);if(c.reservationSummary.cancelledReservation)if(k.lookupPageErrorCancelReservation=y.trustAsHtml(Dictionary.I18n.get("msg.res.resConf.alreadyCancelled")),X){k.reservation=c;k.disableModifyCancel=!0;if(angular.isDefined(Q)&&-1!=Q.indexOf("NonPrePay")&&-1!=Q.indexOf("NonPrePay")&&
1==c.reservationSummary.cancelledReservation){g.location.href=l.contextPath+"/"+l.locale+"/"+m.endPointArray.VIEW_MODIFY_CANCEL+htmlExtension+"?utm_campaign\x3d"+Q+"\x26"+m.urlParamConfirmNumber+"\x3d"+ja+"\x26"+m.urlParamLastName+"\x3d"+ma;return}if(angular.isDefined(c.instructionList)&&0<c.instructionList.length||angular.isDefined(c.errorList)&&0<c.errorList.length||angular.isDefined(c.warningList)&&0<c.warningList.length)if(k.reservation=q.processErrorMessage(c),angular.isDefined(c.instructionList)&&
0<c.instructionList.length&&1==k.reservation.reservationSummary.cancelledReservation){g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/cancel-confirmation?utm_campaign\x3d"+Q;return}g.location.href=contextPath+"/"+locale+"/reservation"+htmlExtension+"#/cancel-confirmation"}else k.messageCancelError=!0,g.location.href=l.contextPath+"/"+l.locale+"/reservation.html#/view-modify-cancel";else if(p.errorKey)g.location.href=contextPath+"/"+locale+"/reservation"+htmlExtension+"#/confirmation/"+
p.errorKey;else if(X){k.reservation=c;c.customerInfo&&"PARTNER_AUTHENTICATED"!=c.customerInfo.userState&&(b=z.setCustomerData(c),z.setCustomerModel(b));c.reservationSummary.awdNumber==Dictionary.I18n.get("lbl.global.amazonBenefits")&&(b=z.setSessionData(c),z.setSessionModel(b));angular.isDefined(k.reservation.reservationSummary)&&angular.isDefined(k.reservation.reservationSummary.personalInfo)&&angular.isDefined(k.reservation.reservationSummary.personalInfo.email)&&(k.emailaddr=k.reservation.reservationSummary.personalInfo.email,
k.rentalLocationCountry=k.reservation.reservationSummary.pickLoc.address.country.toUpperCase());if(angular.isDefined(c.errorList)&&0<c.errorList.length&&R(c)){l.requestInProgress=!0;g.location.href=l.contextPath+"/"+l.locale+"/"+m.endPointArray.VIEW_MODIFY_CANCEL+htmlExtension+"#/lookup/"+c.errorList[0].code;return}angular.isDefinedAndNotNull(k.reservation.reservationSummary.rentalAgreementNumber)&&""!==k.reservation.reservationSummary.rentalAgreementNumber?(J.setStorageData("reservationModelSelfCheckOut",
c),k._redirectToRentalFlow(c)):a()}else g.location.href=contextPath+"/"+locale+"/reservation"+htmlExtension+"#/confirmation/lookup";l.requestInProgress=!1},function(a){l.requestInProgress=!1})}else if(angular.isDefined(p.lastName)&&angular.isDefined(p.confirmationNumber)||X)X||(b={lastName:p.lastName,confirmationNumber:p.confirmationNumber,email:""},f.setLookUpModel(b)),l.requestInProgress=!0,E.load().then(function(c){var b=f.getUrlParameter(m.lookupActionParam);angular.isDefined(b)&&b===m.lookupCheckout&&
null!=c.reservationSummary.status&&d(c);if(c.reservationSummary.cancelledReservation)if(k.lookupPageErrorCancelReservation=y.trustAsHtml(Dictionary.I18n.get("msg.res.resConf.alreadyCancelled")),X){k.reservation=c;k.disableModifyCancel=!0;if(angular.isDefined(Q)&&-1!=Q.indexOf("NonPrePay")&&-1!=Q.indexOf("NonPrePay")&&1==c.reservationSummary.cancelledReservation){g.location.href=l.contextPath+"/"+l.locale+"/"+m.endPointArray.VIEW_MODIFY_CANCEL+htmlExtension+"?utm_campaign\x3d"+Q+"\x26"+m.urlParamConfirmNumber+
"\x3d"+ja+"\x26"+m.urlParamLastName+"\x3d"+ma;return}if(angular.isDefined(c.instructionList)&&0<c.instructionList.length||angular.isDefined(c.errorList)&&0<c.errorList.length||angular.isDefined(c.warningList)&&0<c.warningList.length)if(k.reservation=q.processErrorMessage(c),angular.isDefined(c.instructionList)&&0<c.instructionList.length&&1==k.reservation.reservationSummary.cancelledReservation){g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/cancel-confirmation?utm_campaign\x3d"+
Q;return}g.location.href=contextPath+"/"+locale+"/reservation"+htmlExtension+"#/cancel-confirmation"}else k.messageCancelError=!0,g.location.href=l.contextPath+"/"+l.locale+"/reservation.html#/view-modify-cancel";else if(p.errorKey)g.location.href=contextPath+"/"+locale+"/reservation"+htmlExtension+"#/confirmation/"+p.errorKey;else if(X){k.reservation=c;c.customerInfo&&"PARTNER_AUTHENTICATED"!=c.customerInfo.userState&&(b=z.setCustomerData(c),z.setCustomerModel(b));c.reservationSummary.awdNumber==
Dictionary.I18n.get("lbl.global.amazonBenefits")&&(b=z.setSessionData(c),z.setSessionModel(b));angular.isDefined(k.reservation.reservationSummary)&&angular.isDefined(k.reservation.reservationSummary.personalInfo)&&angular.isDefined(k.reservation.reservationSummary.personalInfo.email)&&(k.emailaddr=k.reservation.reservationSummary.personalInfo.email,k.rentalLocationCountry=k.reservation.reservationSummary.pickLoc.address.country.toUpperCase());if(angular.isDefined(c.errorList)&&0<c.errorList.length&&
R(c)){l.requestInProgress=!0;g.location.href=l.contextPath+"/"+l.locale+"/"+m.endPointArray.VIEW_MODIFY_CANCEL+htmlExtension+"#/lookup/"+c.errorList[0].code;return}angular.isDefinedAndNotNull(k.reservation.reservationSummary.rentalAgreementNumber)&&""!==k.reservation.reservationSummary.rentalAgreementNumber?g.location.href=l.contextPath+"/"+l.locale+"/rental/rental-dashboard"+htmlExtension:a()}else g.location.href=contextPath+"/"+locale+"/reservation"+htmlExtension+"#/confirmation/lookup";l.requestInProgress=
!1},function(a){l.requestInProgress=!1});else if(l.requestInProgress=!0,l.$progressbar.activeItem=5,b=J.getStorageData("equipmentCSSList"),angular.isDefined(b)&&!X){if(angular.isDefined(Q)&&-1!=Q.indexOf("NonPrePay")&&-1!=Q.indexOf("NonPrePay")&&1==data.reservationSummary.cancelledReservation){g.location.href=l.contextPath+"/"+l.locale+"/"+m.endPointArray.VIEW_MODIFY_CANCEL+htmlExtension+"?utm_campaign\x3d"+Q+"\x26"+m.urlParamConfirmNumber+"\x3d"+ja+"\x26"+m.urlParamLastName+"\x3d"+ma;return}if(angular.isDefined(b.instructionList)&&
0<b.instructionList.length||angular.isDefined(b.errorList)&&0<b.errorList.length||angular.isDefined(b.warningList)&&0<b.warningList.length){if(k.reservation=q.processErrorMessage(b),angular.isDefined(b.instructionList)&&0<b.instructionList.length&&1==k.reservation.reservationSummary.cancelledReservation){g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/cancel-confirmation?utm_campaign\x3d"+Q;return}}else k.reservation=b;angular.isDefined(k.reservation.reservationSummary)&&
angular.isDefined(k.reservation.reservationSummary.personalInfo)&&angular.isDefined(k.reservation.reservationSummary.personalInfo.email)&&(k.emailaddr=k.reservation.reservationSummary.personalInfo.email,k.rentalLocationCountry=k.reservation.reservationSummary.pickLoc.address.country.toUpperCase());ka(k.reservation?k.reservation.reservationSummary:{});B.addToConfirmationData(k.reservation);B.addToReservationData(k.reservation);a()}else E.getData().then(function(c){if(angular.isDefined(Q)&&-1!=Q.indexOf("NonPrePay")&&
-1!=Q.indexOf("NonPrePay")&&1==c.reservationSummary.cancelledReservation)g.location.href=l.contextPath+"/"+l.locale+"/"+m.endPointArray.VIEW_MODIFY_CANCEL+htmlExtension+"?utm_campaign\x3d"+Q+"\x26"+m.urlParamConfirmNumber+"\x3d"+ja+"\x26"+m.urlParamLastName+"\x3d"+ma;else{if(angular.isDefined(c.instructionList)&&0<c.instructionList.length||angular.isDefined(c.errorList)&&0<c.errorList.length||angular.isDefined(c.warningList)&&0<c.warningList.length){if(k.reservation=q.processErrorMessage(c),angular.isDefined(c.instructionList)&&
0<c.instructionList.length&&1==k.reservation.reservationSummary.cancelledReservation){g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/cancel-confirmation?utm_campaign\x3d"+Q;return}}else k.reservation=c;angular.isDefined(k.reservation.reservationSummary)&&angular.isDefined(k.reservation.reservationSummary.personalInfo)&&angular.isDefined(k.reservation.reservationSummary.personalInfo.email)&&(k.emailaddr=k.reservation.reservationSummary.personalInfo.email,k.rentalLocationCountry=
k.reservation.reservationSummary.pickLoc.address.country.toUpperCase());B.addToConfirmationData(k.reservation);a();ka(k.reservation?k.reservation.reservationSummary:{})}},function(a){l.requestInProgress=!1});else fa();else k._redirectToSelfCheckoutLoad();k.cancelOrNoShowFeeMessage()}function fa(){E.redirectToSelfCheckoutViaSms(k.smsVoltageToken,m.selfCheckoutEndPoints.filter(function(a){return a.smsVerify})[0].smsVerify,k.MID).then(function(a){if(angular.isDefined(a.errorList)&&0<a.errorList.length&&
R(a))if(angular.equals(a.errorList.code,"5306"))k.errorDisplayList=q.processErrorMessage(a).errorList,l.requestInProgress=!1;else{var c=!1;angular.forEach(a.errorList,function(a){angular.equals(a.code,"05032")&&(c=!0)});1==c?(k.getEmail=a.reservationSummary.personalInfo.email,g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage"):(k.prod=q.processErrorMessage(a),l.requestInProgress=!1,J.setStorageData("sessionErrMsg",a.errorList[0].message),setTimeout(function(){g.location.href=
l.contextPath+"/"+l.locale+"/reservation/quick-pass"+htmlExtension},10))}else Y(a)},function(a){l.requestInProgress=!1;angular.isDefined(a.errorList)&&0<a.errorList.length&&(l.requestInProgress=!0,k._redirectToQuickPass(a))})}function L(){E.redirectToSelfCheckoutLoad(k.selfCheckoutToken).then(function(a){if(angular.isDefined(a.errorList)&&0<a.errorList.length)if(angular.equals(a.errorList.code,"5306"))k.errorDisplayList=q.processErrorMessage(a).errorList,l.requestInProgress=!1;else{var c=!1;angular.forEach(a.errorList,
function(a){angular.equals(a.code,"05032")&&(c=!0)});1==c?(k.getEmail=a.reservationSummary.personalInfo.email,g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage"):(k.prod=q.processErrorMessage(a),l.requestInProgress=!1,J.setStorageData("sessionErrMsg",a.errorList[0].message),setTimeout(function(){g.location.href=l.contextPath+"/"+l.locale+"/reservation/quick-pass"+htmlExtension},10))}else Y(a)},function(a){l.requestInProgress=!1;angular.isDefined(a.errorList)&&0<a.errorList.length&&
(l.requestInProgress=!0,k._redirectToQuickPass(a))})}function ka(a){a.splitBillSummary&&(a.splitBillSummary.splitBillPrimary&&a.splitBillSummary.splitBillPrimary.ccSummary&&a.splitBillSummary.splitBillPrimary.ccSummary.type&&(k.primaryCardType=ABG.getCreditCardMap(a.splitBillSummary.splitBillPrimary.ccSummary.type)),a.splitBillSummary.splitBillSecondary&&a.splitBillSummary.splitBillSecondary.ccSummary&&a.splitBillSummary.splitBillSecondary.ccSummary.type&&(k.secondaryCardType=ABG.getCreditCardMap(a.splitBillSummary.splitBillSecondary.ccSummary.type)))}
function la(){for(var a=["id","action","partner","utm_content"],c=[],b=0;b<a.length;b++)c.push(f.getUrlParameter(a[b]));k.partnerParams=c;return"checkout"===c[1]&&"y"===c[2]&&"partner-dci"===c[3]}function c(){for(var a=["id","express_qr","utm_content","action","utm_medium"],c=[],b=0;b<a.length;++b)c.push(f.getUrlParameter(a[b]));k.expressParams=c;return"y"===c[1]&&("EXPRS_SMS"===c[2]||"ERECEITSMS"===c[2])&&"checkout"===c[3]&&"sms"===c[4]}function na(){for(var a=["id","utm_content","action","utm_medium"],
c=[],b=0;b<a.length;++b)c.push(f.getUrlParameter(a[b]));k.expressParams=c;return("ch_sms"===c[1]||"ch_email"===c[1])&&"checkout"===c[2]&&("sms"===c[3]||"email"===c[3])}t("ExceptionHandlerController",{$scope:q});l.requestInProgress=!0;var N=0,W={},k=this;k.domain=g.domain;k.isBrandPayless=g.brand===m.brandName.PAYLESS;k.reservationModel=f.getReservationModel();k.customer=z.getCustomerModel();k.session=z.getSessionModel();k.model={};k.insuranceCheckbox={};k.productCheckbox={};k.pointCheckbox={};k.insurances=
{};k.products={};k.insurancePackageSelected=!1;k.response={};k.prod;k.loginValidated=!1;k.loginFormPageError="";k.trackingID="";k.modifiedPickupDate="";k.modifiedDropDate="";k.modifiedFullPickupDate="";k.modifiedFullDropDate="";k.modifiedPhoneNumber="";k.redeemedModifyRes=!1;k.CompleteTexNew={};k.airlines={};k.reviewModifications={};k.redeemedRes=!1;k.modifyPageError="";k.currencySymbol="";k.frdProdArrayFLag=!1;k.freeDayPoints=0;k.utmCampaign="";k.MID="";k.childSafetyExpanded=!1;k.selectedProductsCodeForExpansion=
{};k.insuranceDisplayCount={};k.equipDisplayLen={};k.servicesDisplaylen={};k.selfCheckoutToken="";k.smsVoltageToken="";k.utmCampaign="";k.MID="";k.partnerParams=[];k.expressParams=[];k.loyaltyLogin=!1;k.indicatorMap={email_id:"1",credit_id:"1",address_id:"1",phone_id:"1"};k.emailaddr="";k.accordionStatus={mileage:!1};k.lookupPageErrorCancelReservation="";var X=!1,ja="",ma="",Q="";k.processPageLoad=!0;k.displayBundles=!1;k.showEquipmentSec=!1;k.showCarousalArrow=!1;k.cancellingReason="";k.servicestab1len=
{};k.servicestab2len={};k.userAge="";k.cssDropDown={};e=Dictionary.I18n.get("lbl.res.select");k.cssDropDownValues={CBS:[{selectId:"",selectName:e}],CFS:[{selectId:"",selectName:e}],CIS:[{selectId:"",selectName:e}],CSB:[{selectId:"",selectName:e}],CSS:[{selectId:"",selectName:"Select"}],BXS:[{selectId:"",selectName:e}],BXM:[{selectId:"",selectName:e}],BXL:[{selectId:"",selectName:e}],BBS:[{selectId:"",selectName:e}],BLK:[{selectId:"",selectName:e}],BKR:[{selectId:"",selectName:e}],ROP:[{selectId:"",
selectName:e}]};k.proactiveChat=!1;k.showProactiveChatBtn=!1;k.callProactiveChat=function(){k.proactiveChat=!1;$(".oo_feedback_float").hide();$("#divChatContainer").click()};k.pageName=v.current.name;l.reservation=m.resFlowCreate;k.rentalLocationCountry="";k.getLoginModalWindow=function(){l.$broadcast("LoginActivity",{requestType:"Login",variance:"Small"})};k.getDataInitiate=function(){var a=J.getStorageData("equipmentCSSList");angular.isDefined(a)&&!X?(k._processModifyResPage(a),J.deleteStorageData("equipmentCSSList")):
E.getData(m.modifyReservationPage).then(function(a){k.reservationModel=f.getReservationModel();k.reservationModel?k._processModifyResPage(a):f.load(a,!0).then(function(c){k.reservationModel=c;k._processModifyResPage(a)})});k.accordionStatus.mileage=!1};k.getvehicleModify=function(){angular.isDefined(k.prod)&&angular.isDefined(k.prod.reservationSummary)&&angular.isDefined(k.prod.reservationSummary.amazonReservation)&&(k.reservationModel.amazonReservation=k.prod.reservationSummary.amazonReservation);
B.resetAvailableVehicles();"true"!=g.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||g.brand!=m.brandName.AVIS&&g.brand!=m.brandName.BUDGET?(W=I.load(),W.then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length||angular.isDefined(a.warningList)&&0<a.warningList.length?q.processErrorMessage(a):(k.model=a,B.addToAvailableVehicles(a),l.reservation=m.resFlowModify,
X?g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/vehicles":(ABG.stepTwoLoader(),angular.isDefined(k.prod)&&angular.isDefined(k.prod.reservationSummary)&&angular.isDefined(k.prod.reservationSummary.awdNumber)&&(k.reservationModel.confdiscountnum=k.prod.reservationSummary.awdNumber,f.setReservationModel(k.reservationModel)),v.go(m.step2PageName)))},function(a){})):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(a){k.recaptcha=
a;W=I.load(!1,k.recaptcha);W.then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length||angular.isDefined(a.warningList)&&0<a.warningList.length?q.processErrorMessage(a):(k.model=a,B.addToAvailableVehicles(a),l.reservation=m.resFlowModify,X?g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/vehicles":(ABG.stepTwoLoader(),angular.isDefined(k.prod)&&angular.isDefined(k.prod.reservationSummary)&&angular.isDefined(k.prod.reservationSummary.awdNumber)&&
(k.reservationModel.confdiscountnum=k.prod.reservationSummary.awdNumber,f.setReservationModel(k.reservationModel)),v.go(m.step2PageName)))},function(a){})})})};k.modifyTimePlace=function(){l.reservation="modify";k.reservationModel.displayControls.fieldDisable=!0;k.reservationModel.displayControls.countryFieldDisable=!0;jQuery("#avisLoader").removeClass("hidden");jQuery("#step2Placeholder").addClass("hidden");jQuery("#defaultLoader").removeClass("hidden");jQuery("#budgetStep2Placeholder").addClass("hidden");
angular.isDefined(k.reservationModel.coupon)&&angular.isDefined(k.reservationModel.coupon.visible)&&!1===k.reservationModel.coupon.visible&&(k.couponCodeDisabled=!0,k.reservationModel.coupon.couponNumber="");angular.isDefined(k.prod)&&angular.isDefined(k.prod.reservationSummary)&&angular.isDefined(k.prod.reservationSummary.amazonReservation)&&(k.reservationModel.amazonReservation=k.prod.reservationSummary.amazonReservation);angular.isDefined(k.prod)&&angular.isDefined(k.prod.reservationSummary)&&
angular.isDefined(k.prod.reservationSummary.awdNumber)&&(k.reservationModel.confdiscountnum=k.prod.reservationSummary.awdNumber,f.setReservationModel(k.reservationModel));X?g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/time-and-place":v.go("/make-a-reservation")};k.modifyPersonalInfo=function(){event.stopPropagation();v.go(m.step4PayLaterPageName)};k.insuranceSelected=function(a,c){0<$("#PKGchk").length&&(k.insuranceCheckbox.PEP&&k.insuranceCheckbox.ALI&&k.insuranceCheckbox.PAI||
k.insuranceCheckbox.PKG?k._handlePKG():k.insurancePackageSelected=!1);k.insurancePackageSelected||(a.selected=k.insuranceCheckbox[c],k.insuranceCheckbox[c]?k.reservationModel.selectedInsurances.push(a):k.insuranceCheckbox[c]||(k.reservationModel=w.arrayPop(c,!0,k.reservationModel)));f.setReservationModel(k.reservationModel);l.requestInProgress=!0;"true"!=g.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||g.brand!=m.brandName.AVIS&&
g.brand!=m.brandName.BUDGET?(W=w.recalculate("false"),W.then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length?q.processErrorMessage(a):(l.requestInProgress=!1,k.insurances=a.reservationSummary.insuranceSummaryList,k.prod=a,k.response=a)},function(a){})):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(a){k.recaptcha=a;W=w.recalculate("false",k.recaptcha);
W.then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length?q.processErrorMessage(a):(l.requestInProgress=!1,k.insurances=a.reservationSummary.insuranceSummaryList,k.prod=a,k.response=a)},function(a){})})})};k.productSelected=function(a,c,b,d){l.requestInProgress=!0;a.selected=k.productCheckbox[c];a.quantity="1";k.reservationModel.initOptionalServiceFlag=!0;angular.isDefined(a.subProducts)&&0<a.subProducts.length&&(k.selectedProductsCodeForExpansion[c]=
k.productCheckbox[c]);if(!k.productCheckbox[c]&&angular.isDefined(a.subProducts)&&0<a.subProducts.length)for(k.productCheckbox[c]=!1,l.requestInProgress=!1,w.unCheckCSSOption(a),c=0;c<a.subProducts.length;c++)b=a.subProducts[c].code,k.productCheckbox[b]=!1,k.cssDropDown[b]=0;else if(f.setReservationModel(k.reservationModel),a=w.handleProducts(a,c,b,d,oa,{pointCheckbox:k.pointCheckbox,productCheckbox:k.productCheckbox,cssDropDown:k.cssDropDown,products:k.products,redeemedQty:k.redeemedQty,childSafetyExpanded:k.childSafetyExpanded,
frdSelectedFlag:k.frdSelectedFlag,freeDayPoints:k.freeDayPoints,loyaltyDetails:k.loyaltyDetails,totalPoints:k.totalPoints}),k.pointCheckbox=a.pointCheckbox,k.productCheckbox=a.productCheckbox,k.cssDropDown=a.cssDropDown,k.products=a.products,k.redeemedQty=a.redeemedQty,k.childSafetyExpanded=a.childSafetyExpanded,k.freeDayPoints=a.freeDayPoints,k.loyaltyDetails=a.loyaltyDetails,k.totalPoints=a.totalPoints,oa=a.quantity,a.flag){l.requestInProgress=!1;return}f.setReservationModel(k.reservationModel);
l.requestInProgress=!0;"true"!=k.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||g.brand!=m.brandName.AVIS&&g.brand!=m.brandName.BUDGET?w.recalculate("false").then(function(a){if(angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length)q.processErrorMessage(a),l.requestInProgress=
!1;else{l.requestInProgress=!1;k.products=a.reservationSummary.productSummaryList;var c=T.process(a.reservationSummary);k.ancillaryProductsList=c.ancillaryProductsList;k.insurances=a.reservationSummary.insuranceSummaryList;k.pointProducts=a.reservationSummary.pointProducts;k.prod=q.processErrorMessage(a);k.prod.instructionList&&0<k.prod.instructionList.length&&(k.instructionList=k.prod.instructionList);angular.forEach(k.instructionList,function(a){k.instructionList&&0<k.instructionList.length&&r.containsObject(a.code,
m.nonParticpatingBcd)&&(k.reservationModel.coupon.discountNumber="")});f.setReservationModel(k.reservationModel)}},function(a){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(a){k.recaptcha=a;w.recalculate("false",k.recaptcha).then(function(a){if(angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length)q.processErrorMessage(a),l.requestInProgress=!1;else{l.requestInProgress=
!1;k.products=a.reservationSummary.productSummaryList;var c=T.process(a.reservationSummary);k.ancillaryProductsList=c.ancillaryProductsList;k.insurances=a.reservationSummary.insuranceSummaryList;k.pointProducts=a.reservationSummary.pointProducts;k.prod=q.processErrorMessage(a);k.prod.instructionList&&0<k.prod.instructionList.length&&(k.instructionList=k.prod.instructionList);angular.forEach(k.instructionList,function(a){k.instructionList&&0<k.instructionList.length&&r.containsObject(a.code,m.nonParticpatingBcd)&&
(k.reservationModel.coupon.discountNumber="")});f.setReservationModel(k.reservationModel)}},function(a){})})})};k.pointSelectedvsFTP=function(a,c,b,d){k.productObjSelected=a;k.codeSelected=c;k.productSectionSelected=b};k.keepFTPEarning=function(){l.requestInProgress=!0;w.disableLoyalty("true").then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length?q.processErrorMessage(a):(l.requestInProgress=!1,k.products=a.reservationSummary.productSummaryList,
k.pointProducts=a.reservationSummary.pointProducts,k.prod=a,k.displayFreedayFlag=!1)},function(a){})};k.keepPointsSelection=function(){k.pointSelected(k.productObjSelected,k.codeSelected)};k.pointSelected=function(a,c){a.selected=k.pointCheckbox[c];a.redeemedQty="1";a.quantity="1";k.pointCheckbox[c]?k.reservationModel.selectedProducts.push(a):k.pointCheckbox[c]||(k.reservationModel=w.arrayPop(c,!1,reservationModel));f.setReservationModel(k.reservationModel);"true"!=g.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&
"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||g.brand!=m.brandName.AVIS&&g.brand!=m.brandName.BUDGET?(W=w.recalculate("false"),W.then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length?q.processErrorMessage(a):(k.products=a.reservationSummary.productSummaryList,k.prod=a,k.response=a)},function(a){})):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(a){k.recaptcha=
a;W=w.recalculate("false",k.recaptcha);W.then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length?q.processErrorMessage(a):(k.products=a.reservationSummary.productSummaryList,k.prod=a,k.response=a)},function(a){})})})};k.cancelModification=function(a){l.requestInProgress=!0;k.reservationModel=f.getReservationModel();k.reservationModel.displayControls.reservation=m.resFlowModify;k.reservationModel.displayControls.cancelModify=!0;
n.load(a).then(function(a){l.requestInProgress=!1;X?g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/confirmation/":v.go(m.confirmationPage)},function(a){});f.setReservationModel(k.reservationModel);l.requestInProgress=!1};k.loadHelpModal=function(a){k.helpURL=h.getUrl(a.target.parentElement,k.prod.reservationSummary.pickLoc.address.country)};k.loadHelpPath=function(a){k.helpPath=a.target.parentElement.dataset.helpMap+".html"};k.disablePtsPerDay=function(a){return(a.points+
k.prod.reservationSummary.rateSummary.totalRdmPts>k.totalPoints||0==a.redeemable)&&(void 0==k.pointCheckbox[a.code]||0==k.pointCheckbox[a.code])||k.redeemedRes?!0:!1};k.selectingEmail=function(a){k.reservationModel.personalInfoRQ.email=a.email;k.indicatorMap.email_id=a.maskId;B.addToIndicatorMap(k.indicatorMap)};k.selectingPhoneNumber=function(a){k.reservationModel.personalInfoRQ.phone=angular.copy(a.phoneNumber);k.reservationModel.personalInfoRQ.smsOptIn="T"==a.smsOptIn?!0:!1;k.indicatorMap.phone_id=
angular.copy(a.maskId);B.addToIndicatorMap(k.indicatorMap);angular.forEach(k.prod.reservationSummary.personalInfo.phoneNumbers,function(c){c.selected=c.phoneNumber==a.phoneNumber&&c.maskId==a.maskId?!0:!1})};k.couponCodeDisabled=!1;k.modifyExtras=function(){k.extrasCollapse=!k.extrasCollapse};k.extrasCollapse=!0;k.printConfirmation=function(){g.brand==m.brandName.PAYLESS?Z():angular.element(".print-modal").modal("show")};k.printReservationDetails=Z;k.addToCalendar=function(){var a={name:Dictionary.I18n.get("lbl.res.resconf.addtocalendar.name,"+
brand)+": "+k.prod.reservationSummary.confirmationNumber,contact:Dictionary.I18n.get("lbl.res.resconf.addtocalendar.contact,"+brand)};O.addToCalendar(a,k.prod.reservationSummary)};k.showModify=function(){return!k.prod.reservationSummary||k.prod.reservationSummary.permission&&k.prod.reservationSummary.permission.modify&&"TRUE"!=k.prod.reservationSummary.permission.modify.visible?!1:!0};k.showCancel=function(){return!k.prod.reservationSummary||k.prod.reservationSummary.permission&&k.prod.reservationSummary.permission.cancel&&
"TRUE"!=k.prod.reservationSummary.permission.cancel.visible?!1:!0};k.checkRefund=function(){return k.prod&&k.prod.reservationSummary&&k.prod.reservationSummary.permission&&k.prod.reservationSummary.permission.refund&&k.prod.reservationSummary.permission.refund.visible&&"TRUE"==k.prod.reservationSummary.permission.refund.visible?!0:k.prod&&angular.isDefined(k.prod.reservationSummary)&&angular.isDefined(k.prod.reservationSummary.missedReservation)&&1==k.prod.reservationSummary.missedReservation?!0:
!1};k.checkCancelReservation=function(){return k.pageName==m.cancelBookingPage||angular.isDefined(k.prod)&&angular.isDefined(k.prod.reservationSummary)&&(void 0==k.prod.reservationSummary.permission||k.prod.reservationSummary.permission.cancel&&(void 0==k.prod.reservationSummary.permission.cancel.visible||"FALSE"===k.prod.reservationSummary.permission.cancel.visible))?!0:!1};k.pageInit=function(){ja=f.getUrlParameter(m.urlParamConfirmNumber)?f.getUrlParameter(m.urlParamConfirmNumber):f.getUrlParameter(m.urlParamCheckInConfirmNumber);
k.selfCheckoutToken=f.getUrlParameter("selfCheckoutToken");k.smsVoltageToken=f.getUrlParameter("id");k.prod=J.getStorageData("reservationModelSelfCheckOut");k.utmCampaign=f.getUrlParameter(m.urlParamUtm_campaign);k.MID=f.getUrlParameter("MID")?f.getUrlParameter("MID"):f.getUrlParameter("utm_content");k.sessionErrorMessage=J.getStorageData("sessionErrMsg");f.deleteDataBeforeLogoClick();C();if(k.sessionErrorMessage){var a=[];a.push({message:k.sessionErrorMessage});k.errorDisplayList=a;J.deleteStorageData("sessionErrMsg")}ja&&
(ja=f.getUrlParameter(m.urlParamConfirmNumber)?f.getUrlParameter(m.urlParamConfirmNumber):f.getUrlParameter(m.urlParamCheckInConfirmNumber),ma=f.getUrlParameter(m.urlParamLastName)?f.getUrlParameter(m.urlParamLastName):f.getUrlParameter(m.urlParamCheckInLastName),Q=f.getUrlParameter(m.urlParamUtm_campaign),f.setLookUpModel({lastName:ma,confirmationNumber:ja,email:""}),X=!0);ha();k.cancelReasonFunction()};k.getModifyExtra=a;k.redirectError=function(a){v.current.name!==m.step1aPageName&&f.setStorageData("pastDateError",
a)};k.validatePhoneNumber=function(a){if(k.reservationModel.personalInfoRQ.smsOptIn||k.prod.reservationSummary.vehicleDeliveryFlag)if(angular.isDefined(k.reservationModel.personalInfoRQ.phone)&&""!=k.reservationModel.personalInfoRQ.phone)if(angular.isDefined(k.reservationModel.personalInfoRQ.phone)&&u.validateField("vm.reservationModel.personalInfoRQ.phone",!0,a)){if(angular.isDefined(k.prod.reservationSummary)&&angular.isDefined(k.prod.reservationSummary.personalInfo)&&angular.isDefined(k.prod.reservationSummary.personalInfo.phoneNumbers))for(a=
0;a<k.prod.reservationSummary.personalInfo.phoneNumbers.length;a++)k.reservationModel.personalInfoRQ.phone==k.prod.reservationSummary.personalInfo.phoneNumbers[a].phoneNumber&&(k.phoneMaskId=k.prod.reservationSummary.personalInfo.phoneNumbers[a].maskId);D.phoneNumberValidation(k.reservationModel.personalInfoRQ.phone,k.phoneMaskId).then(function(a){if(angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length)for(var c=0;c<a.fieldErrors.length;c++)"phoneNumber"==a.fieldErrors[c].fieldName&&u.displayServiceError("vm.reservationModel.personalInfoRQ.phone",
"uscan");else if(angular.isDefined(a.errorList)&&0<a.errorList.length)for(c=0;c<a.errorList.length;c++){var b=a.errorList[c];"ERROR"===b.type&&"700020"===b.code?(u.displayServiceError("vm.reservationModel.personalInfoRQ.phone","required",!0),k.reservationModel.personalInfoRQ.phone="",k.reservationModel.personalInfoRQ.smsOptIn=!1):"ERROR"===b.type&&"700022"===b.code?(u.displayServiceError("vm.reservationModel.personalInfoRQ.phone","maskedphonenumber",!0),k.reservationModel.personalInfoRQ.phone="",
k.reservationModel.personalInfoRQ.smsOptIn=!1):"ERROR"===b.type&&"86"===b.code&&(u.displayServiceError("vm.reservationModel.personalInfoRQ.phone","uscan",!0),k.reservationModel.personalInfoRQ.phone="",k.reservationModel.personalInfoRQ.smsOptIn=!1)}})}else u.displayServiceError("vm.reservationModel.personalInfoRQ.phone","invalid",!0);else u.displayServiceError("vm.reservationModel.personalInfoRQ.phone","required",!0)};k.cancelFeeGreaterThanPrepaidAmount=!1;k.cancelFeeLessOrEqualThanPrepaidAmount=!1;
k.rentalLocationCountry="";k.showCarousalArrow=!1;k.redirectToSelfCheckOut=function(){var a=document.querySelector("#vmc-dci-btn");a&&(a=a.getAttribute("target"),k.trackingID=a);l.requestInProgress=!0;E.redirectToDLPage().then(function(a){if(angular.isDefined(a.errorList)&&0<a.errorList.length&&R(a))if(angular.equals(a.errorList.code,"5306"))k.errorDisplayList=q.processErrorMessage(a).errorList,l.requestInProgress=!1;else{var c=!1;angular.forEach(a.errorList,function(a){angular.equals(a.code,"05032")&&
(c=!0)});1==c?(k.getEmail=a.reservationSummary.personalInfo.email,g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage"):(k.prod=q.processErrorMessage(a),l.requestInProgress=!1,J.setStorageData("sessionErrMsg",a.errorList[0].message),setTimeout(function(){g.location.href=l.contextPath+"/"+l.locale+"/reservation/quick-pass"+htmlExtension},10))}else J.setStorageData("reservationModelSelfCheckOut",a),angular.isDefined(a.webHeader)&&"CHOICE_LICENSE_PLATE_SCAN"==a.webHeader.viewIndicator?
g.location.href=l.contextPath+"/"+l.locale+"/on-lot-exchange"+htmlExtension+"#/start-up":angular.isDefined(a.webHeader)&&"CHOICE_NO_LICENSE_PLATE_SCAN"==a.webHeader.viewIndicator?g.location.href=l.contextPath+"/"+l.locale+"/on-lot-exchange"+htmlExtension+"#/start-up":angular.isDefined(a.webHeader)&&"PRECHECKIN_ELIGIBLE"==a.webHeader.viewIndicator?g.location.href=l.contextPath+"/"+l.locale+"/self-checkout"+htmlExtension+"#/driver-info?"+k.trackingID:angular.isDefined(a.webHeader)&&"VMC_PAGE"==a.webHeader.viewIndicator&&
(g.location.href=l.contextPath+"/"+l.locale+"/reservation"+htmlExtension+"#/manage")})};k._authenticationHandler=function(a){k.model=a;if(a.reservationSummary.userState==m.userStateAuthenticated){var c={};void 0!=k.model.reservationSummary.rateSummary.totalRdmPts?c=E.load():"true"!=g.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||g.brand!=m.brandName.AVIS&&g.brand!=m.brandName.BUDGET?(c=w.recalculate("false"),c.then(function(a){k.session=
z.getSessionModel();B.addToReservationData(a);k.getDataInitiate()},function(a){})):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(a){k.recaptcha=a;c=w.recalculate("false",k.recaptcha);c.then(function(a){k.session=z.getSessionModel();B.addToReservationData(a);k.getDataInitiate()},function(a){})})})}else k.loginValidated=!0,k.loginFormPageError=Dictionary.I18n.get("err.prof.login.authenticationFailedAction")};k._processModifyResPage=
function(a){angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.personalInfo)&&angular.isDefined(a.reservationSummary.personalInfo.phoneNumbers)&&angular.forEach(a.reservationSummary.personalInfo.phoneNumbers,function(c){c.selected=c.phoneNumber==a.reservationSummary.personalInfo.phone?!0:!1});a.reservationSummary.flightInfo&&"TRUE"===a.reservationSummary.flightInfo.visible&&k._getAirlines();k.reservationModel&&(k.reservationModel.selectedNonSupCPlist=[],a.reservationSummary&&
a.reservationSummary.rateSummary&&a.reservationSummary.rateSummary.selectedNonSupCPlist&&(k.reservationModel.selectedNonSupCPlist=a.reservationSummary.rateSummary.selectedNonSupCPlist),k.reservationModel.userState=a.reservationSummary.userState);k.insurances=a.reservationSummary.insuranceSummaryList;var c=k.insurances;k.products=a.reservationSummary.productSummaryList;var b=k.products,d=T.process(a.reservationSummary);k.ancillaryProductsList=d.ancillaryProductsList;k.insuranceDisplayCount=d.insuranceDisplayCount;
k.displayTabsList=d.displayTabsList;k.equipDisplayLen=d.equipDisplayLen;k.servicesDisplaylen=d.servicesDisplaylen;k.servicestab1len=d.servicestab1len;k.servicestab2len=d.servicestab2len;a.reservationSummary.ancillaryBundleSummary&&0<a.reservationSummary.ancillaryBundleSummary.length&&"INBOUND_BASIC"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"INBOUND_ALL"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"GUIDED_RES"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&
"LAST_MINUTE"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName||angular.isDefined(k.insurances)||(k.showEquipmentSec=!0);if(a.reservationSummary.ancillaryBundleSummary&&0<a.reservationSummary.ancillaryBundleSummary.length&&"INBOUND_BASIC"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"INBOUND_ALL"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"GUIDED_RES"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"LAST_MINUTE"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&
angular.isDefined(k.insurances)&&angular.isDefined(k.products)||!(a.reservationSummary.ancillaryBundleSummary&&0<a.reservationSummary.ancillaryBundleSummary.length&&"INBOUND_BASIC"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"INBOUND_ALL"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"GUIDED_RES"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"LAST_MINUTE"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName)&&angular.isDefined(k.insurances)&&angular.isDefined(k.products)||
a.reservationSummary.ancillaryBundleSummary&&0<a.reservationSummary.ancillaryBundleSummary.length&&"INBOUND_BASIC"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"INBOUND_ALL"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"GUIDED_RES"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"LAST_MINUTE"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&!angular.isDefined(k.insurances)&&angular.isDefined(k.products)||a.reservationSummary.ancillaryBundleSummary&&
0<a.reservationSummary.ancillaryBundleSummary.length&&"INBOUND_BASIC"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"INBOUND_ALL"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"GUIDED_RES"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"LAST_MINUTE"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&angular.isDefined(k.insurances)&&!angular.isDefined(k.products))k.showCarousalArrow=!0;a.reservationSummary.ancillaryBundleSummary&&0<a.reservationSummary.ancillaryBundleSummary.length&&
"INBOUND_BASIC"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"INBOUND_ALL"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"GUIDED_RES"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&"LAST_MINUTE"!==a.reservationSummary.ancillaryBundleSummary[0].bundleName&&(k.displayBundles=!0);k.Tabactive=T.getCurrentActiveTab(k.displayTabsList);k.productsSelected=a.reservationSummary.rateSummary.selectedProducts;if(angular.isUndefined(k.productsSelected)||0==k.productsSelected.length)k.EquipmentServiceSelection=
!0;k.insurancesSelected=a.reservationSummary.rateSummary.selectedInsurances;var e=[];angular.forEach(k.insurances,function(a,c){a.selected&&"INCLUDED"==a.price&&e.push(a)});0<e.length&&!angular.isDefined(k.insurancesSelected)?k.insurancesSelected=e:0<e.length&&angular.isDefined(k.insurancesSelected)&&0<k.insurancesSelected.length&&(k.insurancesSelected=k.insurancesSelected.concat(e));f.setStorageData("insuranceList",c);f.setStorageData("productList",b);k.reservationModel.selectedInsurances=[];angular.forEach(c,
function(a){a.selected&&k.reservationModel.selectedInsurances.push(a)});angular.forEach(k.products,function(a){angular.isDefined(a.price)||(a.price=Dictionary.I18n.get("res.step3.extras.market"));if(a.selected){void 0!=a.redeemedQty&&0<a.redeemedQty?("FRD"==a.code&&(k.frdProdArrayFLag=!0,k.freeDayPoints=a.redeemedQty),k.pointCheckbox[a.code]=!0,k.productCheckbox[a.code]=!1):(k.pointCheckbox[a.code]=!1,k.productCheckbox[a.code]=!0);a.quantity="1";for(var c=!1,b=0;b<k.reservationModel.selectedProducts.length;b++)a.code==
k.reservationModel.selectedProducts[b].code&&(c=!0);c||k.reservationModel.selectedProducts.push(a)}void 0!=a.subProducts&&angular.forEach(a.subProducts,function(c){angular.isDefined(c.selected)&&(k.selectedProductsCodeForExpansion[a.code]=c.selected);for(var b=c.code,d=c.displayQuantity,e=0;e<=d;e++)k.cssDropDownValues[b].push({selectId:e,selectName:e});!0===c.selected?(void 0!=c.redeemedQty&&0<c.redeemedQty?(k.pointCheckbox[c.code]=!0,k.productCheckbox[c.code]=!1):(k.pointCheckbox[c.code]=!1,k.productCheckbox[c.code]=
!0),k.childSafetyExpanded=!0,k.cssDropDown[c.code]=c.quantity,k.productCheckbox[a.code]=!0):k.cssDropDown[c.code]=0})});a.reservationSummary.ftpDetails&&"TRUE"==a.reservationSummary.ftpDetails.visible&&(c=x.getData(),c.then(function(c){k.ftp=c;k.reservationModel.ftpDetails.partnerCode=a.reservationSummary.ftpDetails.partnerCode!=m.ftpNotApplicableLower?a.reservationSummary.ftpDetails.partnerCode:"";k.reservationModel.ftpDetails.ftpNumber=a.reservationSummary.ftpDetails.ftpNumber!=m.ftpNotApplicableLower?
a.reservationSummary.ftpDetails.ftpNumber:"";k.reservationModel.ftpDetails.ftpBonusMiles=a.reservationSummary.ftpDetails.ftpBonusMiles;a.reservationSummary.ftpDetails.messages&&k._getFTPSectionMessage(a.reservationSummary.ftpDetails.messages)},function(a){}));k.loyaltyLogin=k.pageName==m.modifyReservationPage&&a.reservationSummary.loyaltyDetails&&a.reservationSummary.loyaltyDetails.loyaltyLogin&&"TRUE"==a.reservationSummary.loyaltyDetails.loyaltyLogin.visible&&a.reservationSummary.userState==m.userStateRecognized?
!0:!1;k.response=a;k._rentalOptionsCall(B,w,f,a);angular.forEach(k.insurances,function(a){if(a.selected){k.insuranceCheckbox[a.code]=!0;var c=!1;angular.forEach(k.reservationModel.selectedInsurances,function(b){a.code==b.code&&(c=!0)});c||k.reservationModel.selectedInsurances.push(a)}a.selected&&a.code===m.insuranceList.pkg&&(k.insurancePackageSelected=!0)});m.resFlowModify==k.reservationModel.displayControls.reservation&&angular.forEach(k.products,function(a){if(a.selected)for(k.productCheckbox[a.code]=
!0,a.quantity="1",N=0;N<k.reservationModel.selectedProducts.length;N++)0==k.redeemedModifyRes&&0<parseInt(k.reservationModel.selectedProducts[N].totalRedeemedPts)&&(k.redeemedModifyRes=!0)});c=F.load(!0===k.response.reservationSummary.prepayTxn?m.txnTypePrePay:m.txnTypePostPay,k.response.reservationSummary.pickLoc.locationCode);c.then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length||angular.isDefined(a.warningList)&&0<a.warningList.length?
q.processErrorMessage(a):k.CompleteTexNew=a},function(a){});l.requestInProgress=!1;k.reservationModel.costControl=D.costControlData(a.reservationSummary);1==z.getHideRedemptionOption()&&(k.reviewModifications.modifyPageValidated=!1)};k._getAirlines=function(){W=G.load();W.then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length||angular.isDefined(a.warningList)&&0<a.warningList.length?q.processErrorMessage(a):k.airlines=a},function(a){})};
k._getFTPSectionMessage=function(a){var c=[],b=[],d=[];angular.forEach(a,function(a){angular.equals(a.type,"ERROR")?b.push(a):angular.equals(a.type,"WARNING")?d.push(a):c.push(a)});k.ftpSectInstrList=c;k.ftpSectErrList=b;k.ftpSectWarList=d};k._rentalOptionsCall=function(a,c,b,d){k.prod=d;k.reservationModel=b.getReservationModel();b.setReservationModel(k.reservationModel);C();0<k.reservationModel.selectedProducts.length&&angular.forEach(k.reservationModel.selectedProducts,function(a,c){if(void 0!=
k.reservationModel.selectedProducts[c].redeemedQty&&"0"!=k.reservationModel.selectedProducts[c].redeemedQty)k.pointCheckbox[k.reservationModel.selectedProducts[c].code]=!0;else if(void 0==k.reservationModel.selectedProducts[c].redeemedQty||"0"==k.reservationModel.selectedProducts[c].redeemedQty)k.productCheckbox[k.reservationModel.selectedProducts[c].code]=!0});k.prod.reservationSummary.rateSummary.totalRdmPts&&0<k.prod.reservationSummary.rateSummary.totalRdmPts&&(k.redeemedModifyRes=!0,k.redeemedRes=
!0,k.chkRedeemedRes=!0,l.chkRedeemedRes=!0);k.currencySymbol=A("currencySymbol")(k.prod.reservationSummary.rateSummary.currencySymbol);a=g.locale;b="fr"==a||"fr_US"==a?!0:!1;a=k.prod.reservationSummary.rateSummary.surcharges;c=k.prod.reservationSummary.rateSummary.periodFreeMiles.values;if(("us"==g.domain.toLowerCase()||"ca"==g.domain.toLowerCase())&&b&&"C$"==k.currencySymbol){k.currencySymbol="$ CA";k.prod.reservationSummary.rateSummary.estimatedTotal=k.prod.reservationSummary.rateSummary.estimatedTotal.replace(".",
",");k.prod.reservationSummary.rateSummary.baseRate=k.prod.reservationSummary.rateSummary.baseRate.replace(".",",");k.prod.reservationSummary.rateSummary.optionsTotal=k.prod.reservationSummary.rateSummary.optionsTotal.replace(".",",");k.prod.reservationSummary.rateSummary.extrasTotal=k.prod.reservationSummary.rateSummary.extrasTotal.replace(".",",");k.prod.reservationSummary.rateSummary.protectionsTotal=k.prod.reservationSummary.rateSummary.protectionsTotal.replace(".",",");k.prod.reservationSummary.rateSummary.surchargeTotal=
k.prod.reservationSummary.rateSummary.surchargeTotal.replace(".",",");k.prod.reservationSummary.rateSummary.totalTax=k.prod.reservationSummary.rateSummary.totalTax.replace(".",",");angular.isDefined(k.prod.reservationSummary&&k.prod.reservationSummary.prepayInfo&&("null"!=k.prod.reservationSummary.prepayInfo.amount||"null"!=k.prod.reservationSummary.prepayInfo.cancelFee||"null"!=k.prod.reservationSummary.prepayInfo.noShowFee))&&(k.prod.reservationSummary.prepayInfo.amount=k.prod.reservationSummary.prepayInfo.amount.replace(".",
","),k.prod.reservationSummary.prepayInfo.cancelFee=k.prod.reservationSummary.prepayInfo.cancelFee.replace(".",","),k.prod.reservationSummary.prepayInfo.noShowFee=k.prod.reservationSummary.prepayInfo.noShowFee.replace(".",","),k.prod.reservationSummary.prepayInfo.currency="$ CA");for(b=0;b<a.length;b++)null!==a[b].unitPrice&&void 0!==a[b].unitPrice&&(k.prod.reservationSummary.rateSummary.surcharges[b].unitPrice=a[b].unitPrice=a[b].unitPrice.replace(".",",")),null!==a[b].totalSurchargePrice&&void 0!==
a[b].totalSurchargePrice&&(k.prod.reservationSummary.rateSummary.surcharges[b].totalSurchargePrice=a[b].totalSurchargePrice=a[b].totalSurchargePrice.replace(".",","));if(null!==c&&void 0!==c)for(b=0;b<c.length;b++)1==b&&(c[b]=c[b].replace(".",","))}};k._validateFTPData=function(){var a=!0,c=!0,b=[],d,e=[];if(void 0==k.reservationModel.ftpDetails.partnerCode||""==k.reservationModel.ftpDetails.partnerCode)a=!1;if(void 0==k.reservationModel.ftpDetails.ftpNumber||""==k.reservationModel.ftpDetails.ftpNumber)c=
!1;c&&!a?b.push(u.displayServiceError("vm.reservationModel.ftpDetails.partnerCode","ftpInvalid")):a&&!c&&b.push(u.displayServiceError("vm.reservationModel.ftpDetails.ftpNumber","ftpInvalid"));1===b.length&&(d={message:b[0]});0!=b.length&&e.push(d);k.errorList=e};k._handlePKG=function(){k.insuranceCheckbox.PKG=!0;k.insurancePackageSelected=!0;k.insuranceCheckbox.PEP=!1;k.insuranceCheckbox.ALI=!1;k.insuranceCheckbox.PAI=!1;k.reservationModel.selectedInsurances=[];angular.forEach(k.insurances,function(a){"PKG"==
a.code&&(insuranceObj=a,insuranceObj.selected=!0)});k.reservationModel.selectedInsurances.push(insuranceObj)};k._redirectToSelfCheckoutLoad=L;k._redirectToRentalFlow=function(a){da.fetchRentalDetails(a.reservationSummary.rentalAgreementNumber).then(function(a){angular.isDefined(a)&&angular.isUndefined(a.errorList)&&(g.location.href=l.contextPath+"/"+l.locale+"/rental/rental-dashboard"+htmlExtension)},function(a){a&&a.fieldErrors?(a=q.processErrorMessage(a),k.errorDisplayList=a):a&&a.errorList&&(k.errorDisplayList=
a.errorList);l.requestInProgress=!1})};k.bookAgainFTPCheck=function(a){return a&&k.prod.reservationSummary.rebookFlow?angular.isDefined(k.prod.reservationSummary.ftpDetails)&&angular.isDefined(k.prod.reservationSummary.ftpDetails.ftpNumber)?!0:!1:!a&&k.prod.reservationSummary.rebookFlow?angular.isUndefined(k.prod.reservationSummary.ftpDetails)||angular.isUndefined(k.prod.reservationSummary.ftpDetails.ftpNumber)?!0:!1:a?!0:!1};k.showExcludedProducts=function(a){k.excludedProductsList=[];var c,b;if(a){if(a.productSummaryList&&
0<a.productSummaryList.length)for(c=0;c<a.productSummaryList.length;c++)if(a.productSummaryList[c].code!=m.equipmentCodeCSSG)0!=a.productSummaryList[c].discountEligible&&""!=a.productSummaryList[c].discountEligible||k.excludedProductsList.push(a.productSummaryList[c].description);else for(b=0;b<a.productSummaryList[c].subProducts.length;b++)0!=a.productSummaryList[c].subProducts[b].discountEligible&&""!=a.productSummaryList[c].subProducts[b].discountEligible||k.excludedProductsList.push(a.productSummaryList[c].subProducts[b].description);
if(a.insuranceSummaryList&&0<a.insuranceSummaryList.length)for(c=0;c<a.insuranceSummaryList.length;c++)0!=a.insuranceSummaryList[c].discountEligible&&""!=a.insuranceSummaryList[c].discountEligible||k.excludedProductsList.push(a.insuranceSummaryList[c].description)}};k.cancelOrNoShowFeeMessage=function(){!(k.reservation&&k.reservation.reservationSummary&&g.brand!=m.brandName.PAYLESS&&k.reservation.reservationSummary.prepayTxn&&k.reservation.reservationSummary.prepayInfo&&("C"===k.reservation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&
"FALSE"==k.reservation.reservationSummary.permission.refund.visible||"N"===k.reservation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&"TRUE"==k.reservation.reservationSummary.permission.refund.visible))||k.reservation.reservationSummary.prepayInfo.refundIndicator!=m.RESAMT_LESSTHAN_NOSHOWAMT&&k.reservation.reservationSummary.prepayInfo.refundIndicator!=m.RESAMT_LESSTHAN_CANCELAMT||k.reservation.reservationSummary.pickLoc.address.country.toUpperCase()!=m.countryCodeAU&&k.reservation.reservationSummary.pickLoc.address.country.toUpperCase()!=
m.countryCodeNZ?!(k.reservation&&k.reservation.reservationSummary&&g.brand!=m.brandName.PAYLESS&&k.reservation.reservationSummary.prepayTxn&&k.reservation.reservationSummary.prepayInfo&&("C"===k.reservation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&"FALSE"==k.reservation.reservationSummary.permission.refund.visible||"N"===k.reservation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&"TRUE"==k.reservation.reservationSummary.permission.refund.visible))||k.reservation.reservationSummary.prepayInfo.refundIndicator!=
m.RESAMT_GREATERTHAN_CANCELAMT&&k.reservation.reservationSummary.prepayInfo.refundIndicator!=m.RESAMT_GREATERTHAN_NOSHOWAMT||k.reservation.reservationSummary.pickLoc.address.country.toUpperCase()!=m.countryCodeAU&&k.reservation.reservationSummary.pickLoc.address.country.toUpperCase()!=m.countryCodeNZ||(k.cancelFeeGreaterThanPrepaidAmount=!0,k.rentalLocationCountry=k.reservation.reservationSummary.pickLoc.address.country.toUpperCase()):(k.cancelFeeLessOrEqualThanPrepaidAmount=!0,k.rentalLocationCountry=
k.reservation.reservationSummary.pickLoc.address.country.toUpperCase())};k.cancelReasonFunction=function(){if("au"===window.domain||"nz"===window.domain){var a=Dictionary.I18n.get("lbl.reservation.cancelReasons");a=JSON.parse(a);k.cancelReasonList=a.cancelReasons;k.cancellingReason=null}};k._redirectToSelfCheckoutLoad=L;k._redirectToQuickPass=function(a){J.setStorageData("sessionErrMsg",a.errorList[0].message);setTimeout(function(){g.location.href=l.contextPath+"/"+l.locale+"/reservation/quick-pass"+
htmlExtension},10)};k.cancelReasonList=[];k.enableEnterpriseCaptcha=enableEnterpriseCaptcha;k.amazonBenefitsKey=Dictionary.I18n.get("lbl.global.amazonBenefits");l.$on("Profile.displayProactiveChat",function(a,c){k.showProactiveChatBtn=!0});k.forwardEmail={validated:!1,globaErrorFlag:!1,globalError:"",submit:function(a){u.validate(a).success(k.forwardEmail.validationSuccess).error(k.forwardEmail.validationError)},validationSuccess:function(){l.requestInProgress=!0;var a={rqHeader:{locale:internalLocale},
confirmationNum:k.prod.reservationSummary.confirmationNumber,lastName:k.prod.reservationSummary.personalInfo.lastName.value,emailId:k.forwardEmailModel.emailId.toLowerCase()};k.forwardEmailModel.emailId.toLowerCase()==k.forwardEmailModel.confirmEmailId.toLowerCase()?b.forwardEmail(a).then(function(a){l.requestInProgress=!1;k.forwardMessage=a;u.resetError("vm.forwardEmailModel.emailId",!0);u.resetError("vm.forwardEmailModel.confirmEmailId",!0);k.forwardMessage&&jQuery(".confirmation-email").modal("toggle");
k.fwdEmailId=k.forwardEmailModel.emailId.toLowerCase();k.forwardEmail.globalError="";k.forwardEmail.globaErrorFlag=!1;k.forwardEmailModel.emailId="";k.forwardEmailModel.confirmEmailId=""},function(a){l.requestInProgress=!1}):(u.displayServiceError("vm.forwardEmailModel.confirmEmailId","emailmatch"),l.requestInProgress=!1)},validationError:function(a){k.forwardEmail.globaErrorFlag=!0;k.forwardEmail.globalError=ABG.getFormValidationError(a,!1)[0].message}};var oa=0;l.$on("Profile.successAuthentication",
function(a,c){k._authenticationHandler(c)});k.helpURL="";k.helpPath="";k.reviewModifications={modifyPageValidated:!0,submit:function(a){k.reviewModifications.modifyPageValidated=!0;angular.isDefined(k.prod.reservationSummary)&&angular.isDefined(k.prod.reservationSummary.flightInfo)&&"TRUE"===k.prod.reservationSummary.flightInfo.visible&&("au"==k.domain.toLowerCase()||"nz"==k.domain.toLowerCase())&&"WI"==k.reservationModel.airlineCode&&(k.reservationModel.flightNumber=null);u.validate(a).success(k.reviewModifications.validationSuccess).error(k.reviewModifications.validationError)},
validationSuccess:function(){var a=!1;k.prod.reservationSummary.flightInfo&&angular.isDefined(k.prod.reservationSummary.flightInfo.mandatory)&&"TRUE"===k.prod.reservationSummary.flightInfo.mandatory&&(""===k.reservationModel.flightNumber&&(u.displayServiceError("reservationModel.flightNumber","required"),a=!0),""===k.reservationModel.airlineCode&&(u.displayServiceError("reservationModel.airlineCode","selectrequired"),a=!0));k.reservationModel.flightNumber=k.reservationModel.flightNumber||"";!1===
a&&((""===k.reservationModel.airlineCode||null==k.reservationModel.airlineCode)&&""===k.reservationModel.flightNumber||""!==k.reservationModel.airlineCode&&null!=k.reservationModel.airlineCode&&""==k.reservationModel.flightNumber?a=!1:""!==k.reservationModel.airlineCode&&null!=k.reservationModel.airlineCode||!angular.isDefined(k.reservationModel.flightNumber)?""===k.reservationModel.airlineCode&&null==k.reservationModel.airlineCode||""!==k.reservationModel.flightNumber?a=!1:(u.displayServiceError("reservationModel.flightNumber",
"required"),a=!0):(u.displayServiceError("reservationModel.airlineCode","selectrequired"),a=!0));!1===a&&(k.reviewModifications.modifyPageValidated=!0,k._validateFTPData(),1>k.errorList.length&&k.reviewModifications.modifyRequest())},validationError:function(a){k.reviewModifications.modifyPageValidated=!1;1===a.errorCount?k.modifyPageError=a.MSG[0]:1<a.errorCount&&(k.modifyPageError=Dictionary.I18n.get("err.global.multi.errorMessage"))},modifyRequest:function(){angular.isDefined(B)&&angular.isDefined(B.getReservationData())&&
angular.isDefined(B.getReservationData().reservationSummary)&&angular.isDefined(B.getReservationData().reservationSummary)&&angular.isDefined(B.getReservationData().reservationSummary.iataNumber)&&(k.reservationModel.iataNumber=B.getReservationData().reservationSummary.iataNumber);angular.isDefined(k.prod.domainConfigControl)&&angular.isDefined(k.prod.domainConfigControl.displayElementMap)&&(k.reservationModel.displayElementMap=k.prod.domainConfigControl.displayElementMap);f.setStorageData("reservationModel",
k.reservationModel);if(""!=k.reservationModel.wizardNumber||"RECOGNIZED"==k.reservationModel.userState||"AUTHENTICATED"==k.reservationModel.userState){var a={email_id:angular.isDefined(k.indicatorMap.email_id)&&""!=k.indicatorMap.email_id?k.indicatorMap.email_id:"1",address_id:angular.isDefined(k.indicatorMap.address_id)&&!/^[a-zA-Z0-9]*$/.test(k.reservationModel.paymentRq.address.address1)?k.indicatorMap.address_id:"",phone_id:angular.isDefined(k.indicatorMap.phone_id)&&!/^[0-9]*$/.test(k.reservationModel.personalInfoRQ.phone)?
k.indicatorMap.phone_id:"",credit_id:angular.isDefined(k.indicatorMap.credit_id)&&!/^[0-9]*$/.test(k.creditCardNumber)?k.indicatorMap.credit_id:""};B.addToIndicatorMap(a)}W=H.load();W.then(function(a){if(angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length||angular.isDefined(a.warningList)&&0<a.warningList.length){a=q.processErrorMessage(a);if(angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length)k.errorList=
a.errorList;angular.isDefined(a.warningList)&&0<a.warningList.length&&(k.warningList=a.warningList)}else k.model=a,a.reservationSummary.ftpDetails&&a.reservationSummary.ftpDetails.partnerCode&&""!=a.reservationSummary.ftpDetails.partnerCode&&k.ftp&&k.ftp.partnersList&&(k.reservationModel.ftpDetails.partnerName=r.getPartnerName(a.reservationSummary.ftpDetails.partnerCode,k.ftp.partnersList,!1)),B.addReviewModificationData(a),f.setReservationModel(k.reservationModel),X?g.location.href=l.contextPath+
"/"+l.locale+"/reservation"+htmlExtension+"#/review-modifications":v.go(m.modifyReviewConfirmPage)},function(a){})}};k.cancelReservation={submit:function(a){u.validate(a).success(k.cancelReservation.validationSuccess).error(k.cancelReservation.validationError)},validationSuccess:function(){l.requestInProgress=!0;k.cancelReservation.process()},validationError:function(a){},process:function(){M.load(k.prod.reservationSummary.confirmationNumber,k.prod.reservationSummary.personalInfo.lastName.value,k.emailaddr,
k.cancellingReason).then(function(a){k.model=a;angular.isDefined(a.errorList)&&0<a.errorList.length?(S.process(a.errorList[0].code),l.requestInProgress=!1):(void 0!=k.model.reservationSummary.loyaltyDetails&&(z.setLoyaltyDetails(z.setLoyaltyDetailsData(k.model)),l.$broadcast("loyaltyUpdated",k.model)),J.deleteStorageData("upcomingReservations"),J.deleteStorageData("cancelledReservations"),B.deleteConcurTripList(),jQuery(".getres-modal-cancel").modal("hide"),g.location.href=l.contextPath+"/"+l.locale+
"/reservation"+htmlExtension+"#/cancel-confirmation")},function(a){})}};if(z.getXsrfToken()||z.getSessionModel())k.processPageLoad=!1,k.pageInit();l.$on("initSuccess",function(a,c){k.processPageLoad&&k.pageInit()});jQuery(document).ready(function(){f.addGTMScript()});t=t("ModifyReservationExnController",{$scope:q});angular.extend(this,t)}angular.module("reservation").controller("ModifyReservationController",t);t.$inject="ftpService $scope $rootScope $state $stateParams $sce $window $controller $filter getDataService locationTermsConditionsService lookupService optionalService authenticationService airlineService confirmModifications reviewModifyService vehicleService $validation carRentalConstant reservationModelService reviewService $timeout getVehicles utilityService storageService confirmCancelService emailService confirmationService BackButtonFactory ancillaryService gaService rentalService clearMe MiTek".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C,A,B,F,E,w,z,G,n,H,I,u){function m(g){var e=[];angular.isDefined(f.reservationModel.selectedInsurances)&&0<f.reservationModel.selectedInsurances.length?e=f.reservationModel.selectedInsurances:angular.isDefined(g)&&angular.isDefined(g.reservationSummary)&&angular.isDefined(g.reservationSummary.rateSummary)&&angular.isDefined(g.reservationSummary.rateSummary.selectedInsurances)&&0<g.reservationSummary.rateSummary.selectedInsurances.length&&(e=g.reservationSummary.rateSummary.selectedInsurances);
0<e.length&&angular.forEach(e,function(e,g){"PK2"==e.code&&(f.hideSplitCcPaymentZeApac=!0)})}g("ExceptionHandlerController",{$scope:t});q.reservation=G.resFlowCreate;var f=this;f.reservationModel={};f.reviewData={};f.redeemedConfirmReviewRes=!1;f.mreview="0";f.show_message=!1;f.status={isOpen:!0,isOpenmileageOption:!1};f.oldCurrencySymbol="";f.newCurrencySymbol="";f.couponCodeDisabled=!1;f.domain=p.domain;f.hideSplitCcPaymentZeApac=!1;f.modifyReservation=function(g){if(g&&(f.reservationModel.displayControls.reservation===
G.resFlowModify||f.reviewData.webHeader.p13nDetailsMap.reservationFlow===G.resFlowModify)&&f.reviewData.reservationSummary.prepayTxn&&(f.reservationModel.splitEligible||f.reviewData.reservationSummary.splitEligible)&&f.reservationModel.splitBillSummary&&f.reservationModel.splitBillSummary.splitOpted&&(f.reservationModel.splitBillSummary.splitBillSecondary&&!f.reservationModel.splitBillSummary.splitBillSecondary.ccSummary||null==f.reservationModel.splitBillSummary.splitBillSecondary)&&!f.reservationModel.splitBillSummary.splitConfirmed)f.errorDisplayList=
[{type:"ERROR",code:"12345678",message:"Secondary Method of Payment is a required field."}],jQuery("#dropdownMenu2").css("border-color","rgb(212, 0, 42)"),jQuery("#dropdownMenu2").parent().next().removeClass("cus-d-none");else{var e=f.reservationModel.displayControls.reservation!==G.resFlowModify||f.isBookAgainFlow?"Create Flow":"Modfiy Flow",h="Create Flow"===e?"Reserve":-1!=p.location.href.indexOf("review-and-book")?"Confirm Modification":"Keep Modifications";g&&f.reservationModel.splitBillSummary?
u.resSplitOpted("Keep Modifications-"+e,h):f.reservationModel.splitBillSummary&&u.resSplitOpted("Cancel Modifications-"+e,"Cancel Modifications");q.requestInProgress=!0;f.reservationModel=z.getReservationModel();f.reservationModel.displayControls.reservation=G.resFlowModify;e=A.getStorageData("oneClickURLCode");g&&"false"!==g?f.reservationModel.displayControls.cancelModify=!1:(null!=e&&""!=e&&A.deleteStorageData("oneClickURLCode"),f.reservationModel.displayControls.cancelModify=!0);E.load(g).then(function(e){if(e.errorList&&
0<e.errorList.length){var h=!1;angular.forEach(e.errorList,function(g,b){"1112"==g.code&&(g=B.getReviewData(),h=b,g.errorList=e.errorList,B.addToReviewData(g),q.reservation=G.resFlowModify,1==f.reviewData.reservationSummary.prepayTxn?l.go(G.step4PageName):l.go(G.step4PayLaterPageName));e=t.processErrorMessage(e);f.errorDisplayList=e.errorList;!1!==h&&f.errorDisplayList.splice(h,1);q.requestInProgress=!1})}else void 0!=e.reservationSummary.loyaltyDetails&&(H.setLoyaltyDetails(H.setLoyaltyDetailsData(e)),
q.$broadcast("loyaltyUpdated",e)),A.deleteStorageData("upcomingReservations"),B.deleteConcurTripList(),l.go(G.confirmationPage)},function(e){});z.setReservationModel(f.reservationModel)}};f.getvehicleModify=function(){f.reservationModel.displayControls.reservation=G.resFlowModify;B.resetAvailableVehicles();"true"!=p.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||p.brand!=G.brandName.AVIS&&p.brand!=G.brandName.BUDGET?w.load().then(function(g){angular.isDefined(g.fieldErrors)&&
0<g.fieldErrors.length||angular.isDefined(g.errorList)&&0<g.errorList.length||angular.isDefined(g.warningList)&&0<g.warningList.length?t.processErrorMessage(g):(f.model=g,f.selectedcar=g,q.reservation=G.resFlowModify,ABG.stepTwoLoader(),angular.isDefined(f.reservationModel)&&angular.isDefined(f.reservationModel.coupon)&&angular.isDefined(f.reservationModel.coupon.discountNumber)&&(f.reservationModel.confdiscountnum=f.reservationModel.coupon.discountNumber,z.setReservationModel(f.reservationModel)),
l.go(G.step2PageName))},function(f){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(g){f.recaptcha=g;w.load(!1,f.recaptcha).then(function(e){angular.isDefined(e.fieldErrors)&&0<e.fieldErrors.length||angular.isDefined(e.errorList)&&0<e.errorList.length||angular.isDefined(e.warningList)&&0<e.warningList.length?t.processErrorMessage(e):(f.model=e,f.selectedcar=e,q.reservation=G.resFlowModify,ABG.stepTwoLoader(),angular.isDefined(f.reservationModel)&&
angular.isDefined(f.reservationModel.coupon)&&angular.isDefined(f.reservationModel.coupon.discountNumber)&&(f.reservationModel.confdiscountnum=f.reservationModel.coupon.discountNumber,z.setReservationModel(f.reservationModel)),l.go(G.step2PageName))},function(e){})})})};f.getModifyExtra=function(){f.reservationModel.displayControls.reservation=G.resFlowModify;z.setReservationModel(f.reservationModel);B.resetAvailableVehicles();q.reservation=G.resFlowModify;angular.isDefined(f.reservationModel)&&angular.isDefined(f.reservationModel.coupon)&&
angular.isDefined(f.reservationModel.coupon.discountNumber)&&(f.reservationModel.confdiscountnum=f.reservationModel.coupon.discountNumber,z.setReservationModel(f.reservationModel));l.go(G.step3PageName)};f.getmodifyPersonelInfo=function(){f.reservationModel.displayControls.reservation=G.resFlowModify;z.setReservationModel(f.reservationModel);B.resetAvailableVehicles();I.load().then(function(g){if(angular.isDefined(g.fieldErrors)&&0<g.fieldErrors.length||angular.isDefined(g.errorList)&&0<g.errorList.length||
angular.isDefined(g.warningList)&&0<g.warningList.length)t.processErrorMessage(g);else{q.iataNum=!0;var e=g.reservationSummary.iataNumber;angular.isDefined(g.reservationSummary.ccSummary)&&(f.reservationModel.cardNumber=g.reservationSummary.ccSummary.number,f.reservationModel.cardType=g.reservationSummary.ccSummary.type);f.reservationModel.iataNumber=e==G.systemInjectedIata?"":e;q.reservation=G.resFlowModify;1==f.reviewData.reservationSummary.prepayTxn?l.go(G.step4PageName):l.go(G.step4PayLaterPageName)}},
function(f){})};f.modifyTimePlace=function(){f.reservationModel.displayControls.fieldDisable=!0;f.reservationModel.displayControls.countryFieldDisable=!0;q.reservation=G.resFlowModify;jQuery("#avisLoader").removeClass("hidden");jQuery("#step2Placeholder").addClass("hidden");jQuery("#defaultLoader").removeClass("hidden");jQuery("#budgetStep2Placeholder").addClass("hidden");angular.isDefined(f.reservationModel.coupon)&&angular.isDefined(!1===f.reservationModel.coupon.visible)&&(f.couponCodeDisabled=
!0,f.reservationModel.coupon.couponNumber="");angular.isDefined(f.reservationModel)&&angular.isDefined(f.reservationModel.coupon)&&angular.isDefined(f.reservationModel.coupon.discountNumber)&&(f.reservationModel.confdiscountnum=f.reservationModel.coupon.discountNumber,z.setReservationModel(f.reservationModel));l.go(G.step1aPageName)};f.couponApplicable=function(){return f.reviewData.reservationSummary.vehicle.couponApplicable&&angular.isDefined(f.reviewData.reservationSummary.vehicle.payLaterRate)&&
angular.isDefined(f.reviewData.reservationSummary.vehicle.payLaterRate.couponDiscountAmt)&&0!=f.reviewData.reservationSummary.vehicle.payLaterRate.couponDiscountAmt&&angular.isDefined(f.reviewData.reservationSummary.vehicle.payNowRate)&&angular.isDefined(f.reviewData.reservationSummary.vehicle.payNowRate.couponDiscountAmt)&&0!=f.reviewData.reservationSummary.vehicle.payNowRate.couponDiscountAmt?!0:!1};f._hideSplitPaymentZeApac=m;f._pageInit=function(){f.reservationModel=z.getReservationModel();n.getData().then(function(g){f.reviewData=
g;q.$broadcast("splitBillSummaryUpdate",g);f.insurances=z.getStorageData("insuranceList");F.jsonComparator(f.reviewData.reservationSummary,f.reviewData.oldReservationSummary,!0,!1);f.oldCurrencySymbol=y("currencySymbol")(f.reviewData.oldReservationSummary.rateSummary.currencySymbol);f.newCurrencySymbol=y("currencySymbol")(f.reviewData.reservationSummary.rateSummary.currencySymbol);for(var e=0;e<f.reservationModel.selectedProducts.length;e++)if(f.reservationModel.selectedProducts[e].subProducts&&0<
f.reservationModel.selectedProducts[e].subProducts.length)for(var h=0;h<f.reservationModel.selectedProducts[e].subProducts.length;h++){var l=parseInt(f.reservationModel.selectedProducts[e].subProducts[h].totalRedeemedPts);0<l&&(f.redeemedConfirmReviewRes=!0)}else l=parseInt(f.reservationModel.selectedProducts[e].totalRedeemedPts),0<l&&(f.redeemedConfirmReviewRes=!0);f.status.isOpenmileageOption=!0;void 0!=f.reviewData.reservationSummary.redemptionSummary&&(e=parseFloat(f.reviewData.reservationSummary.redemptionSummary.amount),
h=parseFloat(f.reviewData.reservationSummary.rateSummary.estimatedTotal),f.show_message=e>h);f.reviewData.reservationSummary&&f.reviewData.reservationSummary.rateSummary&&f.reviewData.reservationSummary.rateSummary.rateTerms&&0<f.reviewData.reservationSummary.rateSummary.rateTerms.length&&angular.forEach(f.reviewData.reservationSummary.rateSummary.rateTerms,function(e,f){});if(f.reviewData.unavailProductMsg||f.reviewData.unavailInsuranceMsg||f.reviewData.reservationSummary.productDropMsg)f.droppedProdAndInsuranceList=
n.droppedData(f.reviewData);if(void 0!=f.reviewData.oldReservationSummary&&angular.isDefined(f.reviewData.oldReservationSummary.rateSummary.currencySymbol)&&(f.currencySymbol=y("currencySymbol")(f.reviewData.reservationSummary.rateSummary.currencySymbol),e=p.locale,e="fr"==e||"fr_US"==e?!0:!1,h=f.reviewData.oldReservationSummary.rateSummary.surcharges,l=f.reviewData.oldReservationSummary.rateSummary.periodFreeMiles.values,("us"==p.domain.toLowerCase()||"ca"==p.domain.toLowerCase())&&e&&"C$"==f.currencySymbol)){f.currencySymbol=
"$ CA";f.reviewData.oldReservationSummary.rateSummary.estimatedTotal=f.reviewData.oldReservationSummary.rateSummary.estimatedTotal.replace(".",",");f.reviewData.oldReservationSummary.rateSummary.baseRate=f.reviewData.oldReservationSummary.rateSummary.baseRate.replace(".",",");f.reviewData.oldReservationSummary.rateSummary.optionsTotal=f.reviewData.oldReservationSummary.rateSummary.optionsTotal.replace(".",",");f.reviewData.oldReservationSummary.rateSummary.extrasTotal=f.reviewData.oldReservationSummary.rateSummary.extrasTotal.replace(".",
",");f.reviewData.oldReservationSummary.rateSummary.protectionsTotal=f.reviewData.oldReservationSummary.rateSummary.protectionsTotal.replace(".",",");f.reviewData.oldReservationSummary.rateSummary.surchargeTotal=f.reviewData.oldReservationSummary.rateSummary.surchargeTotal.replace(".",",");f.reviewData.oldReservationSummary.rateSummary.totalTax=f.reviewData.oldReservationSummary.rateSummary.totalTax.replace(".",",");angular.isDefined(f.reviewData.oldReservationSummary&&f.reviewData.oldReservationSummary.prepayInfo&&
"null"!=f.reviewData.oldReservationSummary.prepayInfo.amount)&&(f.reviewData.oldReservationSummary.prepayInfo.amount=f.reviewData.oldReservationSummary.prepayInfo.amount.replace(".",","));for(e=0;e<h.length;e++)null!==h[e].unitPrice&&void 0!==h[e].unitPrice&&(f.reviewData.oldReservationSummary.rateSummary.surcharges[e].unitPrice=h[e].unitPrice=h[e].unitPrice.replace(".",",")),null!==h[e].totalSurchargePrice&&void 0!==h[e].totalSurchargePrice&&(f.reviewData.oldReservationSummary.rateSummary.surcharges[e].totalSurchargePrice=
h[e].totalSurchargePrice=h[e].totalSurchargePrice.replace(".",","));if(null!==l&&void 0!==l)for(e=0;e<l.length;e++)1==e&&(l[e]=l[e].replace(".",","))}if(void 0!=f.reviewData.reservationSummary&&angular.isDefined(f.reviewData.reservationSummary.rateSummary.currencySymbol)&&(e=p.locale,e="fr"==e||"fr_US"==e?!0:!1,h=f.reviewData.reservationSummary.rateSummary.surcharges,l=f.reviewData.reservationSummary.rateSummary.periodFreeMiles.values,("us"==p.domain.toLowerCase()||"ca"==p.domain.toLowerCase())&&
e&&"$ CA"==f.currencySymbol)){f.currencySymbol="$ CA";f.reviewData.reservationSummary.rateSummary.estimatedTotal=f.reviewData.reservationSummary.rateSummary.estimatedTotal.replace(".",",");f.reviewData.reservationSummary.rateSummary.baseRate=f.reviewData.reservationSummary.rateSummary.baseRate.replace(".",",");f.reviewData.reservationSummary.rateSummary.optionsTotal=f.reviewData.reservationSummary.rateSummary.optionsTotal.replace(".",",");f.reviewData.reservationSummary.rateSummary.extrasTotal=f.reviewData.reservationSummary.rateSummary.extrasTotal.replace(".",
",");f.reviewData.reservationSummary.rateSummary.protectionsTotal=f.reviewData.reservationSummary.rateSummary.protectionsTotal.replace(".",",");f.reviewData.reservationSummary.rateSummary.surchargeTotal=f.reviewData.reservationSummary.rateSummary.surchargeTotal.replace(".",",");f.reviewData.reservationSummary.rateSummary.totalTax=f.reviewData.reservationSummary.rateSummary.totalTax.replace(".",",");angular.isDefined(f.reviewData.reservationSummary&&f.reviewData.reservationSummary.rateSummary&&f.reviewData.reservationSummary.rateSummary.estimatedCreditDue&&
"null"!=f.reviewData.reservationSummary.rateSummary.estimatedCreditDue)&&(f.reviewData.reservationSummary.rateSummary.estimatedCreditDue=f.reviewData.reservationSummary.rateSummary.estimatedCreditDue.replace(".",","));angular.isDefined(f.reviewData.reservationSummary&&f.reviewData.reservationSummary.prepayInfo&&"null"!=f.reviewData.reservationSummary.prepayInfo.amount)&&(f.reviewData.reservationSummary.prepayInfo.amount=f.reviewData.reservationSummary.prepayInfo.amount.replace(".",","));for(e=0;e<
h.length;e++)null!==h[e].unitPrice&&void 0!==h[e].unitPrice&&(f.reviewData.reservationSummary.rateSummary.surcharges[e].unitPrice=h[e].unitPrice=h[e].unitPrice.replace(".",",")),null!==h[e].totalSurchargePrice&&void 0!==h[e].totalSurchargePrice&&(f.reviewData.reservationSummary.rateSummary.surcharges[e].totalSurchargePrice=h[e].totalSurchargePrice=h[e].totalSurchargePrice.replace(".",","));if(null!==l&&void 0!==l)for(e=0;e<l.length;e++)1==e&&(l[e]=l[e].replace(".",","))}if(void 0!=f.reviewData.reviewSummary&&
angular.isDefined(f.reviewData.reviewSummary.rateSummary.surcharges)&&(e=p.locale,e="fr"==e||"fr_US"==e?!0:!1,h=f.reviewData.reviewSummary.rateSummary.surcharges,("us"==p.domain.toLowerCase()||"ca"==p.domain.toLowerCase())&&e&&"$ CA"==f.currencySymbol))for(f.currencySymbol="$ CA",e=0;e<h.length;e++)null!==h[e].unitPrice&&void 0!==h[e].unitPrice&&(f.reviewData.reviewSummary.rateSummary.surcharges[e].unitPrice=h[e].unitPrice=h[e].unitPrice.replace(".",",")),null!==h[e].newValue&&void 0!==h[e].newValue&&
(f.reviewData.reviewSummary.rateSummary.surcharges[e].newValue=h[e].newValue=h[e].newValue.replace(".",",")),null!==h[e].oldValue&&void 0!==h[e].oldValue&&(f.reviewData.reviewSummary.rateSummary.surcharges[e].oldValue=h[e].oldValue=h[e].oldValue.replace(".",","));m(g);q.requestInProgress=!1})};f._pageInit();v=g("ReviewModifyExnController",{$scope:t});angular.extend(this,v)}angular.module("reservation").controller("ReviewModifyController",t);t.$inject="$scope $rootScope $state $sce $window $filter $controller $q storageService getDataService jsonCompare confirmModifications vehicleService reservationModelService carRentalConstant reviewModifyService authenticationService reviewService gaService".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C,A,B,F,E,w,z){function x(){window.sessionStorage.getItem("print")||(jQuery(".spinnerLoader").addClass("hidden"),g(function(){window.print()},2E3));window.sessionStorage.setItem("print",!0)}var n=this;q.carRentalConstant=E;n.printVersion=!0;n.pageName=l.current.name;n.domain=C.domain;n.confirmation={};n.CompleteTexNew={};n.modifiedPickupDate="";n.modifiedDropDate="";n.modifiedFullPickupDate="";n.modifiedFullDropDate="";n.modifiedPhoneNumber="";n.bookedDate="";
n.rentalLocationCountry="";n.insurances={};n.products={};n.insuranceDisplay=[];n.customer=z.getCustomerModel();n.checkCancelReservation=function(){return"VIEW_URL"===H?!0:!1};n.checkInstructionList=function(){return!0};n.accordionStatus={baseRate:!1,mileage:!1,rental:!1,discount:!1,fees:!1,cancelFeeC:!1,cancelFeeN:!1,paymentInformtion:!1,tnc:!1,rdmPts:!1};n.bookingAddress={fullName:"",address1:"",address2:"",address3:""};n.showUpsellMessageError=!1;n.amazonBenefitsKey=Dictionary.I18n.get("lbl.global.amazonBenefits");
var H="";n._printInit=function(){n.tncRequired=p.search().tncrequired;angular.isDefined(p.search().pageType)&&angular.equals(p.search().pageType,"confirm")?n.pageTitle=Dictionary.I18n.get("lbl.res.resConf.reservationConfirmation"):(n.pageTitle=Dictionary.I18n.get("lbl.res.resConf.cancelReservation"),H="VIEW_URL");w.getData(H).then(function(g){n.confirmation=g;if(void 0!=n.confirmation.reservationSummary&&angular.isDefined(n.confirmation.reservationSummary.rateSummary.currencySymbol)){n.currencySymbol=
v("currencySymbol")(n.confirmation.reservationSummary.rateSummary.currencySymbol);g=C.locale;var l="fr"==g||"fr_US"==g?!0:!1;g=n.confirmation.reservationSummary.rateSummary.surcharges;var m=n.confirmation.reservationSummary.rateSummary.periodFreeMiles.values;if(("us"==C.domain.toLowerCase()||"ca"==C.domain.toLowerCase())&&l&&"C$"==n.currencySymbol){n.currencySymbol="$ CA";n.confirmation.reservationSummary.rateSummary.estimatedTotal=n.confirmation.reservationSummary.rateSummary.estimatedTotal.replace(".",
",");n.confirmation.reservationSummary.rateSummary.baseRate=n.confirmation.reservationSummary.rateSummary.baseRate.replace(".",",");n.confirmation.reservationSummary.rateSummary.optionsTotal=n.confirmation.reservationSummary.rateSummary.optionsTotal.replace(".",",");n.confirmation.reservationSummary.rateSummary.extrasTotal=n.confirmation.reservationSummary.rateSummary.extrasTotal.replace(".",",");n.confirmation.reservationSummary.rateSummary.protectionsTotal=n.confirmation.reservationSummary.rateSummary.protectionsTotal.replace(".",
",");n.confirmation.reservationSummary.rateSummary.surchargeTotal=n.confirmation.reservationSummary.rateSummary.surchargeTotal.replace(".",",");n.confirmation.reservationSummary.rateSummary.totalTax=n.confirmation.reservationSummary.rateSummary.totalTax.replace(".",",");angular.isDefined(n.confirmation.reservationSummary&&n.confirmation.reservationSummary.prepayInfo&&("null"!=n.confirmation.reservationSummary.prepayInfo.amount||"null"!=n.confirmation.reservationSummary.prepayInfo.cancelFee||"null"!=
n.confirmation.reservationSummary.prepayInfo.noShowFee))&&(n.confirmation.reservationSummary.prepayInfo.amount=n.confirmation.reservationSummary.prepayInfo.amount.replace(".",","),n.confirmation.reservationSummary.prepayInfo.cancelFee=n.confirmation.reservationSummary.prepayInfo.cancelFee.replace(".",","),n.confirmation.reservationSummary.prepayInfo.noShowFee=n.confirmation.reservationSummary.prepayInfo.noShowFee.replace(".",","),n.confirmation.reservationSummary.prepayInfo.currency="$ CA");for(l=
0;l<g.length;l++)null!==g[l].unitPrice&&void 0!==g[l].unitPrice&&(n.confirmation.reservationSummary.rateSummary.surcharges[l].unitPrice=g[l].unitPrice=g[l].unitPrice.replace(".",",")),null!==g[l].totalSurchargePrice&&void 0!==g[l].totalSurchargePrice&&(n.confirmation.reservationSummary.rateSummary.surcharges[l].totalSurchargePrice=g[l].totalSurchargePrice=g[l].totalSurchargePrice.replace(".",","));if(null!==m&&void 0!==m)for(l=0;l<m.length;l++)1==l&&(m[l]=m[l].replace(".",","))}}n.confirmation.reservationSummary.ccSummary&&
n.confirmation.reservationSummary.ccSummary.type&&(n.primaryCardType=ABG.getCreditCardMap(n.confirmation.reservationSummary.ccSummary.type));n.confirmation.reservationSummary.secondaryCCSummary&&n.confirmation.reservationSummary.secondaryCCSummary.type&&(n.secondaryCardType=ABG.getCreditCardMap(n.confirmation.reservationSummary.secondaryCCSummary.type));n.userAge=w.getAge(n.confirmation.reservationSummary);n.insurances=n.confirmation.reservationSummary.rateSummary.selectedInsurances;n.products=n.confirmation.reservationSummary.rateSummary.selectedProducts;
n.rentalLocationCountry=n.confirmation.reservationSummary.pickLoc.address.country.toUpperCase();g={};angular.isDefined(n.confirmation.reservationSummary)&&n.confirmation.reservationSummary.dateOfBooking&&n.confirmation.reservationSummary.prepayTxn&&!0===n.confirmation.reservationSummary.prepayTxn&&(n.bookedDate=n.confirmation.reservationSummary.dateOfBooking);if(1==n.confirmation.reservationSummary.prepayTxn&&("AU"==n.confirmation.reservationSummary.pickLoc.address.country.toUpperCase()||"NZ"==n.confirmation.reservationSummary.pickLoc.address.country.toUpperCase())){m=
n.confirmation.reservationSummary.displayAddress;n.bookingAddress.fullName=n.confirmation.reservationSummary.personalInfo.firstName.value+" "+n.confirmation.reservationSummary.personalInfo.displayLastName.value;n.bookingAddress.address1=m.address1;n.bookingAddress.address2=m.address2;switch(m.country){case "AU":n.bookingAddress.address3=m.address3+", "+m.state+", "+m.zipCode;break;case "NZ":n.bookingAddress.address3=m.address3+", "+m.city+", "+m.zipCode;break;case "US":case "CA":n.bookingAddress.address3=
m.city+", "+m.state+", "+m.zipCode;break;default:n.bookingAddress.address3=m.address3}n.bookingAddress.address3=n.bookingAddress.address3+", "+m.country}angular.isDefined(A.getSupportedOptions())&&(g=A.getSupportedOptions().supportedInsurances);n.insuranceDisplay=F.mergeInsurance(g,n.confirmation.reservationSummary.insuranceSummaryList);"true"==n.tncRequired?B.load(!0===n.confirmation.reservationSummary.prepayTxn?E.txnTypePrePay:E.txnTypePostPay,n.confirmation.reservationSummary.pickLoc.locationCode).then(function(f){n.CompleteTexNew=
f;x()}):x();n.accordionStatus={baseRate:!0,mileage:!0,rental:!0,discount:!0,fees:!0,cancelFeeC:!0,cancelFeeN:!0,paymentInformtion:!0,tnc:!0,rdmPts:!0};jQuery(".rate-terms-panel").addClass("panel-open");jQuery(".rate-terms-panel .panel-heading").find(".pull-left.s-icon.arrow-right").removeClass("arrow-right").addClass("arrow-down");jQuery(".rate-terms-panel .panel-collapse").addClass("in").css("height","auto");jQuery(".confirmation-page-printversion .confirmation-booking-summary").css("margin-top",
0)},function(g){})};n._printInit();t=y("PrintConfirmationExnController",{$scope:t});angular.extend(this,t)}angular.module("reservation").controller("PrintConfirmationController",t);t.$inject="$scope $rootScope $state $filter $location $controller $timeout $window getDataService locationTermsConditionsService lookupService carRentalConstant confirmationService authenticationService".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C){function x(g){ABG.loadSkeletonLoader({name:g})}var B=this;B.brand=C.brand;B.isModifyFlow=!1;B.step1aPage=p.step1aPageName;B.step2Page=p.step2PageName;B.step3Page=p.step3PageName;B.pageName=l.current.name;B.loadSkeletonLoader=x;if(C=y.getReservationModel())q.reservation=C.displayControls.reservation,B.isBookAgainFlow=C.bookAgain.bookAgainFlow;C=y.getDataBeforeLogoClick();angular.isDefined(C)&&""!=C.prevPage&&C.prevPage!=p.step1aPageName&&(q.reservation=C.prevFlow,
y.deleteDataBeforeLogoClick());B.isModifyFlow=q.reservation==p.resFlowModify;B.chkRedeemedRes=q.chkRedeemedRes;B.cancelModification=function(v){q.requestInProgress=!0;B.reservationModel=y.getReservationModel();x(p.confirmationPage);B.reservationModel.displayControls.reservation=p.resFlowModify;B.reservationModel.displayControls.cancelModify=!0;g.load(v).then(function(g){l.go(p.confirmationPage)},function(g){q.requestInProgress=!1});y.setReservationModel(B.reservationModel)};B.loadHelpModal=function(g){q.$broadcast("loadHelpModal",
g)};$(document).on("click",".step-progress-bar li.processed",function(){q.requestInProgress=!0});t.$watch("$rootScope.reservation",function(){B.isModifyFlow=q.reservation==p.resFlowModify});t=v("ProgressBarExnController",{$scope:t});angular.extend(this,t)}angular.module("carRental").controller("ProgressBarController",t);t.$inject="$scope $rootScope $state $controller carRentalConstant reservationModelService confirmModifications $window".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C,A,B,F,E,w,z,G,n,H,I,u,m,f,D,e,h,r,J){function x(a){({OFFER_AVAILABLE:function(){null!=document.getElementById("up-pay-monthly-container")&&(document.getElementById("up-pay-monthly-container").style.display="block");c.reservationModel.upliftOffer=!0;angular.element(".estimate.mobile-hide").click()},TOKEN_AVAILABLE:function(){c.upliftTokenAvailable=!0;ca("Uplift")},TOKEN_RETRIEVED:function(){c.upliftToken=a.token},OFFER_UNAVAILABLE:function(){null!=document.getElementById("up-label")&&
(document.getElementById("up-label").style.display="none");null!=document.getElementById("up-service-error")&&(document.getElementById("up-service-error").style.display="none");null!=document.getElementById("up-offerUnavailable-error")&&(document.getElementById("up-offerUnavailable-error").style.display="block");c.reservationModel.upliftOffer=!1;angular.element(".estimate.mobile-hide").click()},SERVICE_UNAVAILABLE:function(){null!=document.getElementById("up-label")&&(document.getElementById("up-label").style.display=
"none");null!=document.getElementById("up-offerUnavailable-error")&&(document.getElementById("up-offerUnavailable-error").style.display="none");null!=document.getElementById("up-service-error")&&(document.getElementById("up-service-error").style.display="block")}})[a.status]()}function b(){c.upliftOrderInfo={travelers:[{id:0,first_name:c.reservationModel.personalInfoRQ.firstName,last_name:c.reservationModel.personalInfoRQ.lastName,date_of_birth:""}],rentals:[{type:c.prod.reservationSummary.vehicle.classDescription,
unit_price:Math.round(100*parseFloat(c.prod.reservationSummary.rateSummary.baseRate).toFixed(2)),quantity:1,start_date:c.reservationModel.pickUpDate.replaceAll("-",""),end_date:c.reservationModel.dropDate.replaceAll("-",""),agency:"Budget",insurance:[]}],add_ons:[],order_amount:Math.round(100*parseFloat(c.reservationModel.estimatedTotal).toFixed(2))};var a=0;c.reservationModel.selectedInsurances&&c.reservationModel.selectedInsurances.forEach(function(b,d){a++;c.upliftOrderInfo.add_ons.push({id:a.toString(),
name:b.code,price:100*b.price})});c.reservationModel.selectedProducts&&c.reservationModel.selectedProducts.forEach(function(b,d){a++;c.upliftOrderInfo.add_ons.push({id:a.toString(),name:b.code,price:100*b.price})});return c.upliftOrderInfo}function O(a){a=a||!1;if(f.getReservationModel().displayControls.reservation===u.resFlowCreate&&angular.isDefined(c.prod.reservationSummary)){if(angular.isDefined(window.DigitalWallet)&&angular.isDefined(DigitalWallet.VISA)){var b=DigitalWallet.VISA;ABG.arrayHasObject(window.domain,
b.domainSupport)&&angular.isDefined(c.prod.reservationSummary)&&!1===c.prod.reservationSummary.digitalWalletFlow&&(!0===c.prod.reservationSummary.prepayTxn||a)&&ABG.appendResource(b.scriptPath,"visa_src","script")}angular.isDefined(window.DigitalWallet)&&angular.isDefined(DigitalWallet.AMEXPAY)&&(b=DigitalWallet.AMEXPAY,angular.isDefined(c.prod.reservationSummary)&&!1===c.prod.reservationSummary.digitalWalletFlow&&(!0===c.prod.reservationSummary.prepayTxn||a)&&($("#amex-express-checkout").empty(),
$(".AMEXPAY_src").remove(),ABG.appendResource(b.scriptPath,"AMEXPAY_src","script",{timeout:50,callback:function(){1<$(".AMEXPAY_src").length&&($(".AMEXPAY_src").first().remove(),$("#amex-express-checkout").empty())}})));angular.isDefined(window.DigitalWallet)&&angular.isDefined(DigitalWallet.PAYPAL)&&(b=DigitalWallet.PAYPAL,angular.isDefined(c.prod.reservationSummary)&&!1===c.prod.reservationSummary.digitalWalletFlow&&(!0===c.prod.reservationSummary.prepayTxn||a)&&ABG.appendResource(b.scriptPath,
"PAYPAL_src","script"))}}function S(){$("#errPartnerCode").remove();var a=document.getElementById("memberNumberField");0<a.getElementsByTagName("span").length&&(a.removeChild(a.getElementsByTagName("span")[0]),document.getElementById("Member-Number").classList.remove("platform-element-error"))}function T(a){jQuery(".credit-card-details")[a?"show":"hide"]();w.resetError("vm.secureCode",!0);c.expiredSpan=!c.expiredSpan;c.reservationModel.splitEligible=c.prod.reservationSummary.splitEligible&&!a;c.reservationModel.prepayOpted=
a;if(1!=c.reservationModel.prepayOpted||P)"true"===c.showPayLaterTnC&&(c.getPrepayTnCs(u.txnTypePostPay),P=c.showpaynowTnC=!1);else{O(!0);if(angular.isDefined(window.DigitalWallet)&&angular.isDefined(DigitalWallet.VISA)&&""!=DigitalWallet.VISA.scriptPath)var b=setInterval(function(){angular.isDefined(window.V)&&angular.isDefined(window.V.init)&&(clearInterval(b),c.dwVisaCheckoutReady())},500);c.showpaynowTnC=!0;c.getPrepayTnCs(u.txnTypePrePayOnly);P=!0}0==c.reservationModel.prepayOpted&&(c.showpaynowTnC=
!1);c.creditCardMdl=a;c.creditCardMdl||(c.useCreditBox=c.creditCardMdl);c._handleCreditID();c.isMemberRateAccountCreationEligible&&(c.reservationModel.usebillingAddressAsMailingAddress=!c.reservationModel.prepayOpted||c.reservationModel.digitalWalletFlow&&(!c.reservationModel.digitalWalletFlow||"AMAZON"!=c.walletType&&"PAYPAL"!=c.walletType&&"APPLEPAY"!=c.walletType&&"UPLIFT"!=c.walletType)?!1:!0)}function ia(a){w.resetError("vm.secureCode",!0);1!=c.reservationModel.prepayOpted||P?"true"===c.showPayLaterTnC&&
(c.getPrepayTnCs(u.txnTypePostPay),P=!1):(c.getPrepayTnCs(u.txnTypePrePayOnly),P=!0);c.useCreditBox=a;c.reservationModel.digitalWalletClicked=!1}function da(){"true"==enableAmazonPay&&(new OffAmazonPayments.Widgets.AddressBook({sellerId:sellerId,agreementType:"BillingAgreement",onReady:function(a){angular.isUndefined(c.walletType)&&ca("AMAZON");c.amazonBillingAgreementId=a.getAmazonBillingAgreementId();ba()},onAddressSelect:function(a){},design:{designMode:"responsive"},onError:function(a){U()}})).bind("addressBookWidgetDiv")}
function ba(){"true"==enableAmazonPay&&angular.isDefined(c.amazonBillingAgreementId)&&(new OffAmazonPayments.Widgets.Wallet({sellerId:sellerId,amazonBillingAgreementId:c.amazonBillingAgreementId,onPaymentSelect:function(a){},design:{designMode:"responsive"},onError:function(a){U()}})).bind("walletWidgetDiv")}function ca(a,b){c.useCreditBox=!1;""!==a&&"APPLEPAY"!==a&&dataLayer.push({event:"trackEvent",eventCategory:"step 4",eventLabel:a,eventAction:"Element_Clicks"});K=B.setWalletType(a);K.then(function(d){d.errorList&&
0<d.errorList.length?c.errorDisplayList=q.processErrorMessage(d.errorList):b&&("MASTER"===a?angular.isDefined(window.DigitalWallet)&&angular.isDefined(DigitalWallet.MASTERPASS)&&(d=DigitalWallet.MASTERPASS,!angular.isDefined(c.prod.reservationSummary)||!1!==c.prod.reservationSummary.digitalWalletFlow||!0!==c.prod.reservationSummary.prepayTxn&&"TRUE"!==c.prod.reservationSummary.payNowCheckBoxInd.visible||ABG.appendResource(d.scriptPath,"masterpass_src","script",{callback:function(){b()}})):b());c.secureCode=
"";c.reservationModel.prepayOpted=!0;c.reservationModel.digitalWalletClicked=!0;try{if(sessionStorage.setItem("avis","avis")||"undefined"==typeof sessionStorage.setItem("avis","avis"))sessionStorage.removeItem("avis"),y.sessionStorage.walletClicked=!0}catch(X){y.sessionStorage.walletClicked=!1}1!=c.reservationModel.prepayOpted||P?"true"===c.showPayLaterTnC&&(c.getPrepayTnCs(u.txnTypePostPay),P=!1):(c.getPrepayTnCs(u.txnTypePrePayOnly),P=!0);"AMAZON"==a&&document.location.reload(!0)},function(a){})}
function U(){K=B.clearWallet();K.then(function(a){a.errorList&&0<a.errorList.length?c.errorDisplayList=q.processErrorMessage(a.errorList):($("#amex-express-checkout").empty(),$(".AMEXPAY_src").remove(),angular.isDefined(c.walletType)&&"AMAZON"==c.walletType&&(angular.isDefined(y.amazon)&&"true"==partnerConfig.amazon.enablePartnerBenefit&&amazon.Login.logout(),window.location=y.environmentBaseURL+contextPath+"/"+y.locale+"/reservation"+htmlExtension+"#/review-and-book"),document.location.reload(!0));
c.secureCode="";c.reservationModel.digitalWalletClicked=!1},function(a){});c.reservationModel.digitalWalletFlowModify=!0}function Z(){angular.isDefined(paypal)&&($("#paypal-button-container").empty(),paypal.Button.render({env:window.environmentDetails,style:{label:"paypal",size:"small",shape:"rect",color:"gold",tagline:"false"},client:{sandbox:window.paypalClientId,production:window.paypalClientId},payment:function(a,b){K=B.setWalletType("PAYPAL");dataLayer.push({event:"trackEvent",eventCategory:"step 4",
eventLabel:"PayPal",eventAction:"Element_Clicks"});K.then(function(b){c.secureCode="";if(b.errorList&&0<b.errorList.length)c.errorDisplayList=q.processErrorMessage(b.errorList);else return B.getRequestToken().then(function(b){b.errorList&&0<b.errorList.length?c.errorDisplayList=q.processErrorMessage(b.errorList):angular.isDefined(b.requestToken)&&a(b.requestToken)})})},onAuthorize:function(a,c){return B.getWalletData("GET").then(function(a){y.location.reload()})},onError:function(a){U()},onCancel:function(a){U()}},
"#paypal-button-container"))}function a(){c.reservationModel.digitalWalletFlow=!0;if(angular.isDefined(c.prod.reservationSummary))var a={countryCode:c.prod.reservationSummary.pickLoc.address.country,currencyCode:c.prod.reservationSummary.rateSummary.currencyCode,total:{label:c.brand+" (ESTIMATED TOTAL)",amount:c.prod.reservationSummary.rateSummary.estimatedTotal},supportedNetworks:["amex","masterCard","visa","discover","jcb"],merchantCapabilities:["supports3DS"],requiredBillingContactFields:["postalAddress"]};
var b=new ApplePaySession(2,a);b.begin();b.onvalidatemerchant=function(a){K=B.setWalletType("APPLEPAY");K.then(function(d){B.getRequestToken(a.validationURL).then(function(a){a.errorList&&0<a.errorList.length?c.errorDisplayList=q.processErrorMessage(a.errorList):(a=JSON.parse(a.requestToken),b.completeMerchantValidation(a))})})};b.onpaymentauthorized=function(a){a=a.payment;var d=JSON.stringify(a);JSON.parse(d);K=B.getWalletData("POST",a);K.then(function(a){b.completePayment(ApplePaySession.STATUS_SUCCESS);
c.confirmBooking()})}}function d(){var a;qantas.Button.render({Client:{id:qantasClientId,name:"AVIS"},payment:function(b){a=parseFloat(c.estimatedAmt);return b.createFixedQuote(a)},onAuthorize:function(b){if(angular.isDefined(b.errorCode))m.setStorageData("isQantasError",!0),m.setStorageData("qantasErrorCode",b.errorCode),m.setStorageData("qantasErrorMsg",b.message);else{m.setStorageData("isQantasError",!1);var d=b.currencyAmount;c.balanceAmountVal=parseFloat(a)-parseFloat(d);c.balanceAmountVal=c.balanceAmountVal.toFixed(2);
m.setStorageData("balanceAmount",c.balanceAmountVal);m.setStorageData("qantasData",b);c.prod.reservationSummary.splitEligible=!1}p.reload()},onError:function(a){return a.message},onLoad:function(){},onClicked:function(){},onClosed:function(){}},"#qantas-button-container")}function ea(){var a;qantas.Button.render({Client:{id:qantasClientId,name:"AVIS"},payment:function(b){a=parseFloat(c.estimatedAmt);return b.createQuote(a)},onAuthorize:function(b){if(angular.isDefined(b.errorCode))m.setStorageData("isQantasError",
!0),m.setStorageData("qantasErrorCode",b.errorCode),m.setStorageData("qantasErrorMsg",b.message);else{m.setStorageData("isQantasError",!1);var d=b.currencyAmount;c.balanceAmountVal=parseFloat(a)-parseFloat(d);c.balanceAmountVal=c.balanceAmountVal.toFixed(2);m.setStorageData("balanceAmount",c.balanceAmountVal);m.setStorageData("qantasData",b);c.prod.reservationSummary.splitEligible=!1}p.reload()},onError:function(a){return a.message},onLoad:function(){},onClicked:function(){},onClosed:function(){}},
"#qantas-button-container")}"true"===y.jsProfileConfigFlag&&(y.startTime.review=performance.now());t("ExceptionHandlerController",{$scope:q});C=t("CouponController",{$scope:q});angular.extend(this,C);v.requestInProgress=!0;window.dataLayer=window.dataLayer||[];var K={},P=!1,aa="",Y="",R="",ha="",fa="",L={uName:"",password:"",enableLoyalty:!0},ka={loyaltyDetails:"",pointProducts:"",displayFreedayFlag:"",freedaySectionDisplay:"",freeDayPoints:"",totalreedem:"",redeemableDays:"",pointCheckbox:"",frdProdFlag:!1,
redeemQty:0},la={restrictedCards:"",rentalLocation:""},c=this;c.prod={};c.model={};c.loginModel={};c.pageName=p.current.name;c.helpURL="";c.expMonths=[];c.tempDescription={};c.firstLastNameDisabled=!1;c.gebUserLastName=!1;c.estimatedAmt="";c.balanceAmountVal="";c.qantasLoyaltyEligible=!1;c.chkObj={checkCanada:!1};c.step4Validated=!1;c.creditCardMdl=!1;c.displayEmailOptIn="";c.chkObj.checkCanada="";c.ccMaskingServiceError=!1;c.termsCheckError=!1;c.reservationModel={};c.insurances=[];c.products=[];
c.creditId="";c.authRecognizepromoMails="";c.creditIdCheck=!1;c.maskedCCNumber="";c.flagCanada="";c.airlines={};c.countryList={};c.statesForCountry={};c.statesForMailingAddress={};c.step4PageError="";c.errorDisplayList=[];c.confirmReservation={};c.termsCondition={};c.quoteNumber="";c.qantasErrCode="";c.qantasErrMsg="";c.reservationModel.expiredCC=!1;c.reservationModel.digitalWalletFlow=!1;c.reservationModel.digitalWalletFlowModify=!1;c.reservationModel.digitalWalletClicked=!1;c.currencySymbol="";
c.ages=u.ageList;c.useCreditBox=!1;c.domain=y.domain;c.showCity=!1;c.showState=!1;c.showZipcode=!1;c.showSuburb=!1;c.visaImage=y.visaImage;c.showPayLaterTnC=y.showPayLaterTnC?y.showPayLaterTnC:!1;c.isBookAgainFlow=!1;c.freedaySectionDisplay=!1;c.prefferedPointsFlag=!1;c.pointCheckbox={};c.productCheckbox={};c.rateAmountShow=y.rateAmountShow;c.paylessFlow=!1;c.ccFilled=!1;c.rentalLocationCountry="";c.selectedAddress=function(a){"1"==a?(angular.forEach(c.countryList,function(a){a.code==c.prod.reservationSummary.addresses[0].country&&
(c.reservationModel.paymentRq.address.country=a.name)}),angular.forEach(c.prod.reservationSummary.addresses,function(a){1==a.primary&&(c.reservationModel.paymentRq.address.address1=a.address1,c.reservationModel.paymentRq.address.address2=a.address2,c.reservationModel.paymentRq.address.address3=a.address3,c.reservationModel.paymentRq.address.city=a.city,c.reservationModel.paymentRq.address.state=a.state,c.reservationModel.paymentRq.address.zipCode=a.zipCode,c.indicatorMap.address_id=a.maskId)})):"2"==
a&&(angular.forEach(c.countryList,function(a){a.code==c.prod.reservationSummary.addresses[1].country&&(c.reservationModel.paymentRq.address.country=a.name)}),angular.forEach(c.prod.reservationSummary.addresses,function(a){0==a.primary&&(c.reservationModel.paymentRq.address.address1=a.address1,c.reservationModel.paymentRq.address.address2=a.address2,c.reservationModel.paymentRq.address.address3=a.address3,c.reservationModel.paymentRq.address.city=a.city,c.reservationModel.paymentRq.address.state=a.state,
c.reservationModel.paymentRq.address.zipCode=a.zipCode,c.indicatorMap.address_id=a.maskId)}))};c.brand=y.brand;c.addressDisplayList=[];c.address="1";c.nickName="";c.phoneMaskId="";c.epIndicator=!1;c.indicatorMap={email_id:"1",credit_id:"1",address_id:"1",phone_id:"1"};c.insuranceCheckbox={};c.showUpliftOptionStep4=y.showUpliftOptionStep4;c.enableUplift=y.enableUplift;c.upliftLoad=function(){if(c.displayUpLiftRelatedInfo&&""!=c.reservationModel.personalInfoRQ.firstName&&""!=c.reservationModel.personalInfoRQ.lastName){var a=
b();window.Uplift.Payments.load(a)}};c.showAddressDiv=angular.isDefined(partnerConfig.amazon.sandboxMode)?partnerConfig.amazon.sandboxMode:!1;c.cbpCustomer=H.getCBPCustomerDetails();c.firstNamekeycount=function(){c.fcount+=1;m.setStorageData("firstNameKeystrokes",c.fcount)};c.firstNamecopyPaste=function(){--c.fcount;m.setStorageData("firstNameKeystrokes",c.fcount)};c.lastNamekeycount=function(){c.lcount+=1;m.setStorageData("lastNameKeystrokes",c.lcount)};c.lastNamecopyPaste=function(){--c.lcount;
m.setStorageData("lastNameKeystrokes",c.lcount)};c.ccKeyCount=function(){c.count+=1;m.setStorageData("ccKeystrokes",c.count)};c.ccCopyPaste=function(){--c.count;m.setStorageData("ccKeystrokes",c.count)};c.domain=y.domain.toUpperCase();c.ftpError=!1;c.getLoginModalWindow=function(a){v.$broadcast("LoginActivity",{requestType:"Login",variance:"Small"})};c.selectingCreditCard=function(a){c.creditCardNumber=a.number;c.cardNickname=a.nickName;var b=c.creditCardNumber.match(/(\d+)/g);c.cardNumberLastDigit=
b[0];c.reservationModel.paymentRq.cardType=a.type;c.reservationModel.paymentRq.creditCardToken=a.creditCardToken;c.indicatorMap.credit_id=a.maskId;c.prod.reservationSummary.prepayTxn||c.creditCardMdl||jQuery(".payment-method-field").toggle();if(void 0!=a.expDate&&0<c.expMonths.length){var d=a.expDate.split("/");b=c.expMonths.indexOf(l("filter")(c.expMonths,function(a){return a.key==d[0]})[0]);c.reservationModel.paymentRq.expMonth=c.expMonths[b].key;c.reservationModel.paymentRq.expYear=d[2];a.expMonth=
c.expMonths[b].key;a.expYear=d[2]}B.ccExpiryCall(a).then(function(a){c.prod=a;1!=a.reservationSummary.ccSummary.expiringcc&&1!=a.reservationSummary.ccSummary.expiredcc||a.reservationSummary.userState!=u.userStateAuthenticated||c.loadExpiredSection();angular.isDefined(c.prod.reservationSummary.ccSummary)&&angular.isDefined(a.reservationSummary.ccSummary)&&angular.isDefined(a.reservationSummary.ccSummary.expiredcc)&&angular.isDefined(a.reservationSummary.ccSummary.expiringcc)&&(c.prod.reservationSummary.ccSummary.expiredcc=
a.reservationSummary.ccSummary.expiredcc,c.prod.reservationSummary.ccSummary.expiringcc=a.reservationSummary.ccSummary.expiringcc)})};c.notYou=function(){K=H.logout();K.then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length||angular.isDefined(a.warningList)&&0<a.warningList.length?q.processErrorMessage(a):y.location.href=rootpath+"/home"+htmlExtension},function(a){})};c.checkEmailOptin=function(){c.reservationModel.emailOptinFlag=
c.chkObj.checkCanada};c.getPrepayTnCs=function(a){c.contentType=c.policyPostpayTxnType&&a!=u.txnTypePrePayOnly?u.txnTypePostPay:u.txnTypePrePayOnly;K=z.load(c.contentType,c.reservationModel.pickInfo);K.then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length||angular.isDefined(a.instructionList)&&0<a.instructionList.length||(c.tempDescription=a)})};c.getStatesForCountry=function(a,b){"onchange"==b&&(c.reservationModel.paymentRq.address.address1=
"",c.reservationModel.paymentRq.address.address2="",c.reservationModel.paymentRq.address.address3="",c.reservationModel.paymentRq.address.suburb="",c.reservationModel.paymentRq.address.city="",c.reservationModel.paymentRq.address.state="",c.reservationModel.paymentRq.address.zipCode="");!c.countryList||void 0==a||""==a||a!==u.countryCodeAU&&a!==u.countryCodeCA&&a!==u.countryCodeUS||(b=c.countryList.indexOf(l("filter")(c.countryList,function(c){return c.code===a})[0]),c.statesForCountry=c.countryList[b].stateList);
c._displayFunction(a)};c.getStatesForMailingAddress=function(){var a=c.reservationModel.personalInfoRQ.residency,b=c.countryList;Array.isArray(b)&&0!==b.length||(b=y.countryList,b=angular.fromJson(b?b:{}));if(void 0!=a&&""!=a&&(a===u.countryCodeAU||a===u.countryCodeCA||a===u.countryCodeUS)){var d=b.indexOf(l("filter")(b,function(c){return c.code===a})[0]);c.statesForMailingAddress=b[d].stateList}};c.geteReceiptSupportedCountry=function(a){var c=y.eReceiptSupportedCountries,b=y.expressConsentCountries,
d={};Array.isArray(c)&&-1!=c.indexOf(a.toUpperCase())&&(d.supported=!0);Array.isArray(b)&&-1!=b.indexOf(a.toUpperCase())?d.optin=!1:d.optin=!0;return d};c.selectAddress=function(a,b){b===u.address&&angular.isDefined(a.address.postalCode)&&(c.reservationModel.mailingAddressRQ.address.zipCode=a.address.postalCode,angular.element("#zip").val(a.address.postalCode),angular.element("#zip").trigger("change"),setTimeout(function(){angular.element("#zip").blur()},5));angular.isDefined(a.address.locality)&&
(c.reservationModel.mailingAddressRQ.address.city=a.address.locality);angular.isDefined(a.address.adminDistrict)&&(a=l("filter")(c.statesForMailingAddress,{stateCode:a.address.adminDistrict},!0)[0],a=c.statesForMailingAddress.indexOf(a),-1<a&&(c.reservationModel.mailingAddressRQ.address.state=c.statesForMailingAddress[a].stateCode))};c.termsCheckChanged=function(){c.step4Validated&&!c.reservationModel.paymentRq.acceptTerms&&(c.termsCheckError=!0);c.termsCheckError=!1};c.onOptPrepay=T;c.clearCCInfo=
function(a){c.prod.reservationSummary.ccSummary.expiredcc||c.prod.reservationSummary.ccSummary.expiringcc?(1==c.reservationModel.ccExpiredAuthUserEdit||1==c.ccMaskingServiceError?(c.expiredCreditCardNumber="",c.reservationModel.expiredPaymentRq.cardType="",c.ccMaskingServiceError=!1):(c.prod.reservationSummary.ccSummary.expiredcc||c.prod.reservationSummary.ccSummary.expiringcc)&&c.reservationModel.ccAuthUserEdit&&c.prod.reservationSummary.rateSummary.nonCancellationFeeApplicable?(c.creditCardNumber=
"",c.reservationModel.paymentRq.cardType=""):(c.prod.reservationSummary.ccSummary.expiredcc||c.prod.reservationSummary.ccSummary.expiringcc)&&!c.reservationModel.ccAuthUserEdit&&c.prod.reservationSummary.rateSummary.nonCancellationFeeApplicable?(c.creditCardNumber=c.prod.reservationSummary.ccSummary.number,c.reservationModel.paymentRq.cardType=c.prod.reservationSummary.ccSummary.type):(c.expiredCreditCardNumber=c.prod.reservationSummary.ccSummary.number,c.reservationModel.expiredPaymentRq.cardType=
c.prod.reservationSummary.ccSummary.type),1==c.reservationModel.ccAuthUserEdit||1==c.reservationModel.addAuthCardEdit?(c.creditCardNumber="",c.reservationModel.expiredPaymentRq.cardType=""):(c.creditCardNumber=c.prod.reservationSummary.ccSummary.number,c.reservationModel.paymentRq.cardType=c.prod.reservationSummary.ccSummary.type)):1==c.reservationModel.ccAuthUserEdit||1==c.reservationModel.addAuthCardEdit||1==c.ccMaskingServiceError?(c.creditCardNumber="",c.reservationModel.paymentRq.cardType="",
c.ccMaskingServiceError=!1,c.nickName=""):(c.creditCardNumber=c.prod.reservationSummary.ccSummary.number,c.reservationModel.paymentRq.cardType=c.prod.reservationSummary.ccSummary.type);c.isBookAgainFlow&&ia(a);angular.isDefined(c.prod.reservationSummary.ccSummary.number)&&1==c.ccFilled&&(c.ccFilled=!1)};c.confirmBooking=function(){0==c.ftpError?(v.requestInProgress=!0,document.getElementById("submit_button").disabled=!0):v.requestInProgress=!1;c.reservationModel.promoMail=c.chkObj.checkCanada;c.reservationModel.displayBusinessClubOptIn=
1==c.buisnessOptIn?!0:!1;c.reservationModel.displayControls.reservation===u.resFlowCreate&&c.prod.reservationSummary.gebUser&&(c.reservationModel.personalInfoRQ.residency=c.prod.reservationSummary.address.country);c.creditCardNumber&&(c.creditCardNumber=c.creditCardNumber.replace(/\s+/g,""));var a={cardNumber:c.creditCardNumber,secureCode:c.secureCode,expiredSecureCode:c.expiredSecureCode,expiredCreditCardNumber:c.expiredCreditCardNumber,saveCreditCard:c.saveCreditCard};c.displayUpLiftRelatedInfo&&
null!=document.getElementById("payMonthly")&&1==document.getElementById("payMonthly").checked&&angular.isDefined(c.upliftToken)&&(a.secureCode=c.upliftToken.card_ccv);1==c.reservationModel.addAuthUserEdit&&(c.reservationModel.paymentRq.address.address1=c.address1,c.reservationModel.paymentRq.address.address2=c.address2,c.reservationModel.paymentRq.address.address3=c.address3,c.reservationModel.paymentRq.address.city=c.city,c.reservationModel.paymentRq.address.state=c.state,c.reservationModel.paymentRq.address.zipCode=
c.zipCode,c.indicatorMap.address_id="");1==c.saveCreditCard&&(c.reservationModel.paymentRq.nickName=c.nickName,c.reservationModel.paymentRq.creditCardToken="");angular.forEach(c.countryList,function(a){a.name==c.reservationModel.paymentRq.address.country&&(c.reservationModel.paymentRq.address.country=a.code)});if(""!=c.reservationModel.wizardNumber){var b={email_id:angular.isDefined(c.indicatorMap.email_id)&&""!=c.indicatorMap.email_id?c.indicatorMap.email_id:"1",address_id:angular.isDefined(c.indicatorMap.address_id)&&
!/^[a-zA-Z0-9]*$/.test(c.reservationModel.paymentRq.address.address1)?c.indicatorMap.address_id:"",phone_id:angular.isDefined(c.indicatorMap.phone_id)&&!/^[0-9]*$/.test(c.reservationModel.personalInfoRQ.phone)?c.indicatorMap.phone_id:"",credit_id:angular.isDefined(c.indicatorMap.credit_id)&&!/^[0-9]*$/.test(c.creditCardNumber)?c.indicatorMap.credit_id:"",epIndicator:c.epIndicator};D.addToIndicatorMap(b)}angular.isDefined(c.prod.reservationSummary.digitalWalletFlow)&&angular.isDefined(c.amazonBillingAgreementId)&&
(c.reservationModel.digitalWalletFlow=c.prod.reservationSummary.digitalWalletFlow,c.reservationModel.billingAgreementId=c.amazonBillingAgreementId);angular.isDefined(c.prod.reservationSummary.digitalWalletFlow)&&"PAYPAL"==c.prod.reservationSummary.walletType&&angular.isDefined(c.prod.reservationSummary.customerWalletGenericRS)&&angular.isDefined(c.prod.reservationSummary.customerWalletGenericRS.paymentCard)&&angular.isDefined(c.prod.reservationSummary.customerWalletGenericRS.paymentCard.billingAgreementId)&&
(c.reservationModel.digitalWalletFlow=c.prod.reservationSummary.digitalWalletFlow,c.reservationModel.billingAgreementId=c.prod.reservationSummary.customerWalletGenericRS.paymentCard.billingAgreementId);D.addToCreditCardData(a);f.setReservationModel(c.reservationModel);c.reservationModel.displayControls.reservation===u.resFlowModify?c.reviewModifications():(K=F.load(),K.then(function(a){if(angular.isDefined(a)){v.requestInProgress=!1;if(angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length){c.secureCode=
"";var b=[],d;angular.forEach(a.fieldErrors,function(a,c){d=angular.equals(a.field,"vm.reservationModel.paymentRq.cardType")?{message:w.displayServiceError("vm.creditCardNumber","invalidcard")}:{message:w.displayServiceError(a.field,a.classifier)}});1<a.fieldErrors.length&&(d={message:Dictionary.I18n.get("err.res.mutliplemsg")});b.push(d);c.errorDisplayList=b;c.errorList=h.handleRateCodeMainFrameError(c.errorDisplayList);if(1==c.displayUpLiftRelatedInfo&&window.Uplift.Payments&&(void 0!=c.errorList||
0!=c.errorList.length)){var k="";b=c.errorList;angular.forEach(b,function(a,c){k=k+b[c].message+", "});k=k.substring(0,k.length-2);window.Uplift.Payments.error(k,"validation")}$(window).scrollTop(0);document.getElementById("submit_button").disabled=!1}else if(angular.isDefined(a.errorList)&&0<a.errorList.length){a=q.processErrorMessage(a);angular.forEach(a.errorList,function(c,b){angular.equals(c.code,"1112")?w.displayServiceError("vm.reservationModel.iataNumber","optional"):angular.equals(c.code,
"10103")?(H.setHideRedemptionOption(!0),a.errorList[b].message=Dictionary.I18n.get("10103",[y.location.pathname+"#/extras"])):angular.equals(c.code,"239")?w.displayServiceError("vm.reservationModel.flightNumber","flightnomessage"):(angular.equals(c.code,"100350")||angular.equals(c.code,"100352")||angular.equals(c.code,"100353"))&&m.deleteStorageData("qantasData")});angular.isDefined(a.couponErrorList)&&(c.couponErrorList=a.couponErrorList);c.errorDisplayList=a.errorList;c.errorDisplayList=h.handleRateCodeMainFrameError(c.errorDisplayList);
1!=c.displayUpLiftRelatedInfo||!window.Uplift.Payments||void 0==c.errorDisplayList&&0==c.errorDisplayList.length||(k="",b=c.errorDisplayList,angular.forEach(b,function(a,c){k=k+b[c].message+", "}),k=k.substring(0,k.length-2),window.Uplift.Payments.error(k,"validation"));c.secureCode="";c.expiredSecureCode&&(c.expiredSecureCode="");if(angular.isUndefined(c.reservationModel.splitBillSummary)||angular.isDefined(c.reservationModel.splitBillSummary)&&angular.isDefined(c.reservationModel.splitBillSummary.splitConfirmed)&&
!c.reservationModel.splitBillSummary.splitConfirmed)c.ccMaskingServiceError=!0;if(angular.isDefined(c.creditCardNumber)){c.chinaUnionCard=!1;var f=null;f=c.creditCardNumber.substring(0,8);if(624E5<=f&&62699999>=f||6282E4<=f&&62889999>=f||62212600<=f&&62292599>=f)c.chinaUnionCard=!0;c.maskedCCNumber=c.creditCardNumber.replace(/.(?=.{4})/g,"x")}v.requestInProgress=!1;document.getElementById("submit_button").disabled=!1;$(window).scrollTop(0)}else{c.model=a;angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.userState)&&
a.reservationSummary.userState!=u.userStateAnonymous&&(H.setCustomerModel(H.setCustomerData(a)),H.setSessionModel(H.setSessionData(a)));void 0!=c.model.reservationSummary.loyaltyDetails&&c.model.reservationSummary.userState==u.userStateAuthenticated&&(H.setLoyaltyDetails(H.setLoyaltyDetailsData(c.model)),v.$broadcast("loyaltyUpdated",a));if(c.reservationModel.displayControls.reservation===u.resFlowCreate){m.deleteStorageData("upcomingReservations");D.deleteConcurTripList();if(angular.isDefined(m.getStorageData("qantasData"))||
angular.isDefined(m.getStorageData("qantasMessage")))m.deleteStorageData("qantasData"),m.deleteStorageData("qantasMessage");"au"!==y.domain.toLowerCase()&&"nz"!==y.domain.toLowerCase()&&e.addEcommerceEvent(c,"purchase");p.go(u.confirmationPage)}m.deleteStorageData("firstNameKeystrokes");m.deleteStorageData("lastNameKeystrokes");m.deleteStorageData("ccKeystrokes")}setTimeout(function(){ABG.updateContextStores()},100)}},function(a){document.getElementById("submit_button").disabled=!1;1==c.displayUpLiftRelatedInfo&&
window.Uplift.Payments&&(a=Dictionary.I18n.get("err.res.genericerrormsg,"+brand),window.Uplift.Payments.error(a,"fatal"))}))};c.getncfmessage=function(){angular.isDefined(c.prod.reservationSummary.rateSummary.disclosureFeeMsg)&&(c.ncfmessage=c.prod.reservationSummary.rateSummary.disclosureFeeMsg.values[0])};c.reviewModifications=function(){angular.isDefined(c.chkObj)&&(c.reservationModel.promoMail=c.chkObj.checkCanada);f.setReservationModel(c.reservationModel);c.reservationModel.displayControls.reservationFlow=
u.resFlowModify;K=G.load();K.then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length?(a=q.processErrorMessage(a),c.errorDisplayList=a.errorList,c.errorDisplayList=h.handleRateCodeMainFrameError(c.errorDisplayList),document.getElementById("submit_button").disabled=!1,v.requestInProgress=!1):(c.model=a,v.$broadcast("splitBillSummaryUpdate",a),p.go(u.modifyReviewConfirmPage))},function(a){})};c.confirmReservationSubmit=function(a){c.displayUpLiftRelatedInfo&&
null!=document.getElementById("payMonthly")&&1==document.getElementById("payMonthly").checked&&(window.Uplift.Payments.getToken(),c.sendUpliftToken());c.step4Validated=!1;document.getElementById("submit_button").disabled=!0;c.reservationModel.ftpDetails.partnerName="";jQuery("#avisLoader").removeClass("hidden");jQuery("#step2Placeholder").addClass("hidden");jQuery("#step3Placeholder").addClass("hidden");jQuery("#defaultLoader").removeClass("hidden");jQuery("#budgetStep2Placeholder").addClass("hidden");
jQuery("#budgetStep3Placeholder").addClass("hidden");angular.isDefined(c.prod.reservationSummary)&&angular.isDefined(c.prod.reservationSummary.flightInfo)&&"TRUE"===c.prod.reservationSummary.flightInfo.visible&&"WI"==c.reservationModel.airlineCode&&(c.reservationModel.flightNumber=null);angular.isDefined(c.reservationModel)&&angular.isDefined(c.reservationModel.paymentRq)&&angular.isDefined(c.reservationModel.paymentRq.expDate)&&""!=c.reservationModel.paymentRq.expDate&&(null==c.reservationModel.paymentRq.expMonth||
null==c.reservationModel.paymentRq.expYear)&&c.assignMonthYear(c.reservationModel.paymentRq.expDate);"au"!=c.domain.toLowerCase()&&"nz"!=c.domain.toLowerCase()||"TRUE"!=c.prod.reservationSummary.ftpDetails.visible?w.validate(a).success(c._validationSuccess).error(c._validationError):(c._validateFTPData(),void 0!=c.errorList&&0<c.errorList.length?(c.ftpError=!0,c.ftpSectErrList=c.errorList,document.getElementById("ftpSectionForm").scrollIntoView(),document.getElementById("submit_button").disabled=
!1):(c.ftpSectErrList="",c.ftpError=!1,w.validate(a).success(c._validationSuccess).error(c._validationError)));angular.isDefined(c.creditId)&&""!=c.creditId&&(c.reservationModel.paymentRq.cardType=c.creditId)};c.printDiv=function(a,c){a=$("#terms-condition-txt").html();var b=window.open("","PrintTC","height\x3d400,width\x3d800,scrollbars\x3dyes");angular.isDefined(c)&&c?b.document.write("\x3chtml\x3e\x3chead\x3e\x3ctitle\x3e"+Dictionary.I18n.get("lbl.res.checkout.tnc.printPageTitle")+"\x3c/title\x3e"):
b.document.write("\x3chtml\x3e\x3chead\x3e\x3ctitle\x3e"+Dictionary.I18n.get("lbl.res.checkout.tnc.paylaterPrintPageTitle")+"\x3c/title\x3e");b.document.write("\x3c/head\x3e\x3cbody\x3e");b.document.write("\x3c/body\x3e\x3c/html\x3e");angular.element(b.document.body).html(a);b.document.close();b.print()};c.validatePhoneNumber=function(a){if(c.reservationModel.personalInfoRQ.smsOptIn||c.prod.reservationSummary.vehicleDeliveryFlag)if(angular.isDefined(c.reservationModel.personalInfoRQ.phone)&&""!=c.reservationModel.personalInfoRQ.phone)if(angular.isDefined(c.reservationModel.personalInfoRQ.phone)&&
w.validateField("vm.reservationModel.personalInfoRQ.phone",!0,a)){if(angular.isDefined(c.prod.reservationSummary)&&angular.isDefined(c.prod.reservationSummary.personalInfo)&&angular.isDefined(c.prod.reservationSummary.personalInfo.phoneNumbers))for(a=0;a<c.prod.reservationSummary.personalInfo.phoneNumbers.length;a++)c.reservationModel.personalInfoRQ.phone==c.prod.reservationSummary.personalInfo.phoneNumbers[a].phoneNumber&&(c.phoneMaskId=c.prod.reservationSummary.personalInfo.phoneNumbers[a].maskId);
B.phoneNumberValidation(c.reservationModel.personalInfoRQ.phone,c.phoneMaskId).then(function(a){if(angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length){for(var b=0;b<a.fieldErrors.length;b++)"phoneNumber"==a.fieldErrors[b].fieldName&&w.displayServiceError("vm.reservationModel.personalInfoRQ.phone","uscan");c.reservationModel.personalInfoRQ.phone="";c.reservationModel.personalInfoRQ.smsOptIn=!1}else if(angular.isDefined(a.errorList)&&0<a.errorList.length)for(b=0;b<a.errorList.length;b++){var d=
a.errorList[b];"ERROR"===d.type&&"700020"===d.code?(w.displayServiceError("vm.reservationModel.personalInfoRQ.phone","required",!0),c.reservationModel.personalInfoRQ.phone="",c.reservationModel.personalInfoRQ.smsOptIn=!1):"ERROR"===d.type&&"700022"===d.code?(w.displayServiceError("vm.reservationModel.personalInfoRQ.phone","maskedphonenumber",!0),c.reservationModel.personalInfoRQ.phone="",c.reservationModel.personalInfoRQ.smsOptIn=!1):"ERROR"===d.type&&"86"===d.code&&(w.displayServiceError("vm.reservationModel.personalInfoRQ.phone",
"uscan",!0),c.reservationModel.personalInfoRQ.phone="",c.reservationModel.personalInfoRQ.smsOptIn=!1)}})}else w.displayServiceError("vm.reservationModel.personalInfoRQ.phone","invalid",!0);else w.displayServiceError("vm.reservationModel.personalInfoRQ.phone","required",!0)};c.loadExpiredSection=function(){if(c.prod.reservationSummary.ccSummary.expiredcc||c.prod.reservationSummary.ccSummary.expiringcc){if(null==c.reservationModel.expiredPaymentRq.cardType&&(c.reservationModel.expiredPaymentRq.cardType=
c.prod.reservationSummary.ccSummary.type,c.expiredCreditCardNumber=c.prod.reservationSummary.ccSummary.number),angular.isDefined(c.prod.reservationSummary.ccSummary.expDate)&&0<c.expMonths.length){var a=c.prod.reservationSummary.ccSummary.expDate.split("/"),b=c.expMonths.indexOf(l("filter")(c.expMonths,function(c){return c.key==a[0]})[0]);c.reservationModel.expiredPaymentRq.expMonth=c.expMonths[b].key;c.reservationModel.expiredPaymentRq.expYear=a[2]}}else c.reservationModel.expiredPaymentRq.cardType=
"",c.expiredCreditCardNumber=""};c.setWalletType=ca;c.processMasterPassLightBox=function(){K=B.getMasterPassToken();K.then(function(a){if(a.errorList&&0<a.errorList.length)c.errorDisplayList=q.processErrorMessage(a.errorList);else var b=setInterval(function(){angular.isDefined(window.MasterPass)&&angular.isDefined(window.MasterPass.client)&&angular.isDefined(window.MasterPass.client.checkout)&&(clearInterval(b),MasterPass.client.checkout({requestToken:a.requestToken,callbackUrl:a.callbackUrl,merchantCheckoutId:a.merchantCheckoutId,
cancelCallback:a.cancelCallback,suppressShippingAddressEnable:a.suppressShippingAddressEnable,allowedCardTypes:"master,visa",loyaltyEnabled:a.loyaltyEnabled,requestBasicCheckout:!1,version:a.version}))},50)},function(a){})};c.clearWallet=U;c.onOptCC=ia;c.toggleBoolean=function(){c.isToggled=!c.isToggled;c.reservationModel.expiredCC=c.isToggled?!0:!1};c.clickCCModifyIcon=function(){c.creditIdCheck=!1;c.reservationModel.ccAuthUserEdit=!0;c.ccMaskingServiceError=!0;c.clearCCInfo();c.reservationModel.ccAuthUserEdit=
!1};c.loadHelpModal=function(a){c.helpURL=h.getUrl(a.target.parentElement,c.prod.reservationSummary.pickLoc.address.country)};c.cancelDiscountModal=function(){c.cancelDicountUtility(c,Y,R,"",ha,fa)};c.checkLockClass=function(){return B.checkLockClass(c.prod)};c.checkCardNumber=function(a){return B.checkCardNumber(a,c.prod,c.reservationModel,c.creditIdCheck)};c.isUnderAgePrePay=function(){return B.isUnderAgePrePay(c.prod,c.reservationModel)};c.showLoginModal=function(){return B.showLoginModal(c.prod)};
c.showExpiringLoginModal=function(){return B.showExpiringLoginModal(c.prod)};c.showExpiredLoginModal=c.showExpiredLoginModal;c.creditCardNotRequired=function(){return B.creditCardNotRequired(c.prod,c.creditCardMdl)};c.analytics=function(a){var b={event:"analyticsVPV"};b.vpvName="/vpv/linkClickPage-"+a+c.pageName;dataLayer.push(b)};c.gtmBlur=function(a,c,b){if("text"==b)var d=a?"Filled In":"Skipped";else"check"==b?d=a?"Checked In":"Skipped":"drop"==b&&(d=a?"Selected":"Not Selected");dataLayer.push({event:"trackEvent",
eventCategory:"Tracking Form: confirmationForm",eventLabel:c,eventAction:d})};c.updateExpiredCard=function(a){null===a||""===a?c.expiredCreditCardNumber=c.prod.reservationSummary.ccSummary.number:(c.expiredCreditCardNumber=a,c.creditCardNumber=c.expiredCreditCardNumber)};c.editExpiredCard=function(a){w.resetError("vm.expiredCreditCardNumber",!0);c.reservationModel.ccExpiredAuthUserEdit=!0;c.expiredCreditCardNumber=null};c.checkCreditCardDisplay=function(){return B.checkCreditCardDisplay(c.reservationModel)};
c.checkNcfState=function(){return B.checkNcfState(c.prod,c.creditCardMdl)};c.loadTermsAndCondition=function(){v.requestInProgress=!0;var a=B.getTermsConditionModel(c.reservationModel);B.getSmsTermsAndCondition(a).then(function(a){c.termsCondition=a;$(".reservation-flow-sms .modal-body").scrollTop(0);v.requestInProgress=!1},function(){c.termsCondition={};v.requestInProgress=!1})};c.dwVisaCheckoutReady=function(){if(angular.isDefined(c.prod.reservationSummary.prepayInfo)){var a="";y.brand===u.brandName.AVIS?
a="avis":y.brand===u.brandName.BUDGET&&(a="avisbudget");V.init({apikey:y.visaApi,dataLevel:u.visaData,externalProfileId:a,paymentRequest:{currencyCode:c.prod.reservationSummary.prepayInfo.currency,total:c.prod.reservationSummary.prepayInfo.amount}});V.on("payment.success",function(a){a=JSON.stringify(a);a=JSON.parse(a);window.location.href=apiurl+"/res-checkout/walletData?callID\x3d"+a.callid});V.on("payment.cancel",function(a){});V.on("payment.error",function(a,b){a=JSON.stringify(b);a=JSON.parse(a);
c.errorDisplayList=q.processErrorMessage(a)})}};c.checkCCtype=function(){if(y.brand==u.brandName.BUDGET||angular.isDefined(c.prod.domainConfigControl.displayElementMap.showcreditCardInfo)&&!0===c.prod.domainConfigControl.displayElementMap.showcreditCardInfo.visible)w.setExpression({credircard:u.cardExpressions[c.reservationModel.paymentRq.cardType]}),!1===w.validateCCOCreditcard("vm.creditCardNumber")&&w.resetError("vm.creditCardNumber")};c.getCreditCardType=function(a){angular.isDefined(a)&&angular.isDefined(a.reservationSummary)&&
angular.isDefined(a.reservationSummary.ccSummary)&&c.reservationModel.displayControls.reservation===u.resFlowModify&&c.pageName==u.step4PageName&&(c.modifyCreditCardType=ABG.getCreditCardMap(a.reservationSummary.ccSummary.type))};c.bookAgainVehicleRates=function(){p.go(u.bookAgainVehiclePage)};c.selectingEmail=function(a){c.reservationModel.personalInfoRQ.email=a.email;c.indicatorMap.email_id=a.maskId;c.reservationModel.emailOptinFlag=!1;c.chkObj.checkCanada=!1;D.addToIndicatorMap(c.indicatorMap)};
c.selectingPhoneNumber=function(a){c.reservationModel.personalInfoRQ.phone=angular.copy(a.phoneNumber);c.reservationModel.personalInfoRQ.smsOptIn="T"==a.smsOptIn?!0:!1;c.indicatorMap.phone_id=angular.copy(a.maskId);D.addToIndicatorMap(c.indicatorMap);angular.forEach(c.prod.reservationSummary.personalInfo.phoneNumbers,function(c){c.selected=c.phoneNumber==a.phoneNumber&&c.maskId==a.maskId?!0:!1});setTimeout(function(){w.resetError("vm.reservationModel.personalInfoRQ.phone",!1)},100);c.prod.reservationSummary.vehicleDeliveryFlag&&
c.validatePhoneNumber()};c.loadQantasButton=d;c.productUpsellCode="";c.showUpsellMessage=!1;c.promoCouponMessage=function(){if(angular.isDefined(c.prod.reservationSummary)&&c.reservationModel.displayControls.reservation==u.resFlowCreate&&void 0!=c.prod.reservationSummary.promotionalCoupon&&""!=c.prod.reservationSummary.promotionalCoupon)return c.prod.reservationSummary.digitalWalletFlow||!0!==c.reservationModel.prepayProcessIndicator||"FALSE"!=c.reservationModel.payNowCheckBoxInd.visible?c.prod.reservationSummary.digitalWalletFlow||
"TRUE"!=c.reservationModel.payNowCheckBoxInd.visible||!0!==c.creditCardMdl?!1:!0:!0};c._productUpsellMessage=function(){c.reservationModel=f.getReservationModel();var a=I.productUpsellMessage(c.reservationModel.selectedProducts);c.showUpsellMessage=a.showUpsellMessage;c.productUpsellCode=a.productUpsellCode;c.reservationModel.selectedProducts=a.selectedProducts;f.setReservationModel(c.reservationModel)};c._displayFunction=function(a){c.showCity=a==u.countryCodeCA||a==u.countryCodePR||a==u.countryCodeUS||
a==u.countryCodeCX||a==u.countryCodeCV||a==u.countryCodeVI?!0:!1;c.showState=a==u.countryCodeAU||a==u.countryCodeCA||a==u.countryCodeUS||a==u.countryCodeNZ?!0:!1;c.showSuburb=a==u.countryCodeAU||a==u.countryCodeNZ?!0:!1;c.showZipcode=c.showSuburb||c.showCity?!0:!1};c._onPageLoad=function(){jQuery("body").off("click");jQuery("body").on("click","#bluetxt, #expandTermsAUNZ",function(){jQuery(".step4-termstxt").children(".terms-condition-section").toggleClass("collapse")});angular.element("#cardnumber").val("");
angular.element("#securitycode").val("");c._getReviewData();c.customerData=H.getCustomerModel();c._productUpsellMessage();angular.isDefined(window.enableApplePay)&&"true"==window.enableApplePay&&y.ApplePaySession&&ApplePaySession.canMakePaymentsWithActiveCard(window.merchantId)&&(c.canMakePayments=!0);angular.isDefined(c.reservationModel.paymentRq.expMonth)&&""==c.reservationModel.paymentRq.expMonth&&(c.reservationModel.paymentRq.expMonth=null);angular.isDefined(c.reservationModel.paymentRq.expYear)&&
""==c.reservationModel.paymentRq.expYear&&(c.reservationModel.paymentRq.expYear=null);angular.isDefined(c.reservationModel.paymentRq.address.state)&&""==c.reservationModel.paymentRq.address.state&&(c.reservationModel.paymentRq.address.state=null);angular.isDefined(c.reservationModel.paymentRq.cardType)&&""==c.reservationModel.paymentRq.cardType&&(c.reservationModel.paymentRq.cardType=null);void 0==m.getStorageData("qantasData")&&(c.qantasMessage=m.getStorageData("qantasMessage"));angular.isDefined(m.getStorageData("isQantasError"))&&
1==m.getStorageData("isQantasError")&&(c.qantasErrCode=m.getStorageData("qantasErrorCode"),c.qantasErrMsg=Dictionary.I18n.get("lbl.qantas.errorMsg,avis"))};c._getReviewData=function(){if(p.current.name===u.bookAgainPayNowPage||p.current.name===u.bookAgainPayLaterPage)v.$progressbar.activeItem=4;c.isBookAgainFlow=f.isBookAgainFlow(c.pageName);B.getData().then(function(a){v.reservationReviewData=a;c.memberElligibleLengthOfRental=!1;c.memberElligibleCarClass=!1;c.ftpreferred=!1;c.reservationModel=f.getReservationModel();
c._hideSplitPaymentZeApac(a);angular.isDefined(a)&&angular.isDefined(a.customerInfo)&&angular.isDefined(a.customerInfo.discountNumber)&&angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.awdNumber)&&angular.isDefined(a.reservationSummary.memberRatesDiscountApplied)&&a.reservationSummary.memberRatesDiscountApplied&&(angular.isDefined(a)&&angular.isDefined(a.webHeader)&&angular.isDefined(a.webHeader.p13nDetailsMap)&&angular.isDefined(a.webHeader.p13nDetailsMap.lor)&&3<=
a.webHeader.p13nDetailsMap.lor&&(c.memberElligibleLengthOfRental=!0),angular.isDefined(a)&&angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.vehicle)&&angular.isDefined(a.reservationSummary.vehicle.carClass)&&("B"==a.reservationSummary.vehicle.carClass||"C"==a.reservationSummary.vehicle.carClass||"D"==a.reservationSummary.vehicle.carClass||"E"==a.reservationSummary.vehicle.carClass)&&(c.memberElligibleCarClass=!0),angular.isDefined(a)&&angular.isDefined(a.customerInfo)&&
angular.isDefined(a.customerInfo.ftpreferred)&&a.customerInfo.ftpreferred&&(c.ftpreferred=!0));angular.isDefined(a)&&angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.rateSummary)&&angular.isDefined(a.reservationSummary.rateSummary.estimatedTotal)&&(c.reservationModel.estimatedTotal=a.reservationSummary.rateSummary.estimatedTotal,f.setReservationModel(c.reservationModel));c.reservationModel.creditcard=!1;c.qantasLoyaltyEligible=a.reservationSummary.qantasLoyaltyEligible;
angular.isDefined(c.reservationModel.prepayProcessIndicator)&&!1===c.reservationModel.prepayProcessIndicator&&!0===c.qantasLoyaltyEligible&&angular.isDefined(window.PartnerPay)&&angular.isDefined(PartnerPay.QANTAS)&&ABG.appendResource(PartnerPay.QANTAS.scriptPath,"QANTAS_src","script");angular.isDefined(a.reservationSummary.splitBillSummary)&&1==a.reservationSummary.splitEligible&&(a.reservationSummary.qantasLoyaltyEligible=!1,c.reservationModel.qantasLoyaltyEligible=a.reservationSummary.qantasLoyaltyEligible,
f.setReservationModel(c.reservationModel));c.reservationModel.displayControls.reservation==u.resFlowModify&&""!=c.reservationModel.iataNumber&&(v.iataNum=!0);c.reservationModel?c._reviewDataProcess(a):f.load(a,!0).then(function(b){c.reservationModel=b;c._reviewDataProcess(a)})},function(a){})};c._dataProcess=function(){angular.extend(c.loginModel,L);H.setHideRedemptionOption(!1);c.reservationModel=f.getReservationModel();c.reservationModel.addAuthUserEdit=!1;c.reservationModel.addAuthCardEdit=!1;
c.estimatedTotalIncents=Math.round(100*parseFloat(c.reservationModel.estimatedTotal).toFixed(2));c.reservationModel.displayControls.reservation==u.resFlowCreate&&void 0!=c.reservationModel.personalInfoRQ.lastNameTemp&&""!=c.reservationModel.personalInfoRQ.lastNameTemp&&(c.reservationModel.personalInfoRQ.lastName=c.reservationModel.personalInfoRQ.lastNameTemp);var a=D.getConfirmationData();a&&a.errorList&&0<a.errorList.length&&angular.forEach(a.errorList,function(b){"1112"==b.code&&(a=q.processErrorMessage(a),
c.errorDisplayList=a.errorList)});void 0!=c.reservationModel&&c.reservationModel.prepayProcessIndicator&&(c.creditCardMdl=c.reservationModel.prepayProcessIndicator);c.prod.reservationSummary.gebUser&&"TRUE"==c.prod.reservationSummary.ccsection.visible&&(c.creditCardMdl=!0);c._populateBillingInfoCountryList();c._loadMnthYrDropdown();angular.isDefined(c.prod.reservationSummary)&&angular.isDefined(c.prod.reservationSummary.addresses)&&c._getAddressList(c.prod.reservationSummary.addresses);if(""==c.reservationModel.confirmationNumber||
""!=c.reservationModel.confirmationNumber&&!c.reservationModel.paymentRq.address.country&&""!=c.reservationModel.personalInfoRQ.residency)c.reservationModel.paymentRq.address.country=c.reservationModel.personalInfoRQ.residency;c.getStatesForCountry(c.reservationModel.paymentRq.address.country,"onload");void 0!=c.reservationModel.coupon&&(Y=c.reservationModel.coupon.couponNumber,ha=c.reservationModel.coupon.couponQuantity,R=c.reservationModel.coupon.discountNumber,fa=c.reservationModel.rentalType);
c.ratecodeNumberTemp=c.reservationModel.coupon.couponRateCode;c.prod.reservationSummary.userState==u.userStateAuthenticated&&(c.prod.reservationSummary.ccSummary&&c.prod.reservationSummary.ccSummary.number?c._handleCC():(c.reservationModel.ccAuthUserEdit=!0,c.creditIdCheck=!0));angular.isDefined(c.prod.reservationSummary)&&angular.isDefined(c.prod.reservationSummary.addresses)&&1<=c.prod.reservationSummary.addresses.length&&(angular.forEach(c.countryList,function(a){a.code==c.prod.reservationSummary.addresses[0].country&&
(c.country=a.name)}),angular.forEach(c.prod.reservationSummary.addresses,function(a){1==a.primary&&(c.reservationModel.paymentRq.address.address1=a.address1,c.reservationModel.paymentRq.address.address2=a.address2,c.reservationModel.paymentRq.address.address3=a.address3,c.reservationModel.paymentRq.address.city=a.city,c.reservationModel.paymentRq.address.state=a.state,c.reservationModel.paymentRq.address.zipCode=a.zipCode)}));angular.isDefined(c.prod.reservationSummary.createAccountSection)&&angular.isDefined(c.prod.reservationSummary.createAccountSection.visible)?
c.reservationModel.createAccountSection={visible:c.prod.reservationSummary.createAccountSection.visible}:c.reservationModel.createAccountSection={visible:"FALSE"};c.isMemberRateAccountCreationEligible=v.isAnonymous&&!v.isPartnerAuth&&c.reservationModel.displayControls.reservation==u.resFlowCreate&&"TRUE"==c.reservationModel.createAccountSection.visible;c.isMemberRateAccountCreationEligible&&(c.reservationModel.showcreateAccountToggle=!c.reservationModel.memberRateSelected,c.reservationModel.createAccountToggle=
c.reservationModel.memberRateSelected?!0:!1,c.reservationModel.emailAddressAsUsername=!0,!c.reservationModel.prepayOpted||c.reservationModel.digitalWalletFlow&&(!c.reservationModel.digitalWalletFlow||"AMAZON"!=c.walletType&&"PAYPAL"!=c.walletType&&"APPLEPAY"!=c.walletType&&"UPLIFT"!=c.walletType)?c.reservationModel.usebillingAddressAsMailingAddress=!1:(c.reservationModel.usebillingAddressAsMailingAddress=!0,c.reservationModel.walletType=c.walletType),c.getStatesForMailingAddress(),c.reservationModel.personalInfoRQ.eRecieptOptin=
c.geteReceiptSupportedCountry(c.reservationModel.personalInfoRQ.residency).optin)};c._populateBillingInfoCountryList=function(){var a=y.countryList;c.countryList=angular.fromJson(a?a:{});c._setCORAsBillingCountry()};c._loadMnthYrDropdown=function(){var a=ABG.loadMonthAndYear();c.expMonths=a.expMonths;c.expYears=a.expYears};c._getAddressList=function(a){angular.forEach(a,function(a){var b={code:"",description:""};"1"==a.maskId&&(b.code="1",b.description="Primary Address",c.addressDisplayList.push(b));
"2"==a.maskId&&(b.code="2",b.description="Secondary Address",c.addressDisplayList.push(b))});return c.addressDisplayList};c._getReservationReview=function(a){void 0!=a&&""!=a?c._getReservationReviewProcess(a):B.getData().then(function(a){c._getReservationReviewProcess(a)})};c._getReservationReviewProcess=function(a){c.reservationModel.costControl=B.costControlData(a.reservationSummary);c.paylessFlow=c.paylessextnControl();1==c.paylessFlow&&(c.reservationModel.costControl=c.paylesscostControl());aa=
a.reservationSummary.promoMails;void 0!=a.reservationSummary.displayEmailOptIn&&(c.displayEmailOptIn=a.reservationSummary.displayEmailOptIn.visible);c.reservationModel.transactionID=a.transactionID;f.setReservationModel(c.reservationModel);var b=m.getStorageData("bridgeResponse");null!=b&&""!=b&&angular.isDefined(b.errorList)&&"5"===b.webHeader.viewIndicator&&(b=q.processErrorMessage(b),a.errorList=b.errorList);a.reservationSummary.userState==u.userStateAnonymous?c._handleAnonymouspromoMail():c._handlePromoMail();
void 0!=a.identityProofMsg&&void 0!=a.identityProofMsg.code&&(c.identityProofMsg=a.identityProofMsg.message);void 0!=a.fraudDetectionMsg&&void 0!=a.fraudDetectionMsg.code&&(c.fraudDetectionMsg=a.fraudDetectionMsg.message);if(!(angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length)){c.currencySymbol=l("currencySymbol")(a.reservationSummary.rateSummary.currencySymbol);b=y.locale;var d="fr"==b||"fr_US"==b?!0:!1;b=c.prod.reservationSummary.rateSummary.periodFreeMiles.values;
if(("us"==y.domain.toLowerCase()||"ca"==y.domain.toLowerCase())&&d&&"C$"==c.currencySymbol){c.currencySymbol="$ CA";angular.isDefined(c.prod.reservationSummary.prepayInfo)&&angular.isDefined(c.prod.reservationSummary.prepayInfo.cancelFee)&&angular.isDefined(c.prod.reservationSummary.prepayInfo.noShowFee)&&(c.prod.reservationSummary.prepayInfo.cancelFee=c.prod.reservationSummary.prepayInfo.cancelFee.replace(".",","),c.prod.reservationSummary.prepayInfo.noShowFee=c.prod.reservationSummary.prepayInfo.noShowFee.replace(".",
","));c.prod.reservationSummary.rateSummary.baseRate=c.prod.reservationSummary.rateSummary.baseRate.replace(".",",");c.prod.reservationSummary.rateSummary.surchargeTotal=c.prod.reservationSummary.rateSummary.surchargeTotal.replace(".",",");c.prod.reservationSummary.rateSummary.estimatedTotal=c.prod.reservationSummary.rateSummary.estimatedTotal.replace(".",",");angular.isDefined(c.prod.reservationSummary.rateSummary.resSavings)&&angular.isDefined(c.prod.reservationSummary.rateSummary.resSavings.totalSavings)&&
null!==c.prod.reservationSummary.rateSummary.resSavings.totalSavings&&(c.prod.reservationSummary.rateSummary.resSavings.totalSavings=c.prod.reservationSummary.rateSummary.resSavings.totalSavings.replace(".",","));c.prod.reservationSummary.rateSummary.totalTax=c.prod.reservationSummary.rateSummary.totalTax.replace(".",",");angular.isDefined(c.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(c.prod.reservationSummary.vehicle.payLaterRate.originalAmount)&&null!==c.prod.reservationSummary.vehicle.payLaterRate.originalAmount&&
(c.prod.reservationSummary.vehicle.payLaterRate.originalAmount=c.prod.reservationSummary.vehicle.payLaterRate.originalAmount.replace(".",","));angular.isDefined(c.prod.reservationSummary.vehicle.payLaterRate)&&angular.isDefined(c.prod.reservationSummary.vehicle.payLaterRate.amount)&&null!==c.prod.reservationSummary.vehicle.payLaterRate.amount&&(c.prod.reservationSummary.vehicle.payLaterRate.amount=c.prod.reservationSummary.vehicle.payLaterRate.amount.replace(".",","));if(null!==b&&void 0!==b)for(d=
0;d<b.length;d++)1==d&&(b[d]=b[d].replace(".",","));if(void 0!=c.prod.reservationSummary&&angular.isDefined(c.prod.reservationSummary.rateSummary.surcharges))for(b=c.prod.reservationSummary.rateSummary.surcharges,d=0;d<b.length;d++)null!==b[d].unitPrice&&void 0!==b[d].unitPrice&&(c.prod.reservationSummary.rateSummary.surcharges[d].unitPrice=b[d].unitPrice=b[d].unitPrice.replace(".",",")),null!==b[d].totalSurchargePrice&&void 0!==b[d].totalSurchargePrice&&(c.prod.reservationSummary.rateSummary.surcharges[d].totalSurchargePrice=
b[d].totalSurchargePrice=b[d].totalSurchargePrice.replace(".",","))}c.annonymousPromoMails=a.reservationSummary.promoMails;a.reservationSummary&&(!a.reservationSummary.ccSummary||1!=a.reservationSummary.ccSummary.expiringcc&&1!=a.reservationSummary.ccSummary.expiredcc||a.reservationSummary.userState==u.userStateAuthenticated&&c.loadExpiredSection(),c.secureCode="",c.prod.reservationSummary.ftpDetails=a.reservationSummary.ftpDetails,angular.isDefined(c.prod.reservationSummary.ccSummary)&&angular.isDefined(a.reservationSummary.ccSummary)&&
angular.isDefined(a.reservationSummary.ccSummary.expiredcc)&&angular.isDefined(a.reservationSummary.ccSummary.expiringcc)&&(c.prod.reservationSummary.ccSummary.expiredcc=a.reservationSummary.ccSummary.expiredcc,c.prod.reservationSummary.ccSummary.expiringcc=a.reservationSummary.ccSummary.expiringcc),c.prod.reservationSummary.rateSummary.rateTerms=a.reservationSummary.rateSummary.rateTerms,c.prod.reservationSummary.rateSummary.surcharges=a.reservationSummary.rateSummary.surcharges,a.reservationSummary.ftpDetails&&
"TRUE"==a.reservationSummary.ftpDetails.visible&&(a.reservationSummary.ftpDetails.partnerCode.toUpperCase()!=u.ftpNotApplicable?c.reservationModel.ftpDetails.partnerCode=a.reservationSummary.ftpDetails.partnerCode:c.reservationModel.ftpDetails.partnerCode="",c.reservationModel.ftpDetails.ftpNumber=a.reservationSummary.ftpDetails.ftpNumber!=u.ftpNotApplicableLower?a.reservationSummary.ftpDetails.ftpNumber:"",a.reservationSummary.ftpDetails.ftpBonusMiles==u.ftpNotApplicableLower&&(c.prod.reservationSummary.ftpDetails.ftpBonusMiles=
u.ftpNotApplicable),c.reservationModel.ftpDetails.ftpBonusMiles=a.reservationSummary.ftpDetails.ftpBonusMiles,c.reservationModel&&c.reservationModel.ftpDetails&&c.reservationModel.ftpDetails.partnerName?c.partnerName=""==c.reservationModel.ftpDetails.partnerName?u.ftpNotApplicable:c.reservationModel.ftpDetails.partnerName:r.getData().then(function(a){c.ftp=a;c.ftp&&c.ftp.partnersList&&(a=B.getPartnerName(c.prod.reservationSummary.ftpDetails.partnerCode,c.ftp),c.partnerName=0<a.length?a[0].partnerName:
u.ftpNotApplicable)},function(a){})))}};c._handleAnonymouspromoMail=function(){var a=B.handleAnonymouspromoMail(aa);c.chkObj.checkCanada=""!==c.reservationModel.emailOptinFlag?c.reservationModel.emailOptinFlag:a.checkCanada;c.flagCanada=a.flagCanada};c._handlePromoMail=function(){c.authRecognizepromoMails=c.prod.reservationSummary.promoMails;var a=B.handlePromoMail(c.authRecognizepromoMails,c.prod);c.chkObj.checkCanada=""!==c.reservationModel.emailOptinFlag?c.reservationModel.emailOptinFlag:a.checkCanada;
c.flagCanada=a.flagCanada};c._handleCreditID=function(){void 0!=c.prod.reservationSummary.coupon&&void 0!=c.prod.reservationSummary.coupon.creditId&&0<c.prod.reservationSummary.coupon.creditId.length&&(c.creditId=c.prod.reservationSummary.coupon.creditId[0]);if(c.creditId)if(c.creditId===u.creditCardTypeMasterId){var a={coupononcc:u.cardExpressions.CM};w.setExpression(a);c.prod.reservationSummary.coupon.creditCardType=u.creditCardTypeMaster;c.useCreditBox=!0}else c.creditId===u.creditCardTypeVisaId?
(a={coupononcc:u.cardExpressions.CX},w.setExpression(a),c.prod.reservationSummary.coupon.creditCardType=u.creditCardTypeVisa,c.useCreditBox=!0):c.creditId===u.creditCardTypeAmericanId?(a={coupononcc:u.cardExpressions.CA},w.setExpression(a),c.prod.reservationSummary.coupon.creditCardType=u.creditCardTypeAmerican,c.useCreditBox=!0):c.creditId===u.creditCardTypeDiscoverId?(a={coupononcc:u.cardExpressions.CS},w.setExpression(a),c.prod.reservationSummary.coupon.creditCardType=u.creditCardTypeDiscover,
c.useCreditBox=!0):c.creditId===u.creditCardTypeJcbId?(a={coupononcc:u.cardExpressions.CJ},w.setExpression(a),c.prod.reservationSummary.coupon.creditCardType=u.creditJcb,c.useCreditBox=!0):c.creditId===u.creditCardTypeDinerId&&(a={coupononcc:u.cardExpressions.CD},w.setExpression(a),c.prod.reservationSummary.coupon.creditCardType=u.creditCardTypeDiner,c.useCreditBox=!0)};c._handleYourInformation=function(){c.reservationModel.personalInfoRQ.firstName=c.prod.reservationSummary.personalInfo.firstName.value;
c.reservationModel.personalInfoRQ.lastName=c.prod.reservationSummary.personalInfo.lastName.value;c.reservationModel.personalInfoRQ.smsOptIn="T"===c.prod.reservationSummary.personalInfo.smsOptIn?!0:!1;c.reservationModel.personalInfoRQ.email=c.prod.reservationSummary.personalInfo.email;c.reservationModel.personalInfoRQ.phone=angular.copy(c.prod.reservationSummary.personalInfo.phone);c.prod.reservationSummary&&!c.prod.reservationSummary.onlineId&&(c.firstLastNameDisabled=!0);c.prod.reservationSummary.gebUser&&
(c.gebUserLastName=!0,c.reservationModel.displayControls.reservation==u.resFlowCreate&&(c.firstLastNameDisabled=!1));"TRUE"==c.prod.reservationSummary.personalInfo.firstName.editable&&(c.firstLastNameDisabled=!1);angular.isDefined(c.prod.reservationSummary.personalInfo.phoneNumbers)&&angular.forEach(c.prod.reservationSummary.personalInfo.phoneNumbers,function(a){a.phoneNumber==c.prod.reservationSummary.personalInfo.phone&&"1"==a.maskId?(a.selected=!0,c.prod.reservationSummary.vehicleDeliveryFlag&&
c.validatePhoneNumber()):a.selected=!1})};c._handlePrepay=function(){c.getPrepayTnCs(u.txnTypePrePayOnly);angular.isDefined(c.prod.reservationSummary.prepayInfo)&&(c.prod.reservationSummary.amountPrepaid=c.prod.reservationSummary.prepayInfo.amount,c.prod.reservationSummary.cancelFee=c.prod.reservationSummary.prepayInfo.cancelFee,c.prod.reservationSummary.noShowFee=c.prod.reservationSummary.prepayInfo.noShowFee,c.reservationModel.cancelFee=c.prod.reservationSummary.prepayInfo.cancelFee,c.reservationModel.noShowFee=
c.prod.reservationSummary.prepayInfo.noShowFee);c.reservationModel.prepayOpted=!0};c._handleCC=function(){var a=y.addr_prefill_disable;c.creditIdCheck=""==c.creditId||c.creditId==c.prod.reservationSummary.ccSummary.type;y.brand==u.brandName.PAYLESS&&angular.equals(v.reservation,u.resFlowCreate)&&(c.creditIdCheck=!1);if(c.creditIdCheck){if(c.reservationModel.paymentRq.cardType=c.prod.reservationSummary.ccSummary.type,void 0!=c.prod.reservationSummary.ccSummary.expDate&&0<c.expMonths.length){var b=
c.prod.reservationSummary.ccSummary.expDate.split("/"),d=c.expMonths.indexOf(l("filter")(c.expMonths,function(a){return a.key==b[0]})[0]);c.reservationModel.paymentRq.expMonth=c.expMonths[d].key;c.reservationModel.paymentRq.expYear=b[2];if(c.prod.reservationSummary.ccSummary.expiredcc||c.prod.reservationSummary.ccSummary.expiringcc||c.prod.reservationSummary.ccSummary.expiryMsg)c.reservationModel.expiredPaymentRq.expMonth=c.expMonths[d].key,c.reservationModel.expiredPaymentRq.expYear=b[2]}}else c.prod.reservationSummary.ccSummary.type=
"",c.prod.reservationSummary.ccSummary.number="",c.ccMaskingServiceError=!1;c.creditCardNumber=c.prod.reservationSummary.ccSummary.number;c.cardNickname=c.prod.reservationSummary.ccSummary.nickName;d=""!=c.creditCardNumber?c.creditCardNumber.match(/(\d+)/g):"";c.cardNumberLastDigit=""!=d?d[0]:"";c.reservationModel.paymentRq.cardType=c.prod.reservationSummary.ccSummary.type;c.prod.reservationSummary.ccoCardType&&(d=c._showCCtype(c.prod.reservationSummary.ccoCardType,c.prod.reservationSummary.ccSummary.type))&&
(c.reservationModel.paymentRq.cardType=d);"true"!=a&&(c.reservationModel.paymentRq.address=c.prod.reservationSummary.address);if(c.prod.reservationSummary.ccSummary.expiredcc||c.prod.reservationSummary.ccSummary.expiringcc||c.prod.reservationSummary.ccSummary.expiryMsg)c.expiredCreditCardNumber=c.prod.reservationSummary.ccSummary.number,c.reservationModel.expiredPaymentRq.cardType=c.prod.reservationSummary.ccSummary.type};c._showCCtype=function(a,c){if(a&&c){var b=a.indexOf(l("filter")(a,function(a){return a.code==
c})[0]);return a[b].code}};c._reviewDataProcess=function(a){if(c.pageName==u.step4PageName||c.pageName==u.step4PayLaterPageName)try{e.analyticsDimension(a.reservationSummary,c.pageName,a)}catch(qa){}v.reservationReviewData=c.prod=a;void 0!=c.prod.reservationSummary.coupon&&void 0!=c.prod.reservationSummary.coupon.creditId&&0<c.prod.reservationSummary.coupon.creditId.length&&(c.creditId=c.prod.reservationSummary.coupon.creditId[0]);setTimeout(function(){la.restrictedCards=c.creditId;la.rentalLocation=
a.reservationSummary.pickLoc.address.country;v.$broadcast("setReviewCreditCard",la)},100);c.rentalLocationCountry=a.reservationSummary.pickLoc.address.country.toUpperCase();angular.isDefined(a.reservationSummary.vehicle)&&angular.isDefined(a.reservationSummary.vehicle.classDescription)&&(c.carDescription=a.reservationSummary.vehicle.classDescription);O(!1);angular.isDefined(a)&&angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.walletType)&&(c.walletType=a.reservationSummary.walletType);
if(angular.isDefined(c.reservationModel)&&angular.isDefined(c.reservationModel.displayControls)&&angular.isDefined(c.reservationModel.displayControls.reservation)&&c.reservationModel.displayControls.reservation!=u.resFlowModify&&angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.walletType)&&"AMAZON"==a.reservationSummary.walletType)if(angular.isDefined(a)&&angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.pickLoc)&&
angular.isDefined(a.reservationSummary.pickLoc.address)&&angular.isDefined(a.reservationSummary.pickLoc.address.country)&&"US"==a.reservationSummary.pickLoc.address.country&&angular.isDefined(a.reservationSummary.dropLoc)&&angular.isDefined(a.reservationSummary.dropLoc.address)&&angular.isDefined(a.reservationSummary.dropLoc.address.country)&&"US"==a.reservationSummary.dropLoc.address.country){c.prod.reservationSummary.digitalWalletFlow=!0;c.walletType=a.reservationSummary.walletType;var b=setInterval(function(){angular.isDefined(window.OffAmazonPayments)&&
angular.isDefined(window.OffAmazonPayments.Widgets)&&angular.isDefined(window.OffAmazonPayments.Widgets.AddressBook)&&(clearInterval(b),da())},500)}else c.walletType=a.reservationSummary.walletType,U();else c.showAmazonPayDetails=!1;if(angular.isDefined(c.qantasLoyaltyEligible)&&!0===c.qantasLoyaltyEligible&&angular.isDefined(window.enableQantas)&&"true"==window.enableQantas)var k=setInterval(function(){angular.isDefined(window.qantas)&&angular.isDefined(window.qantas.Button)&&angular.isDefined(window.qantas.Button.render)&&
(clearInterval(k),c.estimatedAmt=a.reservationSummary.rateSummary.estimatedTotal,"true"==_widgetSwitch?d():"false"==_widgetSwitch&&ea())},500);if(c.prod.unavailProductMsg||c.prod.unavailInsuranceMsg||c.prod.reservationSummary.productDropMsg)c.droppedProdAndInsuranceList=G.droppedData(c.prod);if(c.isBookAgainFlow){ka.reservationModel=angular.copy(c.reservationModel);var l=I.handleLoyalty(c.prod.reservationSummary,ka,c.pointCheckbox,c.productCheckbox,"EXTRAS",c.products);c.prefferedPointsFlag=l.prefferedPointsFlag;
c.loyaltyDetails=l.loyaltyDetails;c.pointProducts=l.pointProducts;c.displayFreedayFlag=l.displayFreedayFlag;c.freedaySectionDisplay=l.freedaySectionDisplay;c.freeDayPoints=l.freeDayPoints;c.totalreedem=l.totalReedemPoints;c.redeemableDays=l.redeemableDays;c.pointCheckbox=l.pointCheckbox;c.productCheckbox=l.productCheckbox;c.frdProdFlag=l.frdProdFlag;l.selectedProducts&&(c.reservationModel.selectedProducts=l.selectedProducts);c.products=a.reservationSummary.productSummaryList}l=m.getStorageData("bridgeResponse");
null!=l&&""!=l&&angular.isDefined(l.errorList)&&"5"===l.webHeader.viewIndicator&&(l=q.processErrorMessage(l),c.errorDisplayList=l.errorList,angular.forEach(l.errorList,function(a,c){angular.equals(a.code,"1112")&&g(function(){w.displayServiceError("vm.reservationModel.iataNumber","optional")},1)}));l=f.getExpressReservationFlag();c.errFlag=!1;if(angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length)a.errorList&&(c.errorDisplayList=a.errorList,
angular.forEach(a.errorList,function(a,c){angular.equals(a.code,"1112")&&g(function(){w.displayServiceError("vm.reservationModel.iataNumber","optional")},1)})),c.errFlag=!0;if(0==c.errFlag||l){c.insurances=a.reservationSummary.insuranceSummaryList;c.products=a.reservationSummary.productSummaryList;c.prod=a;c.reservationModel.ccsection=a.reservationSummary.ccsection;c.reservationModel.payNowCheckBoxInd=a.reservationSummary.payNowCheckBoxInd;angular.isDefined(c.prod.reservationSummary.pickLoc.emeaLocation)&&
c.prod.reservationSummary.pickLoc.emeaLocation&&angular.isDefined(c.prod.reservationSummary.rateSummary.nonCancellationFeeApplicable)&&!0===c.prod.reservationSummary.rateSummary.nonCancellationFeeApplicable&&(c.useCreditBox=!0);y.brand==u.brandName.BUDGET&&angular.isDefined(c.prod.reservationSummary.rateSummary.nonCancellationFeeApplicable)&&!0===c.prod.reservationSummary.rateSummary.nonCancellationFeeApplicable&&(c.useCreditBox=!0);!(angular.isDefined(c.prod)&&angular.isDefined(c.prod.domainConfigControl)&&
angular.isDefined(c.prod.domainConfigControl.displayElementMap)&&angular.isDefined(c.prod.domainConfigControl.displayElementMap.showcreditCardInfo)&&!0===c.prod.domainConfigControl.displayElementMap.showcreditCardInfo.visible)||angular.isDefined(c.prod.reservationSummary.walletType)&&angular.equals(c.prod.reservationSummary.walletType,"AMAZON")||(c.useCreditBox=!0,c.reservationModel.creditcard=!0);angular.isDefined(c.prod.reservationSummary)&&angular.isDefined(c.prod.reservationSummary.rateSummary)&&
angular.isDefined(c.prod.reservationSummary.rateSummary.nonCancellationFeeApplicable)&&angular.equals(c.prod.reservationSummary.rateSummary.nonCancellationFeeApplicable,!0)&&!0===v.isAuthenticated&&(c.useCreditBox=!0);!(angular.isDefined(c.prod.reservationSummary)&&angular.isDefined(c.prod.reservationSummary.rateSummary)&&angular.isDefined(c.prod.reservationSummary.rateSummary.nonCancellationFeeApplicable)&&angular.equals(c.prod.reservationSummary.rateSummary.nonCancellationFeeApplicable,!0))||angular.isDefined(c.prod.reservationSummary.walletType)&&
angular.equals(c.prod.reservationSummary.walletType,"AMAZON")||(c.reservationModel.creditcard=!0);c._getNcfPaylater(c.prod);c.getCreditCardType(c.prod);angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.flightInfo)&&"TRUE"===a.reservationSummary.flightInfo.visible&&c._getAirlines();angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.ftpDetails)&&"TRUE"===a.reservationSummary.ftpDetails.visible&&c._getPartnerList();l=c.prod.reservationSummary.userState==
u.userStateRecognized;var n=c.prod.reservationSummary.userState==u.userStateAuthenticated,r=c.prod.reservationSummary.userState==u.userStateAuthenticatedExpired,R=void 0!=c.prod.reservationSummary.prepayTxn&&c.prod.reservationSummary.prepayTxn,p=c.prod.reservationSummary.userState==u.userStateRememberMe;c._getReservationReview(a);c._handleCreditID();angular.isDefined(c.prod.reservationSummary)&&c.prod.reservationSummary.digitalWalletFlow&&c.reservationModel.prepayOpted?(c.reservationModel.digitalWalletFlow=
c.prod.reservationSummary.digitalWalletFlow,c.reservationModel.digitalWalletClicked=!0,c.creditCardMdl=!0,jQuery(".credit-card-details").show(),1!=c.reservationModel.prepayOpted||P)?"true"===c.showPayLaterTnC&&(c.getPrepayTnCs(u.txnTypePostPay),P=!1):(c.getPrepayTnCs(u.txnTypePrePayOnly),P=!0):c.reservationModel.prepayOpted&&(c.reservationModel.digitalWalletFlow=!1,c.useCreditBox=c.reservationModel.prepayOpted);c.prod.reservationSummary.customerWalletGenericRS&&c.prod.reservationSummary.customerWalletGenericRS.errorList&&
(c.errorDisplayList=c.prod.reservationSummary.customerWalletGenericRS.errorList);c._dataProcess();R||(c.policyPostpayTxnType=!0);R?c._handlePrepay():"true"===c.showPayLaterTnC&&c.getPrepayTnCs(u.txnTypePostPay);(l||r||n||p||c.prod.reservationSummary.gebUser||"PARTNER_AUTHENTICATED"==c.prod.reservationSummary.userState)&&c._handleYourInformation();c.prod.reservationSummary.splitEligible?c.reservationModel.splitEligible=!0:c.reservationModel.splitEligible=!1;c.reservationModel.splitBillSummary=c.prod.reservationSummary.splitBillSummary;
c.prod.reservationSummary.coupon&&c.prod.reservationSummary.coupon.creditId||w.setExpression({coupononcc:u.noCouponCreditCardExp});c.prod.reservationSummary.coupon&&c.prod.reservationSummary.coupon.visible&&(c.reservationModel.coupon.visible=c.prod.reservationSummary.coupon.visible);c.prod.reservationSummary.iataNumber&&(c.reservationModel.iataNumber=c.prod.reservationSummary.iataNumber);angular.isDefined(c.prod.customerInfo)&&angular.isDefined(c.prod.customerInfo.cor)&&("US"==c.prod.customerInfo.cor||
"CA"==c.prod.customerInfo.cor)&&"avis"==c.brand&&angular.isDefined(c.prod.customerInfo.userState)&&"AUTHENTICATED"==c.prod.customerInfo.userState&&(c.epIndicator=!0);angular.isDefined(c.prod.domainConfigControl)&&angular.isDefined(c.prod.domainConfigControl.displayElementMap)&&(c.reservationModel.displayElementMap=c.prod.domainConfigControl.displayElementMap);f.setReservationModel(c.reservationModel);c.reservationModel=f.getReservationModel();if(angular.isDefined(DigitalWallet)&&angular.isDefined(DigitalWallet.VISA)&&
""!=DigitalWallet.VISA.scriptPath)var S=setInterval(function(){angular.isDefined(window.V)&&angular.isDefined(window.V.init)&&(clearInterval(S),c.dwVisaCheckoutReady())},500);if(angular.isDefined(window.enablePaypal)&&"true"==window.enablePaypal)var t=setInterval(function(){angular.isDefined(window.paypal)&&angular.isDefined(window.paypal.Button)&&angular.isDefined(window.paypal.Button.render)&&(clearInterval(t),Z())},500)}c.reservationModel.digitalWalletFlowModify&&(c.creditCardMdl=!0,jQuery(".credit-card-details").show(),
c.onOptPrepay(!0));l=m.getStorageData("partnerName");if(angular.isDefined(l)&&""!=l&&"create"==c.reservationModel.displayControls.reservation){if("USAA"==l){var z=y.usaaUpsellCode;angular.forEach(c.insurances,function(a,b){a.code==z&&(a.currencySymbol=c.prod.reservationSummary.rateSummary.currencySymbol,v.$broadcast("PartnerUpsellPrice",a))})}else if("AARP"==l){var x=y.aarpUpsellCode;angular.forEach(c.insurances,function(a,b){a.code==x&&(a.currencySymbol=c.prod.reservationSummary.rateSummary.currencySymbol,
v.$broadcast("PartnerUpsellPrice",a))});h.getAARPBenefits(c.prod)}h.hideorShowPartnerBenefits(c.prod)}};c._getNcfPaylater=function(a){angular.isDefined(a.reservationSummary.ccSummary)&&angular.isDefined(a.reservationSummary.rateSummary.nonCancellationFeeApplicable)&&angular.equals(a.reservationSummary.rateSummary.nonCancellationFeeApplicable,!0)&&angular.equals(v.reservation,"modify")?(c.splitdata=[],a.reservationSummary.ccSummary&&(angular.isDefined(a.reservationSummary.ccSummary.expDate)&&(c.splitdata=
a.reservationSummary.ccSummary.expDate.split("/")),c.creditCardNumber=a.reservationSummary.ccSummary.number,c.reservationModel.paymentRq.cardType=a.reservationSummary.ccSummary.type),c.reservationModel.paymentRq.expYear=0<c.splitdata.length?c.splitdata[2]:"",a.reservationSummary.address&&(c.reservationModel.paymentRq.address=a.reservationSummary.address)):angular.isDefined(c.prod)&&angular.isDefined(c.prod.domainConfigControl)&&angular.isDefined(c.prod.domainConfigControl.displayElementMap)&&angular.isDefined(c.prod.domainConfigControl.displayElementMap.showcreditCardInfo)&&
!0===c.prod.domainConfigControl.displayElementMap.showcreditCardInfo.visible&&angular.equals(v.reservation,"modify")&&(c.splitdata=[],a.reservationSummary.ccSummary&&(angular.isDefined(a.reservationSummary.ccSummary.expDate)&&(c.splitdata=a.reservationSummary.ccSummary.expDate.split("/"),c.reservationModel.paymentRq.expYear=0<c.splitdata.length?c.splitdata[1]:""),c.creditCardNumber=a.reservationSummary.ccSummary.number,c.reservationModel.paymentRq.cardType=a.reservationSummary.ccSummary.type,angular.isDefined(c.creditCardNumber)&&
(c.ccFilled=!0)),a.reservationSummary.address&&(c.reservationModel.paymentRq.address=a.reservationSummary.address))};c._getAirlines=function(){K=E.load();K.then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length||angular.isDefined(a.warningList)&&0<a.warningList.length?q.processErrorMessage(a):(c.airlines=a,angular.isDefined(c.airlines.flightInfoList)&&angular.isDefined(c.reservationModel.airlineCode)&&"WI"!=c.airlines.flightInfoList[0].airlineCode&&
"WI"==c.reservationModel.airlineCode&&(c.reservationModel.airlineCode=null),""==c.reservationModel.airlineCode&&(c.reservationModel.airlineCode=null))},function(a){})};c._getPartnerList=function(){r.getData().then(function(a){c.ftp=a;c.ftp&&c.ftp.partnersList&&(a=B.getPartnerName(c.prod.reservationSummary.ftpDetails.partnerCode,c.ftp),c.partnerName=0<a.length?a[0].partnerName:u.ftpNotApplicable)},function(a){})};c._setCORAsBillingCountry=function(){c.customer=H.getCustomerModel();var a="";c.customer&&
"PARTNER_AUTHENTICATED"!=c.customer.userState?a=c.customer.cor:c.reservationModel&&c.reservationModel.personalInfoRQ&&""!==c.reservationModel.personalInfoRQ.residency&&(a=c.reservationModel.personalInfoRQ.residency);var b=c.countryList.indexOf(l("filter")(c.countryList,function(c){return c.code===a})[0]);c.reservationModel.personalInfoRQ.residency=c.countryList[b].code};c._validationSuccess=function(){var b=c.reservationModel.displayControls.reservation!==u.resFlowModify||c.isBookAgainFlow?"Create Flow":
"Modfiy Flow",d=!0===c.reservationModel.prepayProcessIndicator?"PayNow":"PayLater",f="Create Flow"===b?"Reserve":-1!=y.location.href.indexOf("review-and-book")?"Confirm Modification":"Keep Modifications",g=c.reservationModel.displayControls.reservation==u.resFlowModify?"Review Modifications":"Reserve";c.reservationModel.splitBillSummary&&e.resSplitOpted(g+"-with split-"+d+"-"+b,f);c.reservationModel.displayControls.reservation===u.resFlowModify&&c.prod.reservationSummary.prepayTxn&&c.reservationModel.splitEligible&&
c.reservationModel.splitBillSummary&&c.reservationModel.splitBillSummary.splitOpted&&(c.reservationModel.splitBillSummary.splitBillSecondary&&!c.reservationModel.splitBillSummary.splitBillSecondary.ccSummary||null==c.reservationModel.splitBillSummary.splitBillSecondary)?(document.getElementById("submit_button").disabled=!1,c.errorDisplayList=[{type:"ERROR",code:"12345678",message:"Secondary Method of Payment is a required field."}],jQuery("#dropdownMenu2").css("border-color","rgb(212, 0, 42)"),jQuery("#dropdownMenu2").parent().next().removeClass("cus-d-none")):
(c.reservationModel.personalInfoRQ.firstName=ABG.getQualifiedName(c.reservationModel.personalInfoRQ.firstName),c.step4Validated=!1,c.step4PageError="",c.errorDisplayList=[],c.displayApplePayMessage?a():c.confirmBooking())};c._validationError=function(a){c.step4Validated=!0;document.getElementById("submit_button").disabled=!1;c.reservationModel.paymentRq.acceptTerms||(c.termsCheckError=!0);c.errorDisplayList=[];c.reservationModel.paymentRq.acceptTerms||(c.secureCode="",c.expiredSecureCode&&(c.expiredSecureCode=
""));c.reservationModel.displayControls.reservation===u.resFlowModify&&c.prod.reservationSummary.prepayTxn&&c.reservationModel.splitEligible&&c.reservationModel.splitBillSummary&&c.reservationModel.splitBillSummary.splitOpted&&c.reservationModel.splitBillSummary.splitBillSecondary&&!c.reservationModel.splitBillSummary.splitBillSecondary.ccSummary&&!c.reservationModel.splitBillSummary.splitBillSecondary.splitConfirmed&&(a.errorCount=++a.errorCount,jQuery("#dropdownMenu2").css("border-color","rgb(212, 0, 42)"),
jQuery("#dropdownMenu2").parent().next().removeClass("cus-d-none"));var b=a.errorCount;1===b?(c.step4PageError=A.trustAsHtml(a.MSG[0]),c.secureCode="",$(window).scrollTop(0)):1<b&&(c.step4PageError=Dictionary.I18n.get("err.global.multi.errorMessage"),0==$("input[type\x3dradio]:checked").length&&"\x3cstrong\x3eCredit Card Number\x3c/strong\x3e is a required field."==a.MSG[0]?c.step4PageError=Dictionary.I18n.get("err.uplift.choosePaymentMethod,"+brand):c.step4PageError=Dictionary.I18n.get("err.global.multi.errorMessage"),
1==c.displayUpLiftRelatedInfo&&window.Uplift.Payments&&window.Uplift.Payments.error(c.step4PageError,"validation"),c.secureCode="",$(window).scrollTop(0));angular.isDefined(c.prod)&&angular.isDefined(c.prod.reservationSummary)&&angular.isDefined(c.prod.reservationSummary.rateSummary)&&angular.isDefined(c.prod.reservationSummary.rateSummary.nonCancellationFeeApplicable)&&c.prod.reservationSummary.rateSummary.nonCancellationFeeApplicable&&!c.prod.reservationSummary.prepayTxn&&""==c.reservationModel.paymentRq.expDate&&
w.displayServiceError("vm.WizardModel.lastName","required")};c._showHideProgressBar=function(){var a=document.getElementById("progress-bar-text-holder"),c=document.getElementById("dropdown-caret");"none"===a.style.display||""===a.style.display?(a.style.display="block",c.style.transform="rotate(0deg)"):(a.style.display="none",c.style.transform="rotate(180deg)")};c._calculateFreedayPoints=function(){var a=I.calculateFreedayPoints(c.pointProducts,c.freeDayPoints);c.noOfFreeDays=a.noOfFreeDays;c.prefferedPointsFlag=
a.prefferedPointsFlag;c.redeemableDays=a.redeemableDays};c.modifyModal=function(a){var c="",b="";switch(a){case "ftpDetails":c="reservation.frequent-travel-program-modal";b="ExtrasController";break;case "protectionModify":c="reservation.protection-modal";b="ExtrasController";break;case "equipmentModify":c="reservation.equipment-modal";b="ExtrasController";break;default:b=c=""}""!=c&&""!=b&&J.showModal({type:a,templateUrl:v.contextPath+"/"+v.locale+"/"+c+htmlExtension,controller:b,controllerAs:"vm"}).then(function(a){a.element.modal();
n.infoToolTip()})};c.pointSelectedvsFTP=function(a,b,d,e){if(d==u.productSectionFREEDAYS){if(e="TRUE"==c.prod.reservationSummary.ftpDetails.visible)e=c.prod.reservationSummary.rebookFlow&&angular.isUndefined(c.prod.reservationSummary.ftpDetails.ftpNumber)&&("n/a"!=c.prod.reservationSummary.ftpDetails.ftpNumber||"N/A"!=c.prod.reservationSummary.ftpDetails.ftpNumber)?!1:!0;e?angular.element(".ftp-loyality-modal").modal("show"):(v.requestInProgress=!0,angular.isDefined(c.pointProducts)&&null!=c.pointProducts.freeDay&&
(a=c.pointProducts.freeDay),e=I.frdSelected(c.pointProducts,c.freeDayPoints,c.pointCheckbox,"EXTRAS",a),c.frdSelectedFlag=e.frdSelectedFlag,c.pageName==u.bookAgainPayNowPage||c.pageName==u.bookAgainPayLaterPage?"true"!=y.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||y.brand!=u.brandName.AVIS&&y.brand!=u.brandName.BUDGET?I.recalculate("false").then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&
0<a.errorList.length?q.processErrorMessage(a):B.load().then(function(b){c.pointProducts=a.reservationSummary.pointProducts;c.frdSelectedFlag&&c._calculateFreedayPoints();c.pageName===u.bookAgainPayNowPage?p.go(u.bookAgainPayNowPage,{},{reload:!0}):p.go(u.bookAgainPayLaterPage,{},{reload:!0})})},function(a){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(a){c.recaptcha=a;I.recalculate("false",c.recaptcha).then(function(a){angular.isDefined(a.fieldErrors)&&
0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length?q.processErrorMessage(a):B.load().then(function(b){c.pointProducts=a.reservationSummary.pointProducts;c.frdSelectedFlag&&c._calculateFreedayPoints();c.pageName===u.bookAgainPayNowPage?p.go(u.bookAgainPayNowPage,{},{reload:!0}):p.go(u.bookAgainPayLaterPage,{},{reload:!0})})},function(a){})})}):v.requestInProgress=!1,void 0!=H.getLoyaltyDetails()&&(c.freedayPresent=!1,c.noOfFreeDays,c.loyaltyDetails=H.getLoyaltyDetails(),c.totalPointsFrd=
parseInt(c.loyaltyDetails.points),c.frdNoChange=!1))}c.productObjSelected=a;c.codeSelected=b;c.productSectionSelected=d};c.keepFTPEarning=function(a){v.requestInProgress=!0;I.disableLoyalty("true",a).then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length?q.processErrorMessage(a):(v.requestInProgress=!1,ka.displayFreedayFlag=!1,I.setFreedaySectionDisplay(a.reservationSummary),p.go(c.pageName,{},{reload:!0}))},function(a){})};
c.keepPointsSelection=function(a,b){c.productSectionSelected=b;c.productSectionSelected==u.productSectionFREEDAYS&&(I.frdSelected(c.pointProducts,c.freeDayPoints,c.pointCheckbox),"true"!=y.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||y.brand!=u.brandName.AVIS&&y.brand!=u.brandName.BUDGET?I.recalculate("false").then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<
a.errorList.length?q.processErrorMessage(a):(v.requestInProgress=!1,c.products=a.reservationSummary.productSummaryList,c.pointProducts=a.reservationSummary.pointProducts,c.prod=q.processErrorMessage(a),c.prod.instructionList&&0<c.prod.instructionList.length&&(c.instructionList=c.prod.instructionList),p.go(c.pageName,{},{reload:!0}))},function(a){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(a){c.recaptcha=a;I.recalculate("false",
c.recaptcha).then(function(a){angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length||angular.isDefined(a.errorList)&&0<a.errorList.length?q.processErrorMessage(a):(v.requestInProgress=!1,c.products=a.reservationSummary.productSummaryList,c.pointProducts=a.reservationSummary.pointProducts,c.prod=q.processErrorMessage(a),c.prod.instructionList&&0<c.prod.instructionList.length&&(c.instructionList=c.prod.instructionList),p.go(c.pageName,{},{reload:!0}))},function(a){})})}))};c.paylesscostControl=function(){};
c.paylessextnControl=function(){};c.showpaynowTnC="";c.amazonBenefitsKey=Dictionary.I18n.get("lbl.global.amazonBenefits");c.authRequest;c.walletType;c.setWalletType=ca;c.triggerAmazonLogin=function(){amazon.Login.authorize({scope:"profile payments:widget"},function(){angular.isDefined(y.amazon)&&1==partnerConfig.amazon.sandboxMode&&(c.showPaymentOptions=!1,c.showAmazonPayDetails=!0,angular.element(".navbar-fixed-top.bg-header").click());c.loginAmazonPay()})};c.loginAmazonPay=function(){var a=setInterval(function(){angular.isDefined(window.OffAmazonPayments)&&
angular.isDefined(window.OffAmazonPayments.Widgets)&&angular.isDefined(window.OffAmazonPayments.Widgets.AddressBook)&&(clearInterval(a),da())},500)};c.loadWallentDiv=ba;c.loadAddress=da;c.amazonBillingAgreementId;c.showAmazonPayDetails=!0;c.loadAmazonPayButton=function(){var a=y.environmentBaseURL+contextPath+"/"+y.locale+"/reservation"+htmlExtension+"#/review-and-book";"true"==enableAmazonPay&&(document.getElementById("AmazonPayButtonMethod").innerHTML="",OffAmazonPayments.Button("AmazonPayButtonMethod",
sellerId,{type:"PwA",color:"gold",size:"medium",authorization:function(){var b={scope:"profile payments:widget payments:shipping_address payments:instrument_descriptor payments:autopay_consent",response_type:"token",popup:1};angular.isDefined(y.amazon)&&1==partnerConfig.amazon.sandboxMode?amazon.Login.authorize(b,function(){c.showPaymentOptions=!1;c.showAmazonPayDetails=!0;angular.element(".navbar-fixed-top.bg-header").click();c.loginAmazonPay()}):amazon.Login.authorize(b,a)},onError:function(a){U()}}))};
c.applePayButtonClicked=function(){c.displayApplePayMessage=!0;dataLayer.push({event:"trackEvent",eventCategory:"step 4",eventLabel:"Apple Pay",eventAction:"Element_Clicks"});$(window).scrollTop(0)};c.canMakePayments=!1;c.displayApplePayMessage=!1;c._validateFTPData=function(a){var b=!0,d=!0,e=[],f,g=[];if(void 0==c.reservationModel.ftpDetails.partnerCode||""==c.reservationModel.ftpDetails.partnerCode||"n/a"==c.reservationModel.ftpDetails.partnerCode)b=!1,c.reservationModel.ftpDetails.partnerCode=
"";if(void 0==c.reservationModel.ftpDetails.ftpNumber||""==c.reservationModel.ftpDetails.ftpNumber||"n/a"==c.reservationModel.ftpDetails.ftpNumber)d=!1,c.reservationModel.ftpDetails.ftpNumber="";"update"==a?d&&!b?e.push(Dictionary.I18n.get("err.res.step3.ftp.PartnerError")):b&&!d&&e.push(Dictionary.I18n.get("err.res.step3.ftp.MemberError")):d&&!b?e.push(w.displayServiceError("vm.reservationModel.ftpDetails.partnerCode","ftpInvalid")):b&&!d&&e.push(w.displayServiceError("vm.reservationModel.ftpDetails.ftpNumber",
"ftpInvalid"));1===e.length?f={message:e[0]}:S();0!=e.length&&g.push(f);c.errorList=g};c.clearErrorFields=S;c.autoSlash=function(){var a=c.reservationModel.paymentRq.expDate;2===a.length&&(c.reservationModel.paymentRq.expDate+="/");if(3===a.length&&0<c.ccCount){var b=c.reservationModel.paymentRq.expDate;c.reservationModel.paymentRq.expDate=c.reservationModel.paymentRq.expDate.substring(0,2)+"/"+b.charAt(2)}3===a.length&&"/"===a.charAt(2)&&(a=a.substring(0,2),c.reservationModel.paymentRq.expDate=c.reservationModel.paymentRq.expDate.substring(0,
2));5===a.length&&c.assignMonthYear()};c.assignMonthYear=function(a){var b=(new Date).getFullYear();b=parseInt(b/100);b=parseInt(b+a.substring(3,5));a=a.substring(0,2);c.reservationModel.paymentRq.expMonth=a;c.reservationModel.paymentRq.expYear=b};c.ccCount=0;c.hideSplitCcPaymentZeApac=!1;c._hideSplitPaymentZeApac=function(a){a=[];angular.isDefined(c.reservationModel.selectedInsurances)&&0<c.reservationModel.selectedInsurances.length?a=c.reservationModel.selectedInsurances:angular.isDefined(c.reservationModel.rateSummary)&&
angular.isDefined(c.reservationModel.rateSummary.selectedInsurances)&&0<c.reservationModel.rateSummary.selectedInsurances.length&&(a=c.reservationModel.rateSummary.selectedInsurances);0<a.length&&angular.forEach(a,function(a,b){"PK2"==a.code&&(c.hideSplitCcPaymentZeApac=!0)})};c.ccNumberFormat=function(a){angular.isUndefined(a)&&""==c.creditCardNumber&&(c.reservationModel.paymentRq.cardType="");if(angular.isDefined(c.prod)&&angular.isDefined(c.prod.reservationSummary)&&angular.isDefined(c.prod.reservationSummary.userState)&&
c.prod.reservationSummary.userState===u.userStateAnonymous&&""==c.creditId)$("#"+a).on("keydown",function(a){""==c.creditCardNumber&&(c.reservationModel.paymentRq.cardType="");var b=this.selectionStart;this.selectionEnd==b&&(46==a.which?" "==this.value[b]&&this.selectionStart++:8==a.which&&b&&" "==this.value[b-1]&&this.selectionEnd--)}).on("input",function(){var c=this.value,b=this.selectionStart,d=c.substring(0,b).match(/[^0-9a-zA-z]/g);d&&(b-=d.length);c=c.replace(/[^0-9a-zA-z]/g,"").substring(0,
16);d="";for(var e=0,f=c.length;e<f;e++){if("34"==c.substring(0,2)||"37"==c.substring(0,2)){if(document.getElementById(a).maxLength="17",e&&1==e/4||e&&0==e%10)d.length<=b&&b++,d+=" "}else e&&0==e%4&&(document.getElementById(a).maxLength="19",d.length<=b&&b++,d+=" ");d+=c[e]}d!=this.value&&(this.value=d,this.selectionEnd=b)})};c.address3placeholder="";c.placeholder=function(){c.address3placeholder="AU"==c.reservationModel.paymentRq.address.country?"":Dictionary.I18n.get("lbl.res.checkout.placeholderaddress3,"+
brand)};c.click=!1;c.show=function(){1==document.getElementById("ccCard").checked?(c.creditCardMdl=!0,c.useCreditBox=!0,document.getElementById("ccdetails").style.display="block",0!=c.checkRadioCount&&c.upliftTokenAvailable&&B.clearWallet()):document.getElementById("ccdetails").style.display="none";null!=document.getElementById("payMonthly")&&(1==document.getElementById("payMonthly").checked?(c.checkRadioCount++,document.getElementById("up-pay-monthly-container").style.display="block",c.creditCardMdl=
!1,c.useCreditBox=!1,c.enableNcr=!1,0==c.reservationModel.prepayProcessIndicator&&$("#payPal-li").is(":visible")&&(c.enableNcr=!1,setTimeout(function(){document.getElementById("creditcard").checked=!0},100))):(document.getElementById("up-pay-monthly-container").style.display="none",c.enableNcr=!0,0!=c.checkRadioCount&&(window.Uplift.Payments.deselect("other"),Uplift.Analytics.selectPayment("other"))));0<c.checkRadioCount&&0==c.checkRadioCount%2&&(document.getElementById("payMonthly").checked=!1,document.getElementById("up-pay-monthly-container").style.display=
"none",$("#payPal-li").is(":visible")&&(c.enableNcr=!1),$("#payPal-li").is(":visible")||(c.enableNcr=!0));1==document.getElementById("amazonPay").checked?(document.getElementById("AmazonPayButtonMethod").style.display="block",document.getElementById("amazonPay-li").style.display="none"):(document.getElementById("AmazonPayButtonMethod").style.display="none",document.getElementById("amazonPay-li").style.display="block");1==document.getElementById("payPal").checked?(document.getElementById("paypal-button-container").style.display=
"block",document.getElementById("payPal-li").style.display="none"):(document.getElementById("paypal-button-container").style.display="none",document.getElementById("payPal-li").style.display="block")};c.sendUpliftToken=function(){if(null!=document.getElementById("payMonthly")&&1==document.getElementById("payMonthly").checked&&angular.isDefined(c.upliftToken)){$("#ccdetails").hide();var a=c.upliftToken;c.upliftToken=a;"VISA"==a.card_type&&(c.reservationModel.paymentRq.cardType="CX");"MASTERCARD"==
a.card_type&&(c.reservationModel.paymentRq.cardType="CM");10>a.expiration_month&&(a.expiration_month="0"+a.expiration_month.toString());c.creditCardNumber=a.card_number;c.reservationModel.paymentRq.expMonth=a.expiration_month.toString();c.reservationModel.paymentRq.expYear=a.expiration_year;c.reservationModel.paymentRq.expDate=c.reservationModel.paymentRq.expMonth.toString()+"/"+c.reservationModel.paymentRq.expYear.toString().slice(-2);c.secureCode=a.card_ccv;c.reservationModel.paymentRq.address.country=
a.contact.country;c.reservationModel.paymentRq.address.address1=a.contact.street_address;c.reservationModel.paymentRq.address.city=a.contact.city;c.reservationModel.paymentRq.address.state=a.contact.region;c.reservationModel.paymentRq.address.zipCode=a.contact.postal_code;c.reservationModel.walletType="UPLIFT";c.walletType="UPLIFT"}};c.openIframe=function(){window.Uplift.Payments.select()};c.checkRadioCount=0;c.enableNcr=!0;c.inCents=100;c.usebillingAddressAsMailingAddress=!1;c.isMemberRateAccountCreationEligible=
!1;c.isAccountCreateSectionVisible=!1;c.showPaymentOptions=!0;v.$on("Profile.successAuthentication",function(a,b){c.model=b;c.prod=b;f.loadPersonalInfo(c.reservationModel,b.reservationSummary);c._handleCC();c._getReservationReview();if(c.prod.reservationSummary.ccSummary){a=[];if(angular.isDefined(c.prod.reservationSummary.ccSummary.supportedCctypes)){for(b=0;b<c.prod.reservationSummary.ccSummary.supportedCctypes.length;b++)a.push({code:c.prod.reservationSummary.ccSummary.supportedCctypes[b],name:ABG.getCreditCardMap(c.prod.reservationSummary.ccSummary.supportedCctypes[b])});
c.prod.reservationSummary.ccoCardType=a}if(a=c._showCCtype(c.prod.reservationSummary.ccSummary.supportedCctypes,c.prod.reservationSummary.ccSummary.type))c.reservationModel.paymentRq.cardType=a}1!=c.model.reservationSummary.ccSummary.expiringcc&&1!=c.model.reservationSummary.ccSummary.expiredcc||c.model.reservationSummary.userState!=u.userStateAuthenticated||c.loadExpiredSection()});v.$on("loadHelpModal",function(a,b){c.loadHelpModal(b)});c._onPageLoad();t=t("ReviewExnController",{$scope:q});angular.extend(this,
t);jQuery(document).ready(function(){c.corporateBcd="C"==c.reservationModel.coupon.discountNumberType||"K"==c.reservationModel.coupon.discountNumberType||"G"==c.reservationModel.coupon.discountNumberType||"S"==c.reservationModel.coupon.discountNumberType||"T"==c.reservationModel.coupon.discountNumberType||"H"==c.reservationModel.coupon.discountNumberType||"J"==c.reservationModel.coupon.discountNumberType||"R"==c.reservationModel.coupon.discountNumberType||"U"==c.reservationModel.coupon.discountNumberType||
"V"==c.reservationModel.coupon.discountNumberType||"I"==c.reservationModel.coupon.discountNumberType||"Z"==c.reservationModel.coupon.discountNumberType;c.displayUpLiftRelatedInfo=!c.corporateBcd&&"US"==c.reservationModel.personalInfoRQ.residency&&"US"==c.reservationModel.pickCountry&&"true"==c.showUpliftOptionStep4&&"true"==c.enableUplift&&angular.equals(v.reservation,u.resFlowCreate)?!0:!1;c.displayUpLiftRelatedInfo&&setTimeout(function(){var a=setInterval(function(){window.Uplift.Payments&&(window.Uplift.Payments.init({apiKey:y.upliftApiKey,
locale:"en-US",currency:"USD",checkout:!0,channel:"desktop",container:"#up-pay-monthly-container",onChange:x}),clearInterval(a))},100),d=setInterval(function(){if($(".payment-list").is(":visible")&&c.prod.reservationSummary.vehicle.classDescription||angular.isDefined(c.prod)&&angular.isDefined(c.prod.reservationSummary)&&angular.isDefined(c.prod.reservationSummary.digitalWalletFlow)&&c.prod.reservationSummary.digitalWalletFlow){var a=b();window.Uplift.Payments.load(a);clearInterval(d)}},100)},200);
setTimeout(function(){angular.isDefined(c.creditId)&&""!=c.creditId&&(c.creditCardMdl=!0,T(c.creditCardMdl),angular.element("#ccCard").click())},2500);c.pageName!=u.step4PageName&&c.pageName!=u.step4PayLaterPageName||f.addGTMScript();v.requestInProgress=!1});$("body").on("shown.bs.modal",".modal.policies_Modal",function(a){c.getPrepayTnCs()});if(angular.isDefined(window.enableAmazonPay)&&"true"==window.enableAmazonPay)var na=setInterval(function(){var a=document.getElementById("AmazonPayButtonMethod");
angular.isDefined(window.OffAmazonPayments)&&angular.isDefined(window.OffAmazonPayments.Widgets)&&angular.isDefined(window.OffAmazonPayments.Widgets.AddressBook)&&a&&0==a.children.length&&(clearInterval(na),c.loadAmazonPayButton())},500);angular.element(document).ready(function(){g(function(){var a=document.getElementById("step4-account-create-section");c.isAccountCreateSectionVisible=a&&angular.isDefined(a)&&!a.className.includes("hide-create-account-section")},1E3)})}angular.module("reservation").controller("ReviewController",
t);t.$inject="$controller $scope $filter $rootScope $state $window $timeout $locale $sce reviewService confirmationService airlineService $validation locationTermsConditionsService reviewModifyService vehicleService authenticationService optionalService carRentalConstant storageService reservationModelService getDataService gaService getVehicles ftpService ModalService".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C,A,B,F,E,w,z){function x(){if(v.current.name===g.modifyReviewConfirmPage){var e=E.getReviewModificationData();b.prod=e&&e.reservationSummary?e:q.reservationReviewData}b.qantasSessionData=angular.element(document).injector().get("storageService").getStorageData("qantasData");angular.isDefined(b.qantasSessionData)&&(b.reservationModel.splitEligible=!1,A.setReservationModel(b.reservationModel));b.reservationModel&&void 0===b.reservationModel.splitBillSummary&&q.reservationReviewData&&
q.reservationReviewData.reservationSummary&&q.reservationReviewData.reservationSummary.splitBillSummary&&(b.reservationModel.splitBillSummary=q.reservationReviewData.reservationSummary.splitBillSummary);if(b.reservationModel.splitBillSummary&&b.reservationModel.splitBillSummary.splitConfirmed&&void 0!==b.prod||q.reservationReviewData&&q.reservationReviewData.reservationSummary&&q.reservationReviewData.reservationSummary.prepayTxn)n(b.prod.reservationSummary),b.enableSplitResponse=angular.copy(b.prod);
b.reservationModel&&!b.reservationModel.creditcards&&b.reservationModel.splitBillSummary&&b.reservationModel.splitBillSummary.splitConfirmed&&b.prod&&b.prod.reservationSummary&&b.prod.reservationSummary.creditcards&&0<b.prod.reservationSummary.creditcards.length&&(b.reservationModel.creditcards=b.prod.reservationSummary.creditcards,b.reservationModel.rateSummary=b.prod.reservationSummary.rateSummary,m(b.reservationModel));b.prod&&b.prod.reservationSummary&&b.prod.reservationSummary.prepayTxn&&b.reservationModel.splitBillSummary&&
b.reservationModel.splitBillSummary.splitBillSecondary&&b.reservationModel.splitBillSummary.splitBillSecondary.ccSummary&&(b.secondaryCardSelected=b.reservationModel.splitBillSummary.splitBillSecondary.ccSummary);b.prod&&b.prod.reservationSummary&&b.prod.reservationSummary.prepayTxn&&b.reservationModel.splitBillSummary&&!b.reservationModel.splitBillSummary.splitConfirmed&&(b.reservationModel.splitBillSummary.splitOpted=!1)}function n(e){b.reservationModel.creditcards=e.creditcards;b.reservationModel.rateSummary=
e.rateSummary;b.reservationModel.prepayTxn=e.prepayTxn;b.primaryCardSelected=e.splitBillSummary?e.splitBillSummary.splitBillPrimary?e.splitBillSummary.splitBillPrimary.ccSummary?e.splitBillSummary.splitBillPrimary.ccSummary:{}:{}:{};b.secondaryCardSelected=e.splitBillSummary?e.splitBillSummary.splitBillSecondary?e.splitBillSummary.splitBillSecondary.ccSummary?e.splitBillSummary.splitBillSecondary.ccSummary:{}:{}:{};b.reservationModel.splitBillSummary=e.splitBillSummary;b.reservationModel.splitBillSummary&&
(b.primaryAmountOldValue=b.reservationModel.splitBillSummary.splitBillPrimary?b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount:e.rateSummary.estimatedTotal,b.secondaryAmountOldValue=b.reservationModel.splitBillSummary.splitBillSecondary?b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount:"0.00");e.rateSummary&&m(e);b.reservationModel.creditcards&&0<b.reservationModel.creditcards.length&&r();M()}function H(e,f){if(e.expMonth&&2==e.expMonth.length||"number"==typeof e.expMonth)var g=
String(e.expMonth);else e.expDate&&(g=1<e.expDate.split("/").length?e.expDate.split("/")[0]:"");if(!e.expYear||"number"!=typeof e.expYear&&4!=String(e.expYear.length))e.expDate&&(h=1<e.expDate.split("/").length?e.expDate.split("/")[2]:"");else var h=String(e.expYear);e={primary:"primary"===f?!0:!1,operation:"add",paymentRQ:{cardNumber:e.number,cardType:b.avisChargeCard?"AV":e.type?e.type:b.reservationModel.paymentRq.cardType,expMonth:g,expYear:h,nickName:e.nickName,address:b.custAddress}};b.error=
[];b.errorDisplayList=[];b.addNewCardModel.formValidated=!1;q.requestInProgress=!0;C.validateCreditCard(e).then(function(e){q.requestInProgress=!1;angular.element("#primaryAmount").hasClass("ng-invalid")&&p.resetError("vm.reservationModel.splitBillSummary.splitBillPrimary.cardAmount",!1);angular.element("#secondaryAmount").hasClass("ng-invalid")&&p.resetError("vm.reservationModel.splitBillSummary.splitBillSecondary.cardAmount",!1);if(b.saveCardMethod){if(angular.isDefined(e.fieldErrors)&&0<e.fieldErrors.length){b.newCard.secureCode=
"";var f=[],g;angular.forEach(e.fieldErrors,function(b,a){g=angular.equals(b.field,"vm.reservationModel.paymentRq.cardType")?{message:p.displayServiceError("vm.newCard.number","invalidcard")}:{message:p.displayServiceError(b.field,b.classifier)}});1<e.fieldErrors.length&&(g={message:Dictionary.I18n.get("err.res.mutliplemsg")});f.push(g);b.errorDisplayList=f}angular.isDefined(e.errorList)&&0<e.errorList.length&&(b.errorDisplayList=e.errorList,t.$parent.vm.errorDisplayList=e.errorList,$(window).scrollTop(0));
angular.isDefined(e.reservationSummary)&&angular.isDefined(e.reservationSummary.creditcards)&&angular.isDefined(0<e.reservationSummary.creditcards.length)&&(b.reservationModel.creditcards=e.reservationSummary.creditcards,b.reservationModel.splitBillSummary=e.reservationSummary.splitBillSummary,b.reservationModel.creditcards&&0<b.reservationModel.creditcards.length&&r());angular.isDefined(e.reservationSummary)&&angular.isDefined(e.reservationSummary.splitBillSummary)&&null!=e.reservationSummary.splitBillSummary.splitBillPrimary&&
angular.isDefined(e.reservationSummary.splitBillSummary.splitBillPrimary)&&angular.isDefined(e.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary)&&(b.primaryCardSelected=angular.copy(e.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary));angular.isDefined(e.reservationSummary)&&angular.isDefined(e.reservationSummary.splitBillSummary)&&null!=e.reservationSummary.splitBillSummary.splitBillSecondary&&angular.isDefined(e.reservationSummary.splitBillSummary.splitBillPrimary)&&
angular.isDefined(e.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary)&&(b.secondaryCardSelected=angular.copy(e.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary));angular.isUndefined(e.errorList)&&angular.isUndefined(e.fieldErrors)?(b.reservationModel.splitBillSummary?b.reservationModel.splitBillSummary.splitBillPrimary?b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount?b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount=e.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount:
b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount=e.reservationSummary.rateSummary.estimatedTotal:"":"",b.reservationModel.splitBillSummary?b.reservationModel.splitBillSummary.splitBillSecondary?b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount?b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount=e.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount:b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount="0.00":"":"",b.enableSplitResponse=
angular.copy(e),$("#modalAddCreditCard").modal("hide"),b.avisChargeCard=b.saveCardMethod=b.addNewCardModel.addAuthUserEdit=b.addNewCardModel.formValidated=!1,b.newCard.number=b.newCard.nickName=b.newCard.expMonth=b.newCard.expYear=b.newCard.secureCode=""):angular.isDefined(e.fieldErrors)&&0<e.fieldErrors.length?b.addNewCardModel.addAuthUserEdit=!0:angular.isDefined(e.errorList)&&0<e.errorList.length&&($("#modalAddCreditCard").modal("hide"),b.avisChargeCard=b.saveCardMethod=b.addNewCardModel.addAuthUserEdit=
b.addNewCardModel.formValidated=!1,b.newCard.number=b.newCard.nickName=b.newCard.expMonth=b.newCard.expYear=b.newCard.secureCode="");q.requestInProgress=!1}else angular.isDefined(e.reservationSummary)&&angular.isDefined(e.reservationSummary.splitBillSummary)&&angular.isDefined(e.reservationSummary.splitBillSummary.splitBillPrimary)&&angular.isDefined(e.reservationSummary.splitBillSummary.splitBillPrimary.address)&&null!=e.reservationSummary.splitBillSummary.splitBillPrimary.address&&(b.reservationModel.splitBillSummary=
e.reservationSummary.splitBillSummary),angular.isDefined(e.reservationSummary)&&angular.isDefined(e.reservationSummary.creditcards)&&(b.reservationModel.creditcards=e.reservationSummary.creditcards,b.reservationModel.creditcards&&0<b.reservationModel.creditcards.length&&r()),M()},function(e){angular.isDefined(e.errorList)&&0<e.errorList.length&&(b.errorDisplayList=e.errorList);q.requestInProgress=!1})}function I(){b.prod&&b.prod.customerInfo&&b.prod.customerInfo.addresses&&0<b.prod.customerInfo.addresses.length&&
b.prod.customerInfo.addresses[0]&&(b.custAddress=b.prod.customerInfo.addresses[0])}function u(){if(b.reservationModel.splitBillSummary.splitBillPrimary&&b.reservationModel.splitBillSummary.splitBillSecondary)b.reservationModel.splitBillSummary.splitBillPrimary.ccSummary&&b.reservationModel.splitBillSummary.splitBillSecondary.ccSummary?($(".modal-paylater-split-payment").find(".close-icon-black").addClass("cus-d-none"),$(".modal-paylater-split-payment").find(".modal-paylater-split-payment-warning").removeClass("cus-d-none"),
$(".modal-paylater-split-payment").find(".modal-paylater-split-payment-non-warning").addClass("cus-d-none")):b.reservationModel.prepayTxn&&C.getReservationExtension().then(function(b){E.addToReviewData(b)});else if(b.reservationModel.prepayTxn&&b.reservationModel.splitBillSummary.splitBillPrimary&&null==b.reservationModel.splitBillSummary.splitBillSecondary)C.getReservationExtension().then(function(b){E.addToReviewData(b)});else{var e=b.reservationModel.displayControls.reservation!==g.resFlowModify||
b.isBookAgainFlow?"Create Flow":"Modfiy Flow",f=!0===b.reservationModel.prepayProcessIndicator?"PayNow":"PayLater",h="Create Flow"===e?"Reserve":-1!=B.location.href.indexOf("review-and-book")?"Confirm Modification":"Keep Modifications";z.resSplitOpted("Toggle OFF-"+f+"-"+e,h)}}function m(e){if(angular.isDefined(e.rateSummary)&&e.rateSummary.selectedProducts){var f=0;angular.forEach(e.rateSummary.selectedProducts,function(b){"GSO"!=b.code&&f++})}var g=f&&0<f?!0:!1,h=e.rateSummary&&e.rateSummary.selectedInsurances&&
0<e.rateSummary.selectedInsurances.length?!0:!1;b.isAncillarySelected=g||h||!g&&1<e.splitBillingLengthOfRental||!h&&1<e.splitBillingLengthOfRental?!0:!1}function f(e){b.totalDays=e;for(e=1;e<b.totalDays;e++){var f=e;e=1==e?e+" Day":e+" Days";b.reservationDays.vehicleDays.push(e);e=f}for(e=0;e<=b.totalDays;e++)f=e,e=1==e?e+" Day":e+" Days",b.reservationDays.productDays.primaryValues.push(e),b.reservationDays.productDays.secondaryValues.push(e),b.reservationDays.insuranceDays.primaryValues.push(e),
b.reservationDays.insuranceDays.secondaryValues.push(e),e=f}function D(e){b.ancillarySplitModel.products.primary=b.dropDownValue.proDropDownPri=null==e.reservationSummary.splitBillSummary.splitBillPrimary.productmap?{}:e.reservationSummary.splitBillSummary.splitBillPrimary.productmap;b.ancillarySplitModel.insurances.primary=b.dropDownValue.insDropDownPri=null==e.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap?{}:e.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap;
var f=C.displayDropDown(b.dropDownValue.proDropDownPri,b.dropDownValue.insDropDownPri,"primary",e);b.ancillarySplitModel.insurances.primary=b.dropDownValue.insDropDownPri=f.insDrop;b.ancillarySplitModel.products.primary=b.dropDownValue.proDropDownPri=f.proDrop;null!=e.reservationSummary.splitBillSummary.splitBillSecondary&&(b.ancillarySplitModel.products.secondary=b.dropDownValue.proDropDownSec=null==e.reservationSummary.splitBillSummary.splitBillSecondary.productmap?{}:e.reservationSummary.splitBillSummary.splitBillSecondary.productmap,
b.ancillarySplitModel.insurances.secondary=b.dropDownValue.insDropDownSec=null==e.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap?{}:e.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap);f=C.displayDropDown(b.dropDownValue.proDropDownSec,b.dropDownValue.insDropDownSec,"secondary",e);b.ancillarySplitModel.insurances.secondary=b.dropDownValue.insDropDownSec=f.insDrop;b.ancillarySplitModel.products.secondary=b.dropDownValue.proDropDownSec=f.proDrop;1==
e.reservationSummary.splitBillSummary.numberOfDays?(b.ancillarySplitModel.vehicleAndFees.primary=e.reservationSummary.splitBillSummary.splitBillPrimary.lengthOfRental,b.ancillarySplitModel.vehicleAndFees.secondary=e.reservationSummary.splitBillSummary.splitBillSecondary.lengthOfRental,b.ancillarySplitModel.vehicleAndFees.primary=1<b.ancillarySplitModel.vehicleAndFees.primary||0==b.ancillarySplitModel.vehicleAndFees.primary?b.ancillarySplitModel.vehicleAndFees.primary+" Days":b.ancillarySplitModel.vehicleAndFees.primary+
" Day",b.ancillarySplitModel.vehicleAndFees.secondary=1<b.ancillarySplitModel.vehicleAndFees.secondary||0==b.ancillarySplitModel.vehicleAndFees.secondary?b.ancillarySplitModel.vehicleAndFees.secondary+" Days":b.ancillarySplitModel.vehicleAndFees.secondary+" Day"):(b.ancillarySplitModel.vehicleAndFees.primary=null,b.ancillarySplitModel.vehicleAndFees.secondary=null);angular.forEach(e.reservationSummary.productSummaryList,function(e){e.subProducts&&0<e.subProducts.length?angular.forEach(e.subProducts,
function(e){"PERRENTAL"==e.category&&(b.oneTimeProducts[e.code]=b.ancillarySplitModel.products.primary[e.code]==b.enableSplitResponse.reservationSummary.splitBillingLengthOfRental?"primary":b.ancillarySplitModel.products.secondary[e.code]==b.enableSplitResponse.reservationSummary.splitBillingLengthOfRental?"secondary":" ")}):"PERRENTAL"==e.category&&(b.oneTimeProducts[e.code]=b.ancillarySplitModel.products.primary[e.code]==b.enableSplitResponse.reservationSummary.splitBillingLengthOfRental?"primary":
b.ancillarySplitModel.products.secondary[e.code]==b.enableSplitResponse.reservationSummary.splitBillingLengthOfRental?"secondary":" ")})}function e(){b.reservationDays.productDays.primaryValues=[];b.reservationDays.productDays.secondaryValues=[];b.reservationDays.insuranceDays.primaryValues=[];b.reservationDays.insuranceDays.secondaryValues=[];"number"===typeof b.ancillarySplitModel.vehicleAndFees.primary&&(b.ancillarySplitModel.vehicleAndFees.primary=1<b.ancillarySplitModel.vehicleAndFees.primary||
0==b.ancillarySplitModel.vehicleAndFees.primary?b.ancillarySplitModel.vehicleAndFees.primary+" Days":b.ancillarySplitModel.vehicleAndFees.primary+" Day");"number"===typeof b.ancillarySplitModel.vehicleAndFees.secondary&&(b.ancillarySplitModel.vehicleAndFees.secondary=1<b.ancillarySplitModel.vehicleAndFees.secondary||0==b.ancillarySplitModel.vehicleAndFees.secondary?b.ancillarySplitModel.vehicleAndFees.secondary+" Days":b.ancillarySplitModel.vehicleAndFees.secondary+" Day");if(0!=b.ancillarySplitModel.vehicleAndFees.secondary||
"0 Days"!=b.ancillarySplitModel.vehicleAndFees.secondary)b.reservationDays.productDays.secondaryValues.push(b.ancillarySplitModel.vehicleAndFees.secondary),b.reservationDays.insuranceDays.secondaryValues.push(b.ancillarySplitModel.vehicleAndFees.secondary);if(0!=b.ancillarySplitModel.vehicleAndFees.primary||"0 Days"!=b.ancillarySplitModel.vehicleAndFees.primary)b.reservationDays.productDays.primaryValues.push(b.ancillarySplitModel.vehicleAndFees.primary),b.reservationDays.insuranceDays.primaryValues.push(b.ancillarySplitModel.vehicleAndFees.primary);
"number"===typeof b.totalDays&&(b.totalDays+=" Days");var e=parseInt(b.ancillarySplitModel.vehicleAndFees.secondary.replace(/^[^0-9]+/,"")),f=parseInt(b.totalDays.replace(/^[^0-9]+/,""));e!=f&&(b.reservationDays.productDays.secondaryValues.push(b.totalDays),b.reservationDays.insuranceDays.secondaryValues.push(b.totalDays));b.checkForMaxDaysExtras(b.dropDownValue.proDropDownPri,b.dropDownValue.insDropDownPri,"primary");b.checkForMaxDaysExtras(b.dropDownValue.proDropDownSec,b.dropDownValue.insDropDownSec,
"secondary")}function h(){$("#primaryAmount").removeClass("platform-element-error");$("#primaryAmountErrormsg").css("display","none");$("#secondaryAmount").removeClass("platform-element-error");$("#secondryAmountErrormsg").css("display","none")}function r(){for(var e=0;e<b.reservationModel.creditcards.length;e++)b.reservationModel.creditcards[e].expiryMsg?J(b.reservationModel.creditcards[e].expiryMsg.code)&&(b.reservationModel.creditcards[e].expiredCheckFrontEnd=!0):b.reservationModel.creditcards[e].expiredCheckFrontEnd=
!1}function J(b){return"05006"==b||"05046"==b||"05054"==b||"05056"==b||"05061"==b||"05062"==b||"05065"==b||"05066"==b||"05176"==b||"05177"==b||"05178"==b||"05179"==b||"05180"==b||"05181"==b||"05182"==b||"05183"==b||"05184"==b||"05185"==b||"05186"==b||"05187"==b||"05200"==b||"05201"==b||"05202"==b||"05203"==b||"05204"==b||"05205"==b||"05206"==b||"05207"==b||"05208"==b||"05209"==b||"05210"==b||"05211"==b||"06015"==b?!0:!1}function M(){b.reservationModel&&b.reservationModel.splitBillSummary&&(b.reservationModel.splitBillSummary.splitBillPrimary&&
b.reservationModel.splitBillSummary.splitBillPrimary.ccSummary&&b.reservationModel.splitBillSummary.splitBillPrimary.ccSummary.expiryMsg&&b.reservationModel.splitBillSummary.splitBillPrimary.ccSummary.expiryMsg.code&&(b.isPrimaryCardExpired=J(b.reservationModel.splitBillSummary.splitBillPrimary.ccSummary.expiryMsg.code)),b.reservationModel.splitBillSummary.splitBillSecondary&&b.reservationModel.splitBillSummary.splitBillSecondary.ccSummary&&b.reservationModel.splitBillSummary.splitBillSecondary.ccSummary.expiryMsg&&
b.reservationModel.splitBillSummary.splitBillSecondary.ccSummary.expiryMsg.code&&(b.isSecondaryCardExpired=J(b.reservationModel.splitBillSummary.splitBillSecondary.ccSummary.expiryMsg.code)))}var b=this;b.errorDisplayList=[];b.primaryAmountOldValue="";b.secondaryAmountOldValue="";b.errorOnSave="";b.selectedProducts=[];b.selectedInsurances=[];b.addressDisplayList=[];b.addresses=[];b.updateAmounts=function(e){e==g.splitInRental.PRIMARYAMOUNT&&angular.isDefined(b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount)&&
""!=b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount&&parseFloat(b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount)<=parseFloat(b.prod.reservationSummary.rateSummary.estimatedTotal)?(b.primaryAmountOldValue=b.enableSplitResponse.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount,b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount=(b.prod.reservationSummary.rateSummary.estimatedTotal-b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount).toFixed(2),
b.reservationModel.splitBillSummary.splitConfirmed=!1):e==g.splitInRental.SECONDARYAMOUNT&&angular.isDefined(b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount)&&""!=b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount&&parseFloat(b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount)<=parseFloat(b.prod.reservationSummary.rateSummary.estimatedTotal)&&(b.secondaryAmountOldValue=b.enableSplitResponse.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount,
b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount=(b.prod.reservationSummary.rateSummary.estimatedTotal-b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount).toFixed(2),b.reservationModel.splitBillSummary.splitConfirmed=!1)};b.enableItemizedConfirm=!1;b.isAncillarySelected=!1;b.toggle=!1;b.prod=q.reservationReviewData;b.cardType;b.reservationModel=A.getReservationModel();b.tempCountry=b.reservationModel.paymentRq.address.country?b.reservationModel.paymentRq.address.country:
b.reservationModel.personalInfoRQ.residency;b.brand=window.brand;b.domain=B.domain.toUpperCase();b.helpURL="";b.splitByTypeConfirmed;b.splitByAmountConfirmed;b.addNewCardModel={showCity:!1,showSuburb:!1,showState:!1,showZipcode:!1,formValidated:!1,epIndicator:!1,saveCreditCard:!1};b.billingAddress={sameAsPrimary:!1,address1:"",address2:"",address3:"",suburb:"",city:"",state:null,zipCode:""};b.indicatorMap={credit_id:"",address_id:""};b.ancillarySplitModel={vehicleAndFees:{primary:null,secondary:null},
products:{primary:[],secondary:[]},insurances:{primary:[],secondary:[]}};b.reservationDays={productDays:{primaryValues:[],secondaryValues:[]},insuranceDays:{primaryValues:[],secondaryValues:[]},vehicleDays:[]};b.dropDownValue={proDropDownPri:{},insDropDownPri:{},proDropDownSec:{},insDropDownSec:{},primaryValue:null,secondaryValue:null};b.oneTimeProducts={};b.enableSplitResponse={};b.totalDays="";var O={rentalLocation:""};b.splitSelected=function(){h();var e=b.reservationModel.splitBillSummary?b.reservationModel.splitBillSummary.splitConfirmed?
"Modify Split":"Add Split":"Add Split",f=b.reservationModel.displayControls.reservation!==g.resFlowModify||b.isBookAgainFlow?"Create Flow":"Modfiy Flow",l=!0===b.reservationModel.prepayProcessIndicator?"PayNow":"PayLater",m="Create Flow"===f?"Reserve":-1!=B.location.href.indexOf("review-and-book")?"Confirm Modification":"Keep Modifications";z.resSplitOpted(e+"-"+l+"-"+f,m);void 0!=b.primaryCardSelected&&void 0!=b.secondaryCardSelected||b.mapSplitPaymentInfo(b.reservationModel);b.reservationModel.splitBillSummary&&
b.reservationModel.splitBillSummary.splitOpted||(b.errorOnSave="");b.reservationModel.splitBillSummary&&!b.reservationModel.splitBillSummary.splitConfirmed&&(b.reservationModel.splitBillSummary.splitOpted=!1,$(".modal-paylater-split-payment").find(".modal-paylater-split-payment-warning").addClass("cus-d-none"),$(".modal-paylater-split-payment").find(".modal-paylater-split-payment-non-warning").removeClass("cus-d-none"));b.reservationModel.splitBillSummary&&b.reservationModel.splitBillSummary.splitConfirmed&&
b.reservationModel.splitBillSummary.dollarAmount&&(b.splitByAmountConfirmed=!0);b.reservationModel.splitBillSummary&&b.reservationModel.splitBillSummary.splitConfirmed&&b.reservationModel.splitBillSummary.numberOfDays&&(b.splitByTypeConfirmed=!0);I()};b.removeErrorCss=h;b._splitOptionChange=function(){$("input:checkbox.splitPayNow").change(function(){$(this).is("#uncheck :checked")||(b.toggle=!0);b.toggle&&b.prod&&b.prod.reservationSummary&&b.prod.reservationSummary.prepayTxn&&b.reservationModel.splitBillSummary.splitBillSecondary&&
b.reservationModel.splitBillSummary.splitBillSecondary.ccSummary&&b.reservationModel.splitBillSummary.splitBillSecondary.ccSummary.number&&(angular.element(".modal-paynow-split-payment").modal("show"),setTimeout(function(){jQuery("body").addClass("modal-open")},500))});t.$parent.vm.errorDisplayList&&1==t.$parent.vm.errorDisplayList.length&&"12345678"==t.$parent.vm.errorDisplayList[0].code&&(t.$parent.vm.errorDisplayList=[]);void 0===b.prod&&(b.prod=q.reservationReviewData);b.reservationModel.splitBillSummary.splitOpted||
(b.errorOnSave="");if(b.reservationModel.splitBillSummary.splitOpted){var e=b.reservationModel.displayControls.reservation!==g.resFlowModify||b.isBookAgainFlow?"Create Flow":"Modfiy Flow",f=!0===b.reservationModel.prepayProcessIndicator?"PayNow":"PayLater",h="Create Flow"===e?"Reserve":-1!=B.location.href.indexOf("review-and-book")?"Confirm Modification":"Keep Modifications";z.resSplitOpted("Toggle ON-"+f+"-"+e,h);q.requestInProgress=!0;C.splitEnable().then(function(e){b.enableSplitResponse=angular.copy(e);
angular.isDefined(e.customerInfo)&&(b.prod.customerInfo=e.customerInfo);q.requestInProgress=!1;n(e.reservationSummary);angular.isDefined(e.reservationSummary.address)&&b.reservationModel.splitBillSummary.splitBillPrimary&&(b.reservationModel.splitBillSummary.splitBillPrimary.address=e.reservationSummary.address);m(e.reservationSummary)})}else u();I()};b.mapSplitPaymentInfo=n;b.resetSplitPaymentInfo=u;b.splitPaymentInit=x;b.processCreditCardList=function(e,f){"primary"===f?y(function(){b.primaryCardSelected=
e}):"secondary"===f&&y(function(){b.secondaryCardSelected=e});H(e,f)};b.splitPaymentAmount=function(e,f){b.errorOnSave="";b.errorAmountSplit="";e!=g.splitInRental.PRIMARYAMOUNT||!angular.isDefined(b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount)||""==b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount||!angular.isUndefined(f)&&angular.element(f.target).hasClass("ng-invalid")?e!=g.splitInRental.SECONDARYAMOUNT||!angular.isDefined(b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount)||
""==b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount||!angular.isUndefined(f)&&angular.element(f.target).hasClass("ng-invalid")||(b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount=parseFloat(b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount).toFixed(2),b.secondaryAmountOldValue!=b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount||""==b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount||angular.element("#primaryAmount").hasClass("ng-invalid")?
(b.primaryAmountOldValue=b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount,b.secondaryAmountOldValue=b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount,h()):b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount=b.primaryAmountOldValue):(b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount=parseFloat(b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount).toFixed(2),b.primaryAmountOldValue!=b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount||
""==b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount||angular.element("#secondaryAmount").hasClass("ng-invalid")?(b.primaryAmountOldValue=b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount,b.secondaryAmountOldValue=b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount,h()):b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount=b.secondaryAmountOldValue)};b.mapCardAndValidate=H;b.splitPaymentConfirm=function(e){var f=$("#primaryAmount, #secondaryAmount").hasClass("platform-element-error")?
!0:!1;if(e==g.splitInRental.AMOUNT&&!f)0!=b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount||b.reservationModel.splitBillSummary.splitConfirmed?b.reservationModel.splitBillSummary.splitConfirmed?($(".modal-paylater-split-payment").modal("hide"),b.errorOnSave=""):(e={splitType:g.splitInRental.AMOUNT,splitOpted:b.reservationModel.splitBillSummary.splitOpted,amount:b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount,estimateCall:!1},E.addToSplitDetails(e),b.splitByTypeAPICall(e)):
b.errorOnSave=Dictionary.I18n.get("err.global.secondary.amount.zero");else if(e==g.splitInRental.ITEMIZED){var h=[],l=[];angular.forEach(b.ancillarySplitModel.products.secondary,function(b,e){b={code:e,days:"string"==typeof b?parseInt(b.replace(/^[^0-9]+/,"")):b};h.push(b)});angular.forEach(b.ancillarySplitModel.insurances.secondary,function(b,e){b={code:e,days:"string"==typeof b?parseInt(b.replace(/^[^0-9]+/,"")):b};l.push(b)});e={days:angular.isDefined(b.ancillarySplitModel.vehicleAndFees.secondary)&&
""!=b.ancillarySplitModel.vehicleAndFees.secondary?b.ancillarySplitModel.vehicleAndFees.secondary:null,splitOpted:b.reservationModel.splitBillSummary.splitOpted,estimateCall:!1,selectedProducts:h,selectedInsurances:l};E.addToSplitDetails(e);b.splitByTypeAPICall(e)}b.reservationModel.splitBillSummary.splitBillPrimary.ccSummary=b.primaryCardSelected;b.reservationModel.splitBillSummary.splitBillSecondary.ccSummary=b.secondaryCardSelected;e=A.getReservationModel();e.splitBillSummary=b.reservationModel.splitBillSummary;
A.setReservationModel(e);1==b.prod.reservationSummary.qantasLoyaltyEligible&&(b.prod.reservationSummary.qantasLoyaltyEligible=!1,b.reservationModel.qantasLoyaltyEligible=!1,A.setReservationModel(b.reservationModel),angular.element(document).injector().get("storageService").setStorageData("qantasMessage",!1),angular.element(document).injector().get("storageService").deleteStorageData("qantasMessage"))};b.splitByTypeAPICall=function(l,m){if(l.splitType==g.splitInRental.AMOUNT)q.requestInProgress=!0,
C.saveSplit().then(function(e){if(angular.isDefined(e.reservationSummary)&&angular.isDefined(e.reservationSummary.splitBillSummary)&&(h(),b.primaryAmountOldValue=b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount=e.reservationSummary.splitBillSummary.splitBillPrimary?e.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount:"0.00",b.secondaryAmountOldValue=b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount=e.reservationSummary.splitBillSummary.splitBillSecondary?
e.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount:"0.00",b.primaryCardSelected=e.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary,b.secondaryCardSelected=e.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary,b.reservationModel.splitBillSummary.splitConfirmed=e.reservationSummary.splitBillSummary.splitConfirmed,b.reservationModel.splitBillSummary.splitConfirmed)){b.reservationModel.splitBillSummary=e.reservationSummary.splitBillSummary;A.setReservationModel(b.reservationModel);
b.ancillarySplitModel.products.primary=null==e.reservationSummary.splitBillSummary.splitBillPrimary.productmap?{}:e.reservationSummary.splitBillSummary.splitBillPrimary.productmap;b.ancillarySplitModel.insurances.primary=null==e.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap?{}:e.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap;var f=C.displayDropDown(b.ancillarySplitModel.products.primary,b.ancillarySplitModel.insurances.primary,"primary",e);b.ancillarySplitModel.insurances.primary=
b.dropDownValue.insDropDownPri=f.insDrop;b.ancillarySplitModel.products.primary=b.dropDownValue.proDropDownPri=f.proDrop;b.ancillarySplitModel.products.secondary=null==e.reservationSummary.splitBillSummary.splitBillSecondary.productmap?{}:e.reservationSummary.splitBillSummary.splitBillSecondary.productmap;b.ancillarySplitModel.insurances.secondary=null==e.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap?{}:e.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap;
f=C.displayDropDown(b.ancillarySplitModel.products.secondary,b.ancillarySplitModel.insurances.secondary,"secondary",e);b.ancillarySplitModel.insurances.secondary=b.dropDownValue.insDropDownSec=f.insDrop;b.ancillarySplitModel.products.secondary=b.dropDownValue.proDropDownSec=f.proDrop;E.addToReviewData(e);b.enableSplitResponse=angular.copy(e);b.splitByTypeConfirmed=!1;b.splitByAmountConfirmed=!0;$(".modal-paylater-split-payment").modal("hide");b.errorOnSave="";v.current.name===g.modifyReviewConfirmPage&&
E.addReviewModificationData(e);e=b.reservationModel.displayControls.reservation!==g.resFlowModify||b.isBookAgainFlow?"Create Flow":"Modfiy Flow";f="Create Flow"===e?"Reserve":-1!=B.location.href.indexOf("review-and-book")?"Confirm Modification":"Keep Modifications";z.resSplitOpted("Saved Amount Split-"+e,f)}q.requestInProgress=!1},function(e){angular.isDefined(e.errorList)&&0<e.errorList.length&&(b.errorAmountSplit=t.processErrorMessage(e).errorList,q.requestInProgress=!1)});else{var n=b.reservationModel.displayControls.reservation!==
g.resFlowModify||b.isBookAgainFlow?"Create Flow":"Modfiy Flow",r="Create Flow"===n?"Reserve":-1!=B.location.href.indexOf("review-and-book")?"Confirm Modification":"Keep Modifications";q.requestInProgress=!0;C.saveSplit().then(function(h){if(angular.isDefined(h.reservationSummary)&&angular.isDefined(h.reservationSummary.splitBillSummary))if(b.reservationModel.splitBillSummary.splitConfirmed=h.reservationSummary.splitBillSummary.splitConfirmed,E.addToReviewData(h),b.reservationModel.splitBillSummary.splitConfirmed&&
(b.reservationModel.splitBillSummary=h.reservationSummary.splitBillSummary,A.setReservationModel(b.reservationModel),b.splitByTypeConfirmed=!0,b.splitByAmountConfirmed=!1,v.current.name===g.modifyReviewConfirmPage&&E.addReviewModificationData(h),b.reservationModel.splitBillSummary.numberOfDays&&b.reservationModel.splitBillSummary.counterProducts||b.reservationModel.splitBillSummary.numberOfDays&&b.reservationModel.splitBillSummary.optionalServices?z.resSplitOpted("Saved Itemized Split-"+n,r):b.reservationModel.splitBillSummary.numberOfDays?
z.resSplitOpted("Saved Days Split-"+n,r):z.resSplitOpted("Saved Ancillary Split-"+n,r),angular.element("#primaryAmount").hasClass("ng-invalid")&&p.resetError("vm.reservationModel.splitBillSummary.splitBillPrimary.cardAmount",!1),angular.element("#secondaryAmount").hasClass("ng-invalid")&&p.resetError("vm.reservationModel.splitBillSummary.splitBillSecondary.cardAmount",!1),b.errorOnSave=""),b.reservationModel.splitBillSummary.splitConfirmed)h.reservationSummary&&h.reservationSummary.splitBillSummary&&
(1==h.reservationSummary.splitBillSummary.counterProducts||1==h.reservationSummary.splitBillSummary.optionalServices||1==h.reservationSummary.splitBillSummary.numberOfDays)&&(b.enableSplitResponse.reservationSummary.splitBillSummary=angular.copy(h.reservationSummary.splitBillSummary)),h.reservationSummary&&h.reservationSummary.splitBillSummary&&0==h.reservationSummary.splitBillSummary.dollarAmount&&(b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount=h.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount?
h.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount:h.reservationSummary.rateSummary.estimatedTotal,b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount=h.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount?h.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount:"0.00"),D(h),b.enableItemizedConfirm=!1,b.enableSplitResponse=angular.copy(h),$(".split-amount-modal").modal("hide");else{b.itemizedPrimaryAmount=b.primaryAmountOldValue=b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount=
h.reservationSummary.splitBillSummary.splitBillPrimary?h.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount:0;b.itemizedSecondaryAmount=b.secondaryAmountOldValue=b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount=h.reservationSummary.splitBillSummary.splitBillSecondary?h.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount:"0.00";b.enableItemizedConfirm=0!=b.itemizedSecondaryAmount?!0:!1;if(angular.isDefined(h.reservationSummary.splitBillSummary.splitBillPrimary)){angular.isDefined(h.reservationSummary.splitBillSummary.splitBillPrimary.productmap)&&
(b.dropDownValue.proDropDownPri=b.ancillarySplitModel.products.primary=h.reservationSummary.splitBillSummary.splitBillPrimary.productmap=null==h.reservationSummary.splitBillSummary.splitBillPrimary.productmap?{}:h.reservationSummary.splitBillSummary.splitBillPrimary.productmap);angular.isDefined(h.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap)&&(b.dropDownValue.insDropDownPri=b.ancillarySplitModel.insurances.primary=h.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap=
null==h.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap?{}:h.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap);var l=C.displayDropDown(b.dropDownValue.proDropDownPri,b.dropDownValue.insDropDownPri,"primary",h);b.ancillarySplitModel.products.primary=b.dropDownValue.proDropDownPri=l.proDrop;b.ancillarySplitModel.insurances.primary=b.dropDownValue.insDropDownPri=l.insDrop}if(angular.isDefined(h.reservationSummary.splitBillSummary.splitBillSecondary)){angular.isDefined(h.reservationSummary.splitBillSummary.splitBillSecondary.productmap)&&
(b.dropDownValue.proDropDownSec=b.ancillarySplitModel.products.secondary=h.reservationSummary.splitBillSummary.splitBillSecondary.productmap=null==h.reservationSummary.splitBillSummary.splitBillSecondary.productmap?{}:h.reservationSummary.splitBillSummary.splitBillSecondary.productmap);angular.isDefined(h.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap)&&(b.dropDownValue.insDropDownSec=b.ancillarySplitModel.insurances.secondary=h.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap=
null==h.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap?{}:h.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap);l=C.displayDropDown(b.dropDownValue.proDropDownSec,b.dropDownValue.insDropDownSec,"secondary",h);b.ancillarySplitModel.products.secondary=b.dropDownValue.proDropDownSec=l.proDrop;b.ancillarySplitModel.insurances.secondary=b.dropDownValue.insDropDownSec=l.insDrop;for(var m in b.oneTimeProducts)for(var u in b.ancillarySplitModel.products.secondary)b.ancillarySplitModel.products.secondary.hasOwnProperty(m)&&
null!=b.ancillarySplitModel.vehicleAndFees.primary&&null!=b.ancillarySplitModel.vehicleAndFees.secondary&&(b.ancillarySplitModel.products.secondary[m]=h.reservationSummary.splitBillingLengthOfRental);for(m in b.oneTimeProducts)for(u in b.ancillarySplitModel.insurances.secondary)b.ancillarySplitModel.insurances.secondary.hasOwnProperty(m)&&null!=b.ancillarySplitModel.vehicleAndFees.primary&&null!=b.ancillarySplitModel.vehicleAndFees.secondary&&(b.ancillarySplitModel.insurances.secondary[m]=h.reservationSummary.splitBillingLengthOfRental)}h.reservationSummary&&
h.reservationSummary.splitBillSummary&&(1==h.reservationSummary.splitBillSummary.counterProducts||1==h.reservationSummary.splitBillSummary.optionalServices||1==h.reservationSummary.splitBillSummary.numberOfDays)&&(b.enableSplitResponse.reservationSummary.splitBillSummary=angular.copy(h.reservationSummary.splitBillSummary));angular.forEach(h.reservationSummary.productSummaryList,function(a){a.subProducts&&0<a.subProducts.length?angular.forEach(a.subProducts,function(a){"PERRENTAL"==a.category&&(b.oneTimeProducts[a.code]=
b.ancillarySplitModel.products.primary[a.code]==h.reservationSummary.splitBillingLengthOfRental?"primary":b.ancillarySplitModel.products.secondary[a.code]==h.reservationSummary.splitBillingLengthOfRental?"secondary":null)}):"PERRENTAL"==a.category&&(b.oneTimeProducts[a.code]=b.ancillarySplitModel.products.primary[a.code]==h.reservationSummary.splitBillingLengthOfRental?"primary":b.ancillarySplitModel.products.secondary[a.code]==h.reservationSummary.splitBillingLengthOfRental?"secondary":null)});null!=
b.ancillarySplitModel.vehicleAndFees.secondary&&null!=b.ancillarySplitModel.vehicleAndFees.primary?e():angular.isDefined(h.reservationSummary)&&angular.isDefined(h.reservationSummary.splitBillingLengthOfRental)&&null!=h.reservationSummary.splitBillingLengthOfRental&&(b.reservationDays.vehicleDays=[],b.reservationDays.productDays.primaryValues=[],b.reservationDays.productDays.secondaryValues=[],b.reservationDays.insuranceDays.primaryValues=[],b.reservationDays.insuranceDays.secondaryValues=[],f(h.reservationSummary.splitBillingLengthOfRental))}q.requestInProgress=
!1},function(e){angular.isDefined(e.errorList)&&0<e.errorList.length&&(b.errorItemizedSplit=t.processErrorMessage(e).errorList,e.reservationSummary&&(b.rentalDays.vehicleDays=[],b.rentalDays.productDays.primaryValues=[],b.rentalDays.productDays.secondaryValues=[],b.rentalDays.insuranceDays.primaryValues=[],b.rentalDays.insuranceDays.secondaryValues=[],f(e.reservationSummary.splitBillingLengthOfRental),D(e)),b.enableItemizedConfirm=!1,q.requestInProgress=!1)})}};b.checkEpIndicator=function(){angular.isDefined(b.prod)&&
angular.isDefined(b.prod.customerInfo)&&angular.isDefined(b.prod.customerInfo.cor)&&(b.prod.customerInfo.cor==g.countryCodeUS||b.prod.customerInfo.cor==g.countryCodeCA||b.prod.customerInfo.cor==g.countryCodeAU||b.prod.customerInfo.cor==g.countryCodeNZ)&&"avis"==b.brand&&angular.isDefined(b.prod.customerInfo.userState)&&"AUTHENTICATED"==b.prod.customerInfo.userState?b.addNewCardModel.epIndicator=!0:b.addNewCardModel.epIndicator=!1};b.getStatesForCountry=function(e,f){"onchange"==f&&(b.billingAddress.address1=
b.billingAddress.address2=b.billingAddress.address3=b.billingAddress.suburb=b.billingAddress.city=b.billingAddress.state=b.billingAddress.zipCode="");!b.countryList||void 0==e||""==e||e!==g.countryCodeAU&&e!==g.countryCodeCA&&e!==g.countryCodeUS||(f=b.countryList.indexOf(l("filter")(b.countryList,function(b){return b.code===e})[0]),b.statesForCountry=b.countryList[f].stateList);b._displayFunction(e)};b._displayFunction=function(e){b.addNewCardModel.showCity=e==g.countryCodeCA||e==g.countryCodePR||
e==g.countryCodeUS||e==g.countryCodeCX||e==g.countryCodeCV||e==g.countryCodeVI?!0:!1;b.addNewCardModel.showState=e==g.countryCodeAU||e==g.countryCodeCA||e==g.countryCodeUS||e==g.countryCodeNZ?!0:!1;b.addNewCardModel.showSuburb=e==g.countryCodeAU||e==g.countryCodeNZ?!0:!1;b.addNewCardModel.showZipcode=b.addNewCardModel.showSuburb||b.addNewCardModel.showCity?!0:!1};b.selectedAddressList=function(e){"1"==e.code?(angular.forEach(b.countryList,function(e){e.code==b.prod.reservationSummary.addresses[0].country&&
(b.reservationModel.paymentRq.address.country=e.code)}),angular.forEach(b.prod.reservationSummary.addresses,function(e){1==e.primary&&(b.reservationModel.paymentRq.address.address1=e.address1,b.reservationModel.paymentRq.address.address2=e.address2,b.reservationModel.paymentRq.address.address3=e.address3,b.reservationModel.paymentRq.address.city=e.city,b.reservationModel.paymentRq.address.state=e.state,b.reservationModel.paymentRq.address.zipCode=e.zipCode,b.indicatorMap.address_id=e.maskId,b.selectedAddress=
g.splitInRental.PRIMARYADDRESS)})):"2"==e.code&&(angular.forEach(b.countryList,function(e){e.code==b.prod.reservationSummary.addresses[1].country&&(b.reservationModel.paymentRq.address.country=e.code)}),angular.forEach(b.prod.reservationSummary.addresses,function(e){0==e.primary&&(b.reservationModel.paymentRq.address.address1=e.address1,b.reservationModel.paymentRq.address.address2=e.address2,b.reservationModel.paymentRq.address.address3=e.address3,b.reservationModel.paymentRq.address.city=e.city,
b.reservationModel.paymentRq.address.state=e.state,b.reservationModel.paymentRq.address.zipCode=e.zipCode,b.indicatorMap.address_id=e.maskId,b.selectedAddress=g.splitInRental.SECONDARYADDRESS)}))};b._populateAddressFields=function(){b.addNewCardModel.epIndicator?angular.isDefined(b.prod.reservationSummary.address)&&angular.isDefined(b.prod.reservationSummary.addresses)?(b.addresses=b.prod.reservationSummary.addresses,b.prefilledZipcode=b.prod.reservationSummary.addresses[0].zipCode):angular.isDefined(b.prod.reservationSummary.address)&&
!angular.isDefined(b.prod.reservationSummary.addresses)?(b.addresses.push(b.prod.reservationSummary.address),b.prefilledZipcode=b.prod.reservationSummary.address.zipCode):angular.isDefined(b.prod.reservationSummary.addresses)&&!angular.isDefined(b.prod.reservationSummary.address)&&(b.addresses=b.prod.reservationSummary.addresses,b.prefilledZipcode=b.prod.reservationSummary.addresses[0].zipCode):angular.isDefined(b.prod)&&angular.isDefined(b.prod.reservationSummary)&&b.prod.reservationSummary&&b.prod.reservationSummary.addresses?
(b.state=b.prod.reservationSummary.addresses[0].state,b.billingAddress=b.prod.reservationSummary.addresses[0],b.prefilledZipcode=b.prod.reservationSummary.addresses[0].zipCode):angular.isDefined(b.prod)&&angular.isDefined(b.prod.reservationSummary)&&angular.isDefined(b.prod.reservationSummary.address)&&angular.isDefined(b.prod.reservationSummary.userState)&&"ANONYMOUS"==b.prod.reservationSummary.userState&&(b.state=b.prod.reservationSummary.address.state,b.billingAddress=b.prod.reservationSummary.address,
b.prefilledZipcode=b.prod.reservationSummary.address.zipCode)};b._getAddressList=function(e){b.addressDisplayList=[];angular.forEach(e,function(e){var f={code:"",description:""};"1"==e.maskId&&(f.code="1",f.description=g.splitInRental.PRIMARYADDRESS,b.addressDisplayList.push(f),b.selectedAddress=g.splitInRental.PRIMARYADDRESS,b.reservationModel.paymentRq.address.address1=e.address1,b.reservationModel.paymentRq.address.address2=e.address2,b.reservationModel.paymentRq.address.address3=e.address3,b.reservationModel.paymentRq.address.city=
e.city,b.reservationModel.paymentRq.address.state=e.state,b.reservationModel.paymentRq.address.zipCode=e.zipCode,b.reservationModel.paymentRq.address.country=e.country,angular.forEach(b.countryList,function(e){e.code==b.addresses[0].country&&(b.reservationModel.paymentRq.address.country=e.code)}),b.indicatorMap.address_id=e.maskId);"2"==e.maskId&&(f.code="2",f.description=g.splitInRental.SECONDARYADDRESS,b.addressDisplayList.push(f))});return b.addressDisplayList};b._loadMnthYrDropdown=function(){var e=
ABG.loadMonthAndYear();b.expMonths=e.expMonths;b.expYears=e.expYears};b.saveCard=function(e){q.requestInProgress=!0;angular.element("#primaryAmount").hasClass("ng-invalid")&&p.resetError("vm.reservationModel.splitBillSummary.splitBillPrimary.cardAmount",!1);angular.element("#secondaryAmount").hasClass("ng-invalid")&&p.resetError("vm.reservationModel.splitBillSummary.splitBillSecondary.cardAmount",!1);p.validate(e).success(function(){b.saveCardMethod=!0;b.selectedAddress==g.splitInRental.PRIMARYADDRESS&&
angular.isDefined(b.prod.customerInfo.addresses&&b.prod.customerInfo.addresses[0])&&b.addNewCardModel.epIndicator&&!b.reservationModel.addAuthUserEdit&&!b.reservationModel.removeAddress?b.custAddress=b.prod.customerInfo.addresses[0]:b.selectedAddress==g.splitInRental.SECONDARYADDRESS&&angular.isDefined(b.prod.customerInfo.addresses[1])&&b.addNewCardModel.epIndicator&&!b.reservationModel.addAuthUserEdit?b.custAddress=b.prod.customerInfo.addresses[1]:(b.custAddress=b.billingAddress,b.custAddress.country=
b.reservationModel.paymentRq.address.country);var e=b.reservationModel.displayControls.reservation!==g.resFlowModify||b.isBookAgainFlow?"Create Flow":"Modfiy Flow",f=!0===b.reservationModel.prepayProcessIndicator?"PayNow":"PayLater",h="Create Flow"===e?"Reserve":-1!=B.location.href.indexOf("review-and-book")?"Confirm Modification":"Keep Modifications";"PRIMARY"===b.cardType.toUpperCase()?z.resSplitOpted("Saved Primary Card Details-"+f+"-"+e,h):"SECONDARY"===b.cardType.toUpperCase()&&z.resSplitOpted("Saved Secondary Card Details-"+
f+"-"+e,h);b.mapCardAndValidate(b.newCard,b.cardType)}).error(function(e){b.secureCode="";b.formError=ABG.getFormValidationError(e,!1)[0].message;b.addNewCardModel.formValidated=!0;var f=e.errorCount;1===f?b.pageError=w.trustAsHtml(e.MSG[0]):1<f&&(b.pageError=Dictionary.I18n.get("err.global.multi.errorMessage"));q.requestInProgress=!1})};b.getCustomerAddressInfoForPrepopultingModal=function(e){b.reservationModel.displayControls.reservation===g.resFlowModify&&b.prod.reservationSummary.prepayTxn&&b.reservationModel.splitEligible&&
b.reservationModel.splitBillSummary&&b.reservationModel.splitBillSummary.splitOpted&&!b.reservationModel.splitBillSummary.splitConfirmed&&(t.$parent.vm.errorDisplayList&&1==t.$parent.vm.errorDisplayList.length&&"12345678"==t.$parent.vm.errorDisplayList[0].code&&(t.$parent.vm.errorDisplayList=[]),jQuery("#dropdownMenu2").css("border-color","rgb(204, 204, 204)"),jQuery("#dropdownMenu2").parent().next().addClass("cus-d-none"));q.$broadcast("setReviewCreditCard",O);var f=window.countryList;b.countryList=
[];b.countryList=angular.fromJson(f?f:window.countryListForAddNewCard);b.reservationModel.paymentRq.address.country=b.tempCountry;b.getStatesForCountry(b.reservationModel.paymentRq.address.country,"onload");b.checkEpIndicator();b._populateAddressFields();b._getAddressList(b.addresses);b._loadMnthYrDropdown();b.cardType=e;f=b.reservationModel.displayControls.reservation!==g.resFlowModify||b.isBookAgainFlow?"Create Flow":"Modfiy Flow";var h=!0===b.reservationModel.prepayProcessIndicator?"PayNow":"PayLater",
l="Create Flow"===f?"Reserve":-1!=B.location.href.indexOf("review-and-book")?"Confirm Modification":"Keep Modifications";"PRIMARY"===b.cardType.toUpperCase()?z.resSplitOpted("Add Primary Card-"+h+"-"+f,l):"SECONDARY"===b.cardType.toUpperCase()&&z.resSplitOpted("Add Secondary Card-"+h+"-"+f,l);"secondary"==e&&(b.reservationModel.removeAddress=!1);b.avisChargeCard=!1;b.newCard={number:"",cardType:"",expMonth:null,expYear:null,secureCode:"",nickName:""};b.billingAddress={address1:"",address2:"",address3:"",
suburb:"",city:"",state:null,zipCode:""}};b.getAncillaryList=function(){b.reservationDays.vehicleDays=[];b.reservationDays.productDays.primaryValues=[];b.reservationDays.productDays.secondaryValues=[];b.reservationDays.insuranceDays.primaryValues=[];b.reservationDays.insuranceDays.secondaryValues=[];b.domain=B.domain.toUpperCase();C.getAncillaryList(b.enableSplitResponse).then(function(e){b.enableSplitResponse=angular.copy(e)});b.enableSplitResponse.reservationSummary&&(f(b.enableSplitResponse.reservationSummary.splitBillingLengthOfRental),
null!=b.enableSplitResponse.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount&&null!=b.enableSplitResponse.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount?(b.itemizedPrimaryAmount=angular.copy(b.enableSplitResponse.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount),b.itemizedSecondaryAmount=angular.copy(b.enableSplitResponse.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount)):null!=b.enableSplitResponse.reservationSummary.rateSummary&&
(b.itemizedPrimaryAmount=angular.copy(b.enableSplitResponse.reservationSummary.rateSummary.estimatedTotal),b.itemizedSecondaryAmount="0.00"));angular.isDefined(b.enableSplitResponse.reservationSummary.splitBillSummary)&&(b.enableSplitResponse.reservationSummary.splitBillSummary.counterProducts||b.enableSplitResponse.reservationSummary.splitBillSummary.optionalServices?(D(b.enableSplitResponse),null!=b.ancillarySplitModel.vehicleAndFees.secondary&&null!=b.ancillarySplitModel.vehicleAndFees.primary&&
e()):(angular.isDefined(b.enableSplitResponse.reservationSummary.splitBillSummary.splitBillPrimary)&&angular.isDefined(b.enableSplitResponse.reservationSummary.splitBillSummary.splitBillPrimary.splitBillingLengthOfRental)&&angular.isDefined(b.enableSplitResponse.reservationSummary.splitBillSummary.splitBillSecondary)&&angular.isDefined(b.enableSplitResponse.reservationSummary.splitBillSummary.splitBillSecondary.splitBillingLengthOfRental)&&b.enableSplitResponse.reservationSummary.splitBillSummary.numberOfDays&&
(b.ancillarySplitModel.vehicleAndFees.primary=b.enableSplitResponse.reservationSummary.splitBillSummary.splitBillPrimary.lengthOfRental,b.ancillarySplitModel.vehicleAndFees.secondary=b.enableSplitResponse.reservationSummary.splitBillSummary.splitBillSecondary.lengthOfRental),b.ancillarySplitModel.vehicleAndFees.secondary&&b.ancillarySplitModel.vehicleAndFees.primary&&e(),D(b.enableSplitResponse)))};b.splitToggleWarning=function(e){if("GOBACK"===e.toUpperCase())b.reservationModel.splitBillSummary.splitOpted=
!0,b.reservationModel.splitBillSummary.splitBillPrimary.cardAmount=b.primaryAmountOldValue,b.reservationModel.splitBillSummary.splitBillSecondary.cardAmount=b.secondaryAmountOldValue,$(".modal-paylater-split-payment").find(".modal-paylater-split-payment-warning").addClass("cus-d-none"),$(".modal-paylater-split-payment").find(".modal-paylater-split-payment-non-warning").removeClass("cus-d-none"),$(".modal-paylater-split-payment").find(".close-icon-black").removeClass("cus-d-none"),$(".modal-paynow-split-payment").modal("hide");
else if("OK"===e.toUpperCase()){e=b.reservationModel.displayControls.reservation!==g.resFlowModify||b.isBookAgainFlow?"Create Flow":"Modfiy Flow";var f=!0===b.reservationModel.prepayProcessIndicator?"PayNow":"PayLater",h="Create Flow"===e?"Reserve":-1!=B.location.href.indexOf("review-and-book")?"Confirm Modification":"Keep Modifications";z.resSplitOpted("Toggle OFF-"+f+"-"+e,h);b.reservationModel.splitBillSummary.splitOpted=!1;$(".modal-paylater-split-payment").find(".modal-paylater-split-payment-warning").addClass("cus-d-none");
$(".modal-paylater-split-payment").find(".modal-paylater-split-payment-non-warning").removeClass("cus-d-none");$(".modal-paylater-split-payment").find(".close-icon-black").removeClass("cus-d-none");b.reservationModel.splitBillSummary=null;C.deleteSplit().then(function(e){E.addToReviewData(e);b.reservationModel.splitBillSummary=e.reservationSummary&&e.reservationSummary.splitBillSummary?e.reservationSummary.splitBillSummary:void 0;""==b.reservationModel.paymentRq.cardNumber&&""!=b.reservationModel.paymentRq.cardType&&
(b.reservationModel.paymentRq.cardType="");b.prod.reservationSummary.qantasLoyaltyEligible=!0;v.reload()});b.splitByTypeConfirmed=!1;b.splitByAmountConfirmed=!1}};b.splitByItem=function(e,f){b.errorItemizedSplit="";if(angular.isDefined(f))var h=f.code;b.ancillarySplitModel.vehicleAndFees.primary="string"===typeof b.ancillarySplitModel.vehicleAndFees.primary?parseInt(b.ancillarySplitModel.vehicleAndFees.primary.replace(/^[^0-9]+/,"")):b.ancillarySplitModel.vehicleAndFees.primary;b.ancillarySplitModel.vehicleAndFees.secondary=
"string"===typeof b.ancillarySplitModel.vehicleAndFees.secondary?parseInt(b.ancillarySplitModel.vehicleAndFees.secondary.replace(/^[^0-9]+/,"")):b.ancillarySplitModel.vehicleAndFees.secondary;b.totalDays="string"===typeof b.totalDays?parseInt(b.totalDays.replace(/^[^0-9]+/,"")):b.totalDays;if("privalue-and-fees"==e||"secvalue-and-fees"==e){if("privalue-and-fees"==e){if(null==b.ancillarySplitModel.vehicleAndFees.primary?b.ancillarySplitModel.vehicleAndFees.secondary=null:(b.ancillarySplitModel.vehicleAndFees.secondary=
b.totalDays-b.ancillarySplitModel.vehicleAndFees.primary,b.ancillarySplitModel.vehicleAndFees.secondary=1<b.ancillarySplitModel.vehicleAndFees.secondary||0==b.ancillarySplitModel.vehicleAndFees.secondary?b.ancillarySplitModel.vehicleAndFees.secondary+" Days":b.ancillarySplitModel.vehicleAndFees.secondary+" Day"),0==b.ancillarySplitModel.vehicleAndFees.secondary||"0 Days"==b.ancillarySplitModel.vehicleAndFees.secondary)b.dropDownValue.secondaryValue="0 Days"}else if(null==b.ancillarySplitModel.vehicleAndFees.secondary?
b.ancillarySplitModel.vehicleAndFees.primary=null:(b.ancillarySplitModel.vehicleAndFees.primary=b.totalDays-b.ancillarySplitModel.vehicleAndFees.secondary,b.ancillarySplitModel.vehicleAndFees.primary=1<b.ancillarySplitModel.vehicleAndFees.primary||0==b.ancillarySplitModel.vehicleAndFees.primary?b.ancillarySplitModel.vehicleAndFees.primary+" Days":b.ancillarySplitModel.vehicleAndFees.primary+" Day"),0==b.ancillarySplitModel.vehicleAndFees.primary||"0 Days"==b.ancillarySplitModel.vehicleAndFees.primary)b.dropDownValue.primaryValue=
"0 Days";var g=C.itemizedDropdown(b.ancillarySplitModel.vehicleAndFees.primary,b.ancillarySplitModel.vehicleAndFees.secondary,b.enableSplitResponse,"",e);b.ancillarySplitModel.products={primary:g.productItemizedPri,secondary:g.productItemizedSec};b.ancillarySplitModel.insurances={primary:g.insuranceItemizedPri,secondary:g.insuranceItemizedSec};b.oneTimeProducts={};angular.forEach(b.ancillarySplitModel.products.secondary,function(e,f){"PERRENTAL"==e&&(b.oneTimeProducts[f]="secondary")});h=null;h=null!=
b.ancillarySplitModel.vehicleAndFees.secondary?b.ancillarySplitModel.vehicleAndFees.secondary:0;g={splitOpted:b.reservationModel.splitBillSummary.splitOpted,estimateCall:!0,days:h,selectedProducts:g.selectedProducts,selectedInsurances:g.selectedInsurances,primary:"privalue-and-fees"==e?!0:!1};E.addToSplitDetails(g);b.splitByTypeAPICall(g,e)}else if(""!=h&&angular.isDefined(f)&&("PERRENTAL"!=f.category||void 0==f.category))if(f=null,"string"===typeof b.totalDays&&(b.totalDays=parseInt(b.totalDays.replace(/^[^0-9]+/,
""))),b.ancillarySplitModel.products.secondary=b.getExtrasDays(b.ancillarySplitModel.products.secondary),b.ancillarySplitModel.products.primary=b.getExtrasDays(b.ancillarySplitModel.products.primary),b.ancillarySplitModel.insurances.secondary=b.getExtrasDays(b.ancillarySplitModel.insurances.secondary),b.ancillarySplitModel.insurances.primary=b.getExtrasDays(b.ancillarySplitModel.insurances.primary),"primaryProduct"==e?(b.ancillarySplitModel.products.secondary[h]=b.totalDays-b.ancillarySplitModel.products.primary[h],
g=C.itemizedDropdown(b.ancillarySplitModel.products.primary,b.ancillarySplitModel.products.secondary,b.enableSplitResponse,h,"product"),b.dropDownValue.proDropDownPri[h]=0):"secondaryProduct"==e?(b.ancillarySplitModel.products.primary[h]=b.totalDays-b.ancillarySplitModel.products.secondary[h],g=C.itemizedDropdown(b.ancillarySplitModel.products.primary,b.ancillarySplitModel.products.secondary,b.enableSplitResponse,h,"product"),b.dropDownValue.proDropDownSec[h]=0):"primaryInsurance"==e?(b.ancillarySplitModel.insurances.secondary[h]=
b.totalDays-b.ancillarySplitModel.insurances.primary[h],g=C.itemizedDropdown(b.ancillarySplitModel.insurances.primary,b.ancillarySplitModel.insurances.secondary,b.enableSplitResponse,h,"insurance"),b.dropDownValue.insDropDownPri[h]=0):"secondaryInsurance"==e&&(b.ancillarySplitModel.insurances.primary[h]=b.totalDays-b.ancillarySplitModel.insurances.secondary[h],g=C.itemizedDropdown(b.ancillarySplitModel.insurances.primary,b.ancillarySplitModel.insurances.secondary,b.enableSplitResponse,h,"insurance"),
b.dropDownValue.insDropDownSec[h]=0),"primaryProduct"==e||"secondaryProduct"==e)f=null!=b.ancillarySplitModel.vehicleAndFees.secondary?b.ancillarySplitModel.vehicleAndFees.secondary:0,g={days:f,splitOpted:b.reservationModel.splitBillSummary.splitOpted,estimateCall:!0,selectedProducts:g.selectedProducts,selectedInsurances:g.selectedInsurances,primary:"primaryProduct"==e?!0:!1},E.addToSplitDetails(g),b.splitByTypeAPICall(g);else{if("primaryInsurance"==e||"secondaryInsurance"==e)f=null!=b.ancillarySplitModel.vehicleAndFees.secondary?
b.ancillarySplitModel.vehicleAndFees.secondary:0,g={days:f,splitOpted:b.reservationModel.splitBillSummary.splitOpted,estimateCall:!0,selectedProducts:g.selectedProducts,selectedInsurances:g.selectedInsurances,primary:"primaryInsurance"==e?!0:!1},E.addToSplitDetails(g),b.splitByTypeAPICall(g)}else if("primary"==e&&angular.isDefined(f)&&"PERRENTAL"==f.category){g=C.itemizedDropdown(b.ancillarySplitModel.products.primary,b.ancillarySplitModel.products.secondary,b.enableSplitResponse,h,"product");for(f=
0;f<g.selectedProducts.length;f++){var l=g.selectedProducts[f];if(h===l.code){g.selectedProducts.splice(f,1);break}}f={code:h,days:0};g.selectedProducts.push(f);g={days:0,splitOpted:b.reservationModel.splitBillSummary.splitOpted,estimateCall:!0,selectedProducts:g.selectedProducts,selectedInsurances:g.selectedInsurances,primary:"primary"==e?!0:!1};E.addToSplitDetails(g);b.splitByTypeAPICall(g)}else if("secondary"==e&&angular.isDefined(f)&&"PERRENTAL"==f.category){g=C.itemizedDropdown(b.ancillarySplitModel.products.primary,
b.ancillarySplitModel.products.secondary,b.enableSplitResponse,h,"product");for(f=0;f<g.selectedProducts.length;f++)if(l=g.selectedProducts[f],h===l.code){g.selectedProducts.splice(f,1);break}f={code:h,days:b.enableSplitResponse.reservationSummary.splitBillingLengthOfRental};g.selectedProducts.push(f);g={days:0,splitOpted:b.reservationModel.splitBillSummary.splitOpted,estimateCall:!0,selectedProducts:g.selectedProducts,selectedInsurances:g.selectedInsurances,primary:!1};E.addToSplitDetails(g);b.splitByTypeAPICall(g)}};
b.addClassDropdown=function(e){"primary"===e&&void 0!=b.reservationModel.creditcards&&b.reservationModel.splitBillSummary&&b.reservationModel.splitBillSummary.splitBillPrimary&&b.reservationModel.splitBillSummary.splitBillPrimary.ccSummary&&angular.element(".modal.modal-paylater-split-payment .modal-dialog, body").addClass("scroll-bar-only-xs-none");"secondary"===e&&void 0!=b.reservationModel.creditcards&&b.reservationModel.splitBillSummary&&b.reservationModel.splitBillSummary.splitBillSecondary&&
"undefined"!==b.reservationModel.splitBillSummary.splitBillSecondary.ccSummary&&angular.element(".modal.modal-paylater-split-payment .modal-dialog, body").addClass("scroll-bar-only-xs-none");I()};b.removeClassDropdown=function(){void 0!=b.reservationModel.creditcards&&b.reservationModel.splitBillSummary.splitBillPrimary.ccSummary?angular.element(".modal.modal-paylater-split-payment .modal-dialog, body").removeClass("scroll-bar-only-xs-none"):void 0!=b.reservationModel.creditcards&&b.reservationModel.splitBillSummary.splitBillSecondary.ccSummary&&
angular.element(".modal.modal-paylater-split-payment .modal-dialog, body").removeClass("scroll-bar-only-xs-none")};b.showUseDiffCards=function(b){for(var e=!1,f=0;f<b.length;f++)b[f].expiryMsg&&J(b[f].expiryMsg.code)&&(e=!0);return 4<=b.length&&1==e?!0:!1};b.prefilPrimaryAddress=function(){b.reservationModel.removeAddress&&(p.resetError("vm.billingAddress.address1",!0),p.resetError("vm.billingAddress.address2",!0),p.resetError("vm.billingAddress.address3",!0),p.resetError("vm.billingAddress.suburb",
!0),p.resetError("vm.billingAddress.city",!0),p.resetError("vm.billingAddress.state",!0),p.resetError("vm.billingAddress.zipCode",!0),b.reservationModel.paymentRq.address.country=b.reservationModel.splitBillSummary.splitBillPrimary.address.country,b.getStatesForCountry(b.reservationModel.paymentRq.address.country,"onload"),b.billingAddress=b.reservationModel.splitBillSummary.splitBillPrimary.address,b.prefilledZipcode=b.billingAddress.zipCode,b.billingAddress.sameAsPrimary=b.reservationModel.removeAddress);
b.reservationModel.removeAddress||(b.billingAddress={address1:"",address2:"",address3:"",suburb:"",city:"",state:null,zipCode:""},b.reservationModel.paymentRq.address.country=b.tempCountry,b.getStatesForCountry(b.reservationModel.paymentRq.address.country,"onload"))};b.loadHelpModal=function(e){if(b.reservationModel&&b.reservationModel.pickUpLocation&&b.reservationModel.pickUpLocation.countryCode)var f=b.reservationModel.pickUpLocation.countryCode;b.helpURL=F.getUrl(e.target.parentElement,f)};b.checkExpiredCardCode=
J;b.ccExpireCodeCheck=r;b.isPrimaryCardExpired=!1;b.isSecondaryCardExpired=!1;b.displayExpiredWarningMessage=M;b.getExtrasDays=function(b){angular.forEach(b,function(e,f){b[f]="string"==typeof e?parseInt(e.replace(/^[^0-9]+/,"")):e});angular.forEach(b,function(e,f){null==e&&(b[f]=0)});return b};b.checkForMaxDaysExtras=function(e,f,h){"primary"==h?(angular.forEach(e,function(e,f){"0 Days"!=e||b.reservationDays.productDays.primaryValues.includes("0 Days")||b.reservationDays.productDays.primaryValues.unshift("0 Days")}),
angular.forEach(f,function(e,f){"0 Days"!=e||b.reservationDays.insuranceDays.primaryValues.includes("0 Days")||b.reservationDays.insuranceDays.primaryValues.unshift("0 Days")})):"secondary"==h&&(angular.forEach(e,function(e,f){"0 Days"!=e||b.reservationDays.productDays.secondaryValues.includes("0 Days")||b.reservationDays.productDays.secondaryValues.unshift("0 Days")}),angular.forEach(f,function(e,f){"0 Days"!=e||b.reservationDays.insuranceDays.secondaryValues.includes("0 Days")||b.reservationDays.insuranceDays.secondaryValues.unshift("0 Days")}))};
if(!(b.prod&&b.prod.reservationSummary&&b.prod.reservationSummary.prepayTxn))$(document).on("hidden.bs.modal",function(b){$(".modal.modal-paylater-split-payment:visible").length&&$("body").addClass("modal-open")});$("#modalAddCreditCard").on("hidden.bs.modal",function(){p.resetError("vm.newCard.expMonth",!0);p.resetError("vm.newCard.expYear",!0);p.resetError("vm.newCard.number",!0);p.resetError("vm.billingAddress.address1",!0);p.resetError("vm.billingAddress.address3",!0);p.resetError("vm.billingAddress.suburb",
!0);p.resetError("vm.billingAddress.city",!0);p.resetError("vm.billingAddress.zipCode",!0);b.reservationModel.addAuthUserEdit=!1;b.addNewCardModel.formValidated=!1;O.rentalLocation=b.prod.reservationSummary.pickLoc.address.country;q.$broadcast("setReviewCreditCard",O);b.errorDisplayList=[];t.$parent.vm.errorDisplayList=[]});q.$on("setDataToSplitPaymentController",function(e,f){angular.isDefined(f.reservationSummary)?(b.enableSplitResponse=b.prod=angular.copy(f),n(f.reservationSummary)):b.prod=f.$$state.value});
q.$on("splitBillSummaryUpdate",function(e,f){angular.isDefined(f.reservationSummary)&&(b.prod=f,n(f.reservationSummary),b.reservationModel.splitBillSummary=b.prod.reservationSummary.splitBillSummary)});b.events={leaveChanges:function(e){"splitPaymentModal"==e&&C.getReservationExtension().then(function(e){b.reservationModel.splitBillSummary=e.reservationSummary.splitBillSummary||null;b.primaryCardSelected=e.reservationSummary.splitBillSummary?e.reservationSummary.splitBillSummary.splitBillPrimary?
e.reservationSummary.splitBillSummary.splitBillPrimary.ccSummary:b.primaryCardSelected:b.primaryCardSelected;b.secondaryCardSelected=e.reservationSummary.splitBillSummary?e.reservationSummary.splitBillSummary.splitBillSecondary?e.reservationSummary.splitBillSummary.splitBillSecondary.ccSummary:b.secondaryCardSelected:b.secondaryCardSelected;b.enableSplitResponse=angular.copy(e);E.addToReviewData(e)},function(){});"itemizedSplitModal"==e&&C.getReservationExtension(!0).then(function(e){E.addToReviewData(e);
b.reservationModel.splitBillSummary=e.reservationSummary.splitBillSummary||null;b.primaryAmountOldValue=e.reservationSummary.splitBillSummary&&e.reservationSummary.splitBillSummary.splitBillPrimary&&e.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount?e.reservationSummary.splitBillSummary.splitBillPrimary.cardAmount:"0.00";b.secondaryAmountOldValue=e.reservationSummary.splitBillSummary&&e.reservationSummary.splitBillSummary.splitBillSecondary&&e.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount?
e.reservationSummary.splitBillSummary.splitBillSecondary.cardAmount:"0.00";b.ancillarySplitModel.vehicleAndFees.secondary=b.ancillarySplitModel.vehicleAndFees.primary=null;b.ancillarySplitModel.products.primary=b.ancillarySplitModel.products.secondary=b.ancillarySplitModel.insurances.primary=b.ancillarySplitModel.insurances.secondary=b.errorItemizedSplit="";b.enableSplitResponse=angular.copy(e);if(e.reservationSummary&&e.reservationSummary.splitBillSummary&&e.reservationSummary.splitBillSummary.splitBillPrimary&&
(e.reservationSummary.splitBillSummary.splitBillPrimary.optionalServiceMap||e.reservationSummary.splitBillSummary.splitBillPrimary.productmap||e.reservationSummary.splitBillSummary.splitBillPrimary.lengthOfRental)||e.reservationSummary.splitBillSummary.splitBillSecondary&&(e.reservationSummary.splitBillSummary.splitBillSecondary.optionalServiceMap||e.reservationSummary.splitBillSummary.splitBillSecondary.productmap||e.reservationSummary.splitBillSummary.splitBillSecondary.lengthOfRental))b.reservationModel.splitBillSummary.splitConfirmed=
!0;b.reservationModel.splitBillSummary||$(".modal-paylater-split-payment").modal("hide");b.enableItemizedConfirm=!1;angular.element("#primaryAmount").hasClass("ng-invalid")&&p.resetError("vm.reservationModel.splitBillSummary.splitBillPrimary.cardAmount",!1);angular.element("#secondaryAmount").hasClass("ng-invalid")&&p.resetError("vm.reservationModel.splitBillSummary.splitBillSecondary.cardAmount",!1)},function(){})}};x()}angular.module("reservation").controller("SplitPaymentController",t);t.$inject=
"$scope $rootScope $filter $state $validation $timeout carRentalConstant splitPaymentService reservationModelService $window getVehicles getDataService $sce gaService".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C,A,B,F,E,w,z,G,n,H,I){function u(){var e=F.getUrlParameter(G.urlParamConfirmNumber)?F.getUrlParameter(G.urlParamConfirmNumber):F.getUrlParameter(G.urlParamCheckInConfirmNumber),f=F.getUrlParameter("selfCheckoutToken"),h=F.getUrlParameter("id");e||f||h?(e=v.location.href,e=e.replace("reservation-details","manage-reservation"),v.location.href=e):v.location.href=C.contextPath+"/"+C.locale+"/reservation"+htmlExtension+"#/manage"}y.current.name==G.resSummaryPage&&
jQuery(".getres-modal-cancel").modal("show");t("ExceptionHandlerController",{$scope:l});C.requestInProgress=!0;var m=this;m.reservation={};m.cancelReservation={};m.messageCancelError=!1;m.lookupPageErrorCancelReservation="";m.emailaddr="";m.modifiedFullPickupDate="";m.modifiedFullDropDate="";m.disableModifyCancel=!1;m.processPageLoad=!0;var f=!1,x="",e="",h="";m.viewReservation=function(){C.requestInProgress=!0;E.getData().then(function(e){m.confirmation=e;1==e.reservationSummary.cancelledReservation?
v.location.href=C.contextPath+"/"+C.locale+"/reservation"+htmlExtension+"#/cancel-confirmation":((angular.isDefined(e.fieldErrors)&&0<e.fieldErrors.length||angular.isDefined(e.errorList)&&0<e.errorList.length||angular.isDefined(e.warningList)&&0<e.warningList.length)&&angular.isDefined(e.errorList),v.location.href=C.contextPath+"/"+C.locale+"/reservation"+htmlExtension+"#/confirmation/lookup")})};m.getModifyExtra=function(){C.requestInProgress=!0;F.load(m.reservation,!1).then(function(e){e.rateRequestDropIndicator?
v.location.href=C.contextPath+"/"+C.locale+"/reservation"+htmlExtension+"#/time-and-place":(C.reservation=e.displayControls.reservation,E.getData().then(function(e){m.reservation=e;var f=w.loadSupportedExtras();w.process(e,f).then(function(b){angular.isDefined(b.fieldErrors)&&0<b.fieldErrors.length||angular.isDefined(b.errorList)&&0<b.errorList.length||angular.isDefined(b.warningList)&&0<b.warningList.length?angular.isDefined(b.errorList)&&0<b.errorList.length&&"02009"==b.errorList[0].code?v.location.href=
C.contextPath+"/"+C.locale+"/reservation"+htmlExtension+"#/manage":(b=l.processErrorMessage(b),(angular.isDefined(b.fieldErrors)&&0<b.fieldErrors.length||angular.isDefined(b.errorList)&&0<b.errorList.length)&&m.redirectError(b.errorList),angular.isDefined(b.warningList)&&0<b.warningList.length&&(m.warningList=b.warningList),v.location.href=C.contextPath+"/"+C.locale+"/reservation"+htmlExtension+"#/time-and-place"):v.location.href=C.contextPath+"/"+C.locale+"/reservation"+htmlExtension+"#/manage"},
function(b){})},function(e){}))},function(e){})};m.showModify=function(){return!m.reservation.reservationSummary||m.reservation.reservationSummary.permission&&m.reservation.reservationSummary.permission.modify&&"TRUE"!=m.reservation.reservationSummary.permission.modify.visible?!1:!0};m.showCancel=function(){return!m.reservation.reservationSummary||m.reservation.reservationSummary.permission&&m.reservation.reservationSummary.permission.cancel&&"TRUE"!=m.reservation.reservationSummary.permission.cancel.visible?
!1:!0};m.showRefund=function(){return m.reservation.reservationSummary&&v.brand!=G.brandName.PAYLESS&&(m.reservation.reservationSummary.permission&&m.reservation.reservationSummary.permission.refund&&m.reservation.reservationSummary.permission.refund.visible&&"TRUE"==m.reservation.reservationSummary.permission.refund.visible||angular.isDefined(m.reservation.reservationSummary.missedReservation)&&1==m.reservation.reservationSummary.missedReservation)?!0:angular.isDefined(m.reservation.reservationSummary)&&
angular.isDefined(m.reservation.reservationSummary.missedReservation)&&1==m.reservation.reservationSummary.missedReservation?!0:!1};m.redirectError=function(e){y.current.name!==G.step1aPageName&&F.setStorageData("pastDateError",e)};m.cancelFeeGreaterThanPrepaidAmount=!1;m.cancelFeeLessOrEqualThanPrepaidAmount=!1;m.rentalLocationCountry="";m.cancellingReason="";m._emailUrlRediections=function(){x=F.getUrlParameter(G.urlParamConfirmNumber);e=F.getUrlParameter(G.urlParamLastName);h=F.getUrlParameter(G.urlParamUtm_campaign);
""!=x&&(F.setLookUpModel({lastName:e,confirmationNumber:x,email:""}),f=!0)};m._resSummaryInit=function(){C.requestInProgress=!0;var r=F.getUrlParameter(G.lookupActionParam);if(angular.isDefined(g.lastName)&&angular.isDefined(g.confirmationNumber)||r==G.lookupParam||f){if(r==G.lookupParam){x=F.getUrlParameter(G.lookupConfNumber);e=F.getUrlParameter(G.lookupLastName);var u={lastName:e,confirmationNumber:x}}else f||(u={lastName:g.lastName,confirmationNumber:g.confirmationNumber,email:""});f||F.setLookUpModel(u);
E.load().then(function(n){angular.element(".summaryHold").removeClass("summaryHold");if(n.reservationSummary.cancelledReservation)if(m.lookupPageErrorCancelReservation=q.trustAsHtml(Dictionary.I18n.get("msg.res.resConf.alreadyCancelled")),r==G.lookupParam)m.reservation=l.processErrorMessage(n),m.disableModifyCancel=!0;else if(r!=G.lookupParam&&f){m.reservation=n;m.disableModifyCancel=!0;if(angular.isDefined(h)&&-1!=h.indexOf("NonPrePay")&&-1!=h.indexOf("NonPrePay")&&1==n.reservationSummary.cancelledReservation){v.location.href=
C.contextPath+"/"+C.locale+"/"+G.endPointArray.VIEW_MODIFY_CANCEL+htmlExtension+"?utm_campaign\x3d"+h+"\x26"+G.urlParamConfirmNumber+"\x3d"+x+"\x26"+G.urlParamLastName+"\x3d"+e;return}if(angular.isDefined(n.instructionList)&&0<n.instructionList.length||angular.isDefined(n.errorList)&&0<n.errorList.length||angular.isDefined(n.warningList)&&0<n.warningList.length)if(m.reservation=l.processErrorMessage(n),angular.isDefined(n.instructionList)&&0<n.instructionList.length&&1==m.reservation.reservationSummary.cancelledReservation){v.location.href=
C.contextPath+"/"+C.locale+"/reservation"+htmlExtension+"#/cancel-confirmation?utm_campaign\x3d"+h;return}}else m.messageCancelError=!0,v.location.href=C.contextPath+"/"+C.locale+"/reservation.html#/view-modify-cancel";else if(g.errorKey)y.go(G.reservationSummaryError,{errorKey:g.errorKey},{reload:!0});else if(r==G.lookupParam||f){if(m.reservation=n,angular.isDefined(m.reservation.reservationSummary)&&angular.isDefined(m.reservation.reservationSummary.personalInfo)&&angular.isDefined(m.reservation.reservationSummary.personalInfo.email)&&
(m.emailaddr=m.reservation.reservationSummary.personalInfo.email),angular.isDefined(n.errorList)&&0<n.errorList.length){C.requestInProgress=!0;v.location.href=C.contextPath+"/"+C.locale+"/"+G.endPointArray.VIEW_MODIFY_CANCEL+htmlExtension+"#/lookup/"+n.errorList[0].code;return}}else y.go(G.resSummaryPage,{},{reload:!0});C.requestInProgress=!1},function(e){C.requestInProgress=!1})}else C.requestInProgress=!0,C.$progressbar.activeItem=5,E.getData().then(function(f){if(angular.isDefined(h)&&-1!=h.indexOf("NonPrePay")&&
-1!=h.indexOf("NonPrePay")&&1==f.reservationSummary.cancelledReservation)v.location.href=C.contextPath+"/"+C.locale+"/"+G.endPointArray.VIEW_MODIFY_CANCEL+htmlExtension+"?utm_campaign\x3d"+h+"\x26"+G.urlParamConfirmNumber+"\x3d"+x+"\x26"+G.urlParamLastName+"\x3d"+e;else{if(angular.isDefined(f.instructionList)&&0<f.instructionList.length||angular.isDefined(f.errorList)&&0<f.errorList.length||angular.isDefined(f.warningList)&&0<f.warningList.length){if(m.reservation=l.processErrorMessage(f),angular.isDefined(f.instructionList)&&
0<f.instructionList.length&&1==m.reservation.reservationSummary.cancelledReservation){v.location.href=C.contextPath+"/"+C.locale+"/reservation"+htmlExtension+"#/cancel-confirmation?utm_campaign\x3d"+h;return}}else g.errorKey?(f.errorList=[{type:"ERROR",code:g.errorKey}],m.reservation=l.processErrorMessage(f)):g.infoKey?(f.instructionList=[{type:"ERROR",code:g.infoKey}],m.reservation=l.processErrorMessage(f)):m.reservation=f;m.emailaddr=m.reservation.reservationSummary.personalInfo.email;n.addToConfirmationData(m.reservation);
p(function(){angular.element(".summaryHold").removeClass("summaryHold");C.requestInProgress=!1},400)}},function(e){C.requestInProgress=!1}),y.current.name===G.reservationSummaryCancel&&jQuery(".getres-modal-cancel").modal();m.cancelReasonFunction();m.cancelOrNoShowFeeMessage()};m.cancelOrNoShowFeeMessage=function(){!(m.reservation&&m.reservation.reservationSummary&&v.brand!=G.brandName.PAYLESS&&m.reservation.reservationSummary.prepayTxn&&m.reservation.reservationSummary.prepayInfo&&("C"===m.reservation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&
"FALSE"==m.reservation.reservationSummary.permission.refund.visible||"N"===m.reservation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&"TRUE"==m.reservation.reservationSummary.permission.refund.visible))||m.reservation.reservationSummary.prepayInfo.refundIndicator!=G.RESAMT_LESSTHAN_NOSHOWAMT&&m.reservation.reservationSummary.prepayInfo.refundIndicator!=G.RESAMT_LESSTHAN_CANCELAMT||m.reservation.reservationSummary.pickLoc.address.country.toUpperCase()!=G.countryCodeAU&&m.reservation.reservationSummary.pickLoc.address.country.toUpperCase()!=
G.countryCodeNZ?!(m.reservation&&m.reservation.reservationSummary&&v.brand!=G.brandName.PAYLESS&&m.reservation.reservationSummary.prepayTxn&&m.reservation.reservationSummary.prepayInfo&&("C"===m.reservation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&"FALSE"==m.reservation.reservationSummary.permission.refund.visible||"N"===m.reservation.reservationSummary.prepayInfo.cancelOrNoShowIndicator&&"TRUE"==m.reservation.reservationSummary.permission.refund.visible))||m.reservation.reservationSummary.prepayInfo.refundIndicator!=
G.RESAMT_GREATERTHAN_CANCELAMT&&m.reservation.reservationSummary.prepayInfo.refundIndicator!=G.RESAMT_GREATERTHAN_NOSHOWAMT||m.reservation.reservationSummary.pickLoc.address.country.toUpperCase()!=G.countryCodeAU&&m.reservation.reservationSummary.pickLoc.address.country.toUpperCase()!=G.countryCodeNZ||(m.cancelFeeGreaterThanPrepaidAmount=!0,m.rentalLocationCountry=m.reservation.reservationSummary.pickLoc.address.country.toUpperCase()):(m.cancelFeeLessOrEqualThanPrepaidAmount=!0,m.rentalLocationCountry=
m.reservation.reservationSummary.pickLoc.address.country.toUpperCase())};m.cancelReasonFunction=function(){if("au"===window.domain||"nz"===window.domain){var e=Dictionary.I18n.get("lbl.reservation.cancelReasons");e=JSON.parse(e);m.cancelReasonList=e.cancelReasons;m.cancellingReason=null}};m.cancelReasonList=[];m.cancelReservation={submit:function(e){z.validate(e).success(m.cancelReservation.validationSuccess).error(m.cancelReservation.validationError)},validationSuccess:function(){C.requestInProgress=
!0;m.cancelReservation.process()},validationError:function(e){},process:function(){B.load(m.reservation.reservationSummary.confirmationNumber,m.reservation.reservationSummary.personalInfo.lastName.value,m.emailaddr,m.cancellingReason).then(function(e){m.model=e;angular.isDefined(e.errorList)&&0<e.errorList.length?(I.process(e.errorList[0].code),C.requestInProgress=!1):(void 0!=m.model.reservationSummary.loyaltyDetails&&(H.setLoyaltyDetails(H.setLoyaltyDetailsData(m.model)),C.$broadcast("loyaltyUpdated",
m.model)),A.deleteStorageData("upcomingReservations"),A.deleteStorageData("cancelledReservations"),n.deleteConcurTripList(),jQuery(".getres-modal-cancel").modal("hide"),v.location.href=C.contextPath+"/"+C.locale+"/reservation"+htmlExtension+"#/cancel-confirmation")},function(e){})}};if(H.getXsrfToken()||H.getSessionModel())m.processPageLoad=!1,u();C.$on("initSuccess",function(e,f){m.processPageLoad&&u()});t=t("SummaryExnController",{$scope:l});angular.extend(this,t)}angular.module("reservation").controller("SummaryController",
t);t.$inject="$controller $sce $scope $window $timeout $state $stateParams $rootScope storageService confirmCancelService reservationModelService lookupService optionalService $validation carRentalConstant getDataService authenticationService BackButtonFactory".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C,A,B,F,E,w,z,G,n,H,I,u,m,f,D,e,h,r,J,M,b,O,S,T,ia){function x(){d.contentType=n.txnTypePostPay;S.load(d.contentType,d.response.reservationSummary.pickLoc.locationCode).then(function(a){d.tempDescription=a;if(angular.isDefined(d.response.reservationSummary.dropLoc)&&angular.isDefined(1==d.response.reservationSummary.dropLoc.keyDrop)&&1==d.keyDroptermsNc)for(var b=0;b<a.length;b++)if("After Hours Return"==a[b].Id){d.afterHourTnC=a[b].Description.toString().replace(/<[^>]+>/gm,
"");break}},function(a){})}function ba(a){if("avis"===g.brand.toLowerCase()&&angular.isDefined(d.reservationModel)&&angular.isDefined(d.reservationModel.displayControls)&&angular.isDefined(d.reservationModel.displayControls.reservation)&&d.reservationModel.displayControls.reservation===n.resFlowCreate){var b=d.reservationModel.coupon.discountNumber;d.reservationModel.coupon.discountNumber="";d.partnerValidation();d.reservationModel.coupon.discountNumber=b}void 0!=a&&(b=H.getReservationModel(),b.coupon.discountNumber=
a,b.displayControls.bannerSelectedAWD=!0,b.selectedRateType="",H.setReservationModel(b));v.requestInProgress=!0;""==d.reservationModel.coupon.discountNumber&&(d.reservationModel.rentalType="",d.reservationModel.partnerMembershipId="",d.reservationModel.NoPartnerMembershipID=!1);H.setReservationModel(d.reservationModel);0<d.discountCouponValidate(d.reservationModel).length?(m(angular.element(".platform-error-message"))(q),m(angular.element("#discountAWDErrStep2"))(q),v.requestInProgress=!1):v.isAuthenticated||
v.isRecognized||1!=d.reservationModel.coupon.partnerEmailRequired||""!=d.corporateEmailID&&void 0!=d.corporateEmailID?(I.setStorageData("corporateEmailID",d.corporateEmailID),U(),angular.isDefined(I.getStorageData("partnerName"))&&I.deleteStorageData("partnerName")):(angular.element("#emailReq").addClass("platform-error-message"),v.requestInProgress=!1)}function ca(a,b){d.reservationModel.coupon.discountNumber=a;d.reservationModel.coupon.couponNumber=b;d.getMultiCoupon();d.applyCoupon()}function U(){var a=
!1;"true"!=d.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||g.brand!=n.brandName.AVIS&&g.brand!=n.brandName.BUDGET?w.load().then(function(b){d.response=b;angular.isDefined(b)&&angular.isDefined(b.fieldErrors)?angular.forEach(b.fieldErrors,function(d,e){"vm.corporateEmailID"==d.field&&(a=!0,I.setStorageData("corporateEmailError",b))}):b=d._processErrorByType(d.response);angular.isDefined(b.errorList)&&0<b.errorList.length||
angular.isDefined(b.warningList)&&0<b.warningList.length||a?y.go(n.step1aPageName):d.reservationModel.bookAgain.bookAgainFlow?y.go(n.bookAgainVehiclePage,{},{reload:!0}):(y.go(n.step2PageName,{},{reload:!0}),O.hideorShowPartnerBenefits(d.response))},function(a){}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(b){d.recaptcha=b;w.load(!1,d.recaptcha).then(function(b){d.response=b;angular.isDefined(b)&&angular.isDefined(b.fieldErrors)?
angular.forEach(b.fieldErrors,function(d,e){"vm.corporateEmailID"==d.field&&(a=!0,I.setStorageData("corporateEmailError",b))}):b=d._processErrorByType(d.response);angular.isDefined(b.errorList)&&0<b.errorList.length||angular.isDefined(b.warningList)&&0<b.warningList.length||a?y.go(n.step1aPageName):d.reservationModel.bookAgain.bookAgainFlow?y.go(n.bookAgainVehiclePage,{},{reload:!0}):y.go(n.step2PageName,{},{reload:!0})},function(a){})})})}function Z(){var a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Tablet PC|Opera Mini/i.test(navigator.userAgent)?
"focus":"hover";angular.element('a.popOver[data-toggle\x3d"popover"], a.steptwoinfo[data-toggle\x3d"popover"], a.info-icon[data-toggle\x3d"popover"]').attr("data-trigger",a);angular.element('[data-toggle\x3d"popover"]').popover().off("shown.bs.popover");angular.element('[data-toggle\x3d"popover"]').popover().on("shown.bs.popover",function(a){angular.element(".popover.in").find(".close-button, .closePopover").on("click",function(){angular.element(".popover.in").popover("hide")})});angular.element(".close-button").popover("hide");
angular.element("body").off("click",'[data-dismiss-custom\x3d"modal"]');angular.element("body").on("click",'[data-dismiss-custom\x3d"modal"]',function(){angular.element(this).closest(".modal").modal("hide")})}function a(){var a=angular.isDefined(d.response.reservationSummary.coupon)&&!1===d.response.reservationSummary.coupon.visible?d.response.reservationSummary.coupon.number:d.reservationModel.displayControls.reservation!=n.resFlowCreate&&angular.isDefined(d.response.oldReservationSummary)&&angular.isDefined(d.response.oldReservationSummary.coupon)&&
!1===d.response.oldReservationSummary.coupon.visible?d.response.oldReservationSummary.coupon.number:d.response.reservationSummary.promotionalCoupon;d.reservationModel.displayControls.reservation==n.resFlowCreate&&a&&0<a.length?(d.couponCodeDisabled=!0,d.reservationModel.coupon.couponNumber="",angular.isDefined(d.response.reservationSummary.coupon)&&angular.isDefined(d.response.reservationSummary.coupon.visible)&&(d.reservationModel.coupon.visible=d.response.reservationSummary.coupon.visible,d.reservationModel.promotionalCoupon=
d.response.reservationSummary.coupon.number),H.setReservationModel(d.reservationModel)):d.reservationModel.displayControls.reservation!=n.resFlowCreate&&a&&0<a.length&&angular.isDefined(d.response.reservationSummary.walletType)&&("VISA"==d.response.reservationSummary.walletType||"VISA_CHECKOUT"==d.response.reservationSummary.walletType)&&(d.couponCodeDisabled=!0,d.reservationModel.coupon.couponNumber="",angular.isDefined(d.response.reservationSummary.coupon)&&angular.isDefined(d.response.reservationSummary.coupon.visible)&&
(d.reservationModel.coupon.visible=d.response.reservationSummary.coupon.visible,d.reservationModel.promotionalCoupon=d.response.reservationSummary.coupon.number),H.setReservationModel(d.reservationModel))}"true"===g.jsProfileConfigFlag&&(g.startTime.vehicleAvailability=performance.now());q.$new();F("ExceptionHandlerController",{$scope:q});var d=this,ea="";t=F("CouponController",{$scope:q});angular.extend(this,t);var K=z.getCouponList();d.ancillariesIncluded=[];d.hideCoupons=!1;d.displayDiscount=!1;
d.epIndicator=!1;d.underAge=!1;d.mode=!0;d.couponAwdSameflag=!1;d.mvtFlag=!1;d.deviceType=v.deviceType;d.displayCouponBanner=angular.isDefined(g.displayCouponBanner)&&"true"==g.displayCouponBanner?!0:!1;d.response={};d.mcouponID={};d.resFormPageInfo="";d.iconImage="";d.selectedFilter="";d.pageName=y.current.name;d.userCurrency="";d.pageContent=[];d.couponList={};d.sortType="";d.bonusMilesCouponCode=n.bonusMilesCouponCode;d.uniqueCurrencylist=[];d.currencySymbol="";d.couponNumberTemp="";d.couponQuantityTemp=
"";d.discountNumberTemp="";d.ratecodeNumberTemp="";d.rentalTypeTemp="";d.errorDisplayList=[];d.vehicleTypeInstruction="";d.awdList="";d.carList=[];d.isRecomendedFlow=!1;d.displayTotalRate=!1;d.couponCodeDisabled=!1;d.helpURL="";d.domain=g.domain;d.brand=g.brand;d.isBookAgainFlow=!1;d.extrasDescriptionList=[];d.requiresMemberID=!1;d.partnerPlaceholder="";d.partnerLabel="";d.partnerDiscount=function(){d.reservationModel.coupon.discountNumber=ABG.awdNumberValidator(d.reservationModel.coupon.discountNumber);
var a=d.reservationModel.coupon.discountNumber,b=d.reservationModel.discountSummaryList,e=!1;angular.isDefined(b)&&angular.isDefined(a)&&angular.forEach(b,function(b,d){a==b.discountNumber&&(e=!0)});angular.isDefined(a)&&7<=a.length&&0==d.reservationModel.NoPartnerMembershipID&&!e&&-1===a.indexOf("AMAZON")&&0==$("#discountAWDErrStep2Mob").length&&angular.isUndefined(d.reservationModel.coupon.isMaskedDiscountCode)&&(v.requestInProgress=!0,angular.isDefined(d.reservationModel.coupon.partnerMembershipId)&&
null==d.reservationModel.coupon.partnerMembershipId||""==d.reservationModel.coupon.partnerMembershipId?w.partnerDiscountValidation(a).then(function(a){a.fieldErrors?v.requestInProgress=!1:(d.requiresMemberID=a.awdSummary.requiresMemberID,d.partnerName=a.awdSummary.partnerName,d.reservationModel.coupon.requiresMemberID=d.requiresMemberID,d.reservationModel.partnerName=d.partnerName,H.setReservationModel(d.reservationModel),v.requestInProgress=!1,angular.isDefined(d.partnerName)&&d.requiresMemberID?
(d.partnerPlaceholder=d.partnerName+Dictionary.I18n.get("lbl.global.partnerMember,"+brand),d.partnerLabel=Dictionary.I18n.get("lbl.global.partnerlabel,"+brand)+d.partnerName+Dictionary.I18n.get("lbl.global.partnerlabel1,"+brand),d.reservationModel.partnerLabel=d.partnerLabel):(d.requiresMemberID=!1,d.membershipID=""),P?setTimeout(function(){ba();P=!1}):aa=!0,v.isAuthenticated||v.isRecognized||g.brand!=n.brandName.AVIS&&g.brand!=n.brandName.BUDGET||(d.reservationModel.coupon.partnerEmailRequired=a.awdSummary.partnerEmailRequired,
angular.isDefined(d.reservationModel.coupon.partnerEmailRequired)&&1==d.reservationModel.coupon.partnerEmailRequired&&0==d.reservationModel.coupon.requiresMemberID&&H.setReservationModel(d.reservationModel)))}):v.requestInProgress=!1)};d.customer=D.getCustomerModel();d.partnerValidation=function(){var a=d.reservationModel.coupon.discountNumber;""==a?(d.reservationModel.isDiscountisEmpty=!0,H.setReservationModel(d.reservationModel)):""!=a&&(d.reservationModel.isDiscountisEmpty=!1,H.setReservationModel(d.reservationModel));
var b=d.reservationModel.discountSummaryList,e=!1;d.reservationModel.coupon.partnerEmailRequired=!1;angular.isDefined(d.reservationModel.coupon.isMaskedDiscountCode)&&d.reservationModel.coupon.isMaskedDiscountCode&&(d.reservationModel.coupon.isMaskedDiscountCode=!1);angular.isDefined(b)&&angular.isDefined(a)&&angular.forEach(b,function(b,d){a==b.discountNumber&&(e=!0)});if(e||angular.isDefined(a)&&7>a.length)d.requiresMemberID=!1,d.reservationModel.coupon.partnerMembershipId="",d.response.reservationSummary.membershipId=
null,angular.isDefined(d.customer)&&(d.customer.awdSummary.requiresMemberID=!1);0==a.length&&(d.reservationModel.coupon.isMaskedDiscountCode=void 0);angular.isDefined(I.getStorageData("partnerName"))&&I.deleteStorageData("partnerName")};d.clearMembershipID=function(){d.membershipID="";d.reservationModel.coupon.partnerMembershipId=""};d.checkPartnerValidation=function(){d.reservationModel.NoPartnerMembershipID&&(d.reservationModel.coupon.partnerMembershipId="",H.setReservationModel(d.reservationModel));
A.resetError("vm.reservationModel.coupon.partnerMembershipId",!0)};d.checkPartnerMemberValidation=function(){""!=d.reservationModel.coupon.partnerMembershipId&&d.reservationModel.NoPartnerMembershipID&&(d.reservationModel.NoPartnerMembershipID=!1,H.setReservationModel(d.reservationModel))};d.rentalLocationCountry="";d.enableBenefit=partnerConfig.amazon.enablePartnerBenefit;d.setMvtFlag=function(){g.brand==n.brandName.AVIS&&T.load("null","step2").then(function(a){a=p.getResolvedOffers(a);null!=a&&
angular.isDefined(a.resolvedOffers)&&0<a.resolvedOffers.length&&-1!=a.resolvedOffers.indexOf("Step2 Best Rate Guaranteed")&&"GUIDED_RES"!=d.response.bundleFlow&&(d.mvtFlag=!0)})};d.displayFeatures=!1;d.premiumDisplayFeatures=!1;d.electricVehicleFeatures=!1;d.redBgSignatureSeriesFeature=!1;d.showUpsellforUSAA=!1;d.enableEnterpriseCaptcha=enableEnterpriseCaptcha;w.setSortBy();w.SortBy=w.getSortBy();d.rateAmountShow=g.rateAmountShow;d.showUpliftOptionStep2=g.showUpliftOptionStep2;d.enableUplift=g.enableUplift;
d.cbpCustomer=D.getCBPCustomerDetails();d.loginWarningMsg=!1;d.isStepTwoAnonymous=!1;d.amazonBenefitsKey=Dictionary.I18n.get("lbl.global.amazonBenefits");d.pageControl={userSortOption:w.SortBy.PRICE.code,sortPlaceHolder:w.SortBy.PRICE.description,orderByAvailable:w.SortBy.PRICE.sortExpression,orderByUnavailable:["+carAvailabilityCode","+carClass"],displayedVehicleType:n.defaultDisplayedVehicleType,vehicleTypePlaceholder:n.defaultVehicleTypeDesc,selectCarType:"",displayVehicleList:!1,specialFeatureFiltered:!1,
visibleVehicleType:"",vehicleTypeLabel:"",vehicleTypeNotAvailable:!1,locationControl:!1,enableSortOption:!1,isModifyVehicleModal:!1,sortByList:[]};d.selectedFeatures={list:[]};d.awdIndicator={addDiscount:!1,validCoupon:!1,invalidAWD:!1,lowest:!1,leisure:!1,corporate:!1};d.updateAwd=function(){P=!0;aa&&(ba(),aa=!1)};d.loadHelpModal=function(a){d.helpURL=O.getUrl(a.target.parentElement,d.response.reservationSummary.pickLoc.address.country)};d.filterVehicle=function(a,b){d.selectedFilter=a;d.mobileSelectedVehicleType=
a;d.selectedFilter.state=b;d.pageControl.specialFeatureFiltered=b;d.pageControl.displayedVehicleType=a.code;d.pageControl.visibleVehicleType=a.code===n.defaultDisplayedVehicleType?"":a.description;d.pageControl.displayVehicleList=!0===d.reservationModel.displayControls.filterVehicleSelect&&d.pageName==n.step2PageName?!0:!1;d.pageControl.vehicleTypeNotAvailable=!1;d.pageControl.vehicleTypePlaceholder=b?Dictionary.I18n.get("msg.res.specialFeature"):a.description+" ("+d.getCarCountByClass(a.cargroup)+
")";d.isFilterRecomDivider=!0;d._isSorted()||d._isFiltered(b)?b?(d.response=w.filterBySpeacialFeatures(d.response,d.selectedFeatures.list),d.pageControl.orderByAvailable=w.getSortExpression(d.pageControl.userSortOption)):d.response=w.filterByVehicleClass(d.response,w.getVehicleClasses(a.cargroup)):(d._defaultSortFilter(),d.isFilterRecomDivider=!1);d._collapseSortFilter();d._hideVehicleInfo();d.reservationModel.vehicleType=a;H.setReservationModel(d.reservationModel);B(function(){var a=v.deviceType===
n.deviceTypeMobile?"focus":"hover";jQuery('a.popOver[data-toggle\x3d"popover"], a.steptwoinfo[data-toggle\x3d"popover"], a.info-icon[data-toggle\x3d"popover"]').attr("data-trigger",a);jQuery('[data-toggle\x3d"popover"]').popover()},0)};d.sortVehicle=function(a){$(window).width()<n.deviceTypeMobileWidth?(d.pageControl.userSortOption=d.sortType,d._sortByFunc(d.sortType)):(d.pageControl.userSortOption=a.code,d.pageControl.sortPlaceHolder=a.description,d._sortByFunc(a.code));angular.element(".dropdown-menu").parent(".dropdown").removeClass("open");
d._hideVehicleInfo()};d.applyCoupon=ba;d.applyCouponAndAwd=ca;d.applyMemberBenefitsCoupon=function(){d.applyCoupon(d.response.customerInfo.memberShipDiscountNumber)};d.getAwdLabel=function(a){(a.rateTypes||a.reservationSummary.coupon||a.errorList)&&(a.rateTypes||a.reservationSummary.coupon||!a.errorList||""!=d.reservationModel.coupon.discountNumber&&void 0!=d.reservationModel.coupon.discountNumber)?!a.rateTypes&&a.reservationSummary.coupon&&a.reservationSummary.coupon.number?d.awdIndicator.validCoupon=
!0:!a.rateTypes&&a.errorList&&""!=d.reservationModel.coupon.discountNumber?d.awdIndicator.invalidAWD=!0:a.rateTypes&&a.rateTypes[0]==n.rateTypeLeisure?d.awdIndicator.leisure=!0:a.rateTypes&&a.rateTypes[0]==n.rateTypeLowest&&d.reservationModel.rentalType==n.rateTypeLowest||a.rateTypes&&a.errorList&&a.rateTypes[0]==n.rateTypeLowest&&a.reservationSummary.rentalType==n.rateTypeLowest?d.awdIndicator.lowest=!0:!a.rateTypes||a.rateTypes[1]!=n.rateTypeCorporate||a.reservationSummary.rentalType!=n.rateTypeCorporate&&
a.reservationSummary.rentalType!=n.businessText||(d.awdIndicator.corporate=!0):d.awdIndicator.addDiscount=!0};d.discountCouponValidate=function(a){var b=[],e=a.coupon.discountNumber,f=a.coupon.couponNumber?a.coupon.couponNumber:"",h=H.validateDiscountNumber(e,f,a,"Step2");h&&b.push(h);h=d._awdValidator();(h=H.validateCouponCode(f,e,a,"Step2",h))&&b.push(h);(h=H.validateMembeshipID(e,a,"Step2",d.requiresMemberID))&&b.push(h);1==b.length&&(a=b[0].message,angular.element("#vecPageError").html(""),m(angular.element("#vecPageError").append(a))(q));
2==b.length&&(d.vecFormPageError=Dictionary.I18n.get("err.res.mutliplemsg"));return b};d.getMultiCoupon=function(){d.getMultiCouponUtility(d,!1)};d.selectVehicle=function(a,b,e,h){d.recaptcha="";b||(d.reservationModel.prepayOpted=!1);if(angular.isDefined(a.bundle)&&angular.isDefined(a.bundle[0].bundleType)&&("LAST_MINUTE"==a.bundle[0].bundleType||"GUIDED_RES"==a.bundle[0].bundleType||"INBOUND_ALL"==a.bundle[0].bundleType||"INBOUND_BASIC"==a.bundle[0].bundleType)){var l=!0===b?"payNowRate":"payLaterRate";
d.reservationModel.rateCode=e&&""!=e?e[l].rateCode:a.bundle[0][l].rateCode}else d.reservationModel.rateCode=b?a.prepayRateCode:a.rateCode;d.reservationModel.memberRateSelected=h?h:!1;v.requestInProgress=!0;$(window).scrollTop(0);d.reservationModel.selectedCar=[];d.reservationModel.carClass=a.carClass;d.reservationModel.couponAppliedCar=a.couponApplicable;d.reservationModel.prepayProcessIndicator=b;d.reservationModel.selectedCar.push(a);H.setReservationModel(d.reservationModel);"true"!=d.enableEnterpriseCaptcha||
angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||g.brand!=n.brandName.AVIS&&g.brand!=n.brandName.BUDGET?n.resFlowCreate===d.reservationModel.displayControls.reservation?(H.updateClientContext("carClass",a.carClass),b="",angular.isDefined(a.bundle)&&angular.isDefined(a.bundle[0].bundleType)&&("LAST_MINUTE"==a.bundle[0].bundleType||"GUIDED_RES"==a.bundle[0].bundleType||"INBOUND_ALL"==a.bundle[0].bundleType||"INBOUND_BASIC"==a.bundle[0].bundleType)&&
(b=a.bundle[0].bundleType),g.brand==n.brandName.PAYLESS||ABG.arrayHasObject(b,["LAST_MINUTE","GUIDED_RES","INBOUND_ALL","INBOUND_BASIC"])?(E.setAncillaryBundlesData(""),d._processToExtras()):f.ancillaryBundlePromisesExecution().then(function(a){d.reservationModel=H.getReservationModel();d._processToExtras()},function(a){E.setAncillaryBundlesData("");d._processToExtras()})):(E.setAncillaryBundlesData(""),d._processToExtras()):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,
{action:"submit"}).then(function(b){d.recaptcha=b;n.resFlowCreate===d.reservationModel.displayControls.reservation?(H.updateClientContext("carClass",a.carClass),b="",angular.isDefined(a.bundle)&&angular.isDefined(a.bundle[0].bundleType)&&("LAST_MINUTE"==a.bundle[0].bundleType||"GUIDED_RES"==a.bundle[0].bundleType||"INBOUND_ALL"==a.bundle[0].bundleType||"INBOUND_BASIC"==a.bundle[0].bundleType)&&(b=a.bundle[0].bundleType),g.brand==n.brandName.PAYLESS||ABG.arrayHasObject(b,["LAST_MINUTE","GUIDED_RES",
"INBOUND_ALL","INBOUND_BASIC"])?(E.setAncillaryBundlesData(""),d._processToExtras(d.recaptcha)):f.ancillaryBundlePromisesExecution().then(function(a){d.reservationModel=H.getReservationModel();d._processToExtras(d.recaptcha)},function(a){E.setAncillaryBundlesData("");d._processToExtras(d.recaptcha)})):(E.setAncillaryBundlesData(""),d._processToExtras(d.recaptcha))})})};d.toggleDiscounts=function(){d._resetModalVal();if(angular.isDefined(K)&&1<K.length&&d.reservationModel.coupon.couponNumber)d.reservationModel.coupon.isMultiCoupon=
!0,d.pageContent.couponList=K,z.setCouponList(d.pageContent.couponList);else{d.reservationModel.coupon.isMultiCoupon=!1;var a=d.pageContent.couponList={};z.setCouponList(a)}d.displayDiscount=!d.displayDiscount;d.pageControl.displayVehicleList&&(d.pageControl.displayVehicleList=!1);A.resetError("vm.reservationModel.coupon.discountNumber");A.resetError("vm.reservationModel.coupon.couponNumber");A.resetError("vm.reservationModel.coupon.couponRateCode");""==d.reservationModel.coupon.discountNumber&&(d.reservationModel.coupon.partnerMembershipId=
"");!v.isRecognized||g.brand!=n.brandName.AVIS&&g.brand!=n.brandName.BUDGET?v.isAuthenticated&&angular.isDefined(d.response.customerInfo)&&angular.isDefined(d.response.customerInfo.awdSummary)&&d.response.customerInfo.awdSummary.requiresMemberID&&(d.response.customerInfo.awdSummary.requiresMemberID=!1,d.partnerName=null,d.customer.awdSummary.requiresMemberID=!1):(!angular.isDefined(d.customer)||d.customer.awdSummary.partnerName!==n.USAAMember&&d.customer.awdSummary.partnerName!==n.CostcoMember||(d.partnerPlaceholder=
d.customer.awdSummary.partnerName+Dictionary.I18n.get("lbl.global.partnerMember,"+brand),d.partnerLabel=Dictionary.I18n.get("lbl.global.partnerlabel,"+brand)+d.customer.awdSummary.partnerName+Dictionary.I18n.get("lbl.global.partnerlabel1,"+brand)),""!=d.reservationModel.coupon.partnerMembershipId&&angular.isDefined(d.response.customerInfo)?d.response.customerInfo.awdSummary.requiresMemberID=!1:""==d.reservationModel.coupon.partnerMembershipId&&1==d.reservationModel.NoPartnerMembershipID&&(d.response.customerInfo.awdSummary.requiresMemberID=
!1,d.customer.awdSummary.requiresMemberID=!1));a=angular.isDefined(d.customer)&&angular.isDefined(d.customer.discountSummaryList)?d.customer.discountSummaryList:"";""==d.reservationModel.corporateBookingType&&angular.isDefined(d.response)&&angular.isDefined(d.response.reservationSummary)&&angular.isDefined(d.response.reservationSummary.corporateBookingType)&&d.response.reservationSummary.corporateBookingType&&(d.reservationModel.corporateBookingType="true");angular.isDefined(d.reservationModel.corporateBookingType)&&
(a=h.getConcurDiscountSummary(a,d.reservationModel.corporateBookingType),angular.isDefined(a.concurList)&&(d.reservationModel.discountSummaryList=a.concurList),angular.isDefined(a.discountNumber)&&(d.reservationModel.coupon.discountNumber=angular.isDefined(d.response.reservationSummary.awdNumber)?d.response.reservationSummary.awdNumber:a.discountNumber),d.pageContent.awdDisabled=ABG.disableDiscountField(d.reservationModel.discountSummaryList,d.reservationModel.corporateBookingType));angular.isDefined(d.reservationModel)&&
angular.isDefined(d.reservationModel.amazonReservation)&&!d.reservationModel.amazonReservation&&(d.reservationModel.discountSummaryList=ABG.removeAmazonBenefits(d.reservationModel.discountSummaryList));angular.isDefined(d.reservationModel)&&angular.isDefined(d.reservationModel.coupon)&&angular.isDefined(d.reservationModel.coupon.discountNumber)&&""!=d.reservationModel.coupon.discountNumber&&-1!=d.reservationModel.coupon.discountNumber.toUpperCase().indexOf("RATE")&&(d.reservationModel.coupon.isMaskedDiscountCode=
!0)};d.toggleFilters=function(a){if(d.pageControl.locationControl)d.pageControl.displayVehicleList=!d.pageControl.displayVehicleList,d.displayDiscount&&(d.displayDiscount=!1);else return!1};d.vehicleInfo=function(a){w.vehicleInfo(a,v.deviceType,n)};d.vehicleFeaturedInfo=function(a){w.vehicleFeaturedInfo(a,v.deviceType,n)};d.vehiclepremiumInfo=function(a){w.vehiclepremiumInfo(a,v.deviceType,n)};d.vehicleFeaturedpremiumInfo=function(a){w.vehicleFeaturedpremiumInfo(a,v.deviceType,n)};d.selectCurrency=
function(a){angular.element(".dropdown-menu").parent(".vehSelectBox").removeClass("open");var b=H.getReservationModel();b.userSelectedCurrency=a.trim();d.reservationModel=b;H.setReservationModel(d.reservationModel);"true"!=d.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||g.brand!=n.brandName.AVIS&&g.brand!=n.brandName.BUDGET?v.deviceType!=n.deviceTypeMobile&&(v.requestInProgress=!0,w.load().then(function(a){v.requestInProgress=
!1;y.go(n.step2PageName,{},{reload:!0})},function(a){})):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,{action:"submit"}).then(function(a){d.recaptcha=a;v.deviceType!=n.deviceTypeMobile&&(v.requestInProgress=!0,w.load(!1,d.recaptcha).then(function(a){v.requestInProgress=!1;y.go(n.step2PageName,{},{reload:!0})},function(a){}))})})};d.enableLoading=function(){angular.element(".wrapper")&&0<angular.element(".wrapper").length&&angular.element(".wrapper").attr("style",
"display:block");jQuery(".allvehimodalformob")&&jQuery(".allvehimodalformob").modal("hide");jQuery(".myModalVehicleDrpDwn")&&jQuery(".myModalVehicleDrpDwn").modal("hide");B(function(){angular.element(".wrapper")&&0<angular.element(".wrapper").length&&angular.element(".wrapper").attr("style","display:none")},1E3)};d.getFeatureCount=function(a){var b={};b[a]=!0;if("abg"===a||"ABG"===a)b.abgquantity={size:6,condition:"\x3e"};return 0===C("customFeaturesFilter")(d.response.availableVehicles,b).length?
!0:!1};d.getCarCountByClass=function(a){return w.getCountByVehicleType(d.response,a)};d.removeError=function(){d.validated=!1;d.reservationModel.coupon.discountNumber&&d.reservationModel.rentalType!=n.rateTypeLeisure||(d.reservationModel.corporateAWD=!1);d.reservationModel.coupon.couponQuantity||(d.reservationModel.hideCoupons=!1);d.resFormPageInfoBool=!1;d.resFormPageInfo=""};d.analytics=function(a){var b={event:"analyticsVPV"};b.vpvName="/vpv/linkClickPage-"+a+d.pageName;dataLayer.push(b)};d.reservationModel=
H.getReservationModel();d.checkModifyDiscount=function(){return d.response.rateTypes||d.response.reservationSummary&&d.response.reservationSummary.coupon&&d.response.reservationSummary.coupon.number||void 0!=d.response.errorList&&0!=d.response.errorList.length&&!d.response.rateTypes&&(""==d.reservationModel.coupon.discountNumber||void 0==d.reservationModel.coupon.discountNumber)?!0:!1};d.checkDiscount=function(){return w.checkDiscount(d.response)};d.isPrepay=function(){return w.isPrepay(d.pageName,
d.reservationModel,d.isRecomendedFlow||d.response.preferredBundleList?!0:!1)};d.setCurrencyList=function(a){var b=[];angular.forEach(a,function(a){angular.isDefined(a)&&b.push(a)});d.uniqueCurrencylist=C("unique")(b,"currency")};d.getAlternateLocation=function(){ea="";angular.equals(d.pageControl.selectCarType,"")?A.displayServiceError("vm.pageControl.selectCarType","selectrequired"):(z.resetLocationSearchData(),e.getDisplayAvailForVehicleType(d.pageControl.selectCarType).then(function(a){angular.isDefined(a.noAvailableLoc)&&
angular.equals(a.noAvailableLoc.code,"05136")?(d.vehicleTypeInstruction=l.trustAsHtml(a.noAvailableLoc.message),jQuery(".selectedVehicleTypeNotAvailable")&&jQuery(".selectedVehicleTypeNotAvailable").modal("hide")):(ea="VEHICLETYPE",""===v.mapModalPath?v.mapModalPath=location.pathname.replace(".html","")+".map-modal"+htmlExtension:d._resolveLocation(),""===v.keyDropPath&&(v.keyDropPath=location.pathname.replace(".html","")+".keydrop-modal"+htmlExtension))},function(){}))};d.removeSelRateType=function(a){g.brand===
n.brandName.BUDGET&&angular.isDefined(d.reservationModel.coupon.discountNumber)&&(""===d.reservationModel.coupon.discountNumber||7<=d.reservationModel.coupon.discountNumber.length&&n.discountValidation.test(d.reservationModel.coupon.discountNumber))&&a&&(d.reservationModel.removeSelRateType=!0)};d.updateDiscountNumber=function(a){d.reservationModel.coupon.discountNumber=a.discountNumber;d.showLearnWhyError=!1;d.customer.awdSummary.partnerName=null;d.partnerName=null;d.partnerDiscount()};d.redirectToVehicle=
function(){z.resetBookAgainVehicle();var a=H.getReservationModel();a.bookAgain.bookAgainFlow=!1;H.setReservationModel(a);U()};d.showExtrasDetails=function(a){angular.isDefined(a)&&(d.extrasDescriptionList=a)};d.keyDropTnC=function(){d.keyDroptermsNc=!0;x()};d.keyDroptermsNc=!0;d.applyCouponCode=function(){G.couponApply(d.pageContent.couponList,d.reservationModel).then(function(a){d.pageContent.couponList=a.couponList;d.reservationModel=a.reservationModel})};d.partnerLogin=function(a){a=a.currentTarget.attributes.name.nodeValue;
angular.isDefined(d.customer)&&angular.isDefined(d.customer.userState)&&"RECOGNIZED"==d.customer.userState&&angular.isDefined(d.customer.amazonLinked)&&!d.customer.amazonLinked&&(d.loginWarningMsg=!0);a==n.amazonLabel&&0==d.loginWarningMsg?setTimeout(D.redirectURLRules(a),1):a==n.amazonLabel&&1==d.loginWarningMsg&&d.recognizedUserAmazonCall(a)};d.assignSelectedVehicleType=function(a){d.mobileSelectedVehicleType=a;d.pageControl.vehicleTypePlaceholder=a.description+" ("+d.getCarCountByClass(a.cargroup)+
")";jQuery(".allvehimodalformob")&&jQuery(".allvehimodalformob").modal("hide")};d.updateView=function(){!angular.equals({},d.mobileSelectedVehicleType)&&d.mobileSelectedVehicleType?d.filterVehicle(d.mobileSelectedVehicleType,!1):d._collapseSortFilter();d.sortVehicle(d.sortType);var a=!1;angular.isDefined(d.response.reservationSummary.awdNumber)&&!angular.equals(d.response.reservationSummary.awdNumber,d.reservationModel.coupon.discountNumber)?a=!0:!angular.isUndefined(d.response.reservationSummary.awdNumber)||
angular.isUndefined(d.reservationModel.coupon.discountNumber)||angular.equals(d.reservationModel.coupon.discountNumber,"")?angular.isDefined(d.response.reservationSummary.coupon)&&d.reservationModel.coupon.couponNumber&&!angular.equals(d.response.reservationSummary.coupon.number,d.reservationModel.coupon.couponNumber.toUpperCase())?a=!0:angular.isUndefined(d.response.reservationSummary.coupon)&&!angular.equals(d.reservationModel.coupon.couponNumber,"")?a=!0:angular.isDefined(d.response.reservationSummary.coupon)&&
angular.isDefined(d.response.reservationSummary.coupon.instances)&&!angular.equals(d.reservationModel.coupon.couponQuantity,d.response.reservationSummary.coupon.instances)?a=!0:!angular.isDefined(d.response.reservationSummary.awdNumber)||angular.isUndefined(d.reservationModel.coupon.discountNumber)||angular.equals(d.reservationModel.coupon.discountNumber,"")||angular.equals(d.reservationModel.coupon.discountNumber,d.response.reservationSummary.awdNumber)?angular.isDefined(d.response.reservationSummary.userSelectedCurrency)&&
!angular.equals(d.reservationModel.userSelectedCurrency,d.response.reservationSummary.userSelectedCurrency)?a=!0:angular.isDefined(d.reservationModel)&&angular.isDefined(d.reservationModel.coupon)&&angular.isDefined(d.reservationModel.coupon.couponRateCode)&&""!=d.reservationModel.coupon.couponRateCode&&(a=!0):a=!0:a=!0;a&&d.applyCoupon()};d.closeRefineAndSortModal=function(){var a=!1;angular.isDefined(d.mobileSelectedVehicleType)&&angular.isDefined(d.reservationModel.vehicleType)&&!angular.equals(d.mobileSelectedVehicleType.code,
d.reservationModel.vehicleType.code)?a=!0:d._isSorted(d.isRecomendedFlow)?a=!0:angular.isDefined(d.reservationModel.userSelectedCurrency)&&!angular.equals(d.reservationModel.userSelectedCurrency,d.response.reservationSummary.userSelectedCurrency)?a=!0:angular.isDefined(d.reservationModel.rentalType)&&!angular.equals(d.reservationModel.rentalType,d.rentalTypeTemp)?a=!0:angular.isDefined(d.reservationModel.coupon)&&angular.isDefined(d.reservationModel.coupon.couponNumber)&&!angular.equals(d.reservationModel.coupon.couponNumber,
d.couponNumberTemp)?a=!0:angular.isDefined(d.reservationModel.coupon)&&angular.isDefined(d.reservationModel.coupon.couponQuantity)&&!angular.equals(d.reservationModel.coupon.couponQuantity,d.couponQuantityTemp)&&(a=!0);a&&(d.mobileSelectedVehicleType=d.reservationModel.vehicleType,angular.isDefined(d.reservationModel.vehicleType)&&angular.equals(d.reservationModel.vehicleType,"")?d.pageControl.vehicleTypePlaceholder=n.defaultVehicleTypeDesc+" ("+d.getCarCountByClass(d.reservationModel.vehicleType.cargroup)+
")":d.pageControl.vehicleTypePlaceholder=d.reservationModel.vehicleType.description+" ("+d.getCarCountByClass(d.reservationModel.vehicleType.cargroup)+")",d.sortType=d.pageControl.userSortOption,d.reservationModel.userSelectedCurrency=d.response.reservationSummary.userSelectedCurrency,d.reservationModel.rentalType=d.rentalTypeTemp);angular.isDefined(d.response.reservationSummary.awdNumber)&&!angular.equals(d.response.reservationSummary.awdNumber,"")?d.reservationModel.coupon.discountNumber=d.response.reservationSummary.awdNumber:
angular.isUndefined(d.response.reservationSummary.awdNumber)&&(d.reservationModel.coupon.discountNumber="");angular.isDefined(d.response.reservationSummary.coupon)&&!angular.equals(d.response.reservationSummary.coupon.number,"")?(d.reservationModel.coupon.couponNumber=d.response.reservationSummary.coupon.number,d.reservationModel.coupon.couponQuantity=d.couponQuantityTemp,d.reservationModel.coupon.isMultiCoupon=d.pageContent.couponList&&1<d.pageContent.couponList.length&&d.reservationModel.coupon.couponNumber?
!0:!1):angular.isUndefined(d.response.reservationSummary.coupon)&&(d.reservationModel.coupon.couponNumber="",d.reservationModel.coupon.couponQuantity="",d.reservationModel.coupon.isMultiCoupon=!1,a=d.couponList={},z.setCouponList(a))};d.mobileSelectedVehicleType={};d.closeCarModel=function(){M.closeModal({type:"CarDetailsModify"})};d.getPrepayTnCs=x;d.amazonUserStatus="";d.openExtrasModal=function(a){d.selectedCarExtrasDetail=a};d._collapseSortFilter=function(){angular.element("#vehicleModal")&&angular.element("#vehicleModal").modal("hide");
angular.element(".allvehimodalformob")&&angular.element(".allvehimodalformob").modal("hide");angular.element(".myModalVehicleDrpDwn")&&angular.element(".myModalVehicleDrpDwn").modal("hide")};d._defaultSortFilter=function(){var a=d._getFeaturedVehicleClasses();if(d.isRecomendedFlow){var b=d.response.recommendation.filterVehicles;a=d.response.recommendation.featureVehicles}d._resetVehicleGrouping(a,b)};d._hideVehicleInfo=function(){var a=jQuery(".avilablecar.available-car-box");a.find(".avlcarimagetab img").removeClass("slide-left");
a.removeClass("bg-grey");a.find(".vehicleinfo").removeClass("icon-remove");a.find(".available-car-fac").addClass("hidden").removeClass("bg-grey");a=jQuery(".featuredcar.featured-car-box");a.find(".ftrcarimage img").removeClass("slide-left");a.removeClass("bg-grey");a.find(".vehicleinfo").removeClass("icon-remove");a.find(".featured-car-fac").addClass("hidden").removeClass("bg-grey");a=jQuery(".choice-section .featuredcar.featured-car-box");0<a.length&&(a.find(".ftrcarimage img").removeClass("slide-left"),
a.removeClass("bg-grey"),a.find(".vehicleinfo"),a.find(".featured-car-fac").addClass("hidden").removeClass("bg-grey"))};d._sortByFunc=function(a){d._isSorted()||d._isFiltered()?d._getVehicleHighlighter()==w.VehicleHighlighter.NEW&&!d._isFiltered()&&d._isSorted()?d._resetVehicleGrouping():-1<d.pageControl.vehicleTypePlaceholder.indexOf(n.defaultVehicleTypeDesc)&&d._resetVehicleGrouping():d._defaultSortFilter();var b=w.getSortExpression(a);d.pageControl.orderByAvailable=b;"MILAGE"==a?d.iconImage="mpg-seats-feat":
"SEAT"==a&&(d.iconImage="four-seats-feat")};d._processErrorByType=function(a){return a=q.processErrorMessage(a)};d._resetModalVal=function(){d.reservationModel.coupon&&0==d.reservationModel.coupon.visible?d.reservationModel.coupon.couponNumber="":(d.reservationModel.coupon.couponNumber=d.couponNumberTemp,d.reservationModel.coupon.couponQuantity=d.couponQuantityTemp,d.reservationModel.coupon.discountNumber=d.discountNumberTemp,angular.forEach(d.response.instructionList,function(a){d.response.instructionList&&
(0<d.response.instructionList.length||0<d.response.errorList.length)&&h.containsObject(a.code,n.nonParticpatingBcd)&&(d.reservationModel.coupon.discountNumber="")}),d.reservationModel.coupon.couponRateCode=d.ratecodeNumberTemp,d.reservationModel.rentalType=d.rentalTypeTemp);H.setReservationModel(d.reservationModel)};d._getVehicleHighlighter=function(){var a=H.getReservationModel();if(angular.isDefined(a.selectedCar)&&0<a.selectedCar.length&&"GUIDED_RES"!=a.bundleFlow&&y.current.name!==n.bookAgainPage&&
y.current.name!==n.bookAgainVehiclePage)var b=w.VehicleHighlighter.NEW;return b};d._isSorted=function(){return d.response.isSortRecommended&&d.pageName==n.step2PageName?d.pageControl.userSortOption!=w.SortBy.RECOMMENDED.code?!0:!1:d.pageControl.userSortOption!=w.SortBy.PRICE.code?!0:!1};d._isFiltered=function(a){return $(window).width()<n.deviceTypeMobileWidth?d.mobileSelectedVehicleType&&d.mobileSelectedVehicleType.cargroup&&0<d.mobileSelectedVehicleType.cargroup.length||0<d.selectedFeatures.list.length||
a?!0:!1:d.selectedFilter&&0<d.selectedFilter.cargroup.length||0<d.selectedFeatures.list.length||a?!0:!1};d._resetVehicleGrouping=function(a,b){d.response=w.groupAvailableVehicles(d.response,a,!1,b)};d._getFeaturedVehicleClasses=function(){var a;d._getVehicleHighlighter()==w.VehicleHighlighter.NEW?a=[d.reservationModel.selectedCar[0].carClass]:n.resFlowModify===d.reservationModel.displayControls.reservation&&angular.isDefined(d.response.oldReservationSummary)?a=[d.response.oldReservationSummary.vehicle.carClass]:
""!=d.reservationModel.selectedCarClass&&""!=d.reservationModel.selectedCarAvailability?a=[H.getStorageData("oneClickSelectedCar").carClass]:angular.isDefined(d.response.preferredCarClass)&&""!=d.response.preferredCarClass&&(a=[d.response.preferredCarClass]);d.response.errorList&&"05129"===d.response.errorList.code&&(a=[]);return w.getVehicleClasses(a)};d._resetPointSelection=function(){var a=[];0<d.reservationModel.selectedProducts.length&&(angular.forEach(d.reservationModel.selectedProducts,function(b,
e){d.reservationModel.selectedProducts[e].redeemedQty&&0!=d.reservationModel.selectedProducts[e].redeemedQty||a.push(d.reservationModel.selectedProducts[e])}),d.reservationModel.selectedProducts=a)};d._removeUPSSelection=function(){var a=[];0<d.reservationModel.selectedProducts.length&&(angular.forEach(d.reservationModel.selectedProducts,function(b,e){"UPS"!=d.reservationModel.selectedProducts[e].code&&a.push(d.reservationModel.selectedProducts[e])}),d.reservationModel.selectedProducts=a)};d._reviewCall=
function(){v.requestInProgress=!0;r.load(d.pageName).then(function(a){if(d.pageName==n.step4PageName||d.pageName==n.step4PayLaterPageName){if(angular.isDefined(a)&&angular.isDefined(a.reservationSummary)&&angular.isDefined(a.reservationSummary.rateSummary)&&angular.isDefined(a.reservationSummary.rateSummary.estimatedTotal)){var b=H.getReservationModel();b.estimatedTotal=a.reservationSummary.rateSummary.estimatedTotal;H.setReservationModel(b)}"FALSE"==a.reservationSummary.payNowCheckBoxInd.visible&&
"FALSE"==a.reservationSummary.ccsection.visible||!(d.reservationModel.prepayOpted||d.reservationModel.prepayProcessIndicator||d.rentalLocationCountry!=n.countryCodeAU.toUpperCase()&&d.rentalLocationCountry!=n.countryCodeNZ.toUpperCase())?y.go(n.step4PayLaterPageName,{},{reload:!0}):y.go(n.step4PageName,{},{reload:!0})}else d.reservationModel.bookAgain.bookAgainFlow&&(v.requestInProgress=!1,(b=r.payNowCheckBox(a))?b&&y.go(n.bookAgainPayLaterPage,{},{reload:!0}):y.go(n.bookAgainPayNowPage,{},{reload:!0})),
"FALSE"==a.reservationSummary.payNowCheckBoxInd.visible&&"FALSE"==a.reservationSummary.ccsection.visible?y.go(n.step4PayLaterPageName,{},{reload:!0}):y.go(n.step4PageName,{},{reload:!0})})};d._isModifyVehicleModal=function(){return d.pageName==n.step3PageName||d.pageName==n.step4PageName||d.pageName==n.step4PayLaterPageName||d.pageName==n.bookAgainPayNowPage||d.pageName==n.bookAgainPayLaterPage?!0:!1};d._processVehiclesPage=function(){d.reservationModel=H.getReservationModel();d.isBookAgainFlow=H.isBookAgainFlow(d.pageName);
d.isBookAgainFlow&&(b.datePickerInitFun(v.deviceType,""),d.pageName===n.bookAgainVehiclePage&&z.resetAvailableExtras());var a=d._getVehicleHighlighter(),e=I.getStorageData("vehicleTypeList");""==e||void 0==e||$.isEmptyObject(e)||(z.addToVehicleType(e),I.deleteStorageData("vehicleTypeList"));w.getData(a).then(function(a){d.reservationModel?d._dataProcess(a):H.load(a,!0).then(function(b){d.reservationModel=b;d._dataProcess(a)});v.$broadcast("Profile.refreshCustomerInfo")},function(a){});d.replayErrMsg()};
d._dataProcess=function(b){d.reservationModel.coupon.discountNumberType=b.reservationSummary.discountNumberType;d.corporateBcd="C"==d.reservationModel.coupon.discountNumberType||"K"==d.reservationModel.coupon.discountNumberType||"G"==d.reservationModel.coupon.discountNumberType||"S"==d.reservationModel.coupon.discountNumberType||"T"==d.reservationModel.coupon.discountNumberType||"H"==d.reservationModel.coupon.discountNumberType||"J"==d.reservationModel.coupon.discountNumberType||"R"==d.reservationModel.coupon.discountNumberType||
"U"==d.reservationModel.coupon.discountNumberType||"V"==d.reservationModel.coupon.discountNumberType||"I"==d.reservationModel.coupon.discountNumberType||"Z"==d.reservationModel.coupon.discountNumberType;d.displayUpLiftRelatedInfo=!d.corporateBcd&&"US"==d.reservationModel.personalInfoRQ.residency&&"US"==d.reservationModel.pickCountry&&"true"==d.showUpliftOptionStep2&&"true"==d.enableUplift&&angular.equals(v.reservation,n.resFlowCreate)?!0:!1;g.brand!=n.brandName.BUDGET||d.domain!==n.countryCodeUS.toLowerCase()&&
d.domain!==n.countryCodeCA.toLowerCase()||!angular.isDefined(b.reservationSummary)||!angular.isDefined(b.reservationSummary.pickLoc.address.country)||"US"!==b.reservationSummary.pickLoc.address.country&&"CA"!==b.reservationSummary.pickLoc.address.country||!angular.isDefined(b.reservationSummary.pickLoc.corpLicInd)||"C"!==b.reservationSummary.pickLoc.corpLicInd||!angular.isDefined(d.reservationModel.personalInfoRQ.residency)||"US"!=d.reservationModel.personalInfoRQ.residency&&"CA"!=d.reservationModel.personalInfoRQ.residency||
(d.displayFeatures=!0);g.brand!=n.brandName.AVIS||d.domain!==n.countryCodeUS.toLowerCase()&&d.domain!==n.countryCodeCA.toLowerCase()||!angular.isDefined(b.reservationSummary)||!angular.isDefined(b.reservationSummary.pickLoc.address.country)||"US"!==b.reservationSummary.pickLoc.address.country&&"CA"!==b.reservationSummary.pickLoc.address.country||!angular.isDefined(b.reservationSummary.pickLoc.corpLicInd)||"C"!==b.reservationSummary.pickLoc.corpLicInd||!angular.isDefined(d.reservationModel.personalInfoRQ.residency)||
"US"!=d.reservationModel.personalInfoRQ.residency&&"CA"!=d.reservationModel.personalInfoRQ.residency||(d.premiumDisplayFeatures=!0);if(g.brand===n.brandName.AVIS||g.brand===n.brandName.BUDGET)d.electricVehicleFeatures=!0;g.brand==n.brandName.AVIS&&d.domain===n.countryCodeAU.toLowerCase()&&angular.isDefined(b.reservationSummary)&&angular.isDefined(b.reservationSummary.pickLoc.address.country)&&"AU"===b.reservationSummary.pickLoc.address.country&&angular.isDefined(d.reservationModel.personalInfoRQ.residency)&&
"AU"==d.reservationModel.personalInfoRQ.residency&&(d.redBgSignatureSeriesFeature=!0);d.displayUpLiftRelatedInfo&&(setTimeout(function(){window.Uplift.Payments.init({apiKey:g.upliftApiKey,locale:"en-US",currency:"USD",checkout:!1,channel:"desktop"});d.orderInfo={travelers:[{}],rentals:[{type:"",unit_price:0,quantity:1,start_date:d.reservationModel.pickUpDate.replaceAll("-",""),end_date:d.reservationModel.dropDate.replaceAll("-",""),agency:"Budget",insurance:[{}]}],add_ons:[{}],order_amount:0};window.Uplift.Payments.load(d.orderInfo)},
500),setTimeout(function(){window.Uplift.Payments.load(d.orderInfo)},500));d.response=b;angular.isDefined(d.response.reservationSummary.coupon)&&angular.isUndefined(d.response.reservationSummary.coupon.type)&&(d.response.reservationSummary.coupon.type=d.response.reservationSummary.coupon.number.charAt(0));d.setMvtFlag();"#/vehicles"===window.location.hash&&ABG.stepTwoLoader();angular.isDefined(b.showTotalRate)&&b.showTotalRate.code==n.showTotalRate&&(d.displayTotalRate=!0,angular.isDefined(b.reservationSummary.gebUser)&&
b.reservationSummary.gebUser&&(d.displayTotalRate=!1));b.reservationSummary.ancillariesIncluded&&0<b.reservationSummary.ancillariesIncluded.length&&w.includedExtas(b).then(function(a){d.ancillariesIncluded=a.reservationSummary.ancillariesIncludedList});angular.isDefined(b.reservationSummary.personalInfo)&&angular.isDefined(b.reservationSummary.personalInfo.residency.value)&&("us"==b.reservationSummary.personalInfo.residency.value.toLowerCase()||"ca"==b.reservationSummary.personalInfo.residency.value.toLowerCase())&&
angular.isDefined(b.reservationSummary.userState)&&"AUTHENTICATED"==b.reservationSummary.userState&&g.brand==n.brandName.AVIS&&(d.epIndicator=!0);"LAST_MINUTE"===b.bundleFlow&&angular.isDefined(g.SKIP_STEP3_FLOW)&&"true"===g.SKIP_STEP3_FLOW.ENABLE_LMB?(angular.element(document).find(".lmb-modal").modal({backdrop:"static"}),w.getBundleDesciption(d.response).then(function(a){d.response=a})):"INBOUND"===b.bundleFlow&&(w.SortBy=w.getBundleSortBy(),d.pageControl.orderByAvailable=w.SortBy.PRICE.sortExpression);
d.reservationModel.userSelectedCurrency=b.reservationSummary.userSelectedCurrency;d.rentalLocationCountry=b.reservationSummary.pickLoc.address.country.toUpperCase();if(d.pageName==n.step2PageName)try{u.analyticsDimension(b.reservationSummary,d.pageName,b)}catch(ka){}v.isAnonymous&&d.pageName==n.step2PageName&&b.reservationSummary.memberRatesEligibile&&(d.isStepTwoAnonymous=!0);var e=b.reservationSummary.pickLoc.address.country;d.pageControl.enableSortOption=w.isFilterAvailable(e);d.pageControl.enableSortOption&&
(d.pageControl.sortByList=w.getSortByOptions(e,!1),d.sortType=d.pageControl.sortByList[0].code);d.pageControl.locationControl=d.pageControl.enableSortOption&&w.isFilterReady(b.carGroupList);d.pageControl.locationControl&&(d.pageControl.vehicleTypePlaceholder=w.getVehicleType(b,b.carGroupList),e=""!=d.reservationModel.vehicleType&&d.pageName==n.step2PageName?d.reservationModel.vehicleType:b.carGroupList[0],e.description!=n.defaultVehicleTypeDesc&&d.filterVehicle(e,!1),d.pageName==n.step2PageName&&
""!=d.reservationModel.vehicleType&&d._setVehicleTypeFilterDisplay(b));d.reservationModel.vehicleType&&""!=d.reservationModel.vehicleType?d.mobileSelectedVehicleType=d.reservationModel.vehicleType:void 0!=b.carGroupList&&(d.mobileSelectedVehicleType=b.carGroupList[0]);H.loadPickUpInfo(d.reservationModel,b.reservationSummary);H.loadDropOffInfo(d.reservationModel,b.reservationSummary);d._processErrorByType(b);!0===b.reservationSummary.underAgeUser&&(d.underAge=!0);void 0!=b.reservationSummary.coupon&&
(d.couponNumberTemp=b.reservationSummary.coupon.number);d._setAwdOnPageLoad();d.amazonUserStatus=D.amazonLoginStatus();d.discountNumberTemp=d.reservationModel.coupon.discountNumber;d.ratecodeNumberTemp=b.reservationSummary.couponRateCode;d.ratecodeNumberTemp=b.reservationSummary.couponRateCode?b.reservationSummary.couponRateCode:"";a();d.pageControl.isModifyVehicleModal=d._isModifyVehicleModal();d.getAwdLabel(b);void 0!=b.reservationSummary.awdNumber&&b.rateTypes&&g.brand===n.brandName.AVIS?d.awdList=
w.getAwdList(b.rateTypes,b.reservationSummary.awdNumber):b.reservationSummary&&d.reservationModel.coupon&&(d.reservationModel.coupon.isprofileBCD=!1,b.reservationSummary.rateTypes&&b.reservationSummary.selDiscountNum&&angular.isDefined(b.reservationSummary.awdNumber)&&b.reservationSummary.awdNumber!=d.amazonBenefitsKey&&(d.reservationModel.coupon.isprofileBCD=!0,d.awdList=w.getBcdList(b.reservationSummary.rateTypes),e=d.awdList.indexOf(C("filter")(d.awdList,function(a){return a.value===b.reservationSummary.selDiscountNum})[0]),
angular.isUndefined(d.reservationModel.rentalType)&&(d.reservationModel.rentalType=""),-1<e&&0<d.awdList.length&&(d.reservationModel.selectedRateType=d.awdList[e].value)));b.reservationSummary.awdNumber&&b.rateTypes&&(d.rentalTypeTemp=d.reservationModel.rentalType);b.currencies&&d.setCurrencyList(b.currencies);if(angular.isDefined(d.reservationModel)&&angular.isDefined(d.reservationModel.displayControls)&&angular.isDefined(d.reservationModel.displayControls.reservation)&&"modify"==d.reservationModel.displayControls.reservation&&
angular.isDefined(b)&&angular.isDefined(b.oldReservationSummary)&&angular.isDefined(b.oldReservationSummary.prepayTxn)&&b.oldReservationSummary.prepayTxn){if(angular.isDefined(b.oldReservationSummary)&&angular.isDefined(b.oldReservationSummary.prepayInfo)&&angular.isDefined(b.oldReservationSummary.prepayInfo.currency)){var f=[];f.push(b.oldReservationSummary.prepayInfo.currency)}d.setCurrencyList(f)}d.userCurrency=b.reservationSummary.userSelectedCurrency;H.getCouponDetails(b)&&(d.currencySymbol=
C("currencySymbol")(b.reservationSummary.coupon.currencySymbol),d.couponNumberTemp=b.reservationSummary.coupon.number,d.pageContent.couponList=z.getCouponList(),b.reservationSummary.coupon.instances?(d.reservationModel.coupon.couponQuantity=b.reservationSummary.coupon.instances,d.couponQuantityTemp=b.reservationSummary.coupon.instances):angular.isDefined(d.pageContent)&&angular.isDefined(d.pageContent.couponList)&&1<d.pageContent.couponList.length?(d.reservationModel.coupon.couponQuantity=1,d.couponQuantityTemp=
1):(d.reservationModel.coupon.couponQuantity="",d.reservationModel.coupon.isMultiCoupon=!1,d.couponQuantityTemp=""),d.applyCouponCode());f=g.locale;f="fr"==f||"fr_US"==f?!0:!1;"us"!=g.domain.toLowerCase()&&"ca"!=g.domain.toLowerCase()||!f||(d.response.reservationSummary.prepayInfo.cancelFee=d.response.reservationSummary.prepayInfo.cancelFee.replace(".",","),d.response.reservationSummary.prepayInfo.noShowFee=d.response.reservationSummary.prepayInfo.noShowFee.replace(".",","),d.response.reservationSummary.prepayInfo.currency=
"$ CA");v.requestInProgress=!1;angular.element(".stepTwoHOL").removeClass("stepTwoHOL");d.oneClickSlecetedCarFlow=!1;d.oneClickSlecetedCarFlow=angular.isDefined(H.getStorageData("oneClickSelectedCar"))?!0:!1;f=H.getReservationModel();angular.isDefined(d.response.preferredBundleList)&&angular.isDefined(d.response.preferredBundleList[0].bundle[0].bundleType)&&"GUIDED_RES"===d.response.preferredBundleList[0].bundle[0].bundleType?f.isGuidedRes=!0:f.isGuidedRes=!1;d.reservationModel.payNowToggleOptionSelected=
"NOT_SELECTED";d.reservationModel.payNowToggle=!1;H.setReservationModel(f);d.reservationModel=f;(0>=d.reservationModel.selectedCar.length||d.domain===n.countryCodeUS.toLowerCase()&&g.brand===n.brandName.AVIS)&&n.resFlowCreate===d.reservationModel.displayControls.reservation&&d.pageName==n.step2PageName&&!d.oneClickSlecetedCarFlow&&!d.isBookAgainFlow&&"NORMAL"===d.response.bundleFlow&&angular.isUndefined(d.response.preferredCarClass)&&d._merchandisingServiceListener(d,b);(g.brand===n.brandName.AVIS||
g.brand===n.brandName.BUDGET)&&n.resFlowCreate===d.reservationModel.displayControls.reservation&&d.pageName==n.step2PageName&&!d.isBookAgainFlow&&d.reservationModel&&d.reservationModel.pickUpLocation&&d.reservationModel.pickUpLocation.countryCode&&T.loadBundles(d.reservationModel.pickUpLocation.countryCode);d.reservationModel.removeSelRateType=!1;m(angular.element('a[piclocInfoMsg \x3d "pickup"]'))(q);m(angular.element('a[piclocInfoMsg \x3d "return"]'))(q);if(g.bundleExceptionText&&angular.isUndefined(d.response.preferredBundleList)&&
f.isGuidedRes)if(angular.isUndefined(d.response.instructionList)&&(d.response.instructionList=[]),d.response&&d.response.instructionList&&0<d.response.instructionList.length)for(f=0;f<d.response.instructionList.length;f++)"05250"===d.response.instructionList[f].code&&(d.response.instructionList[f].message=g.bundleExceptionText);else d.response.instructionList.push({message:g.bundleExceptionText});angular.isDefined(d.reservationModel)&&angular.isDefined(d.reservationModel.coupon)&&angular.isDefined(d.reservationModel.coupon.partnerMembershipId)&&
""!=d.reservationModel.coupon.partnerMembershipId&&angular.isDefined(d.response)&&angular.isDefined(d.response.reservationSummary)&&(d.requiresMemberID=angular.isDefined(d.response.reservationSummary.memberIDVisible)?d.response.reservationSummary.memberIDVisible:!1,d.partnerName=angular.isDefined(d.response.reservationSummary.partnerName)?d.response.reservationSummary.partnerName:null,d.partnerPlaceholder=d.partnerName+Dictionary.I18n.get("lbl.global.partnerMember,"+brand),d.partnerLabel=Dictionary.I18n.get("lbl.global.partnerlabel,"+
brand)+d.partnerName+Dictionary.I18n.get("lbl.global.partnerlabel1,"+brand),d.step2PartnerDiscountMessage=Dictionary.I18n.get("msg.res.awdSavings."+d.partnerName+","+brand));angular.isDefined(d.reservationModel)&&angular.isDefined(d.reservationModel.coupon)&&angular.isDefined(d.reservationModel.coupon.discountNumber)&&""!=d.reservationModel.coupon.discountNumber&&-1!=d.reservationModel.coupon.discountNumber.toUpperCase().indexOf("RATE")&&(d.reservationModel.coupon.isMaskedDiscountCode=!0);angular.isDefined(d.reservationModel)&&
angular.isDefined(d.reservationModel.coupon)&&angular.isDefined(d.reservationModel.coupon.discountNumber)&&(""!=d.reservationModel.coupon.discountNumber&&-1!=d.reservationModel.coupon.discountNumber.toUpperCase().indexOf("DISCOUNT")||-1!=d.reservationModel.coupon.discountNumber.toUpperCase().indexOf("BENEFITS"))&&(d.reservationModel.coupon.isMaskedDiscountCode=!0);var h="";angular.isDefined(d.reservationModel)&&angular.isDefined(d.reservationModel.pickUpLocation)&&angular.isDefined(d.reservationModel.pickUpLocation.corpLicInd)?
h=d.reservationModel.pickUpLocation.corpLicInd:angular.isDefined(b)&&angular.isDefined(b.reservationSummary)&&angular.isDefined(b.reservationSummary.pickLoc)&&angular.isDefined(b.reservationSummary.pickLoc.corpLicInd)&&(h=b.reservationSummary.pickLoc.corpLicInd);angular.isDefined(d.reservationModel)&&"C"==h&&"create"==d.reservationModel.displayControls.reservation?d.showUSAAContent=!0:d.showUSAAContent=!1;setTimeout(function(){d.personalizedPartnerName=I.getStorageData("partnerName");O.hideorShowPartnerBenefits(b);
angular.isDefined(d.personalizedPartnerName)&&""!=d.personalizedPartnerName&&"C"!=h&&I.deleteStorageData("partnerName");angular.isDefined(d.personalizedPartnerName)&&""!=d.personalizedPartnerName&&"USAA"==d.personalizedPartnerName&&"handheld"!==v.deviceType&&d.showUSAAContent&&"create"==d.reservationModel.displayControls.reservation&&(I.getStorageData("hideUsaaModal")||angular.element("#partner-step2-modal").modal());angular.isDefined(d.personalizedPartnerName)&&""!=d.personalizedPartnerName&&"AARP"==
d.personalizedPartnerName&&"handheld"!==v.deviceType&&d.showUSAAContent&&"create"==d.reservationModel.displayControls.reservation&&(I.getStorageData("hideAarpModal")||angular.element("#aarp-partner-step2-modal").modal(),$(".aarp-banner-step2").hide())},500)};d._merchandisingServiceListener=function(a,b){f.promisesExecution(b,"vehicles").then(function(b){a.response=b;b.featuredVehicles&&b.featuredVehicles.forEach(function(a){a.calloutDescription&&(a.calloutDescription=l.trustAsHtml(a.calloutDescription))});
b.filteredVehicles&&b.filteredVehicles.forEach(function(a){a.calloutDescription&&(a.calloutDescription=l.trustAsHtml(a.calloutDescription))});var d=b.reservationSummary.pickLoc.address.country;a.isRecomendedFlow=!0;a.isFilterRecomDivider=!1;a.pageControl.sortByList=w.getSortByOptions(d);b.isSortRecommended&&(a.pageControl.sortByList=w.getSortByOptions(d,!0),a.pageControl.sortByList&&(a.sortType=a.pageControl.sortByList[a.pageControl.sortByList.length-1].code),a.pageControl.userSortOption=w.SortBy.RECOMMENDED.code,
a.pageControl.sortPlaceHolder=w.SortBy.RECOMMENDED.description,a.pageControl.orderByAvailable=w.getSortExpression(a.pageControl.userSortOption));a._displaySoldoutInstruction();B(function(){Z()},1)})};d._displaySoldoutInstruction=function(){""===d.reservationModel.vehicleType||d.reservationModel.vehicleType.code===n.defaultDisplayedVehicleType?d.filterVehicle(d.response.carGroupList[0],!1):""!==d.reservationModel.vehicleType&&d.reservationModel.vehicleType.code!==n.defaultDisplayedVehicleType&&(0===
d.getCarCountByClass(d.reservationModel.vehicleType.cargroup)?d.pageControl.vehicleTypeNotAvailable=!0:d.filterVehicle(d.reservationModel.vehicleType,!1),angular.equals(d.reservationModel.vehicleType.code,"all")||(d.pageControl.displayVehicleList=!0,d.pageControl.vehicleTypePlaceholder=d.reservationModel.vehicleType.description+" ("+d.getCarCountByClass(d.reservationModel.vehicleType.cargroup)+")"))};d._setVehicleTypeFilterDisplay=function(a){var b=d.reservationModel.vehicleType;d.carList=w.populateCarList(a,
a.carGroupList,d.reservationModel.vehicleType.code);a=w.getSelectedCarGruop(b,a.carGroupList);0===d.getCarCountByClass(a)&&(d.pageControl.vehicleTypeNotAvailable=!0,d.vehicleTypeInstruction=l.trustAsHtml(Dictionary.I18n.get("msg.res.step2.vehiclesold1,"+brand)));angular.equals(b.code,"all")||(d.pageControl.displayVehicleList=!0)};d._setAwdOnPageLoad=function(){angular.isDefined(d.response.reservationSummary.discountSummaryList)&&(d.reservationModel.discountSummaryList=d.response.reservationSummary.discountSummaryList);
angular.isDefined(d.response.reservationSummary.amazonLinked)&&(d.reservationModel.amazonLinked=d.response.reservationSummary.amazonLinked);angular.isDefined(d.response.reservationSummary.amazonLinkingSupported)&&(d.reservationModel.amazonLinkingSupported=d.response.reservationSummary.amazonLinkingSupported);angular.isDefined(d.response.reservationSummary.awdNumber)&&!angular.equals(d.response.reservationSummary.awdNumber,"")?d.reservationModel.coupon.discountNumber=d.response.reservationSummary.awdNumber:
g.brand!==n.brandName.AVIS||angular.isDefined(d.customer)&&angular.isDefined(d.customer.userState)&&("PARTNER_AUTHENTICATED"==d.customer.userState||angular.isDefined(d.customer.amazonLinked)&&d.customer.amazonLinked)?g.brand!==n.brandName.BUDGET||angular.isDefined(d.customer)&&("PARTNER_AUTHENTICATED"==d.customer.userState||angular.isDefined(d.customer.amazonLinked)&&d.customer.amazonLinked)?angular.isUndefined(d.response.reservationSummary.awdNumber)&&(d.reservationModel.coupon.discountNumber=""):
d.reservationModel.coupon.discountNumber=angular.isDefined(d.response.reservationSummary.userEnteredBcd)?d.response.reservationSummary.userEnteredBcd:"":d.reservationModel.coupon.discountNumber=angular.isDefined(d.response.reservationSummary.awdNumber)?d.response.reservationSummary.awdNumber:"";angular.isDefined(d.reservationModel)&&angular.isDefined(d.reservationModel.confdiscountnum)&&""!=d.reservationModel.confdiscountnum&&(d.reservationModel.coupon.discountNumber=d.reservationModel.confdiscountnum)};
d._resolveLocation=function(){v.$broadcast("searchLocation.request",{requestFrom:"vehicleType",selectedCarType:d.pageControl.selectCarType,resolvePosition:1});jQuery(".selectedVehicleTypeNotAvailable")&&angular.equals(v.deviceType,n.deviceTypeDesktop)&&jQuery(".selectedVehicleTypeNotAvailable").modal("hide")};d._searchLocationResponseHandler=function(a,b){if(angular.isDefined(b)&&angular.equals(b.event,"SELECT")&&angular.equals(b.requestFrom,"vehicleType")){v.requestInProgress=!0;var e=H.getReservationModel();
a=!1;angular.equals(e.pickUpLocation.suggCode,e.dropLocation.suggCode)&&(a=!0);e.pickUpLocation={};e.pickInfo=b.locCode;e.pickUpLocation.suggCode=b.locCode;e.pickUpLocation.suggDescription=b.description;e.pickUpLocation.originalObject={order:"1"};a&&(e.dropLocation=e.pickUpLocation,e.dropInfo=e.pickInfo);H.setReservationModel(e);"true"!=d.enableEnterpriseCaptcha||angular.isDefined(isHumanSecEnabled)&&"true"==isHumanSecEnabled&&angular.isDefined(window._pxAppId)||g.brand!=n.brandName.AVIS&&g.brand!=
n.brandName.BUDGET?w.load().then(function(a){a=q.processErrorMessage(a);angular.isDefined(a.warningList)&&0<a.warningList.length&&(angular.equals(a.warningList[0].code,"157")||angular.equals(a.warningList[0].code,"158")||angular.equals(a.warningList[0].code,"161"))?v.$emit("searchLocation.soldOutNotification",b):(d.reservationModel=e,d.response=a,d._displaySoldoutInstruction(),Y(),v.requestInProgress=!1)}):grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(enterpriseCaptchaSiteKey,
{action:"submit"}).then(function(a){d.recaptcha=a;w.load(!1,d.recaptcha).then(function(a){a=q.processErrorMessage(a);angular.isDefined(a.warningList)&&0<a.warningList.length&&(angular.equals(a.warningList[0].code,"157")||angular.equals(a.warningList[0].code,"158")||angular.equals(a.warningList[0].code,"161"))?v.$emit("searchLocation.soldOutNotification",b):(d.reservationModel=e,d.response=a,d._displaySoldoutInstruction(),Y(),v.requestInProgress=!1)})})})}else angular.isDefined(b)&&angular.equals(b.event,
"CLOSE")&&angular.equals(b.requestFrom,"vehicleType")&&Y()};d._loadVehicleData=U;d._processToExtras=function(a){d._resetPointSelection();d._removeUPSSelection();d.reservationModel.pointProducts.carUpsell="";d._resetModalVal();var b=d.reservationModel.selectedCar[0];angular.isDefined(b.bundle)&&ABG.arrayHasObject(b.bundle[0].bundleType,["LAST_MINUTE","GUIDED_RES","INBOUND_ALL","INBOUND_BASIC"])&&(d.reservationModel=E.processSupportedExtras(d.reservationModel,d.response.preferredBundleList),E.setAncillaryPrefferredBundlesData(b.bundle[0].bundleType));
H.setReservationModel(d.reservationModel);d.reservationModel.bookAgain.bookAgainFlow&&d.pageName!=n.bookAgainPayNowPage&&d.pageName!=n.bookAgainPayLaterPage?d._reviewCall():E.load(!1,a).then(function(a){var e=H.getExpressReservationFlag();if(!angular.isDefined(a.webHeader)||"4"!=a.webHeader.viewIndicator&&"5"!=a.webHeader.viewIndicator&&"6"!=a.webHeader.viewIndicator||!e||a.reservationSummary.prepayTxn)if(angular.isDefined(a.errorList)&&0<a.errorList.length){d.errorDisplayList=q.processErrorMessage(a).errorList;
var f="05126 05127 05128 14437 14438 14439 14440 14441 14442 14443 14444 14075 30014 10019 10020 19074 14528".split(" ");angular.forEach(a.errorList,function(a,b){h.containsObject(a.code,f)&&(d.reservationModel.forceRateCodeDisplay=!1)});d.errorDisplayList=O.handleRateCodeMainFrameError(d.errorDisplayList);v.requestInProgress=!1}else angular.isDefined(a.fieldErrors)&&0<a.fieldErrors.length?(d.displayDiscount=!0,A.displayServiceError("vm.reservationModel.coupon.discountNumber","platformawd"),v.requestInProgress=
!1):(H.getReservationModel().bookAgain.bookAgainFlow||d.pageName==n.step4PageName||d.pageName==n.step4PayLaterPageName?d._reviewCall():angular.isDefined(g.SKIP_STEP3_FLOW)&&angular.isDefined(b.bundle)&&"true"===g.SKIP_STEP3_FLOW[b.bundle[0].bundleType]?"INBOUND_ALL"!==b.bundle[0].bundleType&&"INBOUND_BASIC"!==b.bundle[0].bundleType||!ABG.arrayHasObject(a.reservationSummary.rateSummary.rateCode.toLowerCase(),n.EnableStep3RateCode)?d._reviewCall():y.go(n.step3PageName,{},{reload:!0}):y.go(n.step3PageName,
{},{reload:!0}),angular.isDefined(a.reservationSummary.previousRateShopList)&&D.setPreviousRateDetails(a.reservationSummary.previousRateShopList));else J.processResults(a,{})},function(a){v.requestInProgress=!1})};d.recognizedUserAmazonCall=function(a){D.logout().then(function(b){D.setLoginAuthenticate(!1);ia.remove("resModelDisplayControls");setTimeout(function(){D.redirectURLRules(a)},1)},function(a){v.requestInProgress=!1})};d.closeLMBModal=function(){$("#closeModal").modal("hide")};d.checkForTruckDomain=
function(){return brand!=n.brandName.BUDGETTRUCK||domain!=n.countryCodeAU.toLowerCase()&&domain!=n.countryCodeNZ.toLowerCase()?!0:!1};d.replayErrMsg=function(){if(null!==I.getStorageData("replayErrMsg")){var a=I.getStorageData("replayErrMsg");d.sessionErrMsg=a;I.deleteStorageData("replayErrMsg")}};d.sessionErrMsg="";d.checkModifyWithPrime=function(){if(!angular.equals(d.response,{}))return"modify"==d.response.webHeader.p13nDetailsMap.reservationFlow&&"Y"==d.response.reservationSummary.partnerRewardInfoDetails.rewardFulfillType?
!0:!1};d.step2PartnerDiscountMessage=Dictionary.I18n.get("msg.res.awdSavings");d.amazonImagePath=g.imagePath;d.aarpImagePath=g.aarpImagePath;d.exclusiveMemberRateImagePath=g.exclusiveMemberRateImagePath;d.enableMemberBenefits=g.enableMemberBenefits;var P=!1,aa=!1;d.partnerEmailRequired=!1;d.getLoginModalWindow=function(){v.$broadcast("LoginActivity",{requestType:"Login"})};d.enableMemberBenefits=g.enableMemberBenefits;d._awdValidator=function(){};F=F("VehicleListExnController",{$scope:q});angular.extend(this,
F);v.mapModalPath="";v.keyDropPath="";v.$on("couponAndawd",function(a,b){ca(b.awdno,b.coupon)});v.$on("applyToastDiscount",function(a,b){v.discountApplied||(angular.isDefined(b.awdno)&&!angular.isDefined(b.coupon)?d.reservationModel.coupon.discountNumber=b.awdno:angular.isDefined(b.coupon)&&!angular.isDefined(b.awdno)?d.reservationModel.coupon.couponNumber=b.coupon:angular.isDefined(b.awdno)&&angular.isDefined(b.coupon)&&(d.reservationModel.coupon.discountNumber=b.awdno,d.reservationModel.coupon.couponNumber=
b.coupon),v.discountApplied=!0,ba())});d._processVehiclesPage();v.$on("learnwhyerror",function(a,b){a=d._awdValidator();b=w.learnWhyErrorMsg(d,b,a);d.title=b.title;d.errorMsg=b.errorMsg;d.reason=b.reason;jQuery(".generic-err-modal").modal("show")});v.$on("LocationControllerLoaded",function(a,b){"VEHICLETYPE"===ea&&d._resolveLocation()});$("body").on("shown.bs.modal",".modal.policies_Modal",function(a){d.getPrepayTnCs()});v.$on("searchLocation.response",function(a,b){d._searchLocationResponseHandler(a,
b)});var Y=function(){jQuery(".modal.mapModal").modal("hide");$(".modal.mapModal").on("hidden.bs.modal",function(){v.mapModalPath=""})};jQuery(document).ready(function(){d.pageName==n.step2PageName&&H.addGTMScript();B(function(){jQuery(".callout-description span").append('\x3cdiv class\x3d"campaign-triangle"\x3e\x3c/div\x3e')},4E3)});v.$on("Partner.partnerInfo",function(a,b){angular.isDefined(b)&&(d.amazonUserStatus=D.amazonLoginStatus())});$(document).on("scroll resize",function(){if(0<jQuery(".choice-section .featuredcar img[lazyLoaded]").length){var a=
jQuery(".choice-section")[0].offsetHeight;angular.isDefined(jQuery(".choice-section")[1])&&jQuery(".choice-section")[1].offsetHeight>a?a=jQuery(".choice-section")[1].offsetHeight:angular.isDefined(jQuery(".choice-section")[2])&&jQuery(".choice-section")[2].offsetHeight>a&&(a=jQuery(".choice-section")[2].offsetHeight);angular.isDefined(jQuery(".choice-section")[0])&&(jQuery(".choice-section")[0].style.height=a.toString()+"px");angular.isDefined(jQuery(".choice-section")[1])&&(jQuery(".choice-section")[1].style.height=
a.toString()+"px");angular.isDefined(jQuery(".choice-section")[2])&&(jQuery(".choice-section")[2].style.height=a.toString()+"px")}})}angular.module("carRental").controller("VehicleListController",t);t.$inject="$q $scope $sce $rootScope recommendedDataService $state $window $filter $validation $timeout $controller optionalService vehicleService getDataService couponService carRentalConstant reservationModelService storageService gaService $compile merchandisingService authenticationService geoservices utilityService reviewService bridgeService ModalService datePickerInit getVehicles locationTermsConditionsService getCampaignDataService $cookies".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C,A,B,F,E){function w(l,p){7<l.length&&(l=l.substring(0,5)+l.substring(6));return""!=x&&""!=x.coupon&&""!=x.coupon.discountNumber?x.coupon.discountNumber!=l&&p==g.buttonTextRedeem||x.coupon.discountNumber===l&&p==g.buttonTextApplied?!0:!1:p==g.buttonTextRedeem?!0:!1}function z(l,p){return""!=x&&""!=x.coupon&&""!=x.coupon.couponNumber?!0:p==g.buttonTextRedeem?!0:!1}this.checkBannerCoupon=this.checkBannerAWD=w;this.checkBannerAwdCoupon=function(g,l,p){if(""!==g&&
""!==l)return w(g,p)&&z(l,p);if(""!==g)return w(g,p);if(""!==l)return z(l,p)};this.showHide=function(g){7<g.length&&(g=g.substring(0,5)+g.substring(6));return""!=x&&""!=x.coupon&&(""!=x.coupon.discountNumber&&x.coupon.discountNumber===g||""==x.coupon.discountNumber&&"create"===x.displayControls.reservation)?!0:!1};this.promoCampaign=function(l){p.requestInProgress=!0;l=v("uppercase")(l);if(q.current.name===g.confirmationPage)E.productUpsellOneClickModify(l).then(function(m){if(angular.isDefined(m.fieldErrors)&&
0<m.fieldErrors.length||angular.isDefined(m.errorList)&&0<m.errorList.length)t.$parent.processErrorMessage(m);else{if(angular.isDefined(m.webHeader)&&angular.isDefined(m.webHeader.viewIndicator)&&"7"!=m.webHeader.viewIndicator)t.$parent.vm.productUpsellError=!0;else{if(angular.isDefined(m.reservationSummary)&&angular.isDefined(m.reservationSummary.rateSummary)){x.selectedProducts=[];for(var f=0;f<m.reservationSummary.rateSummary.selectedProducts.length;f++)x.selectedProducts.push(m.reservationSummary.rateSummary.selectedProducts[f])}for(f=
0;f<x.selectedProducts.length;f++)if(x.selectedProducts[f].code===v("uppercase")(l)){x.selectedProducts[f].isCampaignBased=!0;A.setReservationModel(x);break}}q.go(g.confirmationPage,{},{reload:!0})}});else{for(var n=A.getStorageData("productList"),w,u=0;u<n.length;u++)if(n[u].code===l){w=n[u];w.selected=!0;w.productId+="chk";w.quantity=1;break}x.selectedProducts.push(w);A.setReservationModel(x);B.recalculate("true").then(function(m){if(angular.isDefined(m.fieldErrors)&&0<m.fieldErrors.length||angular.isDefined(m.errorList)&&
0<m.errorList.length)t.$parent.processErrorMessage(m);else{for(var f=0;f<x.selectedProducts.length;f++)if(x.selectedProducts[f].code===v("uppercase")(l)){x.selectedProducts[f].isCampaignBased=!0;A.setReservationModel(x);break}q.current.name===g.step3PageName?q.go(g.step3PageName,{},{reload:!0}):q.current.name===g.step4PageName?(F.addToReviewData(m),q.go(g.step4PageName,{},{reload:!0})):q.current.name===g.step4PayLaterPageName&&(F.addToReviewData(m),q.go(g.step4PayLaterPageName,{},{reload:!0}))}},
function(g){p.requestInProgress=!1})}};var x=A.getReservationModel();this.domain=l.domain.toUpperCase();this.CouponAndAwd=function(g,l){var n={};n.awdno=g;n.coupon=l;p.$emit("couponAndawd",n)};l=C("CampaignExnController",{$scope:t});angular.extend(this,l)}angular.module("carRental").controller("CampaignController",t);t.$inject="$scope $state $window $filter $rootScope $validation carRentalConstant $controller reservationModelService optionalService getDataService confirmationService".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C){var x=this;x.pageName=v.current.name;x.response={};var B,F;x._loadVehicleFeatures=function(){B=C.getReservationModel();angular.isUndefined(B)&&(B=C.bookingModel,B.bookAgain.bookAgainFlow=!0);C.setReservationModel(B);F=y.getRebookVehicleData();F.then(function(g){x.response=g;B.pickInfo=x.response.reservationSummary.pickLoc.locationCode;B.dropInfo=x.response.reservationSummary.dropLoc.locationCode;B.coupon.discountNumber=x.response.reservationSummary.awdNumber;
C.setReservationModel(B)},function(g){})};x.vehicleInfo=function(l){y.vehicleInfo(l,p.deviceType,g)};x._loadVehicleFeatures()}angular.module("carRental").controller("BookAgainController",t);t.$inject="$controller $sce $scope $state $rootScope vehicleService carRentalConstant reservationModelService".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C,A,B,F,E,w,z,G,n,H,I,u,m){function f(){q.requestInProgress=!0;E.submitCheckinForm(e.reservationModel,e.preCheckData.reservationSummary.confirmationNumber).then(function(f){q.requestInProgress=!1;if(angular.isDefined(f)){if(angular.isDefined(f.fieldErrors)&&0<f.fieldErrors.length){var m=[],b;angular.forEach(f.fieldErrors,function(e,f){b={message:l.displayServiceError(e.field,e.classifier)}});1<f.fieldErrors.length&&(b={message:Dictionary.I18n.get("err.res.mutliplemsg")});
m.push(b);e.errors=m;$(window).scrollTop(0);document.getElementById("precheckout_submit_button").disabled=!1}else angular.isDefined(f.errorList)&&0<f.errorList.length&&(f=t.processErrorMessage(f),e.errors=f.errorList,q.requestInProgress=!1,document.getElementById("precheckout_submit_button").disabled=!1,$(window).scrollTop(0));u.preCheckInClickEvent("","","Pre-CheckInSucessful");v.location.pathname==h?v.location.href=q.contextPath+"/"+q.locale+"/contactless-rental/partner-precheckin-confirmation"+
htmlExtension:(e.preCheckData=f,e.reservationModel=B.getReservationModel(),g.go("/pre-checkin-confirmation"))}},function(f){q.requestInProgress=!1;document.getElementById("precheckout_submit_button").disabled=!1;angular.isDefined(f.errorList)&&0<f.errorList.length&&(f=t.processErrorMessage(f),e.errors=f.errorList,$(window).scrollTop(0))})}function x(f){e.preCheckFormValidation=!0;document.getElementById("precheckout_submit_button").disabled=!1;var h=f.errorCount;1===h?(e.preCheckPageError=H.trustAsHtml(f.MSG[0]),
angular.element(".ng-invalid").focus()):1<h&&(e.preCheckPageError=Dictionary.I18n.get("err.global.multi.errorMessage"),$(window).scrollTop(0))}q.requestInProgress=!0;var e=this,h=v.contextPath+"/"+v.locale+"/contactless-rental/partner-precheckin"+htmlExtension,r=v.contextPath+"/"+v.locale+"/contactless-rental/partner-precheckin-confirmation"+htmlExtension;e.preCheckFormValidation=!1;e.preCheckPageError="";e.errors=[];e.preCheckData={};e.countryList={};e.statesForCountry={};e.countryListForDriverLicense=
{};e.customer={};e.hideDLState=!1;e.accountModel={};e.reservationModel={};e.termsCondition={};e.prod={};e.domain=v.domain.toUpperCase();e.locationCodes=v.locationCodes;e.showMsg="false";e.resSelfCheckoutData={};e.pageInit=function(){g.current.name===A.preCheckoutForm||v.location.pathname==h?(F.addToConfirmationData({}),E.getData().then(function(f){e.preCheckData=e.prod=f;e.reservationModel=B.getReservationModel();e.resSelfCheckoutData=m.getStorageData("reservationModelSelfCheckOut");u.preCheckInClickEvent("Pre-CheckIn",
!0===e.reservationModel.prepayProcessIndicator?"PayNow":"PayLater","");e.populateCountryListForDriverLicense();e.populateBillingInfoCountryList();e.checkForPartnerCustomerInfo();e.loadCalendarDropdown();e.getStatesForCountry(e.reservationModel.paymentRq.address.country);angular.isDefined(e.preCheckData.customerInfo)&&angular.isDefined(e.preCheckData.customerInfo.dlSummary)&&!angular.equals({},e.preCheckData.customerInfo.dlSummary)?(e.reservationModel.dlSummary={},e.customer=e.preCheckData.customerInfo,
e.accountModel=n.getAccountData(e.customer),angular.merge(e.reservationModel.dlSummary,e.accountModel.dlSummary)):e.reservationModel.dlSummary={country:e.reservationModel.paymentRq.address.country};e.getStatesForDL(e.reservationModel.paymentRq.address.country,e.countryListForDriverLicense);angular.isDefined(e.reservationModel)&&angular.isDefined(e.reservationModel.paymentRq)&&angular.isDefined(e.reservationModel.paymentRq.address.address1)&&""!=e.reservationModel.paymentRq.address.address1&&e.reservationModel.prepayProcessIndicator&&
(e.disabledField.address=!0);angular.isDefined(e.reservationModel)&&angular.isDefined(e.reservationModel.dlSummary)&&angular.isDefined(e.reservationModel.dlSummary.dlNumber)&&""!=e.reservationModel.dlSummary.dlNumber&&(e.disabledField.driverLicense=!0)}),q.requestInProgress=!1):g.current.name===A.preCheckoutSuccess?(F.addToConfirmationData({}),q.requestInProgress=!0,E.getData().then(function(f){q.requestInProgress=!0;e.preCheckData=f;e.reservationModel=B.getReservationModel();e.comparelocationCode(e.locationCodes);
q.requestInProgress=!1})):v.location.pathname===r&&(E.getData().then(function(f){e.preCheckData=e.prod=f;f=angular.isUndefined(f.reservationSummary.iataNumber)?"":f.reservationSummary.iataNumber;u.trackScanOfPartnerPriceLineEvent(f)}),q.requestInProgress=!1);B.addGTMScript()};e.populateBillingInfoCountryList=function(){var f=v.countryOfResidence;e.countryList=angular.fromJson(f?f:{});e._setCORAsBillingCountry()};e.getStatesForCountry=function(f){if(e.countryList&&void 0!=f&&""!=f&&(f===A.countryCodeAU||
f===A.countryCodeCA||f===A.countryCodeUS)){var h=e.countryList.indexOf(p("filter")(e.countryList,function(b){return b.code===f})[0]);e.statesForCountry=e.countryList[h].stateList}e._displayFunction(f)};e.validatePhoneNumber=function(f){if(e.reservationModel.personalInfoRQ.smsOptIn)if(angular.isDefined(e.reservationModel.personalInfoRQ.phone)&&""!=e.reservationModel.personalInfoRQ.phone)if(angular.isDefined(e.reservationModel.personalInfoRQ.phone)&&l.validateField("vm.reservationModel.personalInfoRQ.phone",
!0,f)){if(angular.isDefined(e.preCheckData.reservationSummary)&&angular.isDefined(e.preCheckData.reservationSummary.personalInfo)&&angular.isDefined(e.preCheckData.reservationSummary.personalInfo.phoneNumbers))for(f=0;f<e.preCheckData.reservationSummary.personalInfo.phoneNumbers.length;f++)e.reservationModel.personalInfoRQ.phone==e.preCheckData.reservationSummary.personalInfo.phoneNumbers[f].phoneNumber&&(e.phoneMaskId=e.preCheckData.reservationSummary.personalInfo.phoneNumbers[f].maskId);E.phoneNumberValidation(e.reservationModel.personalInfoRQ.phone,
e.phoneMaskId).then(function(f){if(angular.isDefined(f.fieldErrors)&&0<f.fieldErrors.length)for(var b=0;b<f.fieldErrors.length;b++)"phoneNumber"==f.fieldErrors[b].fieldName&&l.displayServiceError("vm.reservationModel.personalInfoRQ.phone","uscan");else if(angular.isDefined(f.errorList)&&0<f.errorList.length)for(b=0;b<f.errorList.length;b++){var h=f.errorList[b];"ERROR"===h.type&&"700020"===h.code?(l.displayServiceError("vm.reservationModel.personalInfoRQ.phone","required",!0),e.reservationModel.personalInfoRQ.phone=
"",e.reservationModel.personalInfoRQ.smsOptIn=!1):"ERROR"===h.type&&"700022"===h.code?(l.displayServiceError("vm.reservationModel.personalInfoRQ.phone","maskedphonenumber",!0),e.reservationModel.personalInfoRQ.phone="",e.reservationModel.personalInfoRQ.smsOptIn=!1):"ERROR"===h.type&&"86"===h.code&&(l.displayServiceError("vm.reservationModel.personalInfoRQ.phone","uscan",!0),e.reservationModel.personalInfoRQ.phone="",e.reservationModel.personalInfoRQ.smsOptIn=!1)}})}else l.displayServiceError("vm.reservationModel.personalInfoRQ.phone",
"invalid",!0);else l.displayServiceError("vm.reservationModel.personalInfoRQ.phone","required",!0)};e.populateCountryListForDriverLicense=function(){e.countryListForDriverLicense=angular.element(document).injector().get("accountUtilityService").getCountryList(e.preCheckData,v.countryOfResidence);angular.isDefined(e.preCheckData)&&angular.isDefined(e.preCheckData.customerInfo)&&angular.isDefined(e.preCheckData.customerInfo.dlSummary)&&angular.isDefined(e.preCheckData.customerInfo.dlSummary.country)&&
(e.statesForDL=angular.element(document).injector().get("accountUtilityService").getStateListBasedOnCounty(e.preCheckData.customerInfo.dlSummary.country,e.countryListForDriverLicense).statesForDL);if(e.statesForDL&&angular.isDefined(e.preCheckData.partnerCustomerInfo)&&angular.isDefined(e.preCheckData.partnerCustomerInfo.dlSummary)&&angular.isDefined(e.preCheckData.partnerCustomerInfo.dlSummary.state)&&""!==e.preCheckData.customerInfo.dlSummary.state){var f=e.statesForDL.indexOf(p("filter")(e.statesForDL,
function(f){return f.stateCode.toUpperCase()===e.preCheckData.partnerCustomerInfo.dlSummary.state.toUpperCase()||f.stateName.toUpperCase()===e.preCheckData.partnerCustomerInfo.dlSummary.state.toUpperCase()})[0]);-1<f&&(e.disableDLState=!0,e.accountModel.dlSummary.state=e.statesForDL[f].stateCode)}e.countryListForDriverLicense&&angular.isDefined(e.preCheckData.customerInfo)&&angular.isDefined(e.preCheckData.customerInfo.dlSummary)&&angular.isDefined(e.preCheckData.customerInfo.dlSummary.dlNumber)&&
""!==e.preCheckData.customerInfo.dlSummary.dlNumber?e.showDOBField=!1:e.showDOBField=!0};e.getStatesForDL=function(f,h){f=angular.isDefined(h)&&0<h.length?angular.element(document).injector().get("accountUtilityService").getStateListBasedOnCounty(f,h):angular.element(document).injector().get("accountUtilityService").getStateListBasedOnCounty(f,e.countryList);e.statesForDL=f.statesForDL;e.hideDLState=angular.isUndefined(e.statesForDL)||"Not Applicable"==e.statesForDL[0].stateCode?!0:!1;1==e.hideDLState&&
(e.reservationModel.dlSummary.state="Not Applicable",angular.equals({},e.accountModel)||(e.accountModel.dlSummary.state="Not Applicable"));angular.isDefined(e.reservationModel.dlSummary)&&angular.isDefined(e.reservationModel.dlSummary.state)&&(""==e.reservationModel.dlSummary.state||"Not Applicable"==e.reservationModel.dlSummary.state&&!e.hideDLState)&&(e.reservationModel.dlSummary.state=null)};e.comparelocationCode=function(f){for(var h=0;h<f.length;h++)f[h].toUpperCase()===e.reservationModel.pickInfo&&
(e.showMsg="true")};e.loadHelpModal=function(f){e.country=v.country?v.countrySelect:"US";e.helpURL=z.getUrl(f.target.parentElement,country)};e._displayFunction=function(f){e.showCity=f==A.countryCodeCA||f==A.countryCodePR||f==A.countryCodeUS||f==A.countryCodeCX||f==A.countryCodeCV||f==A.countryCodeVI?!0:!1;e.showState=f==A.countryCodeAU||f==A.countryCodeCA||f==A.countryCodeUS||f==A.countryCodeNZ?!0:!1;e.showSuburb=f==A.countryCodeAU||f==A.countryCodeNZ?!0:!1;e.showZipcode=e.showSuburb||e.showCity?
!0:!1};e.submitForm=function(h){e.preCheckFormValidation=!1;e.preCheckPageError="";e.errors=[];document.getElementById("precheckout_submit_button").disabled=!0;l.validate(h).success(f).error(x)};e.loadCalendarDropdown=function(){var f=e.hasPartnerInfo?angular.isDefined(e.preCheckData.partnerCustomerInfo.minAge)?e.preCheckData.partnerCustomerInfo.minAge:A.ageLimit.lower:A.ageLimit.lower;f=angular.element(document).injector().get("accountUtilityService").loadCalendarDropdown(f);e.monthsList=f.monthsList;
e.yearsList=f.yearsList;e.datesList=f.datesList;if(angular.isDefined(e.preCheckData.customerInfo)&&angular.isDefined(e.preCheckData.customerInfo.dlSummary)&&angular.isUndefined(e.preCheckData.customerInfo.dlSummary.dlNumber)&&angular.isDefined(e.preCheckData.partnerCustomerInfo)&&angular.isDefined(e.preCheckData.partnerCustomerInfo.dob)&&angular.isDefined(e.monthsList)&&""!=e.monthsList&&0<e.monthsList.length&&angular.isDefined(e.accountModel)){var h=e.preCheckData.customerInfo.dob.split("/");f=e.monthsList.indexOf(p("filter")(e.monthsList,
function(b){return b.key==h[0]})[0]);angular.isDefined(f)&&-1!=f&&(e.reservationModel.dobMonth=e.monthsList[f].key);e.reservationModel.dobDate=h[1];e.reservationModel.dobYear=h[2]}};e.checkForPartnerCustomerInfo=function(){angular.isDefined(e.preCheckData)&&angular.isDefined(e.preCheckData.partnerCustomerInfo)&&!angular.equals({},e.preCheckData.partnerCustomerInfo)?e.hasPartnerInfo=!0:e.hasPartnerInfo=!1};e.loadTermsAndCondition=function(){q.requestInProgress=!0;var f=I.getTermsConditionModel(e.reservationModel);
I.getSmsTermsAndCondition(f).then(function(f){e.termsCondition=f;$(".reservation-flow-sms .modal-body").scrollTop(0);q.requestInProgress=!1},function(){e.termsCondition={};q.requestInProgress=!1})};e._validationSuccess=f;e._validationError=x;e._setCORAsBillingCountry=function(){e.customer=G.getCustomerModel();var f="";f=e.customer&&"PARTNER_AUTHENTICATED"!=e.customer.userState?e.customer.cor:e.reservationModel&&e.reservationModel.paymentRq&&e.reservationModel.paymentRq.address&&e.reservationModel.paymentRq.address.country&&
""!=e.reservationModel.paymentRq.address.country?e.reservationModel.paymentRq.address.country:e.reservationModel&&e.reservationModel.personalInfoRQ&&e.reservationModel.personalInfoRQ.residency&&""!==e.reservationModel.personalInfoRQ.residency?e.reservationModel.personalInfoRQ.residency:"US";var h=e.countryList.indexOf(p("filter")(e.countryList,function(b){return b.code===f})[0]);e.reservationModel.paymentRq.address.country=e.countryList[h].code};e.disabledField={address:!1,driverLicense:!1,DOB:!1,
phone:!1,optIn:!1};y("ExceptionHandlerController",{$scope:t});e.pageInit()}angular.module("reservation").controller("PreCheckinController",t);t.$inject="$scope $rootScope $validation $window $filter $controller $state $stateParams carRentalConstant reservationModelService getDataService preCheckinService $timeout getVehicles authenticationService myProfileService $sce reviewService gaService storageService".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C,A,B,F,E,w){var x=this;x.emailErrmsg=!1;x.showSuccessCon=!1;x.errorList=[];t=window.location.origin+window.location.pathname;x.hostNameSuccess=t+"#/?flag\x3dSUCCESS";x.hostNameFailure=t+"#/?flag\x3dFAILURE";x.signUpSubmit=function(g){A.validate(g).success(x._validationSuccess).error(x._validationFailure)};x._validationSuccess=function(){q.requestInProgress=!0;E.submitFreeDays(x.pageLoad).then(function(g){q.requestInProgress=!1;g.errorList?(x.emailErrmsg=!0,x.emailSignFormError=
1<g.errorList.length?Dictionary.I18n.get("err.res.mutliplemsg"):g.errorList[0].message,w.scrollTo("earnSignform")):document.earnSignform.submit()},function(g){q.requestInProgress=!1;x.emailErrmsg=!0;x.emailSignFormError=Dictionary.I18n.get("err.res.mutliplemsg");w.scrollTo("earnSignform")})};x._validationFailure=function(g){x.emailErrmsg=!0;x.emailSignFormError=Dictionary.I18n.get("err.res.mutliplemsg");w.scrollTo("earnSignform")};(function(){var g=B.search();g.flag&&("SUCCESS"===g.flag?(x.showSuccessCon=
!0,$(window).scrollTop(0)):"FAILURE"===g.flag&&(x.emailErrmsg=!0,x.emailSignFormError=Dictionary.I18n.get("msg.earnsignup.failure"),p(function(){w.scrollTo("earnSignform")},1E3)))})()}angular.module("carRental").controller("EarnCntrl",t);t.$inject="$scope $rootScope $window $controller $timeout carRentalConstant getVehicles language $validation $location $state utilityService anchorSmoothScroll".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C,A,B,F,E,w,z,G,n,H,I){C("ExceptionHandlerController",{$scope:q});var u=this;u.travelInfoSubmit=function(g){u.travelAgentBookingError=0;A.validate(g).success(u._validationSuccess).error(u._validationError)};u.travelAgentBookingError=[];u._validationSuccess=function(g){F.load(u.pageLoad).then(function(f){u.prod=q.processErrorMessage(f);u.prod.errorList||(y.location.href=v.contextPath+"/"+v.locale+"/reservation"+htmlExtension+"#/time-and-place")})};u._validationError=
function(g){0<g.errorCount&&(u.travelAgentBookingError=g.MSG)};u.pageLoad=F.travelAgent}angular.module("carRental").controller("travelAgentController",t);t.$inject="$q $scope $sce $rootScope $state $window $filter $controller $validation $timeout travelAgentService couponService carRentalConstant brandConstant reservationModelService gaService $compile utilityService".split(" ")})();
(function(){angular.module("reservation").directive("creditCardType",["$rootScope",function(t){return{require:"ngModel",link:function(x,q,l,v){function p(g,l){for(var p=0;p<g.length;p++)for(var q=0;q<l.length;q++)g[p].name==l[q]&&g.splice(p,1);return g}function y(l){if(8>=l.length||B){if(4>=l.length||B)B=!1,x.cardImgList=[],/^(5[1-5]|2[2-7])/.test(l)&&(A?x.vm.reservationModel.expiredPaymentRq.cardType="CM":x.vm.reservationModel.paymentRq.cardType="CM",x.cardImgList.push({name:"master",seq:2})),/^4/.test(l)&&
(A?x.vm.reservationModel.expiredPaymentRq.cardType="CX":x.vm.reservationModel.paymentRq.cardType="CX",x.cardImgList.push({name:"visa",seq:1})),/^3[47]/.test(l)&&(A?x.vm.reservationModel.expiredPaymentRq.cardType="CA":x.vm.reservationModel.paymentRq.cardType="CA",x.cardImgList.push({name:"american",seq:4}));/^62([4-6]|8[2-8]|2(1(2[6-9]|[3-9]\d)|[2-8]\d{2}|9([01]\d|2[0-5])))/.test(l)&&0===x.cardImgList.length&&(x.cardImgList=[],A?x.vm.reservationModel.expiredPaymentRq.cardType="CS":x.vm.reservationModel.paymentRq.cardType=
"CS",x.cardImgList.push({name:"unionPay",seq:5}));/^6(011|5061[1-9]|5060[1-9]|5[2-9]\d{2}|4[4-9])/.test(l)&&0===x.cardImgList.length&&(x.cardImgList=[],A?x.vm.reservationModel.expiredPaymentRq.cardType="CS":x.vm.reservationModel.paymentRq.cardType="CS",x.cardImgList.push({name:"discover",seq:3}));if("us"==window.domain||"ca"==window.domain)/^(1800|35|2131)/.test(l)&&0===x.cardImgList.length&&(x.cardImgList=[],A?x.vm.reservationModel.expiredPaymentRq.cardType="CJ":x.vm.reservationModel.paymentRq.cardType=
"CJ",x.cardImgList.push({name:"jcb",seq:6})),/^(30|36|3[8-9])/.test(l)&&0===x.cardImgList.length&&(x.cardImgList=[],A?x.vm.reservationModel.expiredPaymentRq.cardType="CD":x.vm.reservationModel.paymentRq.cardType="CD",x.cardImgList.push({name:"diner",seq:7}));void 0!==l&&""!==l||angular.copy(g,x.cardImgList)}if(16===l.length){var p={414720:"Visa-Signature Card|Chase",546616:"MC-World Card|Citibank",517805:"MC-Platinum|Capital One",542418:"MC-Platinum|Citibank",440066:"Visa-Traditional Card|Bank of America",
438857:"Visa-Traditional Card|Chase",414709:"Visa-Traditional Card|Capital One",426684:"Visa-Traditional Card|Chase",427082:"Visa-Traditional|USAA",601100:"Discover-Consumer Credit Reward|N/A"};angular.element("#cardCategory").length&&angular.element("#cardCategory").val(p[l.substring(0,6)]||"")}else 16>l.length&&angular.element("#cardCategory").length&&angular.element("#cardCategory").val("");return l}var g=[{name:"master",seq:2,cardType:"CM"},{name:"visa",seq:1,cardType:"CX"},{name:"american",seq:4,
cardType:"CA"},{name:"discover",seq:3,cardType:"CS"},{name:"unionPay",seq:5,cardType:"CS"},{name:"jcb",seq:6,cardType:"CJ"},{name:"diner",seq:7,cardType:"CD"}],C="",A=l.expired,B=!1;t.$on("setReviewCreditCard",function(l,q){switch(domain.toUpperCase()+"-"+q.rentalLocation.toUpperCase()){case "US-US":case "US-CA":case "CA-US":case "CA-CA":l=g;break;case "AU-US":case "AU-CA":case "NZ-US":case "NZ-CA":l=p(g,["jcb","diner"]);break;case "US-AU":case "US-NZ":case "CA-AU":case "CA-NZ":case "AU-AU":case "AU-NZ":case "NZ-AU":case "NZ-NZ":l=
p(g,["discover","unionPay","jcb","diner"]);break;default:l=p(g,["jcb"])}if(q.restrictedCards){v.$parsers.unshift(y);C=q.restrictedCards;for(q=g.length;q--;)C!=g[q].cardType&&g.splice(q,1);x.cardImgList=g}else x.cardImgList=l,""==C?v.$parsers.unshift(y):A?x.vm.reservationModel.expiredPaymentRq.cardType=C:x.vm.reservationModel.paymentRq.cardType=C});q.on("paste change",function(){setTimeout(function(){B=!0;""==C&&y(q.val());x.$apply()},5)})}}}])})();
angular.module("reservation").directive("checklistModel",["$parse","$compile",function(t,x){function q(l,p,q){if(angular.isArray(l))for(var g=l.length;g--;)if(q(l[g],p))return!0;return!1}function l(l,p,y){function g(g,n){var p=B(l.$parent);if(angular.isFunction(F))if(!0===n){n=l.$parent;var m=G;p=angular.isArray(p)?p:[];q(p,g,m)||p.push(g);F(n,p)}else{n=l.$parent;m=G;if(angular.isArray(p))for(var f=p.length;f--;)if(m(p[f],g)){p.splice(f,1);break}F(n,p)}}function v(n,p){w&&!1===w(l)?g(z,l[y.ngModel]):
l[y.ngModel]=q(n,z,G)}var A=y.checklistModel;y.$set("checklistModel",null);x(p)(l);y.$set("checklistModel",A);var B=t(A),F=B.assign,E=t(y.checklistChange),w=t(y.checklistBeforeChange),z=y.checklistValue?t(y.checklistValue)(l.$parent):y.value,G=angular.equals;if(y.hasOwnProperty("checklistComparator"))if("."==y.checklistComparator[0]){var n=y.checklistComparator.substring(1);G=function(g,l){return g[n]===l[n]}}else G=t(y.checklistComparator)(l.$parent);l.$watch(y.ngModel,function(n,p){n!==p&&(w&&!1===
w(l)?l[y.ngModel]=q(B(l.$parent),z,G):(g(z,n),E&&E(l)))});angular.isFunction(l.$parent.$watchCollection)?l.$parent.$watchCollection(A,v):l.$parent.$watch(A,v,!0)}return{restrict:"A",priority:1E3,terminal:!0,scope:!0,compile:function(q,p){p.ngModel||p.$set("ngModel","checked");return l}}}]);
angular.module("reservation").directive("carImg",function(){return{restrict:"E",scope:{imgheight:"@",imgwidth:"@",imgpath:"@"},controller:["$scope",function(t){t.customCarImagePath=function(){var x;-1!=t.imgpath.indexOf("-black.")?x=t.imgpath.replace("-black.","-white."):-1!=t.imgpath.indexOf("-red.")?x=t.imgpath.replace("-red.","-white."):-1!=t.imgpath.indexOf("-silver.")&&(x=t.imgpath.replace("-silver.","-white."));return x+"/jcr:content/renditions/cq5dam.thumbnail."+t.imgheight+"."+t.imgwidth+
".png"}}],compile:function(t,x){x.imgheight||(x.imgheight="151");x.imgwidth||(x.imgwidth="100")},template:'\x3cimg ng-src\x3d"{{customCarImagePath()}}" alt\x3d"Small to Full Size" ng-cloak\x3e'}});
(function(){function t(t,q,l,v,p,y,g,C,A,B,F,E,w,z,G){function n(e,f){var g=new Date,h="";if(f==B.brandName.AVIS)f="PM"==e.PICKUP_AM_PM?parseInt(e.PICKUP_HOUR,10)+12:e.PICKUP_HOUR,e.PICKUP_YEAR=angular.isDefined(e.PICKUP_YEAR)?e.PICKUP_YEAR:g.getFullYear(),h=new Date(e.PICKUP_YEAR,e.PICKUP_MONTH,e.PICKUP_DAY,f,e.PICKUP_MINUTE);else if(f==B.brandName.BUDGET){f=angular.isDefined(e.PICKUP_TIME)?e.PICKUP_TIME.slice(0,2):angular.isDefined(e.PICKUP_HOUR)?e.PICKUP_HOUR.slice(0,2):"";var b=angular.isDefined(e.PICKUP_TIME)?
e.PICKUP_TIME.slice(2,4):angular.isDefined(e.PICKUP_HOUR)?e.PICKUP_HOUR.slice(2,4):"";""!=f&&""!=b&&(h=new Date(e.PICKUP_MONTH_YEAR.slice(0,4),parseInt(e.PICKUP_MONTH_YEAR.slice(4,6))-1,e.PICKUP_DATE,f,b))}else f==B.brandName.PAYLESS&&(h=new Date(e.PICKUP_YEAR,e.PICKUP_MONTH,e.PICKUP_DAY,e.PICKUP_HOUR,e.PICKUP_MINUTE));g>h&&""!=h&&(e=new Date,g=new Date,e.setDate(e.getDate()+1),g.setDate(g.getDate()+2),brand==B.brandName.AVIS?(m.PICKUP_DAY=String(e.getDate()),m.PICKUP_MONTH=String(e.getMonth()),m.PICKUP_YEAR=
String(e.getFullYear()),m.RETURN_DAY=String(g.getDate()),m.RETURN_MONTH=String(g.getMonth()),m.RETURN_YEAR=String(g.getFullYear())):brand==B.brandName.BUDGET?(e.setMonth(e.getMonth()+1),m.PICKUP_DATE=String(e.getDate()),h=1==String(e.getMonth()).length?"0"+String(e.getMonth()):String(e.getMonth()),m.PICKUP_MONTH_YEAR=String(e.getFullYear())+h,m.DROPOFF_DATE=String(g.getDate()),h=1==String(g.getMonth()+1).length?"0"+String(g.getMonth()+1):String(g.getMonth()+1),m.DROPOFF_MONTH_YEAR=String(g.getFullYear())+
h):brand==B.brandName.PAYLESS&&(m.PICKUP_DAY=String(e.getDate()),m.PICKUP_MONTH=String(e.getMonth()),m.PICKUP_YEAR=String(e.getFullYear()),m.DROPOFF_DAY=String(g.getDate()),m.DROPOFF_MONTH=String(g.getMonth()),m.DROPOFF_YEAR=String(g.getFullYear())))}var x=this;x.processBridge=!0;var I={},u={};x._init=function(){m=p.search();if(brand==B.brandName.PAYLESS){angular.isDefined(m.pl)&&(m.PICKUP_LOCATION_CODE=m.pl,delete m.pl);angular.isDefined(m.age)&&(m.AGE=m.age,delete m.age);angular.isDefined(m.cor)&&
(m.COUNTRY=m.cor,delete m.cor);if(angular.isDefined(m.pd)){var h=D.exec(m.pd);m.PICKUP_MONTH=h[1];m.PICKUP_DAY=h[2];m.PICKUP_YEAR=h[3];delete m.pd}angular.isDefined(m.rd)&&(h=D.exec(m.rd),m.DROPOFF_MONTH=h[1],m.DROPOFF_DAY=h[2],m.DROPOFF_YEAR=h[3],delete m.rd);angular.isDefined(m.pt)&&(h=e.exec(m.pt),m.PICKUP_HOUR=h[1],m.PICKUP_MINUTE=h[2],delete m.pt);angular.isDefined(m.rt)&&(h=e.exec(m.rt),m.DROPOFF_HOUR=h[1],m.DROPOFF_MINUTE=h[2],delete m.rt)}if(!(null==m||"resForm.confirmationNumber"in m||"resForm.lastName.value"in
m)){for(var l in m)m.hasOwnProperty(l)&&(f[l.toUpperCase()]=m[l]);m=f}null!=m&&n(m,brand);if(A.getXsrfToken()||A.getSessionModel())x.processBridge=!1,angular.isDefined(m)&&angular.isDefined(m["resForm.confirmationNumber"])&&angular.isDefined(m["resForm.lastName.value"])?x._oneClickModify(m):C.processBridgeFlow(m);q.$on("initSuccess",function(e,f){x.processBridge&&(angular.isDefined(m)&&angular.isDefined(m["resForm.confirmationNumber"])&&angular.isDefined(m["resForm.lastName.value"])?x._oneClickModify(m):
C.processBridgeFlow(m))});g.addGTMScript()};x._oneClickModify=function(e){var f="";I=angular.copy(g.bookingModel);for(var h in e)if("resForm.confirmationNumber"!=h&&"resForm.lastName.value"!=h&&(h.match("accept")||h.match("list"))){h.match("accept")&&(f=h.split("_")[1]);I.confirmationNumber=e["resForm.confirmationNumber"];I.personalInfoRQ.lastName=e["resForm.lastName.value"];""!=f&&I.selectedProducts.push(f);if(angular.isDefined(e["product.list"])||angular.isDefined(e["insurance.list"]))I.productList=
e["product.list"],I.insuranceList=e["insurance.list"];u={confirmationNumber:e["resForm.confirmationNumber"],lastName:e["resForm.lastName.value"]};E.setStorageData("oneClickURLCode",f);g.setReservationModel(I);g.setLookUpModel(u)}C.processConfirmationpage(f,e)};var m={},f={},D=/(\d{1,2})\/(\d{1,2})\/(\d{4})/,e=/(\d{1,2})(\d{1,2})/;t=v("BridgeExnController",{$scope:t});angular.extend(this,t);x._init()}angular.module("reservation").controller("BridgeController",t);t.$inject="$scope $rootScope $state $controller $location $window reservationModelService bridgeService authenticationService carRentalConstant getDataService storageService vehicleService confirmationService reviewService".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C,A,B){var x=l.email,E=l.partnerId,w={customerServiceEmail:"",customerTitle:"",companyAbn:"",suburb:"",fax:"",wizardNumber:"",amtForHiringVehicle:"",carRentalPerMonth:"",vehicleType:"",specialOffers:"N",gstRegistered:"",requirements:"",formName:"",firstName:"",lastName:"",title:"",userEmail:"",retypeUserEmail:"",companyName:"",subscription:"Y",partnerID:E,empTrvlFirstName:"",empTrvlLastName:"",trvlAgentEmailAddress:"",retypeTrvlAgentEmailAddress:"",arcIataNo:"",
clubRedNum:"",trvlAgentName:"",trvlAgentPhone:"",trvlAgentTitle:"",worldWideId:"",rentalNumber:"",partnerType:l.pageType,location:"",address1:"",address2:"",city:"",state:"",country:"",zip:"",phone:"",agentAddress1:"",agentAddress2:"",agentCity:"",agentState:"",agentZipCode:"",agentCountry:"",rqHeader:{locale:internalLocale}},z={customerServiceEmail:"vm.pageLoad.email",customerTitle:"vm.pageLoad.customerTitle",companyAbn:"vm.pageLoad.companyAbn",suburb:"vm.pageLoad.suburb",gstRegistered:"vm.pageLoad.gstRegistered",
requirements:"vm.pageLoad.requirements",fax:"vm.pageLoad.fax",wizardNumber:"vm.pageLoad.wizardNumber",amtForHiringVehicle:"vm.pageLoad.amtForHiringVehicle",carRentalPerMonth:"vm.pageLoad.carRentalPerMonth",vehicleType:"vm.pageLoad.vehicleType",specialOffers:"vm.pageLoad.specialOffers",formName:"vm.pageLoad.formName",firstName:"vm.pageLoad.firstName",lastName:"vm.pageLoad.lastName",title:"vm.pageLoad.title",userEmail:"vm.pageLoad.userEmail",retypeUserEmail:"vm.pageLoad.retypeUserEmail",companyName:"vm.pageLoad.companyName",
partnerID:"vm.pageLoad.partnerID",empTrvlFirstName:"vm.pageLoad.empTrvlFirstName",empTrvlLastName:"vm.pageLoad.empTrvlLastName",trvlAgentEmailAddress:"vm.pageLoad.trvlAgentEmailAddress",retypeTrvlAgentEmailAddress:"vm.pageLoad.retypeTrvlAgentEmailAddress",arcIataNo:"vm.pageLoad.arcIataNo",clubRedNum:"vm.pageLoad.clubRedNum",trvlAgentName:"vm.pageLoad.trvlAgentName",trvlAgentPhone:"vm.pageLoad.trvlAgentPhone",trvlAgentTitle:"vm.pageLoad.trvlAgentTitle",worldWideId:"vm.pageLoad.worldWideId",rentalNumber:"vm.pageLoad.rentalNumber",
partnerType:"vm.pageLoad.partnerType",address1:"vm.pageLoad.address1",address2:"vm.pageLoad.address2",location:"vm.pageLoad.location",city:"vm.pageLoad.city",state:"vm.pageLoad.state",country:"vm.pageLoad.country",zip:"vm.pageLoad.zip",phone:"vm.pageLoad.phone",agentAddress1:"vm.pageLoad.agentAddress1",agentAddress2:"vm.pageLoad.agentAddress2",agentCity:"vm.pageLoad.agentCity",agentState:"vm.pageLoad.agentState",agentZipCode:"vm.pageLoad.agentZipCode",agentCountry:"vm.pageLoad.agentCountry"};return{getModel:function(){var p=
g.getStorageData("smallBiz");p=angular.isDefined(p)?p:w;if("au"==l.domain||"nz"==l.domain)p.gstRegistered="Y",p.specialOffers="Y",p.customerServiceEmail=angular.isDefined(x)?x:"",p.carRentalPerMonth=B.smallBiz.carRentalPerMonth,p.amtForHiringVehicle=B.smallBiz.amtForHiringVehicle,p.customerTitle=B.smallBiz.customerTitle,p.rqHeader={locale:angular.isDefined(internalLocale)?internalLocale:""};return p},setModel:function(l){g.setStorageData("smallBiz",l)},load:function(g,l){var n=new FormData;n.append("userdata",
new Blob([angular.toJson(g)],{type:"application/json"}));if("us"==l||"ca"==l){var p=apiurl+"/businessprogram/template/"+E+"/123/en_US",u=q.defer();t({method:"GET",url:p,data:g}).then(function(g){g=g.data;g.templateSummary&&g.templateSummary.errorMsg?(g=C.processError(g,z),u.resolve(g)):(p=apiurl+"/customerservice/feedback",t({method:"POST",url:p,data:n}).then(function(f){f=f.data;f=C.processError(f,z);u.resolve(f)}).catch(function(f){u.reject(f.data)}))}).catch(function(g){u.reject(g.data)})}else u=
q.defer(),p=apiurl+"/customerservice/feedback",t({method:"POST",url:p,data:n}).then(function(g){g=g.data;g=C.processError(g,z);u.resolve(g)}).catch(function(g){u.reject(g.data)});return u.promise},getSmallBizAnnualSpend:function(){return{"Annual Spend1":Dictionary.I18n.get("lbl.smallBiz.AnnualSpend1"),"Annual Spend2":Dictionary.I18n.get("lbl.smallBiz.AnnualSpend2"),"Annual Spend3":Dictionary.I18n.get("lbl.smallBiz.AnnualSpend3"),"Annual Spend4":Dictionary.I18n.get("lbl.smallBiz.AnnualSpend4")}},getSmallBizNumberOfCarRentals:function(){return{"Approx Rental1":Dictionary.I18n.get("lbl.smallBiz.aproxRentals1"),
"Approx Rental2":Dictionary.I18n.get("lbl.smallBiz.aproxRentals2"),"Approx Rental3":Dictionary.I18n.get("lbl.smallBiz.aproxRentals3"),"Approx Rental4":Dictionary.I18n.get("lbl.smallBiz.aproxRentals4"),"Approx Rental5":Dictionary.I18n.get("lbl.smallBiz.aproxRentals5")}},getSmallBizTypeOfVehicle:function(){return{Passenger:Dictionary.I18n.get("lbl.smallBiz.passengerVehicle"),Commercial:Dictionary.I18n.get("lbl.smallBiz.commercialVehicle")}}}}angular.module("reservationServices").service("smallbizService",
t);t.$inject="$http $q $window $filter $timeout $rootScope storageService exceptionHandler reservationModelService carRentalConstant".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C,A,B,F,E,w,z,G,n,H,I,u,m,f,D,e){function h(){r.pageLoad=F.getModel();r.reservationModel=n.getReservationModel();angular.isDefined(r.reservationModel)&&angular.isDefined(r.reservationModel.personalInfoRQ)&&(angular.isDefined(r.reservationModel.personalInfoRQ)&&"US"===r.reservationModel.personalInfoRQ.residency?r.pageLoad.subscription="Y":angular.isDefined(r.reservationModel.personalInfoRQ)&&"CA"===r.reservationModel.personalInfoRQ.residency&&(r.pageLoad.subscription=
"N"),r.pageLoad.firstName=r.reservationModel.personalInfoRQ.firstName,r.pageLoad.lastName=r.reservationModel.personalInfoRQ.lastName,r.pageLoad.phone=r.reservationModel.personalInfoRQ.phone,r.pageLoad.userEmail=r.reservationModel.personalInfoRQ.email);if("AU"==r.domain.toUpperCase()||"NZ"==r.domain.toUpperCase())r.pageLoad.amtForHiringVehicle="",r.pageLoad.carRentalPerMonth="";B(function(){q.$apply();0<jQuery(".smBiz-flyout").length&&767<jQuery(window).width()&&jQuery(".smBiz-flyout").addClass("flyout-open");
jQuery(".smBiz-flyout .close-icon-black").click(function(){jQuery(".smBiz-flyout").removeClass("flyout-open")});jQuery(".smBiz-enroll-button").click(function(){jQuery(".smBiz-flyout").addClass("flyout-open")})},100);"au"!=r.domain&&""==r.pageLoad.state&&(r.pageLoad.state=null)}C("ExceptionHandlerController",{$scope:q});var r=this,x="",M="";v.smallBizFunctionCall=!0;r.domain=y.domain;r.pageName=p.current.name;r.loadHelpModal=function(b){r.helpURL=e.getUrl(b.target.parentElement,r.reservationModel.pickCountry)};
r.homePageRedirection=function(){y.location.href=v.contextPath+"/"+v.locale+"/home.html"};r.close=function(){window.location.reload()};r.employeeReservationSubmit=function(b){r.pageLoad.vehicleType&&(r.pageLoad.vehicleType=r.pageLoad.vehicleType.toString());A.validate(b).success(r._validationSuccess).error(r._validationError)};r.smallBizYourInfoformSubmit=function(b){A.validate(b).success(r._validationYourInfoSuccess).error(r._validationYourInfoError)};r.smallBizConfirmSubmit=function(b){if("US"==
r.domain.toUpperCase()||"CA"==r.domain.toUpperCase())r.disableEnroll=!0;A.validate(b).success(r._validationCompInfoSuccess).error(r._validationCompInfoError)};r.smallBizRentalInfoformSubmit=function(b){r.disableEnroll=!0;r.pageLoad.passenger&&r.pageLoad.commercial?(r.pageLoad.vehicleType=r.vehicleTypes,r.pageLoad.vehicleType=r.pageLoad.vehicleType.toString()):1==r.pageLoad.passenger?(r.pageLoad.vehicleType="Passenger",r.pageLoad.vehicleType=r.pageLoad.vehicleType.toString()):1==r.pageLoad.commercial&&
(r.pageLoad.vehicleType="Commercial",r.pageLoad.vehicleType=r.pageLoad.vehicleType.toString());r.displayForm="rental-info";A.validate(b).success(r._validationRentalInfoSuccess).error(r._validationRentalInfoError)};r.progressBar=function(b){r.prod={};if("comp-info"==r.displayForm||"rental-info"==r.displayForm)r.displayForm=b};r.reservationModel=n.bookingModel;r._validationSuccess=function(b){void 0==r._vehicleTypeValidate()?(v.requestInProgress=!0,b=!1,ABG.arrayHasObject(r.pageLoad.country,["PR","CV",
"CX"])&&(b=!0),r.pageLoad.state=angular.isDefined(r.pageLoad.country)&&!b?r.pageLoad.state:"",F.load(r.pageLoad,r.domain).then(function(b){r.prod=q.processErrorMessage(b);if(b.fieldErrors&&0<b.fieldErrors.length)for(var e,f=0;f<b.fieldErrors.length;f++)b.fieldErrors[f].fieldName&&(e="vm.pageLoad."+b.fieldErrors[f].fieldName,A.displayServiceError(e,"invalid"));else r.prod.errorList&&0<r.prod.errorList.length?(r.showConfirmPage=!1,r.smallbizPageError="",G.scrollTo("scrollForm")):(r.showConfirmPage=
!0,y.scrollTo(0,0),jQuery(".succ-modal").modal("show")),r.firstname=r.pageLoad.firstName,r.pageLoad={};v.requestInProgress=!1})):r.smallbizPageError=b.MSG[0]};r._validationYourInfoSuccess=function(b){r._updateSmallBizModel();r.smallBizError="";r.displayForm="comp-info"};r._validationYourInfoError=function(b){var e=b.errorCount;1===e?r.smallbizPageError=b.MSG[0]:1<e&&(r.smallbizPageError=Dictionary.I18n.get("err.global.multi.errorMessage"));v.requestInProgress=!1;r.disableEnroll=!1};r._validationCompInfoSuccess=
function(){r._updateSmallBizModel();"AU"==r.domain.toUpperCase()||"NZ"==r.domain.toUpperCase()?(r.smallBizError="",r.displayForm="rental-info"):v.smallBizFunctionCall&&r._loadSmallBizService()};r._loadSmallBizService=function(){v.smallBizFunctionCall=!1;F.load(r.pageLoad,r.domain).then(function(b){if(b.fieldErrors)r.prod=q.processErrorMessage(b),r.disableEnroll=!1,$("#small-biz-modal").animate({scrollTop:$("#small-biz-modal").offset().top},"slow"),v.smallBizFunctionCall=!0;else if(b.templateSummary&&
b.templateSummary.errorMsg)r.smallBizError=l.trustAsHtml(b.templateSummary.errorMsg.message),r.disableEnroll=!1,$("#small-biz-modal").animate({scrollTop:$("#small-biz-modal").offset().top},"slow"),v.smallBizFunctionCall=!0;else{if("us"==y.domain||"ca"==y.domain)r.discountNumber=b.templateSummary.discountNumber;r.displayForm="success-message"}v.requestInProgress=!1})};r._validationRentalInfoSuccess=function(){var b=angular.element(document).injector().get("getDataService").getConfirmationData();angular.isDefined(b)&&
(r.pageLoad.receiptOrConfirmationNumber=b.reservationSummary.confirmationNumber);r._updateSmallBizModel();r.smallBizError="";"AU"!=r.domain.toUpperCase()&&"NZ"!=r.domain.toUpperCase()||y.brand!=w.brandName.AVIS&&y.brand!=w.brandName.BUDGET&&y.brand!=w.brandName.BUDGETTRUCK||"rental-info"!=r.displayForm||1!=r.updateName||(r.pageLoad.formName=y.brand+"SmallBiz"+r.domain.toUpperCase(),y.brand==w.brandName.BUDGETTRUCK&&(r.pageLoad.formName="budgetSmallBiz"+r.domain.toUpperCase()),r.updateName=!1);r._vehicleTypeValidate();
r._loadSmallBizService()};r._validationRentalInfoError=function(b){r.disableEnroll=!1;var e=b.errorCount;e=r._vehicleTypeValidate(e);1===e?r.smallbizPageError=b.MSG[0]:1<e&&(r.smallbizPageError=Dictionary.I18n.get("err.global.multi.errorMessage"));v.requestInProgress=!1;G.scrollTo("scrollForm")};r._validationCompInfoError=function(){r.disableEnroll=!1};r._updateSmallBizModel=function(){r.partnerPageLoad={firstName:r.pageLoad.firstName,lastName:r.pageLoad.lastName,zip:r.pageLoad.zip,userEmail:r.pageLoad.userEmail,
retypeUserEmail:r.pageLoad.userEmail,companyName:r.pageLoad.companyName,address1:r.pageLoad.address1,address2:r.pageLoad.address2,city:r.pageLoad.city,phone:r.pageLoad.phone,state:r.pageLoad.state,country:r.pageLoad.country,formName:r.pageLoad.formName,subscription:r.pageLoad.subscription,amtForHiringVehicle:r.pageLoad.amtForHiringVehicle,carRentalPerMonth:r.pageLoad.carRentalPerMonth,requirements:r.pageLoad.requirements,receiptOrConfirmationNumber:r.pageLoad.receiptOrConfirmationNumber,smallBizConfirm:"true"};
r.pageLoad.retypeUserEmail=r.pageLoad.userEmail;F.setModel(r.partnerPageLoad)};r._validationError=function(b){var e=b.errorCount;e=r._vehicleTypeValidate(e);1===e?(r.smallbizPageError=b.MSG[0],document.getElementsByName(b.fieldName)[0].focus()):1<e&&(r.smallbizPageError=Dictionary.I18n.get("err.global.multi.errorMessage"),G.scrollTo("employeeForm"));v.requestInProgress=!1};r._vehicleTypeValidate=function(e){if(void 0!=r.pageLoad.vehicleType&&0!=r.pageLoad.vehicleType.length||r.domain!=b.toLowerCase()&&
r.domain!=O.toLowerCase())r.errorMessage="",void 0!=r.prod&&delete r.prod.errorList;else{r.errorMessage=Dictionary.I18n.get("err.smallBiz.typeOfVehicle.required");e=e?e+1:1;if(angular.isUndefined(r.prod)||angular.isUndefined(r.prod.length))r.prod={},r.prod.errorList=r.prod.errorList?r.prod.errorList:[];r.prod.errorList&&(1>=e||angular.isUndefined(e))&&(r.smallbizPageError="",r.prod.errorList.push({message:r.errorMessage}));G.scrollTo("scrollForm")}return e};r.countries=y.countryOfResidence;r.statesList=
[];r.displayForm="your-info";r.stateList=[];r._setResidency=function(){var e=w.countryCodeUS,f=w.countryCodeCA;r.countriesAndStates=angular.fromJson(r.countries);r.partnerType=y.partnerType;if(r.partnerType==f){r.locations=r.countriesAndStates.filter(function(b){b.code===r.partnerType&&(r.stateList=b.stateList);return b.code===r.partnerType});var h=f}else r.partnerType==e?(r.locations=r.countriesAndStates.filter(function(b){b.code===r.partnerType&&(r.stateList=b.stateList);return b.code!=f}),h=e):
r.domain==b.toLowerCase()?(r.locations=r.countriesAndStates.filter(function(e){e.code===b&&(r.stateList=e.stateList);return e.code}),h=b,angular.forEach(r.stateList,function(b,e){b.stateName==w.smallBiz.defaultState&&(r.pageLoad.state=w.smallBiz.defaultState)})):r.domain==O.toLowerCase()?(r.locations=r.countriesAndStates.filter(function(b){b.code===O&&(r.stateList=b.stateList);return b.code!=f}),h=O):r.domain!=e.toLowerCase()||r.pageName!=w.confirmationPage&&r.pageName!=w.displayConfirmationPage&&
r.pageName!=w.preCheckoutCompletePage?r.domain!=f.toLowerCase()||r.pageName!=w.confirmationPage&&r.pageName!=w.displayConfirmationPage&&r.pageName!=w.preCheckoutCompletePage||(r.locations=r.countriesAndStates.filter(function(b){b.code===f&&(r.stateList=b.stateList);return b.code===f}),h=f):(r.locations=r.countriesAndStates.filter(function(b){b.code===e&&(r.stateList=b.stateList);return b.code!=f}),h=e);if(angular.isDefined(r.locations)){var l=r.locations.indexOf(g("filter")(r.locations,function(b){return b.code===
h})[0]);-1<l&&(r.pageLoad.country=r.locations[l].code,r.pageLoad.agentCountry=r.locations[l].code)}r.pageLoad.country==w.countryCodeCA&&(r.pageLoad.subscription="N")};r._pageInit=h;r._load=F.load;r.pageLoad={};r.partnerPageLoad={};r.showConfirmPage=!1;r.pageLoad.subscription="Y";r.partnerIDLink=function(){if("avisEmployee"==r.pageLoad.formName||"avisCustomer"==r.pageLoad.formName)r.partnerPageLoad={worldWideId:r.pageLoad.worldWideId,rentalNumber:r.pageLoad.rentalNumber,title:r.pageLoad.title,subscription:"Y",
companyName:r.pageLoad.companyName,address1:r.pageLoad.address1,address2:r.pageLoad.address2,city:r.pageLoad.city,phone:r.pageLoad.phone,location:r.pageLoad.location,zip:r.pageLoad.zip,smallBizConfirm:"false"};if("avisTravelAgent"==r.pageLoad.formName||"smallBizConfirmform"==r.pageLoad.formName)r.partnerPageLoad={firstName:r.pageLoad.firstName,lastName:r.pageLoad.lastName,title:r.pageLoad.title,subscription:"Y",zip:r.pageLoad.zip,userEmail:r.pageLoad.userEmail,retypeUserEmail:r.pageLoad.retypeUserEmail,
companyName:r.pageLoad.companyName,address1:r.pageLoad.address1,address2:r.pageLoad.address2,city:r.pageLoad.city,phone:r.pageLoad.phone,empTrvlFirstName:r.pageLoad.empTrvlFirstName,empTrvlLastName:r.pageLoad.empTrvlLastName,trvlAgentEmailAddress:r.pageLoad.trvlAgentEmailAddress,retypeTrvlAgentEmailAddress:r.pageLoad.retypeTrvlAgentEmailAddress,arcIataNo:r.pageLoad.arcIataNo,clubRedNum:r.pageLoad.clubRedNum,trvlAgentName:r.pageLoad.trvlAgentName,trvlAgentPhone:r.pageLoad.trvlAgentPhone,trvlAgentTitle:r.pageLoad.trvlAgentTitle,
agentAddress1:r.pageLoad.agentAddress1,agentAddress2:r.pageLoad.agentAddress2,agentCity:r.pageLoad.agentCity,agentZipCode:r.pageLoad.agentZipCode,wizardNumber:r.pageLoad.wizardNumber};if("budgetCustomer"==r.pageLoad.formName||"budgetEmployee"==r.pageLoad.formName||"budgetTravelAgent"==r.pageLoad.formName)r.partnerPageLoad={firstName:r.pageLoad.firstName,lastName:r.pageLoad.lastName,title:r.pageLoad.title,subscription:"Y",userEmail:r.pageLoad.userEmail,retypeUserEmail:r.pageLoad.retypeUserEmail,companyName:r.pageLoad.companyName,
address1:r.pageLoad.address1,address2:r.pageLoad.address2,city:r.pageLoad.city,phone:r.pageLoad.phone,empTrvlFirstName:r.pageLoad.empTrvlFirstName,empTrvlLastName:r.pageLoad.empTrvlLastName,trvlAgentEmailAddress:r.pageLoad.trvlAgentEmailAddress,retypeTrvlAgentEmailAddress:r.pageLoad.retypeTrvlAgentEmailAddress,arcIataNo:r.pageLoad.arcIataNo,clubRedNum:r.pageLoad.clubRedNum,trvlAgentName:r.pageLoad.trvlAgentName,trvlAgentPhone:r.pageLoad.trvlAgentPhone,trvlAgentTitle:r.pageLoad.trvlAgentTitle,agentAddress1:r.pageLoad.agentAddress1,
agentAddress2:r.pageLoad.agentAddress2,agentCity:r.pageLoad.agentCity,agentZipCode:r.pageLoad.agentZipCode,worldWideId:r.pageLoad.worldWideId,rentalNumber:r.pageLoad.rentalNumber,location:r.pageLoad.location,zip:r.pageLoad.zip};F.setModel(r.partnerPageLoad);"avisCustomer"==r.pageLoad.formName||"avisEmployee"==r.pageLoad.formName||"avisTravelAgent"==r.pageLoad.formName?window.internalLocale.includes("US")?(x=v.locale.split("_"),M=x[0],y.location.href="/content/avis/na/ca/"+M+"_CA/business-programs/small-mid-sized-business/partner-"+
r.partnerPageId+".html"):window.internalLocale.includes("CA")&&(x=v.locale.split("_"),M=x[0],y.location.href="/content/avis/na/us/"+M+"_US/business-programs/small-mid-sized-business/partner-"+r.partnerPageId+".html"):window.internalLocale.includes("US")?(x=v.locale.split("_"),M=x[0],y.location.href="/content/budget/na/ca/"+M+"_CA/programs/business-car-rental/partner-"+r.partnerPageId+".html"):window.internalLocale.includes("CA")&&(x=v.locale.split("_"),M=x[0],y.location.href="/content/budget/na/us/"+
M+"_US/programs/business-car-rental/partner-"+r.partnerPageId+".html")};r.pageType=y.pageType;r.partnerPage=y.partnerPage;r.smallBizAnnualSpend=F.getSmallBizAnnualSpend();r.smallBizNumberOfCarRentals=F.getSmallBizNumberOfCarRentals();r.smallBizTypeOfVehicle=F.getSmallBizTypeOfVehicle();r.smallBizSalutation=angular.element(document).injector().get("myProfileService").getTitleList();r.vehicleTypes=["Passenger","Commercial"];var b=w.countryCodeAU,O=w.countryCodeNZ;void 0!=r.partnerPage&&""!=r.partnerPage&&
(r.partnerPage=y.partnerPage.split("partner-")[1],r.partnerPageId=r.partnerPage.split(".")[0]);r.disableEnroll=!1;delete r.smallBizSalutation[""];r.updateName=!0;r.uniqueCurrencylist=y.countryList;t=C("smallBizExnController",{$scope:q});angular.extend(this,t);jQuery(document).ready(function(){r._setResidency()});h()}angular.module("carRental").controller("smallbizController",t);t.$inject="$q $scope $sce $rootScope $state $window $filter $controller $validation $timeout smallbizService couponService carRentalConstant brandConstant anchorSmoothScroll reservationModelService gaService $compile authenticationService utilityService storageService $cookies getVehicles".split(" ")})();
(function(){angular.module("DynamicForm",[])})();
(function(){function t(t,q,l,v,p,y,g,C,A,B,F,E,w,z,G,n,H,I,u){function m(b,e){e.forEach(function(e){b.hasOwnProperty(e)&&delete b[e]});return b}function f(){var b=angular.element('input[type\x3d"file"]');e.dynamicModel.fileName=void 0;b[0].files[0]?(M=b[0].files[0],e.dynamicModel.file=M,e.dynamicModel.fileName=M.name,e.dynamicModel.fileSizeThreshold=angular.element('input[type\x3d"file"]').attr("file-size-threshold"),b=angular.element('input[type\x3d"file"]').attr("supported-file-formats"),null!=
b&&(e.dynamicModel.supportedFileFormats=b.split(",")),e.dynamicModel.fileSize=M.size,e.dynamicModel.fileFormat=M.name.split(".").pop().toLowerCase()):angular.element(".platform-error-message.error").text("");t.$apply()}function x(){var b=angular.element('input[type\x3d"file"]');angular.forEach(b,function(b,e){b.value=null});e.dynamicModel=m(e.dynamicModel,"file fileName fileSize fileSizeThreshold supportedFileFormats fileFormat".split(" "))}var e=this;v=q.countryList;var h=q.parentPageName;B=q.vehicleList;
var r="";n.getLocationsObjModel();e.ccDates=n.getCCObjModel();e.dateObj=n.getDateObjModel();e.timeObj=n.getTimeObjModel();var J=q.domain;e.smallbizForm=!1;var M="";g("ExceptionHandlerController",{$scope:t});e.expMonths=[];e.countriesList=angular.fromJson(v);e.vehicleList="";angular.isDefined(B)&&(e.vehicleList=angular.fromJson(B));e.uniqueCurrencylist=[{country:"Afghanistan",currency:"AFA"},{country:"Albania",currency:"ALL"},{country:"Algeria",currency:"DZD"},{country:"Andorra",currency:"ADF"},{country:"Andorra",
currency:"ADP"},{country:"Angola",currency:"AON"},{country:"Anguilla",currency:"XCD"},{country:"Argentina",currency:"ARS"},{country:"Aruba",currency:"AWG"},{country:"Australia",currency:"AUD"},{country:"Austria",currency:"ATS"},{country:"Bahamas",currency:"BSD"},{country:"Bahrain",currency:"BHD"},{country:"Bangladesh",currency:"BDT"},{country:"Barbados",currency:"BBD"},{country:"Belgium",currency:"BEF"},{country:"Belize",currency:"BZD"},{country:"Bermuda",currency:"BMD"},{country:"Bhutan",currency:"BTN"},
{country:"Bolivia",currency:"BOB"},{country:"Botswana",currency:"BWP"},{country:"Brazil",currency:"BRL"},{country:"Britain",currency:"GBP"},{country:"Brunei",currency:"BND"},{country:"Bulgaria",currency:"BGL"},{country:"Burundi",currency:"BIF"},{country:"CFA Franc BCEAO",currency:"XOF"},{country:"CFA Franc BEAC ",currency:"XAF"},{country:"CFP Franc",currency:"XPF"},{country:"Cambodia",currency:"KHR"},{country:"Canada",currency:"CAD"},{country:"Cape Verde",currency:"CVE"},{country:"Cayman Islands",
currency:"KYD"},{country:"Chile",currency:"CLP"},{country:"China",currency:"CNY"},{country:"Colombia",currency:"COP"},{country:"Comoros",currency:"KMF"},{country:"Costa Rica",currency:"CRC"},{country:"Croatia",currency:"HRK"},{country:"Cuba",currency:"CUP"},{country:"Cyprus",currency:"CYP"},{country:"Czech Rep",currency:"CZK"},{country:"Denmark",currency:"DKK"},{country:"Djibouti",currency:"DJF"},{country:"Dominican Rep",currency:"DOP"},{country:"Ecuador",currency:"ECS"},{country:"Egypt",currency:"EGP"},
{country:"El Salvador",currency:"SVC"},{country:"Estonia",currency:"EEK"},{country:"Ethiopia",currency:"ETB"},{country:"Europe",currency:"EUR"},{country:"Falkland Islands",currency:"FKP"},{country:"Fiji",currency:"FJD"},{country:"Gambia",currency:"GMD"},{country:"Ghana",currency:"GHC"},{country:"Gibraltar",currency:"GIP"},{country:"Guatemala",currency:"GTQ"},{country:"Guinea",currency:"GNF"},{country:"Guyana",currency:"GYD"},{country:"Haiti",currency:"HTG"},{country:"Honduras",currency:"HNL"},{country:"Hong Kong ",
currency:"HKD"},{country:"Hungary",currency:"HUF"},{country:"Iceland",currency:"ISK"},{country:"India",currency:"INR"},{country:"Indonesia",currency:"IDR"},{country:"Iran",currency:"IRR"},{country:"Iraq",currency:"IQD"},{country:"Israel",currency:"ILS"},{country:"Jamaica",currency:"JMD"},{country:"Japan",currency:"JPY"},{country:"Jordan",currency:"JOD"},{country:"Kazakhstan",currency:"KZT"},{country:"Kenyan",currency:"KES"},{country:"Kuwait",currency:"KWD"},{country:"Lao",currency:"LAK"},{country:"Latvia",
currency:"LVL"},{country:"Lebanon",currency:"LBP"},{country:"Lesotho",currency:"LSL"},{country:"Liberia",currency:"LRD"},{country:"Libya",currency:"LYD"},{country:"Lithuania",currency:"LTL"},{country:"Luxembourg",currency:"LUF"},{country:"Macau",currency:"MOP"},{country:"Madagascar",currency:"MGF"},{country:"Malawi",currency:"MWK"},{country:"Malaysia",currency:"MYR"},{country:"Maldive",currency:"MVR"},{country:"Malta",currency:"MTL"},{country:"Mauritania",currency:"MRO"},{country:"Mauritius",currency:"MUR"},
{country:"Mexico",currency:"MXN"},{country:"Mongolia",currency:"MNT"},{country:"Morocco",currency:"MAD"},{country:"Mozambique",currency:"MZM"},{country:"Myanmar",currency:"MMK"},{country:"NL Antillilles",currency:"ANG"},{country:"Namibia",currency:"NAD"},{country:"Nepal",currency:"NPR"},{country:"New Zealand",currency:"NZD"},{country:"Nicaragua",currency:"NIO"},{country:"Nigeria",currency:"NGN"},{country:"North Korea",currency:"KPW"},{country:"Norway",currency:"NOK"},{country:"Oman",currency:"OMR"},
{country:"Pakistan",currency:"PKR"},{country:"Panama",currency:"PAB"},{country:"Papua New Guinea",currency:"PGK"},{country:"Paraguay",currency:"PYG"},{country:"Peru",currency:"PEN"},{country:"Philippines",currency:"PHP"},{country:"Poland",currency:"PLN"},{country:"Portugal",currency:"PTE"},{country:"Qatar",currency:"QAR"},{country:"Romania",currency:"ROL"},{country:"Russia",currency:"RUB"},{country:"Samoa",currency:"WST"},{country:"Sao Tome/Principe",currency:"STD"},{country:"Saudi Arabia",currency:"SAR"},
{country:"Seychelles",currency:"SCR"},{country:"Sierra Leone",currency:"SLL"},{country:"Singapore",currency:"SGD"},{country:"Slovakia",currency:"SKK"},{country:"Slovenia",currency:"SIT"},{country:"Solomon Islands",currency:"SBD"},{country:"Somalia",currency:"SOS"},{country:"South Africa",currency:"ZAR"},{country:"South Korea",currency:"KRW"},{country:"Sri Lanka ",currency:"LKR"},{country:"St.Helena",currency:"SHP"},{country:"Sudan",currency:"SDD"},{country:"Sudan",currency:"SDP"},{country:"Suriname",
currency:"SRG"},{country:"Swaziland",currency:"SZL"},{country:"Sweden",currency:"SEK"},{country:"Switzerland",currency:"CHF"},{country:"Syria",currency:"SYP"},{country:"Taiwan",currency:"TWD"},{country:"Tanzania",currency:"TZS"},{country:"Thailand",currency:"THB"},{country:"Tonga",currency:"TOP"},{country:"Trinidad/Tobago",currency:"TTD"},{country:"Tunisia",currency:"TND"},{country:"Turkey",currency:"TRL"},{country:"U.S.A.",currency:"USD"},{country:"Uganda",currency:"UGS"},{country:"Ukraine",currency:"UAH"},
{country:"Uruguay",currency:"UYP"},{country:"United Arab Emirates",currency:"AED"},{country:"Vanuatu",currency:"VUV"},{country:"Venezuela",currency:"VEB"},{country:"Vietnam",currency:"VND"},{country:"Yemen",currency:"YER"},{country:"Yugoslavia",currency:"YUN"},{country:"Zambia",currency:"ZMK"},{country:"Zimbabwe",currency:"ZWD"}];g=z.getCreditCardDetails();e.creditCardlist=g.masterListForCC;e.successMessage=!1;e.mainErrorFlag=!1;e._pageInit=function(){e.dynamicModel=n.getModel();(p.isRememberME||
p.isAuthenticated||p.isRecognized)&&q.brand!=w.brandName.PAYLESS&&e._prefillCustomerInfo();"group-rental"==h?(e.EventList=[{code:"Select",name:"Select"},{code:"US",name:"U S A"},{code:"CA",name:"Canada"},{code:"PR",name:"Puerto Rico"},{code:"CX",name:"US Virgin Islands (St Croix)"},{code:"CV",name:"US Virgin Islands (St Thomas)"}],e.dynamicModel.countryOfEvent=e.EventList[0].name):e._setDefaultValues();q.brand===w.brandName.PAYLESS&&C.setExpression({platformawd:/[a-zA-Z]{4}[0-9]{3}$|^[a-zA-Z]\d{7}$|^[a-zA-Z]\d{6}$|^[a-zA-Z]{3}[0-9]{3}$/})};
e._validationSuccess=function(){1==e.smallbizForm?(e.reservationModel=u.bookingModel,e.reservationModel.coupon.discountNumber=w.smallbizPdn,u.setReservationModel(e.reservationModel),q.location.href=contextPath+"/"+locale+"/deals/us-offers/small-business/small-business-program"+htmlExtension):(p.requestInProgress=!0,angular.isDefined(e.dynamicModel.zipCode)&&(e.dynamicModel.zip=e.dynamicModel.zipCode),angular.isDefined(e.dynamicModel.userEmail)&&(e.dynamicModel.retypeUserEmail=e.dynamicModel.userEmail),
n.submit(e.dynamicModel).then(function(b){p.requestInProgress=!1;e.result=t.processErrorMessage(b);b.errorList?e.successMessage=!1:(e.mainErrorFlag=!1,e.sameAsBuyer=!1,x(),e.dynamicForm.pageReset(r),e.prefillReceipentDetails(),e.successMessage=!0,I.scrollTo("form-success"),A(function(){e._pageInit()},2E3));(b.fieldErrors&&1<b.fieldErrors.length||!b.fieldErrors)&&b.errorList&&0<b.errorList.length&&(e.mainErrorFlag=!0,I.scrollTo("mainerror"));if(b.fieldErrors&&0<b.fieldErrors.length)for(var f="",g=
0;g<b.fieldErrors.length;g++)b.fieldErrors[g].fieldName&&(f="vm.dynamicModel."+b.fieldErrors[g].fieldName,C.displayServiceError(f,"invalid"))},function(b){}))};e._validationFailure=function(b){1!=e.smallbizForm?(e.successMessage=!1,e.mainErrorFlag=!0,e.dynamicForm.validated=!0,e.dynamicForm.formPageError=l("htmlFilter")(ABG.getFormValidationError(b,!1)[0].message),I.scrollTo("mainerror")):(e.successMessage=!1,e.mainErrorFlag=!0,e.errorMessage=Dictionary.I18n.get("07004"))};e._validateCombinationFields=
function(b){C.displayServiceError()};e._prefillCustomerInfo=function(){e.customer=F.getCustomerModel();e.customer&&(p.isAuthenticated?(e.dynamicModel.firstName=e.customer.firstName,angular.forEach(e.customer.contacts.email,function(b){1==b.primary&&(e.dynamicModel.userEmail=b.email,e.dynamicModel.userReEmail=b.email)}),e.dynamicModel.lastName=e.customer.lastName,e.dynamicModel.phone=e.customer.contacts.homePhone,angular.forEach(e.customer.contacts.address,function(b){1==b.primary&&(e.dynamicModel.address1=
b.address1,e.dynamicModel.address2=b.address2,e.dynamicModel.state=b.state,e.dynamicModel.city=b.city,e.dynamicModel.zipCode=b.zipCode,e._setCountry(b.country))})):e.dynamicModel.firstName=e.customer.firstName,void 0!=e.dynamicModel.customerId?e.dynamicModel.customerId=e.customer.wizardNumberMasked:e.dynamicModel.wizardNumber=e.customer.wizardNumberMasked)};e._setDefaultValues=function(){var b=ABG.getClientInfo();e.dynamicModel.browser=b.browser;e.dynamicModel.os=b.os;e._setCountry(J.toUpperCase());
e.dynamicModel.ccType=w.creditCardTypeAmericanId;angular.element('input[type\x3d"file"]').bind("change",f)};e._getLocationFromElement=function(b){return angular.element("#"+b).val()};e._setCountry=function(b){if(angular.isDefined(e.countriesList)){var f=e.countriesList.indexOf(l("filter")(e.countriesList,function(e){return e.code===b})[0]);e.dynamicModel.country=e.countriesList[f].code;e.dynamicModel.pickUpCountry=e.dynamicModel.dropOffCountry=e.countriesList[f].code}};e._setDate=function(){var b=
new Date;b={day:b.getDate(),month:b.getMonth()+1,year:b.getFullYear().toString()};b.day=ABG.prefixZero(b.day);b.month=ABG.prefixZero(b.month);return b};e._setTime=function(){e.defaultTime=e.times[24].value;return e.defaultTime};e.dynamicModel={};e.loadAttachmentDetails=f;e.getSuggestions=function(b,f,g){if(b)return 83<b.userInputString.length&&(b.userInputString=b.userInputString.slice(0,80)),f={userInputString:b.userInputString},angular.isDefined(b.lat)&&angular.isDefined(b.lon)&&(f.lat=b.lat,f.lon=
b.lon),e.suggestions=[],b=H.loadLocation(f),b.then(function(b){b&&b.data&&(e.suggestions=b.data.suggestions)}),b;b=y.defer();b.reject({});return b.promise};e.loadMnthYrDropdown=function(b,f){e.dateObj[f]=e._setDate();e.updateDate(b,e.dateObj[f]);b=ABG.loadMonthAndYear();e.expMonths=b.expMonths;e.expYears=b.expYears};e.loadTimeDropdown=function(b,f){e.times=w.timeDefaultFormat;e.times[0].minits=Dictionary.I18n.get("msg.res.midnight");e.times[24].minits=Dictionary.I18n.get("msg.res.defaultTime");e.timeObj[f]=
e._setTime();e.updateTime(b,e.timeObj[f])};e.prefillReceipentDetails=function(){e.dynamicModel=n.cloneModel(e.dynamicModel,e.sameAsBuyer)};e.updateDate=function(b,f){var g="vm.dynamicModel."+b;e.dynamicModel[b]="au"==q.domain||"nz"==q.domain?f.day+"/"+f.month+"/"+f.year:f.month+"/"+f.day+"/"+f.year;""==f.year||void 0==f.year?C.displayServiceError(g,"required"):/^\d{4}$/.test(f.year)?C.resetError(g):C.displayServiceError(g,"invalid")};e.updateTime=function(b,f){e.dynamicModel[b]=f};e.removeAttachment=
x;e.updatelocationData=function(b,f){!angular.equals({},b)&&f.match("Id$")&&(f=f.substring(0,f.lastIndexOf("Id")),angular.isDefined(e.dynamicModel[f])&&angular.isDefined(b.originalObject.suggCode)&&(e.dynamicModel[f]=angular.copy(b.originalObject.suggCode)))};e.reqConfNumber=function(){e.checked=!e.checked;1==e.checked&&(e.dynamicModel.receiptOrConfirmationNumber="")};e.lengthOfRentals=function(){if("au"===window.domain||"nz"===window.domain){if(-1<window.location.href.indexOf("long-term-commercial-truck-rental")){var b=
Dictionary.I18n.get("lbl.reservation.lengthOfRentalsTruck,"+q.brand);var f=Dictionary.I18n.get("lbl.reservation.vehichleListTruckJson,"+q.brand)}else b=Dictionary.I18n.get("lbl.reservation.lengthOfRentals,"+q.brand),f=Dictionary.I18n.get("lbl.reservation.vehichleListJson,"+q.brand);b=JSON.parse(b);e.lengthOfRentalsList=b.lengthOfRentals;f=JSON.parse(f);e.vehichleListJson=f.typeOfVehichleJson}};e.prestigeForm=function(){if("au"===window.domain||"nz"===window.domain){var b=Dictionary.I18n.get("lbl.reservation.au.locationListJson,"+
q.brand),f=Dictionary.I18n.get("lbl.res.natureOfQuery,"+q.brand),g=Dictionary.I18n.get("lbl.res.vehicleMake,"+q.brand),h=Dictionary.I18n.get("lbl.res.prestigeVehicleType,"+q.brand);b=JSON.parse(b);e.prestigeLocList=b.auLocationList;f=JSON.parse(f);e.natureOfQryList=f.natureOfQuery;g=JSON.parse(g);e.vehicleMakeTypeList=g.vehicleMake;h=JSON.parse(h);e.prestigeVehicleTList=h.prestigeVehicleType}};e.checked=!1;e.dynamicForm={validated:!1,pageSubmit:function(b){r=b;e.prefillReceipentDetails();""!=e.ccDates.expMonth&&
(e.dynamicModel.ccExp=e.ccDates.expMonth+"/"+e.ccDates.expYear);"group-rental"==h?(e.dynamicModel.eventDescription=e.dynamicModel.eventName,e.dynamicModel.eventName=window.location.href.substr(window.location.href.lastIndexOf("/")+1),angular.isDefined(e.dynamicModel.countryOfEvent)&&"Select"!=e.dynamicModel.countryOfEvent?e.dynamicModel.country=e.dynamicModel.countryOfEvent:e.dynamicModel.country=""):(e.dynamicModel.dropLocation=""==e.dynamicModel.dropLocation?e._getLocationFromElement("dropLocationId_value"):
e.dynamicModel.dropLocation,e.dynamicModel.locationOfInterest=""==e.dynamicModel.locationOfInterest?e._getLocationFromElement("locationOfInterestId_value"):e.dynamicModel.locationOfInterest,e.dynamicModel.pickupLocation=""==e.dynamicModel.pickupLocation?e._getLocationFromElement("pickupLocationId_value"):e.dynamicModel.pickupLocation,e.dynamicModel.productionLocation=""==e.dynamicModel.productionLocation?e._getLocationFromElement("productionLocationId_value"):e.dynamicModel.productionLocation,e.dynamicModel.airport=
""==e.dynamicModel.airport?e._getLocationFromElement("airportId_value"):e.dynamicModel.airport);e.dynamicModel.formName=q.dynamicFormName;e.errorMessage=q.serviceError;e.dynamicModel.customerServiceEmail=q.customerServiceEmail;C.validate(b).success(e._validationSuccess).error(e._validationFailure)},pageReset:function(b){C.reset(b);e.errorMessage="";e.mainErrorFlag=!1},formPageError:""};p.$on("Profile.successAuthentication",function(b,f){q.brand!=w.brandName.PAYLESS&&e._prefillCustomerInfo()});e._pageInit()}
angular.module("DynamicForm").controller("DynamicFormController",t);t.$inject="$scope $window $filter $locale $rootScope $q $controller $validation $timeout datePickerInit authenticationService utilityService carRentalConstant myProfileService gaService dynamicFormService locationService anchorSmoothScroll reservationModelService".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C){var x={dropLocation:"",pickupLocation:"",locationOfInterest:"",productionLocation:"",airport:""},B={expMonth:"",expYear:""},F={startDateObj:{year:"",month:"",day:""},pickupDateObj:{year:"",month:"",day:""},endDateObj:{year:"",month:"",day:""},dropDateObj:{year:"",month:"",day:""}},E={pickupTimeObj:"",dropTimeObj:""},w={formName:"",browser:"",os:"",address1:"",address2:"",certificateAmount:"",amountBilled:"",amountQuoted:"",airport:"",awdNumber:"",ccType:"",
ccNumber:"",ccExp:"",companyName:"",comments:"",corporationName:"",currency:"",customerId:"",customerServiceEmail:"",country:"",device:"",dropDate:"",dropLocation:"",endDate:"",eventCity:"",eventState:"",eventName:"",eventDescription:"",eventZipCode:"",fax:"",firstName:"",isCorporation:"false",jobTitle:"",lastName:"",locationOfInterest:"",lowerRate:"",lowerRateReservationNumber:"",noOfCars:"",noOfAttendees:"",noOfCertificate:"",phone:"",pickupDate:"",pickupLocation:"",platform:"",productionName:"",
productionLocation:"",question:"",rentalNumber:"",receiptOrConfirmationNumber:"",reservationNumber:"",servicingMeeting:"",startDate:"",state:"",receiptantInfoFirstname:"",receiptantInfoLastname:"",receiptantInfoAddress1:"",receiptantInfoAddress2:"",receiptantInfoCity:"",receiptantInfoState:"",receiptantInfoZipCode:"",receiptantInfoCountry:"",subscription:"",shipTo:"false",title:"",typeOfVehicle:"",userEmail:"",retypeUserEmail:"",version:"",website:"",zipCode:"",note:"",overNightDelivery:"",typeOfVehichleAuNz:"",
lengthOfRental:"",selectCommunication:"",prefferedCommunicationTime:"",flyerNumber:"",employeePostion:"",companyAbn:"",termAndConditions:"",additionalInformation:"",prestigelocationList:"",natureOfQuery:"",vehicleMake:"",prestigeVehicleType:""},z={formName:"",browser:"",os:"",address1:"",address2:"",certificateAmount:"",amountBilled:"",amountQuoted:"",airport:"",awdNumber:"",ccType:"",ccNumber:"",ccExp:"",companyName:"",comments:"",corporationName:"",currency:"",customerId:"",customerServiceEmail:"",
country:"",device:"",dropDate:"",dropLocation:"",endDate:"",eventCity:"",eventState:"",eventName:"",eventZipCode:"",fax:"",firstName:"",isCorporation:"false",jobTitle:"",lastName:"",locationOfInterest:"",lowerRate:"",lowerRateReservationNumber:"",noOfCars:"",noOfAttendees:"",noOfCertificate:"",phone:"",pickupDate:"",pickupLocation:"",platform:"",productionName:"",productionLocation:"",question:"",rentalNumber:"",receiptOrConfirmationNumber:"",reservationNumber:"",servicingMeeting:"",startDate:"",
state:"",receiptantInfoFirstname:"",receiptantInfoLastname:"",receiptantInfoAddress1:"",receiptantInfoAddress2:"",receiptantInfoCity:"",receiptantInfoState:"",receiptantInfoZipCode:"",receiptantInfoCountry:"",subscription:"",shipTo:"false",title:"",typeOfVehicle:"",userEmail:"",retypeUserEmail:"",version:"",website:"",zipCode:"",note:"",overNightDelivery:"",typeOfVehichleAuNz:"",lengthOfRental:"",selectCommunication:"",prefferedCommunicationTime:"",flyerNumber:"",employeePostion:"",companyAbn:"",
termAndConditions:"",additionalInformation:""},G={formName:"",browser:"",os:"",address1:"",address2:"",certificateAmount:"",amountBilled:"",amountQuoted:"",airport:"",awdNumber:"",ccType:"",ccNumber:"",ccExp:"",companyName:"",comments:"",corporationName:"",currency:"",customerServiceEmail:"",country:"",device:"",dropDate:"",dropLocation:"",dunsNumber:"",endDate:"",eventCity:"",eventState:"",eventName:"",eventZipCode:"",fax:"",firstName:"",isCorporation:"false",jobTitle:"",lastName:"",locationOfInterest:"",
lowerRate:"",lowerRateReservationNumber:"",noOfCars:"",noOfAttendees:"",noOfCertificate:"",phone:"",pickupDate:"",pickupLocation:"",platform:"",productionName:"",productionLocation:"",question:"",rentalNumber:"",receiptOrConfirmationNumber:"",reservationNumber:"",servicingMeeting:"",startDate:"",state:"",receiptantInfoFirstname:"",receiptantInfoLastname:"",receiptantInfoAddress1:"",receiptantInfoAddress2:"",receiptantInfoCity:"",receiptantInfoState:"",receiptantInfoZipCode:"",receiptantInfoCountry:"",
subscription:"",shipTo:"false",title:"",typeOfVehicle:"",userEmail:"",retypeUserEmail:"",version:"",website:"",perksId:"",zipCode:"",note:"",overNightDelivery:""},n={formName:"",browser:"",os:"",address1:"",address2:"",certificateAmount:"",amountBilled:"",amountQuoted:"",airport:"",awdNumber:"",ccType:"",ccNumber:"",ccExp:"",companyName:"",comments:"",corporationName:"",currency:"",customerServiceEmail:"",country:"",device:"",dropDate:"",dropLocation:"",endDate:"",eventCity:"",eventState:"",eventName:"",
eventDescription:"",eventZipCode:"",fax:"",firstName:"",isCorporation:"false",jobTitle:"",lastName:"",locationOfInterest:"",lowerRate:"",lowerRateReservationNumber:"",noOfCars:"",noOfAttendees:"",noOfCertificate:"",phone:"",pickupDate:"",pickupLocation:"",platform:"",productionName:"",productionLocation:"",question:"",rentalNumber:"",receiptOrConfirmationNumber:"",reservationNumber:"",servicingMeeting:"",startDate:"",state:"",receiptantInfoFirstName:"",receiptantInfoLastName:"",receiptantInfoAddress1:"",
receiptantInfoAddress2:"",receiptantInfoCity:"",receiptantInfoState:"",receiptantInfoZipCode:"",receiptantInfoCountry:"",subscription:"",shipTo:"false",title:"",typeOfVehicle:"",userEmail:"",retypeUserEmail:"",version:"",website:"",wizardNumber:"",zipCode:"",zip:"",note:"",overNightDelivery:"",typeOfVehichleAuNz:"",lengthOfRental:"",selectCommunication:"",prefferedCommunicationTime:"",flyerNumber:"",employeePostion:"",companyAbn:"",termAndConditions:!1,additionalInformation:""};return{submit:function(g){g.rqHeader=
{locale:internalLocale};var l=new FormData;l.append("userdata",new Blob([angular.toJson(g)],{type:"application/json"}));angular.forEach(l,function(f,g){""==f&&delete l[g]});if(angular.isDefined(g.file)){var n=new Blob([g.file],{type:g.file.type});l.append("file",n,g.file.name)}var m=q.defer();t({method:"POST",url:apiurl+"/customerservice/feedback",data:l}).then(function(f){m.resolve(f.data)}).catch(function(f){console.log("Error")});return m.promise},budgetFormModel:w,avisFormModel:n,getModel:function(){if(brand===
C.brandName.AVIS)return n;if(brand===C.brandName.BUDGET)return w;if(brand===C.brandName.BUDGETTRUCK)return z;if(brand===C.brandName.PAYLESS)return G},getDateObjModel:function(){return F},getTimeObjModel:function(){return E},getCCObjModel:function(){return B},getLocationsObjModel:function(){return x},cloneModel:function(g,l){1==l?(g.receiptantInfoFirstName=g.firstName,g.receiptantInfoLastName=g.lastName,g.receiptantInfoAddress1=g.address1,g.receiptantInfoAddress2=g.address2,g.receiptantInfoCity=g.city,
g.receiptantInfoState=g.state,g.receiptantInfoZipCode=g.zipCode,g.receiptantInfoCountry=g.country):0==l&&(g.receiptantInfoFirstName="",g.receiptantInfoLastName="",g.receiptantInfoAddress1="",g.receiptantInfoAddress2="",g.receiptantInfoCity="",g.receiptantInfoState="",g.receiptantInfoZipCode="",g.receiptantInfoCountry="");return g}}}angular.module("DynamicForm").service("dynamicFormService",t);t.$inject="$http $q $window $rootScope authenticationService exceptionHandler reservationModelService carRentalConstant".split(" ")})();
(function(){function t(t,q,l,v,p,y,g,C,A,B){var x={iataNumber:"vm.pageLoad.iataNumber",memberNumber:"vm.pageLoad.memberNumber"};return{load:function(l){var p=apiurl+"/reservation/update-travelagent-details",t=g.defer();q({method:"POST",url:p,data:l}).then(function(g){g=g.data;g=B.processError(g,x);t.resolve(g)}).catch(function(g){t.reject(g.data)});return t.promise}}}angular.module("reservationServices").service("travelAgentService",t);t.$inject="$rootScope $http $timeout $log $sessionStorage $window $q carRentalConstant storageService exceptionHandler".split(" ")})();
(function(){function t(t,q,l,v){}angular.module("reservation").controller("ConfirmationExnController",t);t.$inject=["$q","$scope","$rootScope","$location"]})();(function(){function t(t,q,l,v,p){}angular.module("reservation").controller("ExtrasExnController",t);t.$inject=["$sce","$scope","$rootScope","$window","$filter"]})();(function(){function t(t,q,l,v,p,y){}angular.module("reservation").controller("GlobalSummaryExnController",t);t.$inject="$controller $scope $timeout $rootScope $window $validation".split(" ")})();
(function(){function t(t,q,l,v){}angular.module("reservation").controller("LookupExnController",t);t.$inject=["$controller","$scope","$rootScope","$window"]})();(function(){function t(t,q){}angular.module("reservation").controller("ModifyReservationExnController",t);t.$inject=["$scope","$rootScope"]})();(function(){function t(t,q){}angular.module("reservation").controller("ReviewModifyExnController",t);t.$inject=["$scope","$rootScope"]})();
(function(){function t(t){}angular.module("reservation").controller("PrintConfirmationExnController",t);t.$inject=["$scope"]})();(function(){function t(t){}angular.module("carRental").controller("ProgressBarExnController",t);t.$inject=["$scope"]})();(function(){function t(t){}angular.module("reservation").controller("ReviewExnController",t);t.$inject=["$scope"]})();(function(){function t(t,q,l){}angular.module("reservation").controller("SummaryExnController",t);t.$inject=["$controller","$sce","$scope"]})();
(function(){function t(t,q){}angular.module("carRental").controller("VehicleListExnController",t);t.$inject=["$q","$scope"]})();(function(){function t(t,q){}angular.module("carRental").controller("CampaignExnController",t);t.$inject=["$scope","$rootScope"]})();(function(){function t(t,q,l){}angular.module("reservation").controller("BookAgainExnController",t);t.$inject=["$controller","$sce","$scope"]})();
(function(){function t(t,q){}angular.module("reservation").controller("BridgeExnController",t);t.$inject=["$scope","$rootScope"]})();(function(){function t(t,q){}angular.module("carRental").controller("smallBizExnController",t);t.$inject=["$controller","$scope"]})();